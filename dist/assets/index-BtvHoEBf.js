import{r as d,a as Jr,u as ln,R as Ue,b as Zr,B as Qr}from"./vendor-react-D13asCYP.js";import{c as ei}from"./vendor-supabase-1DGuDZVr.js";import{_ as ia,a as nn,b as rn,c as ti}from"./vendor-pdf-KggZeBPs.js";import{C as oa,S as ca,X as Ce,a as Zt,b as cs,c as nt,d as ct,I as lt,B as on,e as Qt,f as Nt,L as Qe,g as es,A as It,E as Es,h as ds,H as si,i as ht,j as Ra,k as vt,F as wt,P as le,l as ul,U as Jt,m as Ge,n as De,W as Oe,R as Ns,o as da,p as Ht,q as Be,G as Ds,r as cn,M as ai,T as _e,D as vs,s as dn,t as li,u as je,v as ws,w as ts,x as we,y as Ie,z as et,J as _a,K as St,N as ni,O as ri,Q as ii,V as Je,Y as Ss,Z as Ua,_ as oi,$ as ze,a0 as Ee,a1 as Ps,a2 as Ta,a3 as ci,a4 as xa,a5 as Kt,a6 as ss,a7 as ks,a8 as Za,a9 as Bt,aa as Bs,ab as Cs,ac as di,ad as xi,ae as Rs,af as Pt,ag as xn,ah as mi,ai as mn,aj as za,ak as _s,al as ui,am as Na,an as hl,ao as ea,ap as hi,aq as Qa,ar as ma,as as pl,at as bl,au as pi,av as el,aw as bi,ax as gi,ay as fi,az as ji,aA as as,aB as gl,aC as yi,aD as Ni,aE as vi,aF as wi}from"./vendor-icons-BxsMo9aJ.js";import{R as at,A as tl,a as sl,B as ua,X as Xt,Y as Et,T as ft,b as Dt,C as zt,L as un,c as ta,d as os,S as hn,e as pn,f as Zs,P as fl,g as jl,h as Si,Z as Pi}from"./vendor-charts-FOtwH6vf.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(l){if(l.ep)return;l.ep=!0;const r=a(l);fetch(l.href,r)}})();var bn={exports:{}},ha={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ki=d,Ci=Symbol.for("react.element"),Mi=Symbol.for("react.fragment"),Fi=Object.prototype.hasOwnProperty,Ai=ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xi={key:!0,ref:!0,__self:!0,__source:!0};function gn(t,s,a){var n,l={},r=null,i=null;a!==void 0&&(r=""+a),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(i=s.ref);for(n in s)Fi.call(s,n)&&!Xi.hasOwnProperty(n)&&(l[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)l[n]===void 0&&(l[n]=s[n]);return{$$typeof:Ci,type:t,key:r,ref:i,props:l,_owner:Ai.current}}ha.Fragment=Mi;ha.jsx=gn;ha.jsxs=gn;bn.exports=ha;var e=bn.exports,Ia={},yl=Jr;Ia.createRoot=yl.createRoot,Ia.hydrateRoot=yl.hydrateRoot;const Ei="https://gjpucmnghcopsatonqcy.supabase.co",Di="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqcHVjbW5naGNvcHNhdG9ucWN5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzNzYwNDQsImV4cCI6MjA4MDk1MjA0NH0.4VyQQBNmDOlhzjqLpbiBPi9bpMj6eqaGO8JYuC5bqlo",ke=ei(Ei,Di),fn=d.createContext(void 0),Bi=({children:t})=>{const[s,a]=d.useState(null),[n,l]=d.useState(null),[r,i]=d.useState(!0);d.useEffect(()=>{ke.auth.getSession().then(({data:{session:b}})=>{l(b),a(b?.user??null),i(!1)});const{data:{subscription:h}}=ke.auth.onAuthStateChange(async(b,g)=>{l(g),a(g?.user??null),i(!1)});return()=>h.unsubscribe()},[]);const p={user:s,session:n,loading:r,signIn:async(h,b)=>{const{error:g}=await ke.auth.signInWithPassword({email:h,password:b});return{error:g}},signUp:async(h,b)=>{const{error:g}=await ke.auth.signUp({email:h,password:b,options:{emailRedirectTo:`${window.location.origin}/`}});return{error:g}},signInWithGoogle:async()=>{const{error:h}=await ke.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/`}});return{error:h}},signOut:async()=>{try{await ke.auth.signOut({scope:"local"})}catch(b){console.warn("SignOut API call failed, clearing local state anyway:",b)}a(null),l(null);const h=[];for(let b=0;b<localStorage.length;b++){const g=localStorage.key(b);g&&(g.startsWith("sb-")||g.includes("supabase"))&&h.push(g)}h.forEach(b=>localStorage.removeItem(b));for(let b=sessionStorage.length-1;b>=0;b--){const g=sessionStorage.key(b);g&&(g.startsWith("sb-")||g.includes("supabase"))&&sessionStorage.removeItem(g)}window.location.href="/"},resetPassword:async h=>{const{error:b}=await ke.auth.resetPasswordForEmail(h,{redirectTo:`${window.location.origin}/reset-password`});return{error:b}}};return e.jsx(fn.Provider,{value:p,children:t})},Us=()=>{const t=d.useContext(fn);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t};async function Ri(t){const{data:s,error:a}=await ke.from("flights").select("*").eq("user_id",t).order("date",{ascending:!1});return a?(console.error("Error fetching flights:",a),[]):(s||[]).map(n=>({id:n.id,date:n.date,route:`${n.origin}-${n.destination}`,airline:n.airline,flightNumber:n.flight_number||void 0,cabin:n.cabin_class,ticketPrice:n.ticket_price,earnedMiles:n.miles_earned,earnedXP:n.xp_earned,safXp:n.saf_xp||0,uxp:n.uxp||0}))}async function Nl(t,s){if(s.length===0){const{error:i}=await ke.from("flights").delete().eq("user_id",t);return i?(console.error("Error deleting flights:",i),!1):!0}const a=s.map(i=>{const[x,c]=i.route?.split("-")||["???","???"];return{id:i.id,user_id:t,date:i.date,origin:x||"???",destination:c||"???",airline:i.airline,flight_number:i.flightNumber||null,cabin_class:i.cabin,ticket_price:i.ticketPrice,miles_earned:i.earnedMiles,xp_earned:i.earnedXP,saf_xp:i.safXp||0,uxp:i.uxp||0,is_scheduled:new Date(i.date)>new Date}}),{error:n}=await ke.from("flights").upsert(a,{onConflict:"id"});if(n)return console.error("Error upserting flights:",n),!1;const l=s.map(i=>i.id),{error:r}=await ke.from("flights").delete().eq("user_id",t).not("id","in",`(${l.join(",")})`);return r&&console.error("Error cleaning up old flights:",r),!0}async function _i(t,s){const{error:a}=await ke.from("flights").delete().eq("user_id",t);if(a)return console.error("Error deleting existing flights:",a),!1;if(s.length===0)return!0;const n=s.map(r=>{const[i,x]=r.route?.split("-")||["???","???"];return{id:crypto.randomUUID(),user_id:t,date:r.date,origin:i||"???",destination:x||"???",airline:r.airline,flight_number:r.flightNumber||null,cabin_class:r.cabin,ticket_price:r.ticketPrice,miles_earned:r.earnedMiles,xp_earned:r.earnedXP,saf_xp:r.safXp||0,uxp:r.uxp||0,is_scheduled:new Date(r.date)>new Date}}),{error:l}=await ke.from("flights").insert(n);return l?(console.error("Error inserting flights:",l),!1):!0}async function Ui(t){const{data:s,error:a}=await ke.from("miles_transactions").select("*").eq("user_id",t).order("month",{ascending:!0});if(a)return console.error("Error fetching miles:",a),[];const n={};return(s||[]).forEach(l=>{n[l.month]||(n[l.month]={id:l.month,month:l.month,miles_subscription:0,miles_amex:0,miles_flight:0,miles_other:0,miles_debit:0,cost_subscription:0,cost_amex:0,cost_flight:0,cost_other:0});const r=n[l.month];switch(l.source){case"subscription":r.miles_subscription+=l.miles,r.cost_subscription+=l.cost;break;case"amex":r.miles_amex+=l.miles,r.cost_amex+=l.cost;break;case"flight":r.miles_flight+=l.miles,r.cost_flight+=l.cost;break;case"debit":r.miles_debit+=l.miles;break;default:r.miles_other+=l.miles,r.cost_other+=l.cost}}),Object.values(n)}async function va(t,s){await ke.from("miles_transactions").delete().eq("user_id",t);const a=[];if(s.forEach(l=>{(l.miles_subscription>0||l.cost_subscription>0)&&a.push({user_id:t,month:l.month,source:"subscription",miles:l.miles_subscription,cost:l.cost_subscription,is_projected:!1}),(l.miles_amex>0||l.cost_amex>0)&&a.push({user_id:t,month:l.month,source:"amex",miles:l.miles_amex,cost:l.cost_amex,is_projected:!1}),(l.miles_other>0||l.cost_other>0)&&a.push({user_id:t,month:l.month,source:"other",miles:l.miles_other,cost:l.cost_other,is_projected:!1}),l.miles_debit>0&&a.push({user_id:t,month:l.month,source:"debit",miles:l.miles_debit,cost:0,is_projected:!1})}),a.length===0)return!0;const{error:n}=await ke.from("miles_transactions").insert(a);return n?(console.error("Error saving miles:",n),!1):!0}async function Ti(t){const{data:s,error:a}=await ke.from("redemptions").select("*").eq("user_id",t).order("date",{ascending:!1});return a?(console.error("Error fetching redemptions:",a),[]):(s||[]).map(n=>({id:n.id,date:n.date,description:n.description,award_miles:n.award_miles,surcharges:n.surcharges,cash_price_estimate:n.cash_value}))}async function wa(t,s){const{error:a}=await ke.from("redemptions").delete().eq("user_id",t);if(a&&console.error("Error deleting existing redemptions:",a),s.length===0)return!0;const n=s.map(r=>({id:crypto.randomUUID(),user_id:t,date:r.date,description:r.description,award_miles:r.award_miles,surcharges:r.surcharges,cash_value:r.cash_price_estimate})),{error:l}=await ke.from("redemptions").insert(n);return l?(console.error("Error saving redemptions:",l),!1):!0}async function zi(t){const{data:s,error:a}=await ke.from("profiles").select("*").eq("id",t).single();return a?(console.error("Error fetching profile:",a),null):s}async function fs(t,s){const{error:a}=await ke.from("profiles").update({...s,updated_at:new Date().toISOString()}).eq("id",t);return a?(console.error("Error updating profile:",a),!1):!0}async function Ii(t){const{data:s,error:a}=await ke.from("xp_ledger").select("*").eq("user_id",t);if(a)return console.error("Error fetching XP ledger:",a),{};const n={};return(s||[]).forEach(l=>{n[l.month]={month:l.month,amexXp:l.amex_xp||0,bonusSafXp:l.bonus_saf_xp||0,miscXp:l.misc_xp||0,correctionXp:l.correction_xp||0}}),n}async function Sa(t,s){const{error:a}=await ke.from("xp_ledger").delete().eq("user_id",t);if(a)return console.error("Error deleting XP ledger:",a),!1;const n=Object.entries(s).filter(([r,i])=>i.amexXp!==0||i.bonusSafXp!==0||i.miscXp!==0||i.correctionXp!==0).map(([r,i])=>({user_id:t,month:r,amex_xp:i.amexXp,bonus_saf_xp:i.bonusSafXp,misc_xp:i.miscXp,correction_xp:i.correctionXp}));if(n.length===0)return!0;const{error:l}=await ke.from("xp_ledger").insert(n);return l?(console.error("Error saving XP ledger:",l),!1):!0}async function vl(t){const[s,a,n,l,r]=await Promise.all([Ri(t),Ui(t),Ti(t),Ii(t),zi(t)]);return{flights:s,milesData:a,redemptions:n,xpLedger:l,profile:r?{targetCPM:r.target_cpm,qualificationStartMonth:r.qualification_start_month,qualificationStartDate:r.qualification_start_date,homeAirport:r.home_airport||null,xpRollover:r.xp_rollover||0,startingStatus:r.starting_status||null,startingXP:r.starting_xp||null,startingUXP:r.starting_uxp||0,ultimateCycleType:r.ultimate_cycle_type||null,currency:r.currency||"EUR",onboardingCompleted:r.onboarding_completed||!1,emailConsent:r.email_consent||!1,milesBalance:r.miles_balance||0,currentUXP:r.current_uxp||0,pdfBaseline:r.pdf_baseline||null}:null}}const Li={Explorer:{status:"Explorer",totalFlights:6,flownFlights:4,scheduledFlights:2,memberSinceYear:2024,statusStreak:0,currentXP:25,projectedXP:45,currentUXP:20,projectedUXP:38,xpRollover:0,uxpRollover:0,milesBalance:18500,lifetimeMiles:24e3,cabinMix:{economy:100,premiumEconomy:0,business:0,first:0},airlineMix:{kl:50,af:17,partners:33},efficiencyScore:4.8},Silver:{status:"Silver",totalFlights:18,flownFlights:14,scheduledFlights:4,memberSinceYear:2023,statusStreak:1,currentXP:45,projectedXP:110,currentUXP:40,projectedUXP:95,xpRollover:0,uxpRollover:0,milesBalance:42350,lifetimeMiles:125e3,cabinMix:{economy:88,premiumEconomy:8,business:4,first:0},airlineMix:{kl:52,af:20,partners:28},efficiencyScore:6.2},Gold:{status:"Gold",totalFlights:47,flownFlights:38,scheduledFlights:9,memberSinceYear:2021,statusStreak:2,currentXP:135,projectedXP:210,currentUXP:120,projectedUXP:190,xpRollover:20,uxpRollover:0,milesBalance:156800,lifetimeMiles:48e4,cabinMix:{economy:68,premiumEconomy:15,business:16,first:1},airlineMix:{kl:48,af:33,partners:19},efficiencyScore:7.4},Platinum:{status:"Platinum",totalFlights:112,flownFlights:94,scheduledFlights:18,memberSinceYear:2019,statusStreak:4,currentXP:265,projectedXP:340,currentUXP:245,projectedUXP:315,xpRollover:85,uxpRollover:150,milesBalance:324500,lifetimeMiles:125e4,cabinMix:{economy:45,premiumEconomy:18,business:34,first:3},airlineMix:{kl:51,af:38,partners:11},efficiencyScore:8.1},Ultimate:{status:"Ultimate",totalFlights:234,flownFlights:206,scheduledFlights:28,memberSinceYear:2016,statusStreak:6,currentXP:720,projectedXP:945,currentUXP:950,projectedUXP:1020,xpRollover:300,uxpRollover:900,milesBalance:687200,lifetimeMiles:285e4,cabinMix:{economy:22,premiumEconomy:12,business:54,first:12},airlineMix:{kl:54,af:40,partners:6},efficiencyScore:9.2}},Os=[{route:"AMS-CDG",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:430},{route:"AMS-LHR",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:370},{route:"AMS-BER",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:580},{route:"AMS-BCN",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:1090},{route:"AMS-FCO",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:1290},{route:"AMS-VIE",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:940},{route:"AMS-CPH",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:620},{route:"AMS-ZRH",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:660},{route:"CDG-LHR",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:340},{route:"CDG-FCO",distance:"short",xpEconomy:5,xpBusiness:10,xpFirst:15,miles:1100},{route:"AMS-ATH",distance:"medium",xpEconomy:8,xpBusiness:15,xpFirst:23,miles:2160},{route:"AMS-IST",distance:"medium",xpEconomy:8,xpBusiness:15,xpFirst:23,miles:2200},{route:"CDG-CMN",distance:"medium",xpEconomy:8,xpBusiness:15,xpFirst:23,miles:1820},{route:"AMS-DXB",distance:"medium",xpEconomy:8,xpBusiness:15,xpFirst:23,miles:5140},{route:"AMS-JFK",distance:"long1",xpEconomy:15,xpBusiness:30,xpFirst:45,miles:5850},{route:"CDG-JFK",distance:"long1",xpEconomy:15,xpBusiness:30,xpFirst:45,miles:5840},{route:"AMS-BOS",distance:"long1",xpEconomy:15,xpBusiness:30,xpFirst:45,miles:5540},{route:"CDG-BOS",distance:"long1",xpEconomy:15,xpBusiness:30,xpFirst:45,miles:5550},{route:"AMS-LAX",distance:"long2",xpEconomy:20,xpBusiness:40,xpFirst:60,miles:8960},{route:"CDG-LAX",distance:"long2",xpEconomy:20,xpBusiness:40,xpFirst:60,miles:9120},{route:"AMS-SFO",distance:"long2",xpEconomy:20,xpBusiness:40,xpFirst:60,miles:8520},{route:"AMS-NRT",distance:"long2",xpEconomy:20,xpBusiness:40,xpFirst:60,miles:9290},{route:"CDG-NRT",distance:"long2",xpEconomy:20,xpBusiness:40,xpFirst:60,miles:9710},{route:"AMS-SIN",distance:"long3",xpEconomy:25,xpBusiness:50,xpFirst:75,miles:10340},{route:"CDG-SIN",distance:"long3",xpEconomy:25,xpBusiness:50,xpFirst:75,miles:10740},{route:"AMS-BKK",distance:"long3",xpEconomy:25,xpBusiness:50,xpFirst:75,miles:9070},{route:"AMS-SYD",distance:"long3",xpEconomy:25,xpBusiness:50,xpFirst:75,miles:16650},{route:"CDG-SYD",distance:"long3",xpEconomy:25,xpBusiness:50,xpFirst:75,miles:16960},{route:"AMS-JNB",distance:"long3",xpEconomy:25,xpBusiness:50,xpFirst:75,miles:9040}];function ut(){return`demo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function At(t,s){const a=new Date(t,0,1),n=new Date(s,11,31);return new Date(a.getTime()+Math.random()*(n.getTime()-a.getTime())).toISOString().slice(0,10)}function wl(t,s){const a=Math.random()*100;return t.includes("CDG")?a<s.af+10?"AF":a<s.af+s.kl?"KLM":Sl():a<s.kl?"KLM":a<s.kl+s.af?"AF":Sl()}function Sl(){const t=["DL","KE","VS","AM","CI","GA","SU","ME"];return t[Math.floor(Math.random()*t.length)]}function Pl(t){const s=Math.random()*100;return s<t.economy?"Economy":s<t.economy+t.premiumEconomy?"Premium Economy":s<t.economy+t.premiumEconomy+t.business?"Business":"First"}function kl(t,s){switch(s){case"First":return t.xpFirst;case"Business":return t.xpBusiness;case"Premium Economy":return Math.round(t.xpEconomy*1.5);default:return t.xpEconomy}}function Cl(t){return t==="KLM"||t==="AF"}function $i(t){const s=[],a=new Date().getFullYear(),n=t.memberSinceYear;for(let r=0;r<t.flownFlights;r++){const i=Os[Math.floor(Math.random()*Os.length)],x=wl(i.route,t.airlineMix),c=Pl(t.cabinMix),o=kl(i,c),u=At(n,a);s.push({id:ut(),date:u,route:i.route,airline:x,cabin:c,earnedXP:o,earnedMiles:i.miles*(c==="Business"?1.5:c==="First"?2:1),uxp:Cl(x)?o:0,ticketPrice:c==="First"?2500+Math.random()*5e3:c==="Business"?800+Math.random()*2e3:150+Math.random()*400})}const l=[1,2,3,4,5,6];for(let r=0;r<t.scheduledFlights;r++){const i=Os[Math.floor(Math.random()*Os.length)],x=wl(i.route,t.airlineMix),c=Pl(t.cabinMix),o=kl(i,c),u=new Date;u.setMonth(u.getMonth()+l[r%l.length]);const m=u.toISOString().slice(0,10);s.push({id:ut(),date:m,route:i.route,airline:x,cabin:c,earnedXP:o,earnedMiles:i.miles*(c==="Business"?1.5:c==="First"?2:1),uxp:Cl(x)?o:0,ticketPrice:c==="First"?2500+Math.random()*5e3:c==="Business"?800+Math.random()*2e3:150+Math.random()*400})}return s.sort((r,i)=>r.date.localeCompare(i.date)),s}function Oi(t){const s=[],a=new Date().getFullYear(),n=new Date().getMonth()+1;for(let l=23;l>=0;l--){let r=n-l,i=a;for(;r<=0;)r+=12,i-=1;const x=`${i}-${String(r).padStart(2,"0")}`,c=l<12,o=t.status==="Ultimate"?4:t.status==="Platinum"?3:t.status==="Gold"?2:1;s.push({id:ut(),month:x,miles_subscription:c?17e3:0,miles_amex:Math.round((8e3+Math.random()*12e3)*o),miles_flight:Math.round((5e3+Math.random()*15e3)*o),miles_other:Math.random()>.7?Math.round(Math.random()*5e3):0,miles_debit:Math.random()>.85?Math.round(Math.random()*5e4):0,cost_subscription:c?186:0,cost_amex:55,cost_flight:0,cost_other:0})}return s}function Gi(t){const s=[],a=new Date().getFullYear(),n=new Date().getMonth()+1;for(let l=23;l>=0;l--){let r=n-l,i=a;for(;r<=0;)r+=12,i-=1;const x=`${i}-${String(r).padStart(2,"0")}`;s.push({month:x,f1:0,f2:0,f3:0,f4:0,misc:0,saf:Math.random()>.7?Math.round(Math.random()*15):0,amex_xp:Math.random()>.9?60:0,status_correction:0})}return s}function Ki(t){const s=[];return t.status==="Explorer"||t.status==="Silver"?Math.random()>.5&&s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Upgrade AMS-CDG",award_miles:15e3,cash_price_estimate:180,surcharges:25}):t.status==="Gold"?(s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Europe Award Flight",award_miles:3e4,cash_price_estimate:420,surcharges:85}),s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Upgrade to Business",award_miles:2e4,cash_price_estimate:350,surcharges:0})):t.status==="Platinum"?(s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Business Award JFK",award_miles:85e3,cash_price_estimate:2800,surcharges:450}),s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Europe Award Flight",award_miles:25e3,cash_price_estimate:380,surcharges:75}),s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Upgrade to Business",award_miles:35e3,cash_price_estimate:900,surcharges:0})):t.status==="Ultimate"&&(s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"La PremiÃ¨re CDG-JFK",award_miles:15e4,cash_price_estimate:8500,surcharges:850}),s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Business Award SIN",award_miles:95e3,cash_price_estimate:3200,surcharges:520}),s.push({id:ut(),date:At(new Date().getFullYear()-1,new Date().getFullYear()),description:"Companion Ticket Used",award_miles:0,cash_price_estimate:1200,surcharges:0})),s}function Yi(t){const s={},a=new Date().getFullYear();return s[`${a}-03`]={amexXp:60,bonusSafXp:0,miscXp:0,correctionXp:0},t.status!=="Explorer"&&(s[`${a}-06`]={amexXp:0,bonusSafXp:12,miscXp:0,correctionXp:0}),s}function qi(t){const s=new Date().getFullYear();return{cycleStartMonth:`${new Date().getMonth()+1>=11?s:s-1}-11`,startingStatus:t.status,startingXP:t.xpRollover,startingUXP:t.uxpRollover,ultimateCycleType:t.status==="Ultimate"?"calendar":"qualification"}}function Vi(t){const s=Li[t];return{flights:$i(s),milesData:Oi(s),xpData:Gi(),redemptions:Ki(s),manualLedger:Yi(s),qualificationSettings:qi(s),xpRollover:s.xpRollover,uxpRollover:s.uxpRollover,currentStatus:s.status,targetCPM:.012}}const Hi=t=>({id:t.id??`flight-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,date:t.date,route:t.route,airline:t.airline,cabin:t.cabin,ticketPrice:t.ticketPrice,earnedMiles:t.earnedMiles,earnedXP:t.earnedXP,safXp:t.safXp??0,flightNumber:t.flightNumber,uxp:t.uxp}),Wi=(t,s,a)=>{const n=new Map,l=new Map,r=(c,o)=>`${c}-${o}`;(t??[]).forEach(c=>{c&&typeof c.month=="string"&&n.set(c.month,{...c})}),(s??[]).forEach(c=>{c&&typeof c.month=="string"&&l.set(c.month,{...c})}),(a??[]).forEach(c=>{const o=c.month||c.date?.slice(0,7);if(!o)return;const u=c.earnedMiles||0,m=c.ticketPrice||0,p=n.get(o);p?n.set(o,{...p,miles_flight:(p.miles_flight||0)+u,cost_flight:(p.cost_flight||0)+m}):n.set(o,{id:r("miles",o),month:o,miles_subscription:0,miles_amex:0,miles_flight:u,miles_other:0,miles_debit:0,cost_subscription:0,cost_amex:0,cost_flight:m,cost_other:0});const h=l.get(o),b=c.safXp||0,g=c.earnedXP||0;h?l.set(o,{...h,f1:(h.f1||0)+g,saf:(h.saf||0)+b}):l.set(o,{id:r("xp",o),month:o,f1:g,f2:0,f3:0,f4:0,misc:0,saf:b,amex_xp:0,status_correction:0})});const i=Array.from(n.values()).sort((c,o)=>(c.month||"").localeCompare(o.month||"")),x=Array.from(l.values()).sort((c,o)=>(c.month||"").localeCompare(o.month||""));return{miles:i,xp:x}},$e=300,sa=180,aa=100,jn=900,Ji=1800,Zi=900,Qi=["KL","AF","KLM","AIR FRANCE","AIRFRANCE"],is={Explorer:0,Silver:1,Gold:2,Platinum:3},la=(t,s,a)=>Math.max(s,Math.min(a,t)),La=t=>{switch(t){case"Silver":return aa;case"Gold":return sa;case"Platinum":return $e;default:return 0}},$a=t=>{switch(t){case"Explorer":return"Silver";case"Silver":return"Gold";case"Gold":return"Platinum";default:return null}},Oa=t=>{const s=$a(t);return s?La(s):null},eo=(t,s)=>{const a=is[t];return is[s]>=a?s:t==="Platinum"?"Gold":t==="Gold"?"Silver":"Explorer"},to=t=>t>=$e?"Platinum":t>=sa?"Gold":t>=aa?"Silver":"Explorer",so=t=>{const s=t.toUpperCase().replace(/\s+/g,"");return Qi.some(a=>s===a||s.startsWith(a))},yn=t=>so(t.airline)?(t.earnedXP||0)+(t.safXp||0):0,Ms=(t,s)=>t==="Platinum"&&s>=jn,Ml=t=>Math.min(t,Ji),al=t=>{const s=Math.max(0,t-jn);return Math.min(s,Zi)},Gt=t=>new Date(t+"-01"),pa=t=>{const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0");return`${s}-${a}`},Fl=t=>{const s=Gt(t);return s.setMonth(s.getMonth()+1),pa(s)},Nn=t=>{const s=Gt(t);return s.setMonth(s.getMonth()+1),s.setDate(0),s.toISOString().slice(0,10)},vn=t=>{const s=Gt(t);return s.setMonth(s.getMonth()+12),s.setDate(0),s.toISOString().slice(0,10)},wn=t=>`${t}-01`,Sn=(t,s)=>{const a=[];let n=Gt(t);const l=Gt(s);for(;n<=l;)a.push(pa(n)),n.setMonth(n.getMonth()+1);return a},Pn=()=>pa(new Date),kn=()=>new Date().toISOString().slice(0,10),ao=t=>{const s=kn();return t<s},ll=t=>{const s=Nn(t);return ao(s)},lo=(t,s)=>{const a=new Map,n=kn();let l=0,r=0;for(const i of t){const x=i.date.slice(0,7);if(s&&i.date<=s){l++;continue}r++;const c=i.date<n,o=a.get(x)??{flightXP:0,flightSafXP:0,flightCount:0,actualFlightXP:0,actualFlightSafXP:0,actualFlightCount:0,projectedFlightXP:0,projectedFlightSafXP:0,projectedFlightCount:0,flightUXP:0,actualFlightUXP:0,projectedFlightUXP:0},u=i.earnedXP??0,m=i.safXp??0,p=yn(i);a.set(x,{flightXP:o.flightXP+u,flightSafXP:o.flightSafXP+m,flightCount:o.flightCount+1,actualFlightXP:o.actualFlightXP+(c?u:0),actualFlightSafXP:o.actualFlightSafXP+(c?m:0),actualFlightCount:o.actualFlightCount+(c?1:0),projectedFlightXP:o.projectedFlightXP+(c?0:u),projectedFlightSafXP:o.projectedFlightSafXP+(c?0:m),projectedFlightCount:o.projectedFlightCount+(c?0:1),flightUXP:o.flightUXP+p,actualFlightUXP:o.actualFlightUXP+(c?p:0),projectedFlightUXP:o.projectedFlightUXP+(c?0:p)})}return console.log(`[XP Engine] Flight filtering: ${l} excluded (before cutoff), ${r} included`),a},no=(t,s,a,n,l)=>{const r=lo(t,n),i=new Set;if(r.forEach((c,o)=>i.add(o)),Object.keys(s||{}).forEach(c=>{(!l||c>=l)&&i.add(c)}),a.forEach(c=>{(!l||c.month>=l)&&i.add(c.month)}),l){const c=Object.keys(s||{}).filter(u=>u<l),o=a.filter(u=>u.month<l).map(u=>u.month);(c.length>0||o.length>0)&&console.log(`[XP Engine] Filtered out months before ${l}:`,{manualLedgerMonths:c,legacyMonths:o})}return Array.from(i).sort().map(c=>{const o=r.get(c)??{flightXP:0,flightSafXP:0,flightCount:0,actualFlightXP:0,actualFlightSafXP:0,projectedFlightXP:0,projectedFlightSafXP:0,flightUXP:0,actualFlightUXP:0,projectedFlightUXP:0},u=s[c]??{amexXp:0,bonusSafXp:0,miscXp:0,correctionXp:0},m=a.find(b=>b.month===c),p=o.flightXP>0||o.flightSafXP>0||u.amexXp||u.bonusSafXp||u.miscXp||u.correctionXp,h=ll(c);if(m&&!p){const b=m.f1+m.f2+m.f3+m.f4;return{month:c,flightXP:b,flightSafXP:m.saf,flightCount:0,amexXp:m.amex_xp,bonusSafXp:0,miscXp:m.misc,correctionXp:m.status_correction,actualFlightXP:b,actualFlightSafXP:m.saf,projectedFlightXP:0,projectedFlightSafXP:0,isFullyPast:!0,flightUXP:0,actualFlightUXP:0,projectedFlightUXP:0}}return{month:c,flightXP:o.flightXP,flightSafXP:o.flightSafXP,flightCount:o.flightCount,amexXp:u.amexXp??0,bonusSafXp:u.bonusSafXp??0,miscXp:u.miscXp??0,correctionXp:u.correctionXp??0,actualFlightXP:o.actualFlightXP,actualFlightSafXP:o.actualFlightSafXP,projectedFlightXP:o.projectedFlightXP,projectedFlightSafXP:o.projectedFlightSafXP,isFullyPast:h,flightUXP:o.flightUXP,actualFlightUXP:o.actualFlightUXP,projectedFlightUXP:o.projectedFlightUXP}})},ro=(t,s)=>{const a=t.flightXP+t.flightSafXP+t.bonusSafXp+t.amexXp+t.miscXp+t.correctionXp,l=t.isFullyPast?a:t.actualFlightXP+t.actualFlightSafXP;let r=s.balance+a,i=s.status,x=0,c=!1,o=!0;for(;o;){o=!1;const S=$a(i);if(S){const P=La(S);r>=P&&(r-=P,x-=P,i=S,c=!0,o=!0)}}let u=s.actualBalance+l,m=s.actualStatus,p=0,h=!1;for(o=!0;o;){o=!1;const S=$a(m);if(S){const P=La(S);u>=P&&(u-=P,p-=P,m=S,h=!0,o=!0)}}const b={monthData:t,xpEarned:a,balanceAfter:r,statusAfter:i,levelUpOccurred:c,levelUpCorrection:x,actualXPEarned:l,actualBalanceAfter:u,actualStatusAfter:m,actualLevelUpOccurred:h,actualLevelUpCorrection:p},g={status:i,balance:r,cycleStartMonth:s.cycleStartMonth,actualStatus:m,actualBalance:u,actualLevelUpOccurred:s.actualLevelUpOccurred||h,actualLevelUpMonth:h?t.month:s.actualLevelUpMonth};return{processed:b,newState:g}},io=(t,s,a,n,l)=>{const{monthData:r,xpEarned:i,levelUpCorrection:x,actualXPEarned:c}=t,o=Gt(r.month),u=Pn(),m=r.isFullyPast,p=r.month>u,h=r.flightUXP,b=r.actualFlightUXP,g=r.projectedFlightUXP;return{month:r.month,monthLabel:o.toLocaleDateString("en-US",{month:"short"}),fullLabel:o.toLocaleDateString("en-US",{month:"short",year:"numeric"}),f1:r.flightXP,f2:0,f3:0,f4:0,misc:r.miscXp,saf:r.flightSafXP+r.bonusSafXp,amex_xp:r.amexXp,status_correction:r.correctionXp+x,flightXP:r.flightXP,flightSafXP:r.flightSafXP,flightCount:r.flightCount,xpMonth:i,monthTotal:i,cumulative:s,deltaP:s-$e,hitPlatinum:s>=$e,isFullyFlown:m,isFuture:p,actualXP:c,projectedXP:i-c,actualCumulative:a,uxp:h,cumulativeUXP:n,actualUXP:b,projectedUXP:g,actualCumulativeUXP:l}},Ga=t=>{const s=Gt(t);return s.setMonth(s.getMonth()+11),pa(s)},oo=t=>{const{cycleIndex:s,startMonth:a,ledger:n,startStatus:l,endStatus:r,rolloverIn:i,endedByLevelUp:x,levelUpMonth:c,levelUpIsActual:o,currentMonth:u,finalBalance:m,actualStatus:p,actualBalance:h,uxpRolloverIn:b}=t,g=i+n.reduce((Y,O)=>Y+O.xpMonth,0),S=to(g),P=x?r:eo(l,S);let C=0;(x||P==="Platinum")&&(C=la(m,0,$e));const w=n.length>0?n[n.length-1].month:a,f=wn(a);let D;x&&c&&o?D=Nn(c):D=vn(a);let _=h,N=null;for(const Y of n)Y.month<=u&&(N=Y.month,_=Y.actualCumulative);const F=p,j=x?r:P,v=m;let A=0,R=0;if(F==="Platinum")A=Math.max(0,$e-_);else{const Y=Oa(F);Y!=null&&(A=Math.max(0,Y-_))}if(j==="Platinum")R=Math.max(0,$e-v);else{const Y=Oa(j);Y!=null&&(R=Math.max(0,Y-v))}const X=n.reduce((Y,O)=>Y+O.uxp,0),L=b+X,G=Ml(L),k=n.reduce((Y,O)=>Y+O.actualUXP,0),I=b+k,y=Ml(I),U=G,M=al(G),z=Ms(F,y),K=Ms(j,U);return{cycleIndex:s,startDate:f,endDate:D,startMonth:a,endMonth:w,startStatus:l,endStatus:P,achievedStatus:S,rolloverIn:i,rolloverOut:C,totalXP:m,ledger:n,endedByLevelUp:x,levelUpMonth:c,levelUpIsActual:o,currentMonth:N,actualStatus:F,actualXP:_,actualXPToNext:A,projectedStatus:j,projectedXP:v,projectedXPToNext:R,currentStatus:F,currentXP:_,currentXPToNext:A,uxpRolloverIn:b,totalUXP:G,actualUXP:y,projectedUXP:U,uxpRolloverOut:M,isUltimate:z,projectedUltimate:K}},co=(t,s,a,n,l,r=0)=>{const i=Ga(s),c=Sn(s,i).map(h=>{const b=Gt(h),g=h>l,S=ll(h);return{month:h,monthLabel:b.toLocaleDateString("en-US",{month:"short"}),fullLabel:b.toLocaleDateString("en-US",{month:"short",year:"numeric"}),f1:0,f2:0,f3:0,f4:0,misc:0,saf:0,amex_xp:0,status_correction:0,flightXP:0,flightSafXP:0,flightCount:0,xpMonth:0,monthTotal:0,cumulative:n,deltaP:n-$e,hitPlatinum:n>=$e,isFullyFlown:S,isFuture:g,actualXP:0,projectedXP:0,actualCumulative:n,uxp:0,cumulativeUXP:r,actualUXP:0,projectedUXP:0,actualCumulativeUXP:r}}),o=Oa(a),u=o?Math.max(0,o-n):0,m=l>=s&&l<=i,p=Ms(a,r);return{cycleIndex:t,startDate:wn(s),endDate:vn(s),startMonth:s,endMonth:i,startStatus:a,endStatus:a,achievedStatus:a,rolloverIn:n,rolloverOut:a==="Platinum"?la(n,0,$e):0,totalXP:n,ledger:c,endedByLevelUp:!1,levelUpIsActual:!1,currentMonth:m?l:null,actualStatus:a,actualXP:n,actualXPToNext:u,projectedStatus:a,projectedXP:n,projectedXPToNext:u,currentStatus:a,currentXP:n,currentXPToNext:u,uxpRolloverIn:r,totalUXP:r,actualUXP:r,projectedUXP:r,uxpRolloverOut:al(r),isUltimate:p,projectedUltimate:p}},xo=(t,s)=>{const a=new Date().toISOString().slice(0,10),n=`${s}-01-01`,l=`${s}-12-31`;let r=0,i=0;for(const c of t){if(c.date<n||c.date>l)continue;const o=yn(c);if(o===0)continue;c.date<a?r+=o:i+=o}const x=Math.min(1800,r+i);return r=Math.min(1800,r),{actualUXP:r,projectedUXP:i,totalUXP:x}},mo=(t,s)=>{const a=new Date().getFullYear();return t.map(n=>{const l=parseInt(n.endDate.slice(0,4));parseInt(n.startDate.slice(0,4));const r=new Date().toISOString().slice(0,10),x=r>=n.startDate&&r<=n.endDate?a:l,{actualUXP:c,projectedUXP:o,totalUXP:u}=xo(s,x),m=Ms(n.actualStatus,c),p=Ms(n.projectedStatus,u),h=al(u);return{...n,actualUXP:c,projectedUXP:o,totalUXP:u,uxpRolloverOut:h,isUltimate:m,projectedUltimate:p,uxpRolloverIn:0}})},Lt=(t,s,a,n,l)=>{const r=l?.cycleStartDate;console.log("[XP Engine] Qualification settings:",{cycleStartMonth:l?.cycleStartMonth,cycleStartDate:l?.cycleStartDate,startingStatus:l?.startingStatus,startingXP:l?.startingXP,excludeBeforeDate:r});const i=l?.cycleStartMonth,x=no(a??[],n??{},t,r,i),c=Pn(),o=l?.startingStatus??(s>0?"Platinum":"Explorer"),u=la(l?.startingXP??s,0,$e),m=new Date,p=m.getMonth()>=10?`${m.getFullYear()}-11`:`${m.getFullYear()-1}-11`;if(x.length===0){const G=l?.cycleStartMonth??p;return{cycles:[co(0,G,o,u,c,0)]}}const h=[];let b=0;const g=new Map;x.forEach(G=>g.set(G.month,G));const S=x[0].month,P=x[x.length-1].month,C=m.getMonth()>=10?`${m.getFullYear()}-11`:`${m.getFullYear()-1}-11`,w=l?.cycleStartMonth??(S<C?S:C),f=P>c?P:c,[D,_]=f.split("-").map(Number),N=new Date(D,_-1+12,1),j=`${N.getFullYear()}-${String(N.getMonth()+1).padStart(2,"0")}`;let v={status:o,balance:u,cycleStartMonth:w,actualStatus:o,actualBalance:u,actualLevelUpOccurred:!1,actualLevelUpMonth:null},A=w,R=v.status,X=u,L=0;for(;A<=j;){const G=Ga(A),k=Sn(A,G),I=[];let y=L,U=L,M=!1,z,K=v.status,Y=!1,O;for(const J of k){const q=v.status,B=v.actualStatus,$=g.get(J)??{month:J,flightXP:0,flightSafXP:0,flightCount:0,amexXp:0,bonusSafXp:0,miscXp:0,correctionXp:0,actualFlightXP:0,actualFlightSafXP:0,projectedFlightXP:0,projectedFlightSafXP:0,isFullyPast:ll(J),flightUXP:0,actualFlightUXP:0,projectedFlightUXP:0},{processed:Q,newState:oe}=ro($,v);y+=$.flightUXP,U+=$.actualFlightUXP;const se=io(Q,oe.balance,oe.actualBalance,y,U);I.push(se),Q.levelUpOccurred&&is[Q.statusAfter]>is[q]&&(M||(M=!0,z=J),K=Q.statusAfter);const Z=Q.actualLevelUpOccurred&&is[Q.actualStatusAfter]>is[B];if(v=oe,Z){Y=!0,O=J;break}}const V=oo({cycleIndex:b,startMonth:A,ledger:I,startStatus:R,endStatus:Y?v.actualStatus:M?K:v.status,rolloverIn:X,endedByLevelUp:Y||M,levelUpMonth:Y?O:z,levelUpIsActual:Y,currentMonth:c,finalBalance:v.balance,actualStatus:v.actualStatus,actualBalance:v.actualBalance,uxpRolloverIn:L});if(h.push(V),b++,Y){if(!O)break;A=Fl(O),R=v.actualStatus,X=v.actualBalance,L=V.uxpRolloverOut}else{const J=Ga(A);A=Fl(J),R=V.endStatus,X=V.rolloverOut,L=V.uxpRolloverOut}if(A>j)break}return l?.ultimateCycleType==="calendar"?{cycles:mo(h,a??[])}:{cycles:h}},nl=(t,s,a,n)=>{const{cycles:l}=Lt(t,s,a,n),r={};return l.forEach(i=>{const x=new Date(i.endDate).getFullYear();r[x]=i}),r},Ts="skystatus_import_backup",Cn="skystatus_import_backup_timestamp";function uo(t,s){const a={...t,timestamp:new Date().toISOString(),source:s};try{localStorage.setItem(Ts,JSON.stringify(a)),localStorage.setItem(Cn,a.timestamp),console.log("[BackupService] Backup created:",a.timestamp)}catch(n){throw console.error("[BackupService] Failed to create backup:",n),new Error("Could not create backup before import")}}function ho(){return localStorage.getItem(Ts)!==null}function po(){try{const t=localStorage.getItem(Ts);if(!t)return null;const s=JSON.parse(t);return{timestamp:s.timestamp,source:s.source}}catch{return null}}function bo(){try{const t=localStorage.getItem(Ts);if(!t)return null;const s=JSON.parse(t);return console.log("[BackupService] Restoring backup from:",s.timestamp),s}catch(t){return console.error("[BackupService] Failed to restore backup:",t),null}}function go(){localStorage.removeItem(Ts),localStorage.removeItem(Cn),console.log("[BackupService] Backup cleared")}function fo(t,s){const[a,n]=d.useState(t);return d.useEffect(()=>{const l=setTimeout(()=>{n(t)},s);return()=>{clearTimeout(l)}},[t,s]),a}function jo(){const{user:t}=Us(),s=new Date,a=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`,[n,l]=d.useState(a),[r,i]=d.useState([]),[x,c]=d.useState([]),[o,u]=d.useState({}),[m,p]=d.useState([]),[h,b]=d.useState([]),[g,S]=d.useState(0),[P,C]=d.useState(.012),[w,f]=d.useState("EUR"),[D,_]=d.useState(null),[N,F]=d.useState(null),[j,v]=d.useState(!0),[A,R]=d.useState(!1),[X,L]=d.useState(0),[G,k]=d.useState(0),[I,y]=d.useState(!1),[U,M]=d.useState(!1),[z,K]=d.useState(0),Y=fo(z,2e3),[O,V]=d.useState(null),[J,q]=d.useState(!1),[B,$]=d.useState(!1),[Q,oe]=d.useState(!1),[se,Z]=d.useState("Platinum"),[ee,T]=d.useState(!1),ce=d.useRef(!1),fe=d.useRef(null),{miles:Se,xp:Te}=d.useMemo(()=>Wi(r,x,h),[r,x,h]),Me=d.useMemo(()=>{if(B)return se;const E=nl(Te,g,h,o),re=new Date,ge=re.getMonth()>=10?re.getFullYear()+1:re.getFullYear(),de=E[ge];return de?.actualStatus||de?.achievedStatus||de?.startStatus||"Explorer"},[B,se,Te,g,h,o]),{displayXP:H,displayUXP:ie,displayMiles:ue,displayStatus:be}=d.useMemo(()=>{if(!O)return{displayXP:void 0,displayUXP:void 0,displayMiles:Se.reduce((tt,$t)=>tt+$t.miles_subscription+$t.miles_amex+$t.miles_flight+$t.miles_other-$t.miles_debit,0),displayStatus:Me};const E=D?.cycleStartMonth?`${D.cycleStartMonth}-01`:null,re=E?h.filter(Xe=>Xe.date>=E):h,ge=re.reduce((Xe,tt)=>Xe+(tt.earnedXP||0)+(tt.safXp||0),0)+(D?.startingXP||0),de=re.reduce((Xe,tt)=>Xe+(tt.uxp||0),0),Ut=O.xp-(O.calculatedXpAtImport??O.xp),$s=O.uxp-(O.calculatedUxpAtImport??O.uxp),He=O.pdfExportDate,kt=h.filter(Xe=>Xe.importSource==="manual"&&Xe.date>He).reduce((Xe,tt)=>Xe+(tt.earnedMiles||0),0);return{displayXP:ge+Ut,displayUXP:de+$s,displayMiles:O.miles+kt,displayStatus:O.status}},[O,h,D,Se,Me]),ve=d.useCallback(async()=>{if(t){y(!0);try{const E=await vl(t.id);b(E.flights),i(E.milesData),p(E.redemptions);const re={};Object.entries(E.xpLedger).forEach(([de,Ut])=>{re[de]={amexXp:Ut.amexXp,bonusSafXp:Ut.bonusSafXp,miscXp:Ut.miscXp,correctionXp:Ut.correctionXp}}),u(re);const ge=E.flights.length>0||E.milesData.length>0||E.redemptions.length>0;if(E.profile){C(E.profile.targetCPM||.012),S(E.profile.xpRollover||0),f(E.profile.currency||"EUR"),F(E.profile.homeAirport||null),L(E.profile.milesBalance||0),k(E.profile.currentUXP||0),R(E.profile.emailConsent??!1),E.profile.pdfBaseline&&V(E.profile.pdfBaseline);const de=E.profile.onboardingCompleted??ge;v(de),E.profile.qualificationStartMonth&&_({cycleStartMonth:E.profile.qualificationStartMonth,cycleStartDate:E.profile.qualificationStartDate||void 0,startingStatus:E.profile.startingStatus||"Explorer",startingXP:E.profile.startingXP??E.profile.xpRollover??0,startingUXP:E.profile.startingUXP||0,ultimateCycleType:E.profile.ultimateCycleType||"qualification"})}else v(!1);ce.current=!0,fe.current=t.id,q(!0)}catch(E){console.error("Error loading user data:",E),q(!0)}finally{y(!1)}}},[t]),Ye=d.useCallback(async()=>{if(!(!t||B)){M(!0);try{const E={};Object.entries(o).forEach(([re,ge])=>{E[re]={month:re,amexXp:ge.amexXp||0,bonusSafXp:ge.bonusSafXp||0,miscXp:ge.miscXp||0,correctionXp:ge.correctionXp||0}}),await Promise.all([Nl(t.id,h),va(t.id,r),wa(t.id,m),Sa(t.id,E),fs(t.id,{target_cpm:P,xp_rollover:g,currency:w,qualification_start_month:D?.cycleStartMonth??null,qualification_start_date:D?.cycleStartDate??null,starting_status:D?.startingStatus??null,starting_xp:D?.startingXP??0,starting_uxp:D?.startingUXP??0,ultimate_cycle_type:D?.ultimateCycleType??null,pdf_baseline:O??null})])}catch(E){console.error("Error saving user data:",E)}finally{M(!1)}}},[t,B,h,r,m,o,P,g,w,D,O]);d.useEffect(()=>{t&&!B&&(!ce.current||fe.current!==t.id)&&ve()},[t,B,ve]),d.useEffect(()=>{!t&&!B&&!Q&&(i([]),c([]),p([]),b([]),S(0),u({}),_(null),F(null),L(0),k(0),C(.012),ce.current=!1,fe.current=null,q(!1),T(!0))},[t,B,Q]),d.useEffect(()=>{t&&!B&&Y>0&&ce.current&&Ye()},[Y,t,B,Ye]);const he=d.useCallback(()=>{K(E=>E+1)},[]),Ae=d.useCallback(E=>{b(E),he()},[he]),bt=d.useCallback(E=>{i(E),he()},[he]),ot=d.useCallback(E=>{c(E),he()},[he]),gt=d.useCallback(E=>{p(E),he()},[he]),W=d.useCallback(E=>{u(typeof E=="function"?re=>E(re):E),he()},[he]),pe=d.useCallback(E=>{S(E),he()},[he]),Fe=d.useCallback(E=>{C(E),he()},[he]),ae=d.useCallback(E=>{_(E),E&&S(E.startingXP),he()},[he]),te=d.useCallback(E=>{f(E),he()},[he]),xe=d.useCallback(E=>{Ae(E)},[Ae]),qe=d.useCallback(E=>{const re=E.map(Hi);b(ge=>[...ge,...re]),he()},[he]),Rt=d.useCallback(E=>{const re=E.map(ge=>({...ge,miles_flight:0,cost_flight:0}));bt(re)},[bt]),Ve=d.useCallback(E=>{gt(E)},[gt]),_t=d.useCallback(E=>{Fe(E)},[Fe]),ls=d.useCallback(E=>{te(E)},[te]),hs=d.useCallback(E=>{W(E)},[W]),ps=d.useCallback(E=>{pe(E)},[pe]),bs=d.useCallback(E=>{ae(E)},[ae]),dl=d.useCallback((E,re,ge,de,Ut)=>{t&&(ce.current=!0,fe.current=t.id,q(!0));try{uo({flights:h,milesRecords:r,qualificationSettings:D,manualLedger:o},Ut||"PDF Import"),console.log("[handlePdfImport] Backup created before import")}catch(Pe){console.error("[handlePdfImport] Failed to create backup:",Pe)}const $s={xp:ge.xp,uxp:ge.uxp,miles:ge.miles,status:ge.status,pdfExportDate:ge.exportDate,importedAt:new Date().toISOString(),cycleStartMonth:de?.cycleStartMonth,cycleStartDate:de?.cycleStartDate,rolloverXP:de?.rolloverXP},He=new Date().toISOString(),gs=E.map(Pe=>({...Pe,importSource:"pdf",importedAt:He})),kt=new Set(h.map(Pe=>`${Pe.date}|${Pe.route}`)),Xe=gs.filter(Pe=>{const Ct=`${Pe.date}|${Pe.route}`;return!kt.has(Ct)}),tt=[...h,...Xe];tt.sort((Pe,Ct)=>Ct.date.localeCompare(Pe.date)),b(tt),console.log(`[handlePdfImport] Merged flights: ${h.length} existing + ${Xe.length} new = ${tt.length} total`);const $t=new Map(r.map(Pe=>[Pe.month,Pe]));for(const Pe of re)$t.set(Pe.month,Pe);const ja=Array.from($t.values());ja.sort((Pe,Ct)=>Ct.month.localeCompare(Pe.month)),i(ja),console.log(`[handlePdfImport] Merged miles: ${r.length} existing months, ${re.length} from PDF = ${ja.length} total`),de?.cycleStartMonth?(_({cycleStartMonth:de.cycleStartMonth,cycleStartDate:de.cycleStartDate,startingStatus:ge.status,startingXP:de.rolloverXP??0}),console.log("[handlePdfImport] Qualification settings updated from PDF cycle info")):D||console.log("[handlePdfImport] No cycle info detected - user needs to set qualification date");const ya=tt.filter(Pe=>de?.cycleStartDate?Pe.date>=de.cycleStartDate:!0).reduce((Pe,Ct)=>Pe+(Ct.earnedXP||0)+(Ct.safXp||0),0)+(de?.rolloverXP||0),Wr=tt.filter(Pe=>de?.cycleStartDate?Pe.date>=de.cycleStartDate:!0).reduce((Pe,Ct)=>Pe+(Ct.uxp||0),0),xl=ge.xp-ya;Math.abs(xl)>0&&console.log(`[handlePdfImport] XP validation: PDF header=${ge.xp}, calculated=${ya}, difference=${xl}`);const ml={...$s,calculatedXpAtImport:ya,calculatedUxpAtImport:Wr};V(ml),console.log("[handlePdfImport] PDF Baseline with delta tracking:",ml),he()},[t,he,h,r,D,o]),Ls=d.useCallback(()=>{const E=bo();return E?(b(E.flights),i(E.milesRecords),_(E.qualificationSettings),u(E.manualLedger),go(),he(),console.log("[handleUndoImport] Data restored from backup"),!0):(console.warn("[handleUndoImport] No backup found"),!1)},[he]),[Ne,Le]=d.useState({canUndo:!1,info:null});d.useEffect(()=>{Le({canUndo:ho(),info:po()})},[h]);const fa=Ne.canUndo,Ur=Ne.info,ns=d.useCallback(E=>{const re=Vi(E);i(re.milesData),c(re.xpData),p(re.redemptions),b(re.flights),S(re.xpRollover),u(re.manualLedger),_(re.qualificationSettings),Z(E)},[]),Tr=d.useCallback(()=>{ns(se),$(!0),T(!1)},[se,ns]),zr=d.useCallback(E=>{B&&(Z(E),ns(E))},[B,ns]),Ir=d.useCallback(()=>{i([]),c([]),p([]),b([]),S(0),u({}),_(null),T(!1),he()},[he]),Lr=d.useCallback(async()=>{if(window.confirm("Are you sure you want to start over? This wipes all data.")){if(i([]),c([]),p([]),b([]),S(0),u({}),_(null),F(null),L(0),k(0),C(.012),$(!1),oe(!1),t)try{await Promise.all([Nl(t.id,[]),va(t.id,[]),wa(t.id,[]),Sa(t.id,{}),fs(t.id,{xp_rollover:0,qualification_start_month:null,qualification_start_date:null,starting_status:null,starting_xp:0,ultimate_cycle_type:null,home_airport:null,miles_balance:0,current_uxp:0,target_cpm:.012})])}catch(E){console.error("Error clearing user data:",E)}ce.current=!1,fe.current=null,q(!0),T(!0)}},[t]),$r=d.useCallback(()=>{$(!0),Z("Platinum"),q(!0),ns("Platinum")},[ns]),Or=d.useCallback(()=>{oe(!0),q(!0),i([]),c([]),p([]),b([]),S(0),u({}),_(null),F(null),L(0),k(0)},[]),Gr=d.useCallback(()=>{$(!1),oe(!1),ce.current=!1,fe.current=null,q(!1),t?ve():(i([]),c([]),p([]),b([]),S(0),u({}),_(null),F(null),L(0),k(0),C(.012))},[t,ve]),Kr=d.useCallback(async E=>{if(f(E.currency),F(E.homeAirport),C(E.targetCPM),R(E.emailConsent),v(!0),!E.isReturningUser&&(S(E.rolloverXP),L(E.milesBalance),k(E.currentUXP),E.currentStatus!=="Explorer"||E.currentXP>0)){const re=new Date,de=`${(re.getMonth()>=10?re.getFullYear()+1:re.getFullYear())-1}-11`;_({cycleStartMonth:de,startingStatus:E.currentStatus,startingXP:E.currentXP,ultimateCycleType:E.ultimateCycleType})}if(t&&!B)try{const re={currency:E.currency,home_airport:E.homeAirport,target_cpm:E.targetCPM,email_consent:E.emailConsent,onboarding_completed:!0};E.isReturningUser||(re.xp_rollover=E.rolloverXP,re.miles_balance=E.milesBalance,re.current_uxp=E.currentUXP,re.starting_status=E.currentStatus,re.starting_xp=E.currentXP,re.ultimate_cycle_type=E.ultimateCycleType),await fs(t.id,re)}catch(re){console.error("Error saving onboarding data:",re)}},[t,B]),Yr=d.useCallback(()=>{v(!1)},[]),qr=d.useCallback(async E=>{if(R(E),t&&!B)try{await fs(t.id,{email_consent:E})}catch(re){console.error("Error updating email consent:",re)}},[t,B]),Vr=d.useCallback(()=>{const E=Se.reduce((ge,de)=>ge+de.miles_subscription+de.miles_amex+de.miles_flight+de.miles_other,0),re=Se.reduce((ge,de)=>ge+de.cost_subscription+de.cost_amex+de.cost_flight+de.cost_other,0);return E>0?re/E*100:0},[Se]),Hr=d.useCallback(async E=>{if(!t||B||Q)return E.flights&&b(E.flights),E.baseMilesData&&i(E.baseMilesData),E.baseXpData&&c(E.baseXpData),E.redemptions&&p(E.redemptions),E.manualLedger&&u(E.manualLedger),E.qualificationSettings&&_(E.qualificationSettings),typeof E.xpRollover=="number"&&S(E.xpRollover),E.homeAirport!==void 0&&F(E.homeAirport),!0;M(!0),ce.current=!0,fe.current=t.id,q(!0);try{const re={};E.manualLedger&&Object.entries(E.manualLedger).forEach(([kt,Xe])=>{re[kt]={month:kt,amexXp:Xe.amexXp||0,bonusSafXp:Xe.bonusSafXp||0,miscXp:Xe.miscXp||0,correctionXp:Xe.correctionXp||0}});const ge=[];E.flights&&ge.push(_i(t.id,E.flights)),E.baseMilesData&&ge.push(va(t.id,E.baseMilesData)),E.redemptions&&ge.push(wa(t.id,E.redemptions)),E.manualLedger&&Object.keys(re).length>0&&ge.push(Sa(t.id,re));const de={};if(E.qualificationSettings&&(de.qualification_start_month=E.qualificationSettings.cycleStartMonth||null,de.qualification_start_date=E.qualificationSettings.cycleStartDate||null,de.starting_status=E.qualificationSettings.startingStatus||null,de.starting_xp=E.qualificationSettings.startingXP??0,de.starting_uxp=E.qualificationSettings.startingUXP??0,de.ultimate_cycle_type=E.qualificationSettings.ultimateCycleType||null),typeof E.xpRollover=="number"&&(de.xp_rollover=E.xpRollover),E.homeAirport!==void 0&&(de.home_airport=E.homeAirport),Object.keys(de).length>0&&ge.push(fs(t.id,de)),!(await Promise.all(ge)).every(kt=>kt))return console.error("JSON import: some saves failed"),!1;const He=await vl(t.id);b(He.flights),i(He.milesData),p(He.redemptions);const gs={};return Object.entries(He.xpLedger).forEach(([kt,Xe])=>{gs[kt]={amexXp:Xe.amexXp,bonusSafXp:Xe.bonusSafXp,miscXp:Xe.miscXp,correctionXp:Xe.correctionXp}}),u(gs),He.profile&&(S(He.profile.xpRollover||0),He.profile.qualificationStartMonth&&_({cycleStartMonth:He.profile.qualificationStartMonth,cycleStartDate:He.profile.qualificationStartDate||void 0,startingStatus:He.profile.startingStatus||"Explorer",startingXP:He.profile.startingXP??0,ultimateCycleType:He.profile.ultimateCycleType||"qualification"})),!0}catch(re){return console.error("JSON import error:",re),!1}finally{M(!1)}},[t,B,Q]);return{state:{baseMilesData:r,baseXpData:x,manualLedger:o,redemptions:m,flights:h,xpRollover:g,targetCPM:P,currency:w,qualificationSettings:D,pdfBaseline:O,milesData:Se,xpData:Te,displayXP:H,displayUXP:ie,displayMiles:ue,displayStatus:be,currentStatus:Me,currentMonth:n,homeAirport:N,milesBalance:X,currentUXP:G},actions:{setFlights:Ae,setBaseMilesData:bt,setBaseXpData:ot,setRedemptions:gt,setManualLedger:W,setXpRollover:pe,setTargetCPM:Fe,setCurrency:te,setQualificationSettings:ae,setCurrentMonth:l,handleFlightsUpdate:xe,handleFlightIntakeApply:qe,handleManualLedgerUpdate:Rt,handleRedemptionsUpdate:Ve,handleTargetCPMUpdate:_t,handleCurrencyUpdate:ls,handleManualXPLedgerUpdate:hs,handleXPRolloverUpdate:ps,handlePdfImport:dl,handleUndoImport:Ls,canUndoImport:fa,importBackupInfo:Ur,handleQualificationSettingsUpdate:bs,handleLoadDemo:Tr,handleStartEmpty:Ir,handleStartOver:Lr,handleEnterDemoMode:$r,handleEnterLocalMode:Or,handleExitDemoMode:Gr,handleSetDemoStatus:zr,markDataChanged:he,calculateGlobalCPM:Vr,forceSave:Ye,handleJsonImport:Hr,handleOnboardingComplete:Kr,handleRerunOnboarding:Yr,handleEmailConsentChange:qr},meta:{isLoading:I||!!t&&!B&&!Q&&!J,isSaving:U,isDemoMode:B,isLocalMode:Q,demoStatus:se,showWelcome:ee,setShowWelcome:T,onboardingCompleted:j,emailConsent:A}}}const Mn="skystatus_cookie_consent",Fn="1.0",An=d.createContext(void 0),zs=()=>{const t=d.useContext(An);if(!t)throw new Error("useCookieConsent must be used within CookieConsentProvider");return t},yo=()=>{try{const t=localStorage.getItem(Mn);if(t){const s=JSON.parse(t);if(s.version===Fn)return{consent:s.consent,showBanner:!1}}}catch{}return{consent:null,showBanner:!0}},xt=({children:t})=>{const[s,a]=d.useState(yo),[n,l]=d.useState(!1);d.useEffect(()=>{s.consent?.analytics&&Al()},[]);const r=d.useCallback(m=>{const p=s.consent,h={version:Fn,consent:m,timestamp:new Date().toISOString()};localStorage.setItem(Mn,JSON.stringify(h)),a({consent:m,showBanner:!1}),l(!1),m.analytics&&(!p||!p.analytics)?Al():!m.analytics&&p?.analytics&&No()},[s.consent]),i=d.useCallback(()=>{r({necessary:!0,functional:!0,analytics:!0,marketing:!0})},[r]),x=d.useCallback(()=>{r({necessary:!0,functional:!1,analytics:!1,marketing:!1})},[r]),c=d.useCallback(m=>{r({necessary:!0,functional:m.functional??!1,analytics:m.analytics??!1,marketing:m.marketing??!1})},[r]),o=d.useCallback(()=>{l(!0)},[]),u=d.useCallback(()=>{l(!1)},[]);return e.jsx(An.Provider,{value:{consent:s.consent,hasConsented:s.consent!==null,showBanner:s.showBanner,acceptAll:i,rejectAll:x,acceptSelected:c,openSettings:o,closeSettings:u,showSettings:n},children:t})};async function Al(){try{const{initializeAnalytics:t}=await ia(async()=>{const{initializeAnalytics:s}=await Promise.resolve().then(()=>cr);return{initializeAnalytics:s}},void 0);await t(),console.log("[Cookie Consent] Analytics consent granted - GA4 initialized")}catch(t){console.error("[Cookie Consent] Failed to initialize analytics:",t)}}async function No(){try{const{revokeAnalyticsConsent:t}=await ia(async()=>{const{revokeAnalyticsConsent:s}=await Promise.resolve().then(()=>cr);return{revokeAnalyticsConsent:s}},void 0);t(),console.log("[Cookie Consent] Analytics consent revoked")}catch(t){console.error("[Cookie Consent] Failed to revoke analytics:",t)}}const rl="G-9846CTNB76";let Xl=!1,Fs=!1;function Xn(){typeof window>"u"||(window.dataLayer=window.dataLayer||[],window.gtag=function(...s){window.dataLayer.push(s)},window.gtag("js",new Date),window.gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",wait_for_update:500}),window.gtag("config",rl,{anonymize_ip:!0,allow_google_signals:!1,allow_ad_personalization_signals:!1,send_page_view:!1}))}function En(){return new Promise((t,s)=>{if(typeof window>"u"){s(new Error("Window not available"));return}if(Xl){t();return}const a=document.createElement("script");a.src=`https://www.googletagmanager.com/gtag/js?id=${rl}`,a.async=!0,a.onload=()=>{Xl=!0,console.log("[Analytics] GA4 script loaded"),t()},a.onerror=()=>{s(new Error("Failed to load GA4 script"))},document.head.appendChild(a)})}async function vo(){if(!(typeof window>"u")&&!Fs)try{Xn(),await En(),window.gtag("consent","update",{analytics_storage:"granted"}),Fs=!0,console.log("[Analytics] GA4 initialized with consent"),il()}catch(t){console.error("[Analytics] Failed to initialize:",t)}}function wo(){typeof window>"u"||!window.gtag||(window.gtag("consent","update",{analytics_storage:"denied"}),console.log("[Analytics] Consent revoked"))}function il(t,s){if(typeof window>"u"||!window.gtag||!Fs)return;const a=t||window.location.pathname+window.location.search,n=document.title;window.gtag("event","page_view",{page_path:a,page_title:n,page_location:window.location.href}),console.log("[Analytics] Page view:",a)}function ye(t,s){typeof window>"u"||!window.gtag||!Fs||(window.gtag("event",t,s),console.log("[Analytics] Event:",t,s))}function Dn(t){ye("access_mode_start",{method:t,event_category:"authentication"})}function Bn(){ye("sign_out",{event_category:"authentication"})}function Rn(t,s){ye("demo_status_change",{from_status:t,to_status:s,event_category:"demo"})}function _n(t){ye("demo_exit",{action:t,event_category:"demo"})}function Un(t){ye("view_mode_change",{mode:t,event_category:"preferences"})}function Tn(t,s){ye("navigation",{from_view:t,to_view:s,event_category:"navigation"})}function zn(t,s,a){ye("pdf_import",{flight_count:t,miles_months:s,pdf_language:a||"unknown",event_category:"data_import"})}function In(t){ye("pdf_import_error",{error_type:t,event_category:"data_import"})}function Ln(t,s){ye("flight_add",{cabin_class:t,is_af_klm:s,event_category:"data_entry"})}function $n(t){ye("flight_delete",{count:t,event_category:"data_entry"})}function On(t){ye("miles_entry_add",{source:t,event_category:"data_entry"})}function Gn(t,s){ye("redemption_add",{miles_used:t,cpm_category:s,event_category:"data_entry"})}function Kn(t){ye("redemption_delete",{count:t,event_category:"data_entry"})}function Yn(){ye("data_export",{format:"json",event_category:"data_management"})}function qn(t,s,a){ye("data_import",{flights_count:t,redemptions_count:s,miles_months:a,format:"json",event_category:"data_management"})}function Vn(t){ye("analytics_section_view",{section:t,event_category:"analytics"})}function Hn(t){ye("calculator_use",{calculator_type:t,event_category:"engagement"})}function Wn(t,s){ye("mileage_run_simulation",{target_status:t,current_xp:s,event_category:"engagement"})}function Jn(t,s){ye("onboarding_complete",{has_pdf:t,has_flights:s,event_category:"engagement"})}function Zn(t,s){ye("onboarding_step",{step_number:t,step_name:s,event_category:"engagement"})}function Qn(t,s){ye("settings_change",{setting_name:t,setting_value:String(s),event_category:"preferences"})}function er(t){ye("guide_view",{guide_slug:t,event_category:"content"})}function tr(t){ye("search_open",{trigger:t,event_category:"search"})}function sr(t,s){ye("search_query",{search_term:t.substring(0,100),result_count:s,event_category:"search"})}function ar(t,s,a,n){ye("search_result_click",{search_term:t.substring(0,100),result_type:s,result_title:a.substring(0,100),result_position:n,event_category:"search"})}function lr(t,s){ye("search_result_open",{result_type:t,result_url:s,event_category:"search"})}function nr(t){ye("feature_use",{feature_name:t,event_category:"engagement"})}function rr(t){ye("bug_report_submit",{category:t,event_category:"feedback"})}function ir(t){ye("contact_form_submit",{subject:t,event_category:"feedback"})}function or(t,s){ye("exception",{description:`${t}: ${s}`,fatal:!1})}function ol(){return Fs}const cr=Object.freeze(Object.defineProperty({__proto__:null,GA_MEASUREMENT_ID:rl,initializeAnalytics:vo,initializeGtagDefaults:Xn,isAnalyticsActive:ol,loadGtagScript:En,revokeAnalyticsConsent:wo,trackAccessModeStart:Dn,trackAnalyticsSectionView:Vn,trackBugReport:rr,trackCalculatorUsage:Hn,trackContactForm:ir,trackDataExport:Yn,trackDataImport:qn,trackDemoExit:_n,trackDemoStatusChange:Rn,trackError:or,trackEvent:ye,trackFeatureUsage:nr,trackFlightAdd:Ln,trackFlightDelete:$n,trackGuideView:er,trackMileageRunSimulation:Wn,trackMilesAdd:On,trackNavigation:Tn,trackOnboardingComplete:Jn,trackOnboardingStep:Zn,trackPageView:il,trackPdfImport:zn,trackPdfImportError:In,trackRedemptionAdd:Gn,trackRedemptionDelete:Kn,trackSearchOpen:tr,trackSearchQuery:sr,trackSearchResultClick:ar,trackSearchResultOpen:lr,trackSettingsChange:Qn,trackSignOut:Bn,trackViewModeChange:Un},Symbol.toStringTag,{value:"Module"}));function So(){const t=ln(),{consent:s}=zs();d.useEffect(()=>{if(s?.analytics&&ol()){const a=setTimeout(()=>{il(t.pathname+t.search)},100);return()=>clearTimeout(a)}},[t.pathname,t.search,s?.analytics])}function rt(){const{consent:t}=zs(),s=d.useRef(null),a=t?.analytics&&ol(),n=d.useCallback((y,U)=>{a&&ye(y,U)},[a]),l=d.useCallback(y=>{a&&Dn(y)},[a]),r=d.useCallback(()=>{a&&Bn()},[a]),i=d.useCallback((y,U)=>{a&&Rn(y,U)},[a]),x=d.useCallback(y=>{a&&_n(y)},[a]),c=d.useCallback(y=>{a&&Un(y)},[a]),o=d.useCallback(y=>{if(a){const U=s.current||"unknown";Tn(U,y),s.current=y}},[a]),u=d.useCallback((y,U,M)=>{a&&zn(y,U,M)},[a]),m=d.useCallback(y=>{a&&In(y)},[a]),p=d.useCallback((y,U)=>{a&&Ln(y,U)},[a]),h=d.useCallback(y=>{a&&$n(y)},[a]),b=d.useCallback(y=>{a&&On(y)},[a]),g=d.useCallback((y,U)=>{a&&Gn(y,U)},[a]),S=d.useCallback(y=>{a&&Kn(y)},[a]),P=d.useCallback(()=>{a&&Yn()},[a]),C=d.useCallback((y,U,M)=>{a&&qn(y,U,M)},[a]),w=d.useCallback(y=>{a&&Vn(y)},[a]),f=d.useCallback(y=>{a&&Hn(y)},[a]),D=d.useCallback((y,U)=>{a&&Wn(y,U)},[a]),_=d.useCallback((y,U)=>{a&&Jn(y,U)},[a]),N=d.useCallback((y,U)=>{a&&Zn(y,U)},[a]),F=d.useCallback((y,U)=>{a&&Qn(y,U)},[a]),j=d.useCallback(y=>{a&&er(y)},[a]),v=d.useCallback(y=>{a&&tr(y)},[a]),A=d.useCallback((y,U)=>{a&&sr(y,U)},[a]),R=d.useCallback((y,U,M,z)=>{a&&ar(y,U,M,z)},[a]),X=d.useCallback((y,U)=>{a&&lr(y,U)},[a]),L=d.useCallback(y=>{a&&nr(y)},[a]),G=d.useCallback(y=>{a&&rr(y)},[a]),k=d.useCallback(y=>{a&&ir(y)},[a]),I=d.useCallback((y,U)=>{a&&or(y,U)},[a]);return{isEnabled:a,track:n,trackAccessMode:l,trackUserSignOut:r,trackDemoStatus:i,trackExitDemo:x,trackViewMode:c,trackNav:o,trackPdf:u,trackPdfError:m,trackFlight:p,trackFlightRemove:h,trackMiles:b,trackRedemption:g,trackRedemptionRemove:S,trackExport:P,trackImport:C,trackAnalyticsSection:w,trackCalculator:f,trackMileageRun:D,trackOnboarding:_,trackOnboardingStepComplete:N,trackSettings:F,trackGuide:j,trackSearch:v,trackSearchTerm:A,trackSearchClick:R,trackSearchExternal:X,trackFeature:L,trackBugReportSubmit:G,trackContactFormSubmit:k,logError:I}}const na=[{code:"EUR",label:"Euro",symbol:"â¬"},{code:"USD",label:"US Dollar",symbol:"$"},{code:"GBP",label:"British Pound",symbol:"Â£"},{code:"CAD",label:"Canadian Dollar",symbol:"C$"},{code:"CHF",label:"Swiss Franc",symbol:"CHF"},{code:"AUD",label:"Australian Dollar",symbol:"A$"},{code:"SEK",label:"Swedish Krona",symbol:"kr"},{code:"NOK",label:"Norwegian Krone",symbol:"kr"},{code:"DKK",label:"Danish Krone",symbol:"kr"},{code:"PLN",label:"Polish ZÅoty",symbol:"zÅ"}],dr=(t="EUR")=>na.find(s=>s.code===t)?.symbol||"â¬",xr=(t,s="EUR")=>new Intl.NumberFormat("en-US",{style:"currency",currency:s,minimumFractionDigits:2}).format(t),mr=(t,s="EUR")=>new Intl.NumberFormat("en-US",{style:"currency",currency:s,minimumFractionDigits:0,maximumFractionDigits:0}).format(t),ur=(t,s="EUR",a=4)=>`${dr(s)}${t.toFixed(a)}`,ne=t=>new Intl.NumberFormat("en-US").format(t),ba=()=>Math.random().toString(36).substr(2,9),hr=d.createContext(null),Po=({currency:t,children:s})=>{const a={currency:t,symbol:dr(t),format:n=>xr(n,t),formatShort:n=>mr(n,t),formatPrecise:(n,l)=>ur(n,t,l)};return e.jsx(hr.Provider,{value:a,children:s})},Ke=()=>{const t=d.useContext(hr);return t||{currency:"EUR",symbol:"â¬",format:s=>xr(s,"EUR"),formatShort:s=>mr(s,"EUR"),formatPrecise:(s,a)=>ur(s,"EUR",a)}},ko=[{id:"necessary",name:"Strictly Necessary",description:"Essential for the website. These cookies enable core functionality like security, authentication, and accessibility. They cannot be disabled.",required:!0,examples:["Session management","Authentication tokens","Security preferences"]},{id:"functional",name:"Functional",description:"Remembers your preferences and settings. Without these, some features may not work optimally.",required:!1,examples:["Currency preference","Home airport setting","Display preferences"]},{id:"analytics",name:"Analytics",description:"Helps us understand visitor interaction. This data is anonymized and used to improve SkyStatus.",required:!1,examples:["Page views","Feature usage","Error tracking"]},{id:"marketing",name:"Marketing",description:"Tracks visitors across websites for advertising. We currently do not use marketing cookies.",required:!1,examples:["Currently not used"],disabled:!0}],Co=()=>{const{showBanner:t,acceptAll:s,rejectAll:a,openSettings:n}=zs();return t?e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-[100] p-4 animate-in slide-in-from-bottom duration-300",children:e.jsx("div",{className:"max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden",children:e.jsxs("div",{className:"p-4 sm:p-5 flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-xl flex-shrink-0 hidden sm:flex",children:e.jsx(oa,{size:20,className:"text-slate-600"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed",children:["We use cookies to improve your experience. Analytics help us make SkyStatus better."," ",e.jsx("button",{onClick:n,className:"text-brand-600 hover:text-brand-700 font-medium underline underline-offset-2",children:"Customize"})," ","or read our"," ",e.jsx("a",{href:"/privacy",className:"text-brand-600 hover:text-brand-700 font-medium underline underline-offset-2",children:"Privacy Policy"}),"."]})})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:a,className:"flex-1 sm:flex-none px-4 py-2.5 text-slate-600 font-medium rounded-xl hover:bg-slate-100 transition-colors text-sm",children:"Decline"}),e.jsx("button",{onClick:s,className:"flex-1 sm:flex-none px-6 py-2.5 bg-brand-600 hover:bg-brand-700 text-white font-semibold rounded-xl transition-colors text-sm shadow-lg shadow-brand-600/25",children:"Accept All"})]})]})})}):null},Mo=()=>{const{showSettings:t,closeSettings:s,acceptSelected:a,consent:n}=zs(),[l,r]=d.useState(null),[i,x]=d.useState({functional:n?.functional??!1,analytics:n?.analytics??!1,marketing:n?.marketing??!1});if(!t)return null;const c=u=>{u!=="necessary"&&x(m=>({...m,[u]:!m[u]}))},o=()=>{a(i)};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-xl max-h-[90vh] rounded-2xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100 flex items-center justify-between bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-brand-100 rounded-xl",children:e.jsx(ca,{size:20,className:"text-brand-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Cookie Settings"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Manage your cookie preferences"})]})]}),e.jsx("button",{onClick:s,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded-xl transition-colors",children:e.jsx(Ce,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-3",children:[ko.map(u=>{const m=l===u.id,p=u.required||i[u.id],h=u.required||u.disabled;return e.jsxs("div",{className:`border rounded-xl overflow-hidden transition-colors ${p?"border-brand-200 bg-brand-50/30":"border-slate-200"}`,children:[e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>r(m?null:u.id),className:"flex-1 flex items-center gap-3 text-left",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${p?"bg-brand-100 text-brand-600":"bg-slate-100 text-slate-400"}`,children:u.required?e.jsx(Zt,{size:16}):e.jsx(oa,{size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-slate-900 text-sm flex items-center gap-2",children:[u.name,u.required&&e.jsx("span",{className:"text-[10px] font-bold bg-emerald-100 text-emerald-700 px-1.5 py-0.5 rounded",children:"Required"}),u.disabled&&e.jsx("span",{className:"text-[10px] font-bold bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded",children:"Not used"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5 line-clamp-1",children:u.description})]}),m?e.jsx(cs,{size:16,className:"text-slate-400"}):e.jsx(nt,{size:16,className:"text-slate-400"})]}),e.jsx("button",{onClick:()=>c(u.id),disabled:h,className:`ml-3 relative w-12 h-7 rounded-full transition-colors ${h?"bg-slate-200 cursor-not-allowed":p?"bg-brand-500":"bg-slate-300 hover:bg-slate-400"}`,children:e.jsx("div",{className:`absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ${p?"translate-x-6":"translate-x-1"}`,children:p&&e.jsx(ct,{size:12,className:"text-brand-500 m-1"})})})]}),m&&e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-slate-100 bg-white/50",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-3",children:u.description}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:"Examples:"}),e.jsx("ul",{className:"mt-1 space-y-0.5",children:u.examples.map((b,g)=>e.jsxs("li",{className:"text-slate-500 flex items-center gap-1.5",children:[e.jsx("span",{className:"w-1 h-1 bg-slate-300 rounded-full"}),b]},g))})]})]})]},u.id)}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 rounded-xl border border-amber-100 mt-4",children:[e.jsx(lt,{size:14,className:"text-amber-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-amber-800",children:'You can change these preferences at any time by clicking "Cookie Settings" in the footer of any page. Your choice will be remembered for 12 months.'})]})]}),e.jsxs("div",{className:"p-5 border-t border-slate-100 bg-slate-50 flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:s,className:"flex-1 px-4 py-3 border border-slate-200 text-slate-600 font-semibold rounded-xl hover:bg-white transition-colors text-sm",children:"Cancel"}),e.jsxs("button",{onClick:o,className:"flex-1 px-4 py-3 bg-gradient-to-r from-brand-500 to-blue-600 text-white font-semibold rounded-xl hover:from-brand-600 hover:to-blue-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(ct,{size:16}),"Save Preferences"]})]})]})})},Fo=({className:t=""})=>{const{openSettings:s,hasConsented:a}=zs();return a?e.jsxs("button",{onClick:s,className:`inline-flex items-center gap-1 text-xs text-slate-400 hover:text-brand-600 transition-colors ${t}`,children:[e.jsx(oa,{size:12}),"Cookie Settings"]}):null},mt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Co,{}),e.jsx(Mo,{})]}),ra="skystatus_view_mode",Ao=768;function pr(){return typeof window>"u"?!1:window.innerWidth<Ao}function br(){return pr()?"simple":"full"}let Qs=[];function El(){try{const t=localStorage.getItem(ra);if(t==="simple"||t==="full")return t}catch{}return br()}function Xo(){return"simple"}function Eo(t){return Qs.push(t),()=>{Qs=Qs.filter(s=>s!==t)}}function gr(){Qs.forEach(t=>t())}function Dl(t){try{localStorage.setItem(ra,t)}catch{}gr()}function it(){const t=d.useSyncExternalStore(Eo,El,Xo),s=d.useCallback(n=>{Dl(n)},[]),a=d.useCallback(()=>{const n=El();Dl(n==="simple"?"full":"simple")},[]);return d.useEffect(()=>{try{if(!localStorage.getItem(ra)){const l=br();localStorage.setItem(ra,l),gr()}}catch{}},[]),{viewMode:t,isSimpleMode:t==="simple",isMobile:pr(),setViewMode:s,toggleViewMode:a}}const pt={FIRST_IMPORT_DATE:"skystatus_first_import_date",SESSION_COUNT:"skystatus_session_count",FEEDBACK_DISMISSED_UNTIL:"skystatus_feedback_dismissed_until",POST_IMPORT_FEEDBACK_GIVEN:"skystatus_post_import_feedback_given",DASHBOARD_FEEDBACK_GIVEN:"skystatus_dashboard_feedback_given"};async function xs(t){try{const{data:s}=await ke.auth.getUser(),{error:a}=await ke.from("feedback").insert({user_id:s?.user?.id||null,user_email:s?.user?.email||null,trigger:t.trigger,rating:t.rating||null,message:t.message||null,page:t.page||null});return a?(console.error("Error submitting feedback:",a),!1):!0}catch(s){return console.error("Error submitting feedback:",s),!1}}function Bl(){localStorage.getItem(pt.FIRST_IMPORT_DATE)||localStorage.setItem(pt.FIRST_IMPORT_DATE,new Date().toISOString())}function Do(){const t=parseInt(localStorage.getItem(pt.SESSION_COUNT)||"0",10);localStorage.setItem(pt.SESSION_COUNT,String(t+1))}function fr(){return parseInt(localStorage.getItem(pt.SESSION_COUNT)||"0",10)}function Rl(){return localStorage.getItem(pt.POST_IMPORT_FEEDBACK_GIVEN)==="true"}function _l(){localStorage.setItem(pt.POST_IMPORT_FEEDBACK_GIVEN,"true")}function Bo(){return localStorage.getItem(pt.DASHBOARD_FEEDBACK_GIVEN)==="true"}function Ro(){localStorage.setItem(pt.DASHBOARD_FEEDBACK_GIVEN,"true")}function _o(){const t=new Date;t.setDate(t.getDate()+30),localStorage.setItem(pt.FEEDBACK_DISMISSED_UNTIL,t.toISOString())}function Uo(){if(Bo())return!1;const t=localStorage.getItem(pt.FEEDBACK_DISMISSED_UNTIL);if(t&&new Date(t)>new Date)return!1;const s=localStorage.getItem(pt.FIRST_IMPORT_DATE);return!!(fr()>=5||s&&Math.floor((new Date().getTime()-new Date(s).getTime())/864e5)>=7)}function To(){return fr()>=5?"5_sessions":"7_days"}const zo=({isOpen:t,onClose:s})=>{const[a,n]=d.useState(""),[l,r]=d.useState(""),[i,x]=d.useState(""),[c,o]=d.useState(""),[u,m]=d.useState(!1),[p,h]=d.useState("idle"),{trackBugReportSubmit:b}=rt(),g=()=>{const C=navigator.userAgent;let w="Unknown",f="Unknown";return C.includes("Firefox")?w="Firefox":C.includes("Chrome")?w="Chrome":C.includes("Safari")?w="Safari":C.includes("Edge")&&(w="Edge"),C.includes("Windows")?f="Windows":C.includes("Mac")?f="macOS":C.includes("Linux")?f="Linux":C.includes("iPhone")||C.includes("iPad")?f="iOS":C.includes("Android")&&(f="Android"),`${w} on ${f}`},S=async C=>{if(C.preventDefault(),!a.trim())return;m(!0),h("idle");const w=["ð BUG REPORT","","**What happened:**",a.trim(),"","**What I expected:**",l.trim()||"(not provided)","","**Steps to reproduce:**",i.trim()||"(not provided)","","**Browser/Device:**",g(),"","**Contact email:**",c.trim()||"(not provided)","","**Page:**",window.location.href,"","**Timestamp:**",new Date().toISOString()].join(`
`),f=await xs({trigger:"bug_report",message:w,page:window.location.pathname});m(!1),h(f?"success":"error"),f&&(b("bug"),setTimeout(()=>{n(""),r(""),x(""),o(""),h("idle"),s()},2e3))},P=()=>{u||(h("idle"),s())};return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:P}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200 bg-gradient-to-r from-amber-50 to-orange-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl shadow-lg shadow-amber-500/25",children:e.jsx(on,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Report a Bug"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Help us improve SkyStatus"})]})]}),e.jsx("button",{onClick:P,disabled:u,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(Ce,{size:20})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:p==="success"?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-emerald-100 rounded-full mb-4",children:e.jsx(Qt,{size:32,className:"text-emerald-600"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Thanks for reporting!"}),e.jsx("p",{className:"text-sm text-slate-500",children:"We'll look into this issue."})]}):p==="error"?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:e.jsx(Nt,{size:32,className:"text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Please try again. If the problem persists, try using the Contact form in the FAQ page."}),e.jsx("button",{onClick:()=>h("idle"),className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"Try again"})]}):e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:["What happened? ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:a,onChange:C=>n(C.target.value),placeholder:"Describe the bug you encountered...",rows:3,required:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"What did you expect?"}),e.jsx("textarea",{value:l,onChange:C=>r(C.target.value),placeholder:"What should have happened instead?",rows:2,className:"w-full px-4 py-3 border border-slate-200 rounded-xl text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Steps to reproduce"}),e.jsx("textarea",{value:i,onChange:C=>x(C.target.value),placeholder:`1. Go to...
2. Click on...
3. See error...`,rows:3,className:"w-full px-4 py-3 border border-slate-200 rounded-xl text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:["Email for follow-up",e.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(optional)"})]}),e.jsx("input",{type:"email",value:c,onChange:C=>o(C.target.value),placeholder:"your@email.com",className:"w-full px-4 py-3 border border-slate-200 rounded-xl text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsx("div",{className:"p-3 bg-slate-50 rounded-xl",children:e.jsxs("p",{className:"text-xs text-slate-500",children:[e.jsx("span",{className:"font-medium text-slate-600",children:"Auto-detected:"})," ",g()," â¢ Current page will be included"]})})]})}),p==="idle"&&e.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-slate-200 bg-slate-50",children:[e.jsx("button",{type:"button",onClick:P,disabled:u,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-800 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:S,disabled:u||!a.trim(),className:"inline-flex items-center gap-2 px-5 py-2 text-sm font-semibold text-white bg-gradient-to-r from-amber-500 to-orange-500 rounded-xl hover:from-amber-400 hover:to-orange-400 transition-all shadow-lg shadow-amber-500/25 disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:16,className:"animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{size:16}),"Submit Report"]})})]})]})]}):null},Ka="2.4.0";function Gs(t,s){if(!t||!s)return 0;const a=t.toLowerCase(),n=s.toLowerCase(),l=n.split(/\s+/).filter(i=>i.length>0);let r=0;return a.includes(n)&&(r+=100),l.forEach(i=>{a.includes(i)&&(r+=20,(a.startsWith(i)||a.includes(" "+i))&&(r+=10))}),r}function Io(t,s){if(!s.trim())return[];const a=[];return t.forEach(n=>{const l=Gs(n.title,s)*3,r=Gs(n.description,s)*2,i=Gs(n.content,s)*.5;let x=0,c;n.headings.forEach(u=>{const m=Gs(u.text,s)*2.5;m>x&&(x=m,c=u)});const o=l+r+i+x;o>0&&a.push({...n,score:o,matchedHeading:x>l*.5?c:void 0})}),a.sort((n,l)=>l.score-n.score).slice(0,12)}const jr=({isOpen:t,onClose:s})=>{const[a,n]=d.useState(""),[l,r]=d.useState([]),[i,x]=d.useState(0),[c,o]=d.useState(null),[u,m]=d.useState(!1),[p,h]=d.useState(null),[b,g]=d.useState(""),[S,P]=d.useState(!1),[C,w]=d.useState("guide"),f=d.useRef(null),D=d.useRef(null),_=d.useRef(""),{trackSearchTerm:N,trackSearchClick:F,trackSearchExternal:j}=rt();d.useEffect(()=>{t&&!c&&(m(!0),fetch("/search-index.json").then(k=>k.json()).then(k=>{o(k),m(!1)}).catch(k=>{console.error("Failed to load search index:",k),m(!1)}))},[t,c]),d.useEffect(()=>{t&&!p&&f.current&&setTimeout(()=>f.current?.focus(),50)},[t,p]),d.useEffect(()=>{if(c&&a.trim()){const k=Io(c.items,a);if(r(k),x(0),a.length>=2&&a!==_.current){const I=setTimeout(()=>{N(a,k.length),_.current=a},500);return()=>clearTimeout(I)}}else r([])},[a,c,N]),d.useEffect(()=>{t||(h(null),g(""),n(""),r([]))},[t]);const v=d.useCallback(k=>{if(p){k.key==="Escape"&&(h(null),g(""));return}switch(k.key){case"ArrowDown":k.preventDefault(),x(I=>Math.min(I+1,l.length-1));break;case"ArrowUp":k.preventDefault(),x(I=>Math.max(I-1,0));break;case"Enter":k.preventDefault(),l[i]&&A(l[i],i);break;case"Escape":s();break}},[l,i,s,p]);d.useEffect(()=>{if(D.current){const k=D.current.querySelector('[data-selected="true"]');k&&k.scrollIntoView({block:"nearest"})}},[i]);const A=(k,I)=>{let y=k.url;k.matchedHeading?.id&&(y+=`#${k.matchedHeading.id}`),F(a,k.type,k.title,I+1),g(k.title),h(y),w(k.type),P(!0)},R=()=>{h(null),g("")},X=()=>{p&&(j(C,p),window.open(p,"_blank"))},L=k=>{switch(k){case"guide":return e.jsx(Ra,{size:18});case"faq":return e.jsx(vt,{size:18});default:return e.jsx(wt,{size:18})}},G=k=>{switch(k){case"guide":return"bg-blue-500";case"faq":return"bg-emerald-500";default:return"bg-slate-500"}};return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-[100]",onClick:s}),e.jsx("div",{className:"fixed inset-4 md:inset-x-auto md:top-[5vh] md:bottom-[5vh] md:left-1/2 md:-translate-x-1/2 md:w-full md:max-w-3xl z-[101] flex flex-col",onKeyDown:v,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col h-full border border-slate-200/50",children:[p?e.jsxs("div",{className:"flex items-center gap-3 px-5 py-4 border-b border-slate-200 bg-slate-50",children:[e.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-white rounded-lg transition-colors",children:[e.jsx(It,{size:16}),"Back"]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-semibold text-slate-900 truncate",children:b})}),e.jsxs("button",{onClick:X,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(Es,{size:14}),"Open"]}),e.jsx("button",{onClick:s,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Ce,{size:18})})]}):e.jsxs("div",{className:"flex items-center gap-4 px-5 py-4 border-b border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg shadow-blue-500/25",children:e.jsx(ds,{size:20,className:"text-white"})}),e.jsx("input",{ref:f,type:"text",value:a,onChange:k=>n(k.target.value),placeholder:"Search guides, FAQ, and more...",className:"flex-1 bg-transparent border-none outline-none text-slate-900 placeholder-slate-400 text-lg font-medium",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}),a&&e.jsx("button",{onClick:()=>n(""),className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Ce,{size:16})}),e.jsx("div",{className:"w-px h-6 bg-slate-200"}),e.jsx("button",{onClick:s,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Ce,{size:18})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:p?e.jsxs("div",{className:"h-full relative",children:[S&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white z-10",children:e.jsxs("div",{className:"flex items-center gap-3 text-slate-500",children:[e.jsx(Qe,{size:24,className:"animate-spin"}),e.jsx("span",{children:"Loading..."})]})}),e.jsx("iframe",{src:p,className:"w-full h-full border-0",onLoad:()=>P(!1),title:b})]}):e.jsxs("div",{ref:D,className:"h-full overflow-y-auto",children:[u&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex items-center gap-3 text-slate-500",children:[e.jsx(Qe,{size:24,className:"animate-spin"}),e.jsx("span",{children:"Loading search index..."})]})}),!u&&a&&l.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mb-4",children:e.jsx(ds,{size:28,className:"text-slate-400"})}),e.jsx("p",{className:"text-slate-900 font-semibold mb-1",children:"No results found"}),e.jsxs("p",{className:"text-slate-500 text-sm",children:['Try different keywords for "',a,'"']})]}),!u&&l.length>0&&e.jsxs("div",{className:"p-3",children:[e.jsxs("p",{className:"px-3 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:[l.length," result",l.length!==1?"s":""]}),e.jsx("div",{className:"space-y-1",children:l.map((k,I)=>e.jsxs("button",{"data-selected":I===i,onClick:()=>A(k,I),onMouseEnter:()=>x(I),className:`w-full p-4 flex items-start gap-4 text-left rounded-xl transition-all ${I===i?"bg-gradient-to-r from-blue-50 to-indigo-50 ring-1 ring-blue-200":"hover:bg-slate-50"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center text-white ${G(k.type)}`,children:L(k.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h4",{className:"font-semibold text-slate-900 leading-snug line-clamp-2",children:k.title}),e.jsx("span",{className:`flex-shrink-0 text-[10px] font-bold uppercase tracking-wide px-2 py-1 rounded-md ${k.type==="guide"?"bg-blue-100 text-blue-700":k.type==="faq"?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:k.type})]}),k.matchedHeading&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[e.jsx(si,{size:12,className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-blue-600 font-medium",children:k.matchedHeading.text})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1.5 line-clamp-2 leading-relaxed",children:k.description})]}),e.jsx(ht,{size:18,className:`flex-shrink-0 mt-2.5 transition-all ${I===i?"text-blue-500 translate-x-0 opacity-100":"text-slate-300 -translate-x-1 opacity-0"}`})]},k.id))})]}),!u&&!a&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider text-slate-400 mb-3",children:"Popular searches"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["XP explained","Gold status","Mileage run","PDF import","Rollover","Ultimate"].map(k=>e.jsx("button",{onClick:()=>n(k),className:"px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-xl text-sm font-medium text-slate-700 transition-colors",children:k},k))})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider text-slate-400 mb-3",children:"Browse by category"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>n("status"),className:"flex flex-col items-center gap-2 p-4 bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-xl flex items-center justify-center",children:e.jsx(Ra,{size:20,className:"text-white"})}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Guides"})]}),e.jsxs("button",{onClick:()=>n("how do I"),className:"flex flex-col items-center gap-2 p-4 bg-emerald-50 hover:bg-emerald-100 rounded-xl transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center",children:e.jsx(vt,{size:20,className:"text-white"})}),e.jsx("span",{className:"text-sm font-medium text-emerald-900",children:"FAQ"})]}),e.jsxs("button",{onClick:()=>n("XP"),className:"flex flex-col items-center gap-2 p-4 bg-violet-50 hover:bg-violet-100 rounded-xl transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-violet-500 rounded-xl flex items-center justify-center",children:e.jsx(wt,{size:20,className:"text-white"})}),e.jsx("span",{className:"text-sm font-medium text-violet-900",children:"XP & Miles"})]})]})]})]})]})}),!p&&e.jsxs("div",{className:"px-5 py-3 bg-slate-50 border-t border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-slate-200 rounded text-[10px] font-mono shadow-sm",children:"â"}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-slate-200 rounded text-[10px] font-mono shadow-sm",children:"â"}),e.jsx("span",{className:"text-slate-400",children:"navigate"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-slate-200 rounded text-[10px] font-mono shadow-sm",children:"âµ"}),e.jsx("span",{className:"text-slate-400",children:"open"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-slate-200 rounded text-[10px] font-mono shadow-sm",children:"esc"}),e.jsx("span",{className:"text-slate-400",children:"close"})]})]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[c?.items.length||0," items indexed"]})]})]})})]}):null};function yr(t,s){d.useEffect(()=>{const a=n=>{(n.metaKey||n.ctrlKey)&&n.key==="k"&&(n.preventDefault(),s?.("keyboard"),t())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[t,s])}const Ul=({id:t,label:s,icon:a,isActive:n,onClick:l})=>e.jsxs("button",{onClick:l,className:`w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 group ${n?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx(a,{size:20,className:`transition-colors ${n?"text-white":"text-slate-500 group-hover:text-white"}`}),e.jsx("span",{className:"font-medium text-sm tracking-wide",children:s})]}),Lo=({currentView:t,onNavigate:s,children:a,onOpenSettings:n,isDemoMode:l,isLocalMode:r=!1})=>{const[i,x]=Ue.useState(!1),[c,o]=Ue.useState(!1),[u,m]=Ue.useState(!1),{user:p,signOut:h}=Us(),{viewMode:b,isSimpleMode:g,setViewMode:S}=it(),{trackViewMode:P,trackNav:C,trackUserSignOut:w,trackSearch:f}=rt();Ue.useEffect(()=>{new URLSearchParams(window.location.search).get("search")==="1"&&(m(!0),f("button"),window.history.replaceState({},"",window.location.pathname))},[f]),yr(()=>m(!0),f);const D=()=>{f("button"),m(!0)},_=j=>{C(j),s(j)},N=()=>{w(),h()},F=g?[{id:"dashboard",label:"Dashboard",icon:ul},{id:"profile",label:"Profile",icon:Jt},{id:"addFlight",label:"Add Flight",icon:le},{id:"addMiles",label:"Add Miles",icon:Ge},{id:"xp",label:"Status Progress",icon:De},{id:"miles",label:"Miles Balance",icon:Oe},{id:"mileageRun",label:"XP Planner",icon:Ns}]:[{id:"dashboard",label:"Dashboard",icon:ul},{id:"profile",label:"Profile",icon:Jt},{id:"addFlight",label:"Add Flight",icon:le},{id:"addMiles",label:"Add Miles",icon:Ge},{id:"miles",label:"Miles Engine",icon:Oe},{id:"xp",label:"XP Qualification",icon:De},{id:"redemption",label:"Redemptions",icon:da},{id:"analytics",label:"Analytics",icon:Ht},{id:"mileageRun",label:"XP Run Simulator",icon:Ns}];return e.jsxs("div",{className:"min-h-screen bg-[#F8FAFC] font-sans flex",children:[e.jsxs("aside",{className:`fixed lg:static inset-y-0 left-0 z-[80] w-72 bg-slate-900 text-white p-6 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${i?"translate-x-0":"-translate-x-full"} flex flex-col`,children:[e.jsxs("div",{className:"flex items-center gap-3 px-2 mb-10 mt-2 flex-shrink-0",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl shadow-lg shadow-white/10",children:e.jsx(le,{className:"text-slate-900 transform -rotate-45",size:24,fill:"currentColor"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold tracking-tight text-white leading-none",children:"SkyStatus"}),e.jsx("p",{className:"text-[10px] font-bold text-blue-400 uppercase tracking-widest mt-1",children:"Pro Analytics"})]})]}),e.jsxs("nav",{className:"space-y-2 flex-1 overflow-y-auto",children:[F.map(j=>e.jsx(Ul,{id:j.id,label:j.label,icon:j.icon,isActive:t===j.id,onClick:()=>{_(j.id),x(!1)}},j.id)),e.jsx("div",{className:"my-4 border-t border-slate-800 mx-4"}),e.jsx(Ul,{label:"Data Settings",icon:ca,isActive:!1,onClick:()=>{n(),x(!1)}}),e.jsxs("button",{onClick:D,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-800 hover:text-white transition-all duration-200 group",children:[e.jsx(ds,{size:20,className:"text-slate-500 group-hover:text-white transition-colors"}),e.jsx("span",{className:"font-medium text-sm tracking-wide",children:"Search"}),e.jsx("kbd",{className:"ml-auto px-1.5 py-0.5 bg-slate-800 group-hover:bg-slate-700 rounded text-[10px] font-mono text-slate-500",children:"âK"})]})]}),e.jsxs("div",{className:"mt-auto pt-6 flex-shrink-0 space-y-3",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-slate-800/50 border border-slate-700/50",children:[e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider mb-2",children:"View Mode"}),e.jsxs("div",{className:"flex bg-slate-800 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>{b!=="simple"&&(P("simple"),S("simple"))},className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2 rounded-md text-xs font-semibold transition-all ${b==="simple"?"bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(Be,{size:14}),"Simple"]}),e.jsxs("button",{onClick:()=>{b!=="full"&&(P("full"),S("full"))},className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2 rounded-md text-xs font-semibold transition-all ${b==="full"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(Ds,{size:14}),"Full"]})]})]}),p&&!l&&e.jsx("div",{className:"p-3 rounded-xl bg-slate-800/50 border border-slate-700/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-700 rounded-lg",children:e.jsx(Jt,{size:16,className:"text-slate-300"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider",children:"Signed in as"}),e.jsx("p",{className:"text-xs text-slate-300 font-medium truncate",children:p.email})]}),e.jsx("button",{onClick:N,className:"p-2 text-slate-500 hover:text-slate-300 hover:bg-slate-700 rounded-lg transition-all",title:"Sign out",children:e.jsx(cn,{size:16})})]})}),e.jsxs("div",{className:"p-4 rounded-2xl bg-slate-800/50 border border-slate-700/50 backdrop-blur-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider mb-1",children:"Current Model"}),e.jsxs("p",{className:"text-xs text-slate-300 font-medium flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),"Flying Blue v",Ka," ",e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-[8px] bg-amber-500/20 text-amber-400 rounded font-bold",children:"BETA"})]})]}),l&&e.jsxs("div",{className:`mt-2 rounded-xl px-3 py-2 ${r?"bg-amber-500/10 border border-amber-500/20":"bg-indigo-500/10 border border-indigo-500/20"}`,children:[e.jsx("p",{className:`text-[10px] font-bold uppercase tracking-wider mb-1 ${r?"text-amber-400":"text-indigo-400"}`,children:"Workspace"}),e.jsx("p",{className:`text-[11px] font-medium ${r?"text-amber-200":"text-indigo-200"}`,children:r?"Local Mode Active":"Demo Mode Active"})]})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-[79] lg:hidden backdrop-blur-sm",onClick:()=>x(!1)}),e.jsxs("main",{className:"flex-1 flex flex-col min-w-0 h-screen overflow-hidden",children:[e.jsxs("header",{className:"lg:hidden bg-white border-b border-slate-200 px-4 py-4 flex items-center justify-between sticky top-0 z-30 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-slate-900 p-1.5 rounded-lg",children:e.jsx(le,{className:"text-white transform -rotate-45",size:18,fill:"currentColor"})}),e.jsx("span",{className:"font-bold text-slate-900",children:"SkyStatus"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:D,className:"p-2 text-slate-500 hover:bg-slate-100 rounded-lg transition-colors","aria-label":"Search",children:e.jsx(ds,{size:20})}),e.jsx("button",{onClick:()=>x(!i),className:"p-2 text-slate-500 hover:bg-slate-100 rounded-lg transition-colors",children:i?e.jsx(Ce,{size:24}):e.jsx(ai,{size:24})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 sm:p-6 lg:p-10 scroll-smooth",children:[e.jsxs("div",{className:"max-w-7xl mx-auto pb-12",children:[l&&e.jsxs("div",{className:`mb-6 rounded-2xl border px-4 py-3 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 shadow-sm animate-in fade-in slide-in-from-top-2 ${r?"border-amber-200 bg-amber-50":"border-indigo-100 bg-indigo-50"}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full text-white text-[10px] font-bold shadow-sm ring-2 ${r?"bg-amber-500 ring-amber-200":"bg-indigo-600 ring-indigo-200"}`,children:r?"L":"D"}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-bold ${r?"text-amber-900":"text-indigo-900"}`,children:r?"Local Mode Active":"Demo Workspace Active"}),e.jsx("p",{className:`text-[11px] leading-relaxed max-w-lg ${r?"text-amber-700/80":"text-indigo-700/80"}`,children:r?e.jsxs(e.Fragment,{children:["Your data is ",e.jsx("span",{className:"font-bold",children:"not saved automatically"}),". Use ",e.jsx("span",{className:"font-bold",children:"Data Settings â Export JSON"})," to save your work, or sign in for cloud sync."]}):e.jsxs(e.Fragment,{children:["You are exploring SkyStatus with sample data. Your changes here are temporary. Use ",e.jsx("span",{className:"font-bold",children:"Data Settings"})," to clear this and start your own portfolio."]})})]})]}),e.jsx("button",{type:"button",onClick:n,className:`whitespace-nowrap inline-flex items-center justify-center rounded-xl border bg-white px-4 py-2 text-[11px] font-bold transition-all shadow-sm ${r?"border-amber-200 text-amber-700 hover:bg-amber-50 hover:border-amber-300":"border-indigo-200 text-indigo-700 hover:bg-indigo-50 hover:border-indigo-300"}`,children:r?"Export Data":"Open Settings"})]}),a]}),e.jsx("footer",{className:"mt-auto border-t border-slate-200 py-4 px-4 sm:px-6 lg:px-10 bg-white/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-3 text-xs text-slate-400",children:[e.jsxs("p",{children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("a",{href:"/guide",className:"hover:text-slate-600 transition-colors",children:"Guides"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("a",{href:"/faq",className:"hover:text-slate-600 transition-colors",children:"Help & FAQ"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("a",{href:"/about",className:"hover:text-slate-600 transition-colors",children:"About"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("a",{href:"/contact",className:"hover:text-slate-600 transition-colors",children:"Contact"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("a",{href:"/privacy",className:"hover:text-slate-600 transition-colors",children:"Privacy"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("a",{href:"/cookies",className:"hover:text-slate-600 transition-colors",children:"Cookies"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("a",{href:"/terms",className:"hover:text-slate-600 transition-colors",children:"Terms"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx(Fo,{})]})]})})]}),e.jsx("div",{className:"hidden lg:block fixed bottom-6 left-1/2 -translate-x-1/2 z-50",children:e.jsxs("div",{className:"bg-slate-900 text-white rounded-2xl shadow-2xl shadow-slate-900/30 px-6 py-3 flex items-center gap-6 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 shadow-lg shadow-amber-500/30",children:e.jsx(_e,{size:16,className:"text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-white",children:["Beta v",Ka]}),e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Export your data regularly"})]})]}),e.jsx("div",{className:"w-px h-8 bg-slate-700"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:n,className:"inline-flex items-center gap-1.5 px-4 py-2 text-xs font-semibold text-slate-300 bg-slate-800 rounded-xl hover:bg-slate-700 hover:text-white transition-all",children:[e.jsx(vs,{size:14}),"Export"]}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center gap-1.5 px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-amber-500 to-orange-500 rounded-xl hover:from-amber-400 hover:to-orange-400 transition-all shadow-lg shadow-amber-500/25",children:[e.jsx(on,{size:14}),"Report Bug"]})]})]})}),e.jsx(zo,{isOpen:c,onClose:()=>o(!1)}),e.jsx(jr,{isOpen:u,onClose:()=>m(!1)})]})]})},Ya=t=>{switch(t){case"Platinum":return 8;case"Gold":return 7;case"Silver":return 6;default:return 4}},$o=t=>{const s=t.toUpperCase();return["KLM","KL","AIR FRANCE","AF","AIRFRANCE","TRANSAVIA","HV","DELTA","DL","VIRGIN","VS"].some(a=>s.includes(a))},ga=(t,s,a=[],n=.01)=>{let l=0,r=0,i=0,x=0,c=0,o=0;t.forEach(N=>{const F=N.miles_subscription+N.miles_amex+N.miles_flight+N.miles_other,j=N.miles_debit,v=N.cost_subscription+N.cost_amex+N.cost_flight+N.cost_other;i+=F,x+=j,o+=v,N.month<=s&&(l+=F,r+=j,c+=v)});const u=l-r,m=i-x,p=o,h=i>0?o/i*100:0,b=l>0?c/l:0,g=i>0?o/i:0,S=(n-b)*l,P=(n-g)*i,C=Nr(a,n,b),w=C.lifetime.totalMilesRedeemed||0,f=C.lifetime.avgBurnCpm/100,D=w*(f-b),_=b>0?f/b:0;return{earnedPast:l,burnPast:r,netCurrent:u,earnedAll:i,burnAll:x,netProjected:m,totalCost:p,globalCPM:h,cpmCurrent:b,cpmProjected:g,costPast:c,costAll:o,savingsCurrent:S,savingsProjected:P,targetCPM:n,avgBurnCpm:C.lifetime.avgBurnCpm,roiMultiplier:_,totalBurnValue:D,redeemedMiles:w}},Nr=(t=[],s,a,n)=>{let l=0,r=0,i=0,x=0,c=0,o=0,u=0,m=0,p=1/0;const h=new Date,b=new Date;b.setFullYear(h.getFullYear()-1);const S=(t||[]).filter(P=>!!P&&typeof P=="object").map(P=>{let C=0,w=0;P.override_cpm&&P.override_cpm>0?(C=P.override_cpm,w=C/100*P.award_miles):P.cash_price_estimate>0&&P.award_miles>0&&(w=P.cash_price_estimate-P.surcharges,C=w/P.award_miles*100);const f=s*100;let D="Unknown";C>0&&(C>=f*1.5?D="Excellent":C>=f*1.1?D="Good":C>=f*.9?D="Average":D="Poor");const _=(C/100-s)*P.award_miles,N=(C/100-a)*P.award_miles;if(C>0){l+=P.award_miles,r+=C*P.award_miles,i++;const F=new Date(P.date);!Number.isNaN(F.getTime())&&F>=b&&(x+=P.award_miles,c+=C*P.award_miles,o++,u+=_,m=Math.max(m,C),p=Math.min(p,C))}return{...P,cpm:parseFloat(C.toFixed(2)),value:w,vsTarget:_,vsAcquisition:N,classification:D}});return p===1/0&&(p=0),{processed:S,last12M:{avgBurnCpm:x>0?c/x:0,bestBurnCpm:m,worstBurnCpm:p,totalValueVsTarget:u,totalMilesRedeemed:x,count:o},lifetime:{avgBurnCpm:l>0?r/l:0,totalMilesRedeemed:l,count:i}}},qa=(t,s,a)=>{if(t<a-1e-4)return{label:"LOSS",color:"text-red-700 bg-red-50 border-red-200",icon:dn,hex:"#ef4444",description:"Value is lower than acquisition cost. You are losing money."};const n=s>0?s:a,l=n>0?t/n:0;return l<.8?{label:"POOR",color:"text-orange-700 bg-orange-50 border-orange-200",icon:_e,hex:"#f97316",description:"Significantly below your target CPM."}:l<1?{label:"ACCEPTABLE",color:"text-yellow-700 bg-yellow-50 border-yellow-200",icon:li,hex:"#eab308",description:"Close to target, but slightly under."}:l<1.5?{label:"GOOD",color:"text-blue-700 bg-blue-50 border-blue-200",icon:je,hex:"#3b82f6",description:"Solid redemption, meets or exceeds target."}:l<2.5?{label:"EXCELLENT",color:"text-emerald-700 bg-emerald-50 border-emerald-200",icon:Be,hex:"#10b981",description:"High value, well above target."}:{label:"LEGENDARY",color:"text-purple-700 bg-purple-50 border-purple-200",icon:ws,hex:"#a855f7",description:"Exceptional value. A unicorn redemption!"}},Tl=300;function Yt(t){return t?t.startingStatus==="Ultimate"?{...t,startingStatus:"Platinum",startingUXP:Math.max(t.startingUXP??0,900)}:t:null}function ms(t,s){return s&&t==="Platinum"?"Ultimate":t}function vr(t,s,a=!1,n=0){return s&&t==="Platinum"||a&&n>=Tl?"Ultimate":a&&n>=Tl&&(t==="Explorer"||t==="Silver"||t==="Gold")?"Platinum":t}const me=({text:t})=>{const[s,a]=d.useState(!1),n=()=>a(r=>!r),l=()=>a(!1);return e.jsxs("div",{className:"relative inline-flex items-center ml-1.5",onMouseEnter:()=>a(!0),onMouseLeave:l,onClick:n,role:"button",tabIndex:0,"aria-label":"More information",onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),n()),r.key==="Escape"&&(r.preventDefault(),l())},children:[e.jsx(lt,{size:12,className:"text-slate-300 hover:text-blue-500 cursor-help transition-colors"}),s&&e.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-48 p-3 bg-slate-800 text-white text-[11px] font-medium leading-relaxed rounded-xl shadow-2xl z-[9999]",children:[t,e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-slate-800"})]})]})},Vt={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,mrt:3,mei:5,okt:10,fÃ©v:2,avr:4,mai:5,jui:6,aoÃ»:8,dÃ©c:12,mÃ¤r:3,mrz:3,dez:12,ene:1,abr:4,ago:8,set:9,dic:12,out:10,gen:1,mag:5,giu:6,lug:7,ott:10,january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12};for(const[t,s]of Object.entries(Vt))String(s).padStart(2,"0");function Oo(t){const s=t.toLowerCase().replace(/[^a-zÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼Ã]/g,"");if(Vt[s])return Vt[s];const a=s.substring(0,3);if(Vt[a])return Vt[a];for(const[n,l]of Object.entries(Vt))if(s.startsWith(n)||n.startsWith(s))return l;return null}function wr(t){const s=t.toLowerCase();if(!/\d/.test(s))return!1;const a=Object.keys(Vt).some(r=>s.includes(r)),n=/\d+[/.-]\d+[/.-]\d+/.test(s),l=/\d{1,2}\s+\w{3,}|\w{3,}\s+\d{1,2}/.test(s);return a||n||l}function Pa(t){if(!wr(t))return!1;const s=t.split(/\s+/);for(let a=2;a<=Math.min(5,s.length);a++){const n=s.slice(0,a).join(" ");if(Tt(n))return!0}return!1}const Go={KL:"KLM",AF:"AF",SK:"SAS",DL:"DL",KE:"KE",VS:"VS",MU:"MU",GA:"GA",SU:"SU",AR:"AR",AM:"AM",CI:"CI",CZ:"CZ",ME:"ME",RO:"RO",SV:"SV",UX:"UX",VN:"VN",XN:"XN"};function Tt(t){const s=t.trim().replace(/,/g," ").replace(/\s+/g," ");let a=null,n=null,l=null;const r=s.match(/^(\d{1,4})[-/.](\d{1,2})[-/.](\d{1,4})$/);if(r){const[,i,x,c]=r.map(Number);i>1e3?(l=i,n=x,a=c):c>1e3&&(l=c,i>12?(a=i,n=x):x>12?(n=i,a=x):(a=i,n=x))}if(!l){const i=s.split(/[\s/.-]+/),x=[];let c=null;for(const o of i){const u=parseInt(o,10);if(!isNaN(u))x.push(u);else{const m=Oo(o);m!==null&&(c=m)}}if(c!==null){n=c;const o=x.find(m=>m>1e3&&m<2100),u=x.filter(m=>m>=1&&m<=31&&m<1e3);o&&(l=o),u.length>0&&(a=u[0])}}return a&&n&&l&&a>=1&&a<=31&&n>=1&&n<=12&&l>=2e3&&l<=2100?`${l}-${String(n).padStart(2,"0")}-${String(a).padStart(2,"0")}`:null}function Ze(t){let s=0,a=0,n=0;const l=t.match(/(-?\d[\d\s.,]*)\s*Miles/i);l&&(s=parseInt(l[1].replace(/[\s.,]/g,""),10));const r=t.match(/(\d+)\s*UXP/i);r&&(n=parseInt(r[1],10));const i=t.match(/(\d+)\s*XP(?!\s*U)/i);if(i)a=parseInt(i[1],10);else{const x=t.match(/(\d+)\s*XP/i);x&&(a=parseInt(x[1],10))}return{miles:s,xp:a,uxp:n}}function Ko(t){const s=[],a=t.split(`
`).map(C=>C.trim()).filter(C=>C);let n=null,l=null,r=null,i=null,x=null,c=null;console.log("[Parser] Scanning header, first 15 lines:",a.slice(0,15));for(let C=0;C<Math.min(15,a.length);C++){const w=a[C].trim(),f=w.match(/Flying Blue[- ]?(?:nummer|number)[:\s]+(\d+)/i);if(f&&(l=f[1]),!r){const _=w.match(/^(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)$/i)||w.match(/\b(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)\b/i);_&&(r=_[1].toUpperCase(),console.log("[Parser] Detected status:",r,"from line:",w))}const D=w.match(/(\d[\d\s.,]*)\s*Miles\s+(\d+)\s*XP\s+(\d+)\s*UXP/i);D&&(i=parseInt(D[1].replace(/[\s.,]/g,""),10),x=parseInt(D[2],10),c=parseInt(D[3],10),console.log("[Parser] Detected totals:",{totalMiles:i,totalXP:x,totalUXP:c})),C===0&&/^[A-Z\s]+$/.test(w)&&w.length>3&&(n=w)}console.log("[Parser] Header result:",{memberName:n,memberNumber:l,status:r,totalMiles:i,totalXP:x,totalUXP:c});const o=[],u=new Map,m=[],p=C=>(u.has(C)||u.set(C,{month:C,subscription:0,amex:0,hotel:0,shopping:0,partner:0,other:0,debit:0,bonusXp:0}),u.get(C));let h=0;for(;h<a.length;){const C=a[h];let w=null,f="";const D=C.match(/^(\d{1,2})\s+(jan|feb|mrt|mar|apr|mei|may|jun|jul|aug|sep|okt|oct|nov|dec)\s+(\d{4})(.*)$/i);if(D){const[,_,N,F,j]=D,v=Tt(`${_} ${N} ${F}`);v&&(w=v,f=j.trim())}if(!w&&wr(C)){const _=C.split(/\s+/);for(let N=2;N<=Math.min(5,_.length-1);N++){const F=_.slice(0,N).join(" "),j=Tt(F);if(j){w=j,f=_.slice(N).join(" ");break}}}if(w&&f){const _=w.substring(0,7);if(!_){h++;continue}if(/Mijn\s+reis\s+naar|My\s+trip\s+to|Mon\s+voyage/i.test(f)){const F=[];let j=0,v=0,A=h+1;for(;A<a.length;){const R=a[A];if(/Sustainable\s+Aviation\s+Fuel/i.test(R)){const{miles:G,xp:k}=Ze(R);j+=k,v+=G,A++;continue}if(Pa(R)&&!/Sustainable|gespaarde|reisafstand|^op\s|^on\s|^le\s/i.test(R)&&/Mijn\s+reis|My\s+trip|Mon\s+voyage|Hotel|Subscribe|Winkelen|Shopping|Miles\s+(earn|overdragen)/i.test(R))break;const X=R.match(/^([A-Z]{3})\s*[-â]\s*([A-Z]{3})\s+([A-Z]{2}\d{2,5})\s+(.+)$/);if(X){const[,G,k,I,y]=X;let{miles:U,xp:M,uxp:z}=Ze(y);if(U===0)for(let J=A+1;J<Math.min(A+5,a.length);J++){const q=a[J];if(/^[A-Z]{3}\s*[-â]\s*[A-Z]{3}/.test(q)||Pa(q)&&!/^op\s|^on\s|Sustainable/i.test(q))break;const B=Ze(q);if(B.miles>0||B.xp>0){U=B.miles,M=B.xp,z=B.uxp;break}}const K=I.substring(0,2),Y=Go[K]||K,O=/bestede|spent|dÃ©pensÃ©s|ausgegeben/i.test(y);let V=w;for(let J=A+1;J<Math.min(A+8,a.length);J++){const q=a[J].trim();if(/^(?:op|on|le|am)$/i.test(q)&&J+1<a.length){const oe=a[J+1].match(/^\s*(\d{1,2})\s+([a-zA-ZÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼Ã]+)\s+(\d{4})/i);if(oe){const[,se,Z,ee]=oe,T=Tt(`${se} ${Z} ${ee}`);if(T){V=T;break}}}const B=q.match(/^(?:op|on|le|am)\s+(.+)/i);if(B){const Q=Tt(B[1]);if(Q){V=Q;break}}const $=q.match(/(?:op|on|le|am)\s+(\d{1,2})\s+([a-zA-ZÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼Ã]+)\s+(\d{4})/i);if($){const[,Q,oe,se]=$,Z=Tt(`${Q} ${oe} ${se}`);if(Z){V=Z;break}}}F.push({date:V,route:`${G}-${k}`,flightNumber:I,airline:Y,earnedMiles:U,earnedXP:M,uxp:z>0?z:null,safXp:0,safMiles:0,isRevenue:O}),A++;continue}const L=R.match(/^([A-Z]{3})\s*[-â]\s*([A-Z]{3})\s+([A-Z][A-Za-z\s]+?)(?:\s*[-â])?\s*(?:gespaarde|earned|Miles|acquis|gesammelt)/i);if(L){const[,G,k,I]=L,y=I.trim().toUpperCase();let U=y.includes("TRANSAVIA")?"HV":y.includes("DELTA")?"DL":y.includes("SAS")?"SK":y.substring(0,2);const M=`${U}0000`;let{miles:z,xp:K,uxp:Y}=Ze(R);if(z===0)for(let V=A+1;V<Math.min(A+5,a.length);V++){const J=a[V];if(/^[A-Z]{3}\s*[-â]\s*[A-Z]{3}/.test(J))break;const q=Ze(J);if(q.miles>0||q.xp>0){z=q.miles,K=q.xp,Y=q.uxp;break}}let O=w;for(let V=A+1;V<Math.min(A+8,a.length);V++){const J=a[V].trim();if(/^(?:op|on|le|am)$/i.test(J)&&V+1<a.length){const Q=a[V+1].match(/^\s*(\d{1,2})\s+([a-zA-ZÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼Ã]+)\s+(\d{4})/i);if(Q){const[,oe,se,Z]=Q,ee=Tt(`${oe} ${se} ${Z}`);if(ee){O=ee;break}}}const q=J.match(/^(?:op|on|le|am)\s+(.+)/i);if(q){const $=Tt(q[1]);if($){O=$;break}}const B=J.match(/(?:op|on|le|am)\s+(\d{1,2})\s+([a-zA-ZÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼Ã]+)\s+(\d{4})/i);if(B){const[,$,Q,oe]=B,se=Tt(`${$} ${Q} ${oe}`);if(se){O=se;break}}}F.push({date:O,route:`${G}-${k}`,flightNumber:M,airline:U,earnedMiles:z,earnedXP:K,uxp:Y>0?Y:null,safXp:0,safMiles:0,isRevenue:!1}),A++;continue}A++}F.length>0&&(j>0||v>0)&&(F[0].safXp=j,F[0].safMiles=v),o.push(...F),h=A-1}else if(/Subscribe to Miles|Miles\s*Complete/i.test(f)){const{miles:F}=Ze(f);F>0&&(p(_).subscription+=F)}else if(/first flight bonus|MILES\+POINTS|bonus.*XP|XP.*bonus/i.test(f)){const{miles:F,xp:j}=Ze(f);j>0&&(p(_).bonusXp+=j),F>0&&(p(_).other+=F)}else if(/Hotel|BOOKING\.COM|Accor|ALL-|Marriott|Hilton|IHG|Hyatt|Radisson/i.test(f)){const{miles:F,xp:j}=Ze(f);F>0&&(p(_).hotel+=F),j>0&&(p(_).bonusXp+=j)}else if(/Winkelen|Shopping|SHOP|AMAZON|retail|store/i.test(f)){const{miles:F}=Ze(f);F>0&&(p(_).shopping+=F)}else if(/RevPoints|REVOLUT|Batavia/i.test(f)){const{miles:F}=Ze(f);F>0&&(p(_).partner+=F)}else if(/upgrade|award|overdragen|transfer|Lastminute/i.test(f.toLowerCase())){const{miles:F}=Ze(f);F<0&&(p(_).debit+=Math.abs(F))}else if(!/Sustainable Aviation Fuel|gespaarde Miles|reisafstand|boekingsklasse/i.test(f)){if(!/^[A-Z]{3}\s*-\s*[A-Z]{3}/.test(f))if(/Mastercard|Visa|Express|Amex|Diners|Discover|Debit|Credit|Betaal/i.test(f)||/Miles\s+(earn|on|from|voor)/i.test(f)||/earn.*Miles/i.test(f)||/(expenses|uitgaven|purchases|aankopen|spending|spend|transactions?)/i.test(f)||/kaart|carte|tarjeta|card|co-?brand/i.test(f)){const{miles:F,xp:j}=Ze(f);F>0?p(_).amex+=F:F<0&&(p(_).debit+=Math.abs(F)),j>0&&(p(_).bonusXp+=j)}else if(/Air\s*adjustment/i.test(f)||/Luchtvaart\s*correctie/i.test(f)||/Ajustement\s*aÃ©rien/i.test(f)||/Flugkorrektur/i.test(f)||/Correzione\s*aerea/i.test(f)||/Ajuste\s*aÃ©reo/i.test(f)){const{xp:F}=Ze(f);F>0&&(p(_).bonusXp+=F)}else if(/Aftrek\s*XP[- ]?teller/i.test(f)||/XP[- ]?(?:Counter|teller|compteur|ZÃ¤hler|contatore|contador)\s*(?:deduct|offset|aftrek|dÃ©duction|abzug|deduzione|deducciÃ³n)/i.test(f)||/(?:deduct|offset|aftrek|dÃ©duction|abzug|deduzione|deducciÃ³n).*XP[- ]?(?:Counter|teller|compteur|ZÃ¤hler|contatore|contador)/i.test(f)){const F=f.match(/(-\d+)\s*XP/i),j=F?Math.abs(parseInt(F[1],10)):null;console.log("[Parser] XP Deduction detected:",{date:w,xpDeducted:j,content:f.substring(0,60)});let v=f.match(/(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)\s*(?:reached|bereikt|atteint|erreicht|raggiunto|alcanzado|atingido)/i);if(!v)for(let X=h+1;X<Math.min(h+4,a.length);X++){const L=a[X];if(Pa(L))break;if(v=L.match(/(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)\s*(?:reached|bereikt|atteint|erreicht|raggiunto|alcanzado|atingido)/i),v){console.log("[Parser] Status found in look-ahead:",v[1]);break}}const A=v?v[1].toUpperCase():null;console.log("[Parser] Final detected status:",A);const R=m.find(X=>X.date===w);if(R)R.xpDeducted=j,v&&!R.toStatus&&(R.toStatus=A),console.log("[Parser] Updated existing requalification:",R);else{const X={date:w,fromStatus:null,toStatus:A,xpDeducted:j,rolloverXP:null};m.push(X),console.log("[Parser] Created new requalification:",X)}}else if(/(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)\s*(?:reached|bereikt|atteint|erreicht|raggiunto|alcanzado|atingido)/i.test(f)||/(?:Qualification|Kwalificatie).*(?:period|periode).*(?:ended|beÃ«indigd|terminÃ©e|beendet|terminato|terminado)/i.test(f)){const F=f.match(/(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)/i),j=F?F[1].toUpperCase():null,v=m.find(A=>A.date===w);v?j&&!v.toStatus&&(v.toStatus=j):m.push({date:w,fromStatus:null,toStatus:j,xpDeducted:null,rolloverXP:null})}else if(/Surplus\s*XP\s*(?:beschikbaar|available|disponibles?|verfÃ¼gbar|disponibili)/i.test(f)||/XP\s*(?:excÃ©dentaires?|Ã¼berschÃ¼ssige?|eccesso|excedentes?)\s*(?:disponibles?|verfÃ¼gbar|disponibili)/i.test(f)||/(?:Excess|Ãberschuss|Eccesso|Exceso)\s*XP/i.test(f)){const{xp:F}=Ze(f);console.log("[Parser] Surplus XP detected:",{date:w,xp:F,content:f.substring(0,60)});const j=m.find(v=>v.date===w);j?(j.rolloverXP=F,console.log("[Parser] Added rollover to existing requalification")):(m.push({date:w,fromStatus:null,toStatus:null,xpDeducted:null,rolloverXP:F}),console.log("[Parser] Created new requalification entry with rollover"))}else if(/[Rr]e?qualifi(?:cation|catie|cazione|caciÃ³n|caÃ§Ã£o|ed|Ã©|ziert|cato|cado)/i.test(f)||/[Hh]erkwalifi/i.test(f)||/[Gg]ekwalificeerd/i.test(f)||/[Ss]tatus.*(?:renewed|verlengd|renouvelÃ©|erneuert|rinnovato|renovado)/i.test(f)){const F=f.match(/(EXPLORER|SILVER|GOLD|PLATINUM|ULTIMATE)/i);m.find(v=>v.date===w)||m.push({date:w,fromStatus:null,toStatus:F?F[1].toUpperCase():null,xpDeducted:null,rolloverXP:null})}else{const{miles:F}=Ze(f);F<0?p(_).debit+=Math.abs(F):F>0&&(p(_).other+=F)}}}h++}o.sort((C,w)=>w.date.localeCompare(C.date));const b=Array.from(u.values()).sort((C,w)=>C.month.localeCompare(w.month)),g=o.map(C=>C.date).filter(C=>C),S=g.length>0?g.reduce((C,w)=>C<w?C:w):null,P=g.length>0?g.reduce((C,w)=>C>w?C:w):null;return console.log("[Parser] All requalifications detected:",m.length),m.forEach((C,w)=>{console.log(`[Parser] Requalification ${w+1}:`,{date:C.date,toStatus:C.toStatus,xpDeducted:C.xpDeducted,rolloverXP:C.rolloverXP})}),{flights:o,miles:b,memberName:n,memberNumber:l,status:r,totalMiles:i,totalXP:x,totalUXP:c,errors:s,oldestDate:S,newestDate:P,requalifications:m}}function Yo(t){return t.map(s=>({id:`fb-${s.date}-${s.flightNumber}`,date:s.date,route:s.route,airline:s.airline,cabin:"Economy",ticketPrice:0,earnedMiles:s.earnedMiles+s.safMiles,earnedXP:s.earnedXP,safXp:s.safXp,flightNumber:s.flightNumber,uxp:s.uxp??void 0}))}function qo(t){return t.filter(s=>s.subscription>0||s.amex>0||s.hotel+s.shopping+s.partner+s.other>0||s.debit>0).map(s=>({id:`fb-miles-${s.month}`,month:s.month,miles_subscription:s.subscription,miles_amex:s.amex,miles_flight:0,miles_other:s.hotel+s.shopping+s.partner+s.other,miles_debit:s.debit,cost_subscription:s.subscription>0?186:0,cost_amex:s.amex>0?55:0,cost_flight:0,cost_other:0}))}typeof window<"u"&&(rn.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${nn}/pdf.worker.min.js`);const Vo=({currentStep:t,totalSteps:s})=>e.jsx("div",{className:"flex items-center justify-center gap-2",children:Array.from({length:s}).map((a,n)=>e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${n===t?"w-6 bg-blue-600":n<t?"w-2 bg-blue-600":"w-2 bg-slate-200"}`},n))}),Ho=({currentStep:t,totalSteps:s,canContinue:a,onBack:n,onContinue:l,onComplete:r,continueLabel:i="Continue",completeLabel:x="Import",showSkip:c=!1,onSkip:o})=>{const u=t===s-1,m=t===0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:n,disabled:m,className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all ${m?"text-slate-300 cursor-not-allowed":"text-slate-600 hover:bg-slate-200"}`,children:[e.jsx(ts,{size:18}),"Back"]}),c&&o&&e.jsx("button",{onClick:o,className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Skip"}),u?e.jsxs("button",{onClick:r,disabled:!a,className:`flex items-center gap-2 px-6 py-2.5 rounded-xl font-bold transition-all ${a?"bg-gradient-to-r from-emerald-500 to-teal-600 text-white shadow-lg hover:shadow-xl":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[e.jsx(ct,{size:18}),x]}):e.jsxs("button",{onClick:l,disabled:!a,className:`flex items-center gap-2 px-6 py-2.5 rounded-xl font-bold transition-all ${a?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[i,e.jsx(we,{size:18})]})]})},Va=[{value:"Explorer",label:"Explorer",color:"bg-slate-500"},{value:"Silver",label:"Silver",color:"bg-slate-400"},{value:"Gold",label:"Gold",color:"bg-amber-500"},{value:"Platinum",label:"Platinum",color:"bg-slate-600"},{value:"Ultimate",label:"Ultimate",color:"bg-slate-900"}],Wo=({status:t,large:s})=>{const a=Va.find(n=>n.value===t);return e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-white font-bold ${a?.color||"bg-slate-500"} ${s?"text-lg px-5 py-2":"text-sm"}`,children:[e.jsx(De,{size:s?20:14}),t]})},Jo=({wizardState:t,updateState:s,detectedStatus:a})=>{const n=!a,l=i=>{s({statusConfirmed:i,status:i&&a?a:t.status})},r=i=>{s({status:i,statusConfirmed:!1})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(De,{className:"text-blue-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:n?"Select Your Status":"Confirm Your Status"}),e.jsx("p",{className:"text-slate-500 text-sm",children:n?"We couldn't detect your status from the PDF. Please select it manually.":"We detected the following Flying Blue status from your PDF."})]}),a&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Wo,{status:a,large:!0})}),n&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"font-medium text-slate-700 text-center",children:"What is your current Flying Blue status?"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Va.map(i=>e.jsx("button",{type:"button",onClick:()=>r(i.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${t.status===i.value?`${i.color} text-white`:"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:i.label},i.value))})]}),!n&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center gap-4 p-4 rounded-xl border-2 cursor-pointer transition-all ${t.statusConfirmed?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"radio",name:"statusConfirm",checked:t.statusConfirmed,onChange:()=>l(!0),className:"w-5 h-5 text-blue-600 border-slate-300 focus:ring-blue-500"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium text-slate-800",children:"Yes, this is correct"})}),t.statusConfirmed&&e.jsx(ct,{size:20,className:"text-blue-600"})]}),e.jsxs("label",{className:`flex items-start gap-4 p-4 rounded-xl border-2 cursor-pointer transition-all ${t.statusConfirmed?"border-slate-200 hover:border-slate-300":"border-blue-500 bg-blue-50"}`,children:[e.jsx("input",{type:"radio",name:"statusConfirm",checked:!t.statusConfirmed,onChange:()=>l(!1),className:"w-5 h-5 mt-0.5 text-blue-600 border-slate-300 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("p",{className:"font-medium text-slate-800",children:"No, my status is:"}),!t.statusConfirmed&&e.jsx("div",{className:"flex flex-wrap gap-2",children:Va.map(i=>e.jsx("button",{type:"button",onClick:()=>r(i.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${t.status===i.value?`${i.color} text-white`:"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:i.label},i.value))})]})]})]}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4",children:e.jsx("p",{className:"text-xs text-slate-500",children:"Your status determines your qualification targets and benefits. This comes from the header of your Flying Blue PDF statement."})})]})};function Zo(t){return{isValid:!0,errors:[]}}function Sr(t){const s=[];return isNaN(t.xpBalance)||t.xpBalance<0?s.push({field:"xpBalance",message:"XP must be 0 or higher"}):t.xpBalance>1e3&&s.push({field:"xpBalance",message:"XP seems unusually high (max ~400 for requalification)"}),isNaN(t.uxpBalance)||t.uxpBalance<0?s.push({field:"uxpBalance",message:"UXP must be 0 or higher"}):t.uxpBalance>1e3&&s.push({field:"uxpBalance",message:"UXP seems unusually high"}),isNaN(t.milesBalance)||t.milesBalance<0?s.push({field:"milesBalance",message:"Miles must be 0 or higher"}):t.milesBalance>1e7&&s.push({field:"milesBalance",message:"Miles balance seems unusually high"}),{isValid:s.filter(a=>!a.message.includes("unusually")).length===0,errors:s}}function Pr(t){const s=[];return!t.cycleStartMonth||t.cycleStartMonth.trim()===""?s.push({field:"cycleStartMonth",message:"Qualification cycle start month is required"}):/^\d{4}-(0[1-9]|1[0-2])$/.test(t.cycleStartMonth)||s.push({field:"cycleStartMonth",message:"Invalid month format"}),isNaN(t.surplusXP)||t.surplusXP<0?s.push({field:"surplusXP",message:"Surplus XP must be 0 or higher"}):t.surplusXP>300&&s.push({field:"surplusXP",message:"Maximum surplus XP is 300"}),{isValid:s.length===0,errors:s}}function Qo(){return{isValid:!0,errors:[]}}function ec(){return{isValid:!0,errors:[]}}function ka(t,s,a=!1){switch(t){case 0:return Zo().isValid;case 1:return Sr(s).isValid;case 2:return a&&s.cycleStartMonth?!0:Pr(s).isValid;case 3:return Qo().isValid;case 4:return ec().isValid;default:return!1}}const tc=({wizardState:t,updateState:s,detectedXP:a,detectedUXP:n,detectedMiles:l})=>{const r=Sr(t),i=o=>r.errors.find(u=>u.field===o)?.message,x=(o,u)=>{const m=u===""?0:parseInt(u.replace(/[^0-9]/g,""),10);isNaN(m)||s({[o]:m})},c=o=>{switch(o){case"xp":return t.xpBalance!==a;case"uxp":return t.uxpBalance!==n;case"miles":return t.milesBalance!==l}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Ge,{className:"text-emerald-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Verify Your Balances"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"These values come from your PDF header. Edit only if incorrect."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(Ie,{size:16,className:"text-blue-500"}),"XP Balance",c("xp")&&e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:"Modified"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",inputMode:"numeric",value:t.xpBalance===0?"":t.xpBalance.toString(),onChange:o=>x("xpBalance",o.target.value),placeholder:a.toString(),className:`w-full px-4 py-3 bg-white border rounded-xl text-slate-800 font-medium focus:outline-none focus:ring-2 transition-all ${i("xpBalance")?"border-red-300 focus:ring-red-200":"border-slate-200 focus:ring-blue-200 focus:border-blue-400"}`}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"XP"})]}),i("xpBalance")&&e.jsx("p",{className:"text-xs text-red-500",children:i("xpBalance")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(Ie,{size:16,className:"text-purple-500"}),"UXP Balance",c("uxp")&&e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:"Modified"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",inputMode:"numeric",value:t.uxpBalance===0?"":t.uxpBalance.toString(),onChange:o=>x("uxpBalance",o.target.value),placeholder:n.toString(),className:`w-full px-4 py-3 bg-white border rounded-xl text-slate-800 font-medium focus:outline-none focus:ring-2 transition-all ${i("uxpBalance")?"border-red-300 focus:ring-red-200":"border-slate-200 focus:ring-blue-200 focus:border-blue-400"}`}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"UXP"})]}),i("uxpBalance")&&e.jsx("p",{className:"text-xs text-red-500",children:i("uxpBalance")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(le,{size:16,className:"text-emerald-500"}),"Miles Balance",c("miles")&&e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:"Modified"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",inputMode:"numeric",value:t.milesBalance===0?"":t.milesBalance.toLocaleString("nl-NL"),onChange:o=>x("milesBalance",o.target.value),placeholder:l.toLocaleString("nl-NL"),className:`w-full px-4 py-3 bg-white border rounded-xl text-slate-800 font-medium focus:outline-none focus:ring-2 transition-all ${i("milesBalance")?"border-red-300 focus:ring-red-200":"border-slate-200 focus:ring-blue-200 focus:border-blue-400"}`}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"Miles"})]}),i("milesBalance")&&e.jsx("p",{className:"text-xs text-red-500",children:i("milesBalance")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 bg-blue-50 rounded-xl",children:[e.jsx(lt,{size:18,className:"text-blue-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-blue-700",children:"These values are extracted from your PDF header and represent your official Flying Blue balances at the time of export. Only modify if the values don't match what you see on flyingblue.com."})]})]})},zl=["January","February","March","April","May","June","July","August","September","October","November","December"],Ha=new Date().getFullYear(),sc=Array.from({length:Ha-2020+2},(t,s)=>2020+s),ac=({wizardState:t,updateState:s,suggestedCycleStart:a,suggestedSurplusXP:n,hasExistingSettings:l})=>{const[r,i]=d.useState(!1),[x,c]=d.useState(!1),o=Pr(t),u=w=>o.errors.find(f=>f.field===w)?.message,m=w=>{if(!w)return{year:Ha,month:1};const[f,D]=w.split("-");return{year:parseInt(f,10)||Ha,month:parseInt(D,10)||1}},{year:p,month:h}=m(t.cycleStartMonth),b=t.cycleStartMonth&&t.cycleStartMonth.length>0,g=w=>{const f=`${p}-${w.toString().padStart(2,"0")}`;s({cycleStartMonth:f})},S=w=>{const f=`${w}-${h.toString().padStart(2,"0")}`;s({cycleStartMonth:f})},P=w=>{const f=w===""?0:parseInt(w.replace(/[^0-9]/g,""),10);isNaN(f)||s({surplusXP:Math.min(f,300)})},C=a&&a.length>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-14 h-14 ${l?"bg-green-100":"bg-amber-100"} rounded-xl flex items-center justify-center mx-auto mb-4`,children:e.jsx(et,{className:l?"text-green-600":"text-amber-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:l?"Confirm Your Qualification Cycle":"Set Your Qualification Cycle"}),e.jsx("p",{className:"text-slate-500 text-sm",children:l?"Your settings are pre-filled. Review and adjust if needed.":"This information is required for accurate calculations."})]}),l?e.jsxs("div",{className:"flex gap-3 p-4 bg-green-50 border border-green-200 rounded-xl",children:[e.jsx(et,{size:20,className:"text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Settings loaded from your account"}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"We've pre-filled your qualification cycle. You can skip this step or adjust if needed."})]})]}):e.jsxs("div",{className:"flex gap-3 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[e.jsx(_e,{size:20,className:"text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"This step is required"}),e.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"Without your qualification cycle start date, we cannot calculate your progress correctly."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"When did your current qualification year start?"}),e.jsx("button",{type:"button",onClick:()=>i(!r),className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(vt,{size:18})})]}),C&&!b&&e.jsxs("button",{type:"button",onClick:()=>s({cycleStartMonth:a}),className:"w-full p-3 bg-blue-50 border border-blue-200 rounded-xl text-left hover:bg-blue-100 transition-colors",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"We detected a requalification:"}),e.jsxs("p",{className:"text-sm text-blue-800 font-bold",children:["Click to use ",zl[parseInt(a.split("-")[1],10)-1]," ",a.split("-")[0]]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:b?h:"",onChange:w=>g(parseInt(w.target.value,10)),className:`w-full px-4 py-3 bg-white border rounded-xl text-slate-800 font-medium focus:outline-none focus:ring-2 appearance-none cursor-pointer ${u("cycleStartMonth")?"border-red-300 focus:ring-red-200":"border-slate-200 focus:ring-blue-200 focus:border-blue-400"}`,children:[e.jsx("option",{value:"",disabled:!0,children:"Month..."}),zl.map((w,f)=>e.jsx("option",{value:f+1,children:w},w))]})}),e.jsx("div",{className:"w-28",children:e.jsxs("select",{value:b?p:"",onChange:w=>S(parseInt(w.target.value,10)),className:`w-full px-4 py-3 bg-white border rounded-xl text-slate-800 font-medium focus:outline-none focus:ring-2 appearance-none cursor-pointer ${u("cycleStartMonth")?"border-red-300 focus:ring-red-200":"border-slate-200 focus:ring-blue-200 focus:border-blue-400"}`,children:[e.jsx("option",{value:"",disabled:!0,children:"Year..."}),sc.map(w=>e.jsx("option",{value:w,children:w},w))]})})]}),u("cycleStartMonth")&&e.jsx("p",{className:"text-xs text-red-500",children:u("cycleStartMonth")}),r&&e.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl text-sm text-slate-600 space-y-3",children:[e.jsx("p",{className:"font-medium text-slate-700",children:"Where to find this:"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"1."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Flying Blue Website:"})," Log in â My Account â Status",e.jsx("br",{}),e.jsx("span",{className:"text-xs text-slate-500",children:'Look for "Qualification period" or "Kwalificatieperiode"'})]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"2."}),e.jsxs("span",{children:[e.jsx("strong",{children:"Your PDF Statement:"}),' Search for "qualification period beginning" or "kwalificatieperiode beginnend op"']})]})]}),e.jsxs("a",{href:"https://www.flyingblue.com/en/account/membership",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 hover:underline text-xs",children:["Open Flying Blue Account ",e.jsx(Es,{size:12})]})]})]}),e.jsx("div",{className:"border-t border-slate-200"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Surplus XP from previous cycle"}),e.jsx("button",{type:"button",onClick:()=>c(!x),className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(vt,{size:18})})]}),n!==null&&n>0&&t.surplusXP===0&&e.jsxs("button",{type:"button",onClick:()=>s({surplusXP:n}),className:"w-full p-3 bg-blue-50 border border-blue-200 rounded-xl text-left hover:bg-blue-100 transition-colors",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"We detected surplus XP:"}),e.jsxs("p",{className:"text-sm text-blue-800 font-bold",children:["Click to use ",n," XP"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",inputMode:"numeric",value:t.surplusXP===0?"":t.surplusXP.toString(),onChange:w=>P(w.target.value),placeholder:"0",className:`w-full px-4 py-3 bg-white border rounded-xl text-slate-800 font-medium focus:outline-none focus:ring-2 transition-all ${u("surplusXP")?"border-red-300 focus:ring-red-200":"border-slate-200 focus:ring-blue-200 focus:border-blue-400"}`}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"XP (max 300)"})]}),u("surplusXP")&&e.jsx("p",{className:"text-xs text-red-500",children:u("surplusXP")}),x&&e.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl text-sm text-slate-600 space-y-2",children:[e.jsx("p",{className:"font-medium text-slate-700",children:"What is Surplus XP?"}),e.jsx("p",{children:'When you requalify, up to 300 XP above your qualification threshold carries over to your new cycle. Look for "Surplus XP" or "Surplus XP beschikbaar" in your PDF statement.'}),e.jsx("p",{className:"text-xs text-slate-500",children:"If you can't find it, enter 0. You can always adjust this later."})]})]})]})},lc=({flights:t,newFlights:s,duplicateFlights:a,milesData:n,summary:l})=>{const[r,i]=d.useState(!1),[x,c]=d.useState(!1),o=n.reduce((m,p)=>m+p.miles_subscription+p.miles_amex+p.miles_other+p.miles_flight,0),u=n.reduce((m,p)=>m+Math.abs(p.miles_debit),0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 bg-violet-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"text-violet-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Review Your Data"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Here's what we found in your PDF."})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>i(!r),className:"w-full p-4 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(le,{size:18,className:"text-blue-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-slate-800",children:"Flights"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.length," new â¢ ",a.length," duplicates â¢ ",l.totalFlightXP," XP"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[t.length," total"]}),r?e.jsx(cs,{size:18,className:"text-slate-400"}):e.jsx(nt,{size:18,className:"text-slate-400"})]})]}),r&&e.jsxs("div",{className:"border-t border-slate-100 max-h-48 overflow-y-auto",children:[s.length===0?e.jsx("p",{className:"p-4 text-sm text-slate-500 text-center",children:"No new flights to import"}):e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-slate-500 font-medium",children:"Date"}),e.jsx("th",{className:"px-3 py-2 text-left text-slate-500 font-medium",children:"Route"}),e.jsx("th",{className:"px-3 py-2 text-left text-slate-500 font-medium",children:"Cabin"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-500 font-medium",children:"XP"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:s.slice(0,20).map((m,p)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-3 py-2 text-slate-700",children:m.date}),e.jsx("td",{className:"px-3 py-2 font-medium text-slate-800",children:m.route}),e.jsx("td",{className:"px-3 py-2 text-slate-600",children:m.cabin}),e.jsxs("td",{className:"px-3 py-2 text-right font-medium text-blue-600",children:["+",(m.earnedXP||0)+(m.safXp||0)]})]},p))})]}),s.length>20&&e.jsxs("p",{className:"p-2 text-center text-xs text-slate-500 bg-slate-50",children:["... and ",s.length-20," more flights"]})]}),a.length>0&&e.jsx("div",{className:"px-4 py-2 bg-amber-50 border-t border-amber-100",children:e.jsxs("p",{className:"text-xs text-amber-700",children:[e.jsx("strong",{children:a.length})," flights already exist and will be skipped"]})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>c(!x),className:"w-full p-4 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(Ge,{size:18,className:"text-emerald-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-slate-800",children:"Miles Data"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["+",o.toLocaleString()," earned â¢ -",u.toLocaleString()," spent"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-emerald-600",children:[n.length," months"]}),x?e.jsx(cs,{size:18,className:"text-slate-400"}):e.jsx(nt,{size:18,className:"text-slate-400"})]})]}),x&&e.jsxs("div",{className:"border-t border-slate-100 max-h-48 overflow-y-auto",children:[n.length===0?e.jsx("p",{className:"p-4 text-sm text-slate-500 text-center",children:"No miles data found"}):e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-slate-500 font-medium",children:"Month"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-500 font-medium",children:"Earned"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-500 font-medium",children:"Spent"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:n.slice(0,15).map((m,p)=>{const h=m.miles_subscription+m.miles_amex+m.miles_other+m.miles_flight;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-3 py-2 text-slate-700",children:m.month}),e.jsxs("td",{className:"px-3 py-2 text-right font-medium text-emerald-600",children:["+",h.toLocaleString()]}),e.jsx("td",{className:"px-3 py-2 text-right font-medium text-red-500",children:m.miles_debit!==0?`-${Math.abs(m.miles_debit).toLocaleString()}`:"-"})]},p)})})]}),n.length>15&&e.jsxs("p",{className:"p-2 text-center text-xs text-slate-500 bg-slate-50",children:["... and ",n.length-15," more months"]})]})]}),l.hasXpDiscrepancy&&l.xpDiscrepancy!==null&&e.jsxs("div",{className:"flex gap-3 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[e.jsx(lt,{size:18,className:"text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"XP Calculation Note"}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Your PDF shows ",l.pdfTotalXP," XP, but flights total ",l.calculatedXP," XP. This is normal â older flights outside your current qualification cycle don't count toward your XP balance."]})]})]}),(s.length>0||n.length>0)&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 rounded-xl",children:[e.jsx(je,{size:18,className:"text-emerald-600"}),e.jsxs("p",{className:"text-sm text-emerald-700",children:["Ready to import ",e.jsx("strong",{children:s.length})," flights and ",e.jsx("strong",{children:n.length})," months of data"]})]})]})},nc={Explorer:"text-slate-600",Silver:"text-slate-500",Gold:"text-amber-600",Platinum:"text-slate-700",Ultimate:"text-slate-900"},rc=["January","February","March","April","May","June","July","August","September","October","November","December"],ic=t=>{if(!t)return"Not set";const[s,a]=t.split("-"),n=parseInt(a,10)-1;return`${rc[n]} ${s}`},oc=({wizardState:t,newFlightsCount:s,milesMonthsCount:a})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(_a,{className:"text-white",size:32})}),e.jsx("h2",{className:"text-2xl font-black text-slate-900 mb-2",children:"Ready to Import!"}),e.jsx("p",{className:"text-slate-500",children:"Review your settings and confirm."})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-5 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(De,{size:16}),"Status"]}),e.jsx("span",{className:`font-bold ${nc[t.status]}`,children:t.status})]}),e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(Ie,{size:16}),"XP Balance"]}),e.jsxs("span",{className:"font-bold text-slate-800",children:[t.xpBalance.toLocaleString()," XP"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(Ie,{size:16}),"UXP Balance"]}),e.jsxs("span",{className:"font-bold text-slate-800",children:[t.uxpBalance.toLocaleString()," UXP"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(Ge,{size:16}),"Miles Balance"]}),e.jsx("span",{className:"font-bold text-slate-800",children:t.milesBalance.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(et,{size:16}),"Cycle Start"]}),e.jsx("span",{className:"font-bold text-slate-800",children:ic(t.cycleStartMonth)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(Ie,{size:16}),"Surplus XP"]}),e.jsxs("span",{className:"font-bold text-slate-800",children:[t.surplusXP," XP"]})]}),e.jsx("div",{className:"py-2"}),e.jsxs("div",{className:"flex justify-between items-center py-2.5 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(le,{size:16}),"Flights to Import"]}),e.jsxs("span",{className:"font-bold text-blue-600",children:[s," new"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[e.jsx(Ge,{size:16}),"Miles Data"]}),e.jsxs("span",{className:"font-bold text-emerald-600",children:[a," months"]})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4",children:e.jsx("p",{className:"text-xs text-blue-700",children:"Your data will be saved and you can always adjust settings later in your profile. The PDF header values (XP, UXP, Miles, Status) will be used as your baseline."})})]}),js=5,cc=["Verify Status","Verify Balances","Qualification Cycle","Preview Data","Confirm Import"],dc=({isOpen:t,onClose:s,onComplete:a,parseResult:n,existingSettings:l})=>{const[r,i]=d.useState(0),x=!!l?.cycleStartMonth;l?.status,console.log("[PdfImportWizard] Received existingSettings:",l),console.log("[PdfImportWizard] hasExistingSettings:",x),console.log("[PdfImportWizard] parseResult.suggestedCycleStart:",n.suggestedCycleStart);const[c,o]=d.useState(()=>{const P={status:l?.status||n.detectedStatus||"Explorer",statusConfirmed:!!(l?.status||n.detectedStatus),xpBalance:n.detectedXP,uxpBalance:n.detectedUXP,milesBalance:n.detectedMiles,cycleStartMonth:l?.cycleStartMonth||n.suggestedCycleStart||"",surplusXP:l?.surplusXP??n.suggestedSurplusXP??0};return console.log("[PdfImportWizard] Initial state:",P),P}),u=P=>{o(C=>({...C,...P}))},m=()=>{r>0&&i(P=>P-1)},p=()=>{r<js-1&&ka(r,c)&&i(P=>P+1)},h=()=>{for(let C=0;C<js;C++)if(!ka(C,c)){i(C);return}const P={status:c.status,xpBalance:c.xpBalance,uxpBalance:c.uxpBalance,milesBalance:c.milesBalance,cycleStartMonth:c.cycleStartMonth,surplusXP:c.surplusXP,flights:n.flights,newFlights:n.newFlights,milesData:n.milesData};a(P)},b=d.useMemo(()=>ka(r,c,x),[r,c,x]),g=r!==2||x,S=()=>{switch(r){case 0:return e.jsx(Jo,{wizardState:c,updateState:u,detectedStatus:n.detectedStatus});case 1:return e.jsx(tc,{wizardState:c,updateState:u,detectedXP:n.detectedXP,detectedUXP:n.detectedUXP,detectedMiles:n.detectedMiles});case 2:return e.jsx(ac,{wizardState:c,updateState:u,suggestedCycleStart:n.suggestedCycleStart,suggestedSurplusXP:n.suggestedSurplusXP,hasExistingSettings:x});case 3:return e.jsx(lc,{wizardState:c,updateState:u,flights:n.flights,newFlights:n.newFlights,duplicateFlights:n.duplicateFlights,milesData:n.milesData,summary:n.summary});case 4:return e.jsx(oc,{wizardState:c,updateState:u,newFlightsCount:n.newFlights.length,milesMonthsCount:n.milesData.length});default:return null}};return t?e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-2 sm:p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] sm:max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{className:"text-blue-600",size:20}),e.jsx("span",{className:"font-bold text-slate-800",children:"PDF Import"}),e.jsxs("span",{className:"text-xs text-slate-400",children:["Step ",r+1," of ",js]})]}),e.jsx("button",{onClick:s,className:"p-1.5 text-slate-400 hover:text-slate-600 transition-colors rounded-lg hover:bg-slate-100",children:e.jsx(Ce,{size:18})})]}),e.jsx(Vo,{currentStep:r,totalSteps:js}),e.jsx("p",{className:"text-center text-sm text-slate-500 mt-2",children:cc[r]})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-6",children:S()}),e.jsx("div",{className:"p-4 border-t border-slate-100 bg-slate-50",children:e.jsx(Ho,{currentStep:r,totalSteps:js,canContinue:b,onBack:m,onContinue:p,onComplete:h,completeLabel:`Import ${n.newFlights.length} Flights & ${n.milesData.length} Months`,showSkip:g,onSkip:p})})]})}):null},xc=Ko,mc=Yo,uc=qo;rn.workerSrc=`https://unpkg.com/pdfjs-dist@${nn}/build/pdf.worker.min.mjs`;const As=({isOpen:t,onClose:s,onImport:a,existingFlights:n,existingMiles:l,existingQualificationSettings:r,existingStatus:i,existingActiveCycleStart:x,existingRolloverXP:c})=>{const[o,u]=d.useState("upload"),[m,p]=d.useState(!1),[h,b]=d.useState(null),[g,S]=d.useState(null),[P,C]=d.useState(!1),[w,f]=d.useState(!1),D=d.useRef(null),{trackPdf:_,trackPdfError:N}=rt(),[F,j]=d.useState(null),[v,A]=d.useState(!1),[R,X]=d.useState(""),[L,G]=d.useState(!1),[k,I]=d.useState(null),[y,U]=d.useState(!0),[M,z]=d.useState(!0),K=d.useCallback(()=>{if(!h)return null;const H=mc(h.flights),ie=uc(h.miles),ue=new Set(n.map(Ne=>`${Ne.date}-${Ne.route}`)),be=H.filter(Ne=>!ue.has(`${Ne.date}-${Ne.route}`)),ve=H.length-be.length,Ye=new Set(l.map(Ne=>Ne.month)),he=ie.filter(Ne=>!Ye.has(Ne.month)),Ae=ie.filter(Ne=>Ye.has(Ne.month)),bt=H.reduce((Ne,Le)=>Ne+Le.earnedXP,0),ot=H.reduce((Ne,Le)=>Ne+Le.safXp,0),gt=bt+ot,W=h.totalXP,pe=W!==null?W-gt:null,Fe=pe!==null&&pe!==0,ae=h.oldestDate,te=h.newestDate,xe=h.requalifications||[];let qe=0;if(ae&&te){const Ne=new Date(ae),Le=new Date(te);qe=Math.round((Le.getTime()-Ne.getTime())/(1e3*60*60*24*30))}const Ve=[...xe].sort((Ne,Le)=>Le.date.localeCompare(Ne.date))[0]||null;let _t=null,ls=null,hs=null,ps=null;if(Ve){ls=Ve.date;const Ne=new Date(Ve.date);_t=new Date(Ne.getFullYear(),Ne.getMonth()+1,1).toISOString().substring(0,7);const fa={EXPLORER:"Explorer",SILVER:"Silver",GOLD:"Gold",PLATINUM:"Platinum",ULTIMATE:"Platinum"};hs=Ve.toStatus&&fa[Ve.toStatus]||null,ps=Ve.rolloverXP??null,console.log("[PDF Import] Requalification detected:",{requalDate:Ve.date,officialCycleStart:_t,status:hs,xpDeducted:Ve.xpDeducted,rolloverXP:ps})}const bs=h.status?.toUpperCase(),Ls=bs&&{EXPLORER:"Explorer",SILVER:"Silver",GOLD:"Gold",PLATINUM:"Platinum",ULTIMATE:"Platinum"}[bs]||null;return console.log("[PDF Import] Header status:",{rawStatus:bs,pdfHeaderStatus:Ls}),{flights:H,miles:ie,newFlights:be,duplicateFlights:ve,newMiles:he,updatedMiles:Ae,totalFlightXP:bt,totalFlightSafXP:ot,totalFlightMiles:H.reduce((Ne,Le)=>Ne+Le.earnedMiles,0),totalMilesEarned:ie.reduce((Ne,Le)=>Ne+Le.miles_subscription+Le.miles_amex+Le.miles_other,0),totalMilesDebit:ie.reduce((Ne,Le)=>Ne+Le.miles_debit,0),pdfTotalXP:W,calculatedXP:gt,xpDiscrepancy:pe,hasXpDiscrepancy:Fe,oldestDate:ae,newestDate:te,dataRangeMonths:qe,requalifications:xe,suggestedCycleStart:_t,suggestedCycleStartDate:ls,suggestedStatus:hs,suggestedRolloverXP:ps,pdfHeaderStatus:Ls,pdfTotalMiles:h.totalMiles,pdfTotalUXP:h.totalUXP}},[h,n,l]),Y=async H=>{const ie=await H.arrayBuffer(),ue=await ti({data:ie}).promise;let be="";for(let ot=1;ot<=ue.numPages;ot++){const pe=(await(await ue.getPage(ot)).getTextContent()).items;for(const Fe of pe)be+=Fe.str+" ";be+=`
`}const ve="jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|mrt|mei|okt|fÃ©v|avr|mai|aoÃ»|dÃ©c|mÃ¤r|dez|ene|ago|dic|gen|mag|giu|lug|ott",Ye=new RegExp(`(\\d{1,2}\\s+(?:${ve})[a-zÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼]*\\s+\\d{4}|(?:${ve})[a-zÃ©Ã»Ã´Ã Ã¨Ã¹Ã¤Ã¶Ã¼]*\\s+\\d{1,2},?\\s+\\d{4})`,"gi"),he=/(\d{1,4}[/.-]\d{1,2}[/.-]\d{2,4})/g;let Ae=be.replace(Ye,`
$1`);Ae=Ae.replace(he,`
$1`);const bt=/([A-Z]{3}\s*[-â]\s*[A-Z]{3}\s+[A-Z]{2}\d{2,5})/g;return Ae=Ae.replace(bt,`
$1`),Ae=Ae.replace(/(Sustainable Aviation Fuel)/gi,`
$1`),Ae=Ae.replace(/(Subscribe to Miles|Miles\s*Complete)/gi,`
$1`),Ae=Ae.replace(/(Hotel\s*[-â])/gi,`
$1`),Ae=Ae.replace(/((?:op|on|le|am)\s+\d{1,2}\s+\w{3,12}\s+\d{4})/gi,`
$1`),Ae},O=async H=>{if(!H.name.toLowerCase().endsWith(".pdf")){S("Please select a PDF file."),u("error"),N("invalid_file_type");return}u("parsing"),S(null);try{const ie=await Y(H),ue=xc(ie);if(ue.flights.length===0&&ue.miles.length===0){S("No Flying Blue data found in this PDF. Make sure you're uploading a Flying Blue transaction history export."),u("error"),N("no_data_found");return}b(ue),u("wizard")}catch(ie){console.error("PDF parsing error:",ie),S("Failed to parse PDF. Make sure it's a valid Flying Blue transaction history."),u("error"),N("parse_failed")}},V=d.useCallback(H=>{H.preventDefault(),p(!1);const ie=H.dataTransfer.files[0];ie&&O(ie)},[]),J=d.useCallback(H=>{H.preventDefault(),p(!0)},[]),q=d.useCallback(H=>{H.preventDefault(),p(!1)},[]),B=H=>{const ie=H.target.files?.[0];ie&&O(ie)},$=()=>{const H=K();if(!H||!h)return;const ie={xp:h.totalXP??0,uxp:h.totalUXP??0,miles:h.totalMiles??0,status:H.pdfHeaderStatus||"Explorer",exportDate:H.newestDate||new Date().toISOString().substring(0,10)};console.log("[PDF Import] PDF Header (Source of Truth):",ie);let ue;const be=H.suggestedStatus===H.pdfHeaderStatus;if(M&&H.suggestedCycleStart&&be?(ue={cycleStartMonth:H.suggestedCycleStart,cycleStartDate:H.suggestedCycleStartDate||void 0,rolloverXP:H.suggestedRolloverXP??0},console.log("[PDF Import] Cycle info detected:",ue)):console.log("[PDF Import] No matching cycle info - user may need to set qualification date manually"),a(H.newFlights,H.miles,ie,ue,"Flying Blue PDF"),_(H.newFlights.length,H.miles.length,h.language),Bl(),Rl())Z();else{const ve=H.miles.reduce((Ye,he)=>Ye+he.miles_subscription+he.miles_amex+he.miles_other,0);I({flights:H.newFlights.length,miles:ve}),u("feedback")}},Q=async()=>{G(!0),await xs({trigger:"post_import",rating:F,message:R.trim()||void 0,page:"pdf_import"}),_l(),G(!1),Z()},oe=()=>{_l(),Z()},se=H=>{if(!h)return;const ie=K();if(ie)if(a(H.newFlights,H.milesData,{xp:H.xpBalance,uxp:H.uxpBalance,miles:H.milesBalance,status:H.status,exportDate:ie.newestDate||new Date().toISOString().substring(0,10)},{cycleStartMonth:H.cycleStartMonth,rolloverXP:H.surplusXP},"Flying Blue PDF"),_(H.newFlights.length,H.milesData.length,h.language),Bl(),Rl())Z();else{const ue=H.milesData.reduce((be,ve)=>be+ve.miles_subscription+ve.miles_amex+ve.miles_other,0);I({flights:H.newFlights.length,miles:ue}),u("feedback")}},Z=()=>{u("upload"),b(null),S(null),C(!1),f(!1),j(null),X(""),I(null),U(!0),z(!0),D.current&&(D.current.value=""),s()},ee=()=>{u("upload"),b(null),S(null),D.current&&(D.current.value="")};if(!t)return null;const T=K(),fe=(()=>{if(!h||!T)return null;const H={EXPLORER:"Explorer",SILVER:"Silver",GOLD:"Gold",PLATINUM:"Platinum",ULTIMATE:"Ultimate"};return{detectedStatus:h.status&&H[h.status.toUpperCase()]||null,detectedXP:h.totalXP??0,detectedUXP:h.totalUXP??0,detectedMiles:h.totalMiles??0,suggestedCycleStart:T.suggestedCycleStart||null,suggestedSurplusXP:T.suggestedRolloverXP??null,flights:T.flights,newFlights:T.newFlights,duplicateFlights:T.flights.filter(ue=>n.some(be=>be.date===ue.date&&be.route===ue.route)),milesData:T.miles,summary:{totalFlights:T.flights.length,newFlights:T.newFlights.length,duplicateFlights:T.duplicateFlights,totalFlightXP:T.totalFlightXP,totalFlightSafXP:T.totalFlightSafXP,totalMonths:T.miles.length,totalMilesEarned:T.totalMilesEarned,totalMilesDebit:T.totalMilesDebit,pdfTotalXP:T.pdfTotalXP,calculatedXP:T.calculatedXP,hasXpDiscrepancy:T.hasXpDiscrepancy,xpDiscrepancy:T.xpDiscrepancy}}})(),Se=x||r?.cycleStartMonth||null,Te=c??r?.startingXP??null,Me=Se||i?{status:i||r?.startingStatus||null,cycleStartMonth:Se,surplusXP:Te}:null;return console.log("[PdfImportModal] existingQualificationSettings prop:",r),console.log("[PdfImportModal] existingActiveCycleStart prop:",x),console.log("[PdfImportModal] existingRolloverXP prop:",c),console.log("[PdfImportModal] existingStatus prop:",i),console.log("[PdfImportModal] Built existingSettings:",Me),o==="wizard"&&fe?(console.log("[PdfImportModal] Passing to wizard - existingSettings:",Me),console.log("[PdfImportModal] Passing to wizard - parseResult.suggestedCycleStart:",fe.suggestedCycleStart),e.jsx(dc,{isOpen:!0,onClose:Z,onComplete:se,parseResult:fe,existingSettings:Me})):e.jsxs("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center",children:e.jsx(wt,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Import Flying Blue PDF"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Import your transaction history from Flying Blue"})]})]}),e.jsx("button",{onClick:Z,className:"p-2 rounded-xl hover:bg-slate-100 transition-colors",children:e.jsx(Ce,{size:20,className:"text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[o==="upload"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-blue-50 border border-blue-100",children:[e.jsx(lt,{size:18,className:"text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"How to get your Flying Blue PDF:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-blue-700",children:[e.jsxs("li",{children:["Log in to ",e.jsx("span",{className:"font-medium",children:"flyingblue.com"})]}),e.jsxs("li",{children:["Go to ",e.jsx("span",{className:"font-medium",children:"My Account â Activity overview"})]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-amber-700",children:'Click "More" repeatedly'})," until all activities are loaded"]}),e.jsxs("li",{children:["Scroll up and click ",e.jsx("span",{className:"font-medium",children:'"Download"'})]})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-amber-50 border border-amber-200",children:[e.jsx(_e,{size:16,className:"text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-amber-700",children:[e.jsx("strong",{children:"Important:"}),' Flying Blue only exports activities visible on screen. Click "More" until you see your full history, or your import will be incomplete!']})]})]}),e.jsxs("div",{onDrop:V,onDragOver:J,onDragLeave:q,onClick:()=>D.current?.click(),className:`
                  border-2 border-dashed rounded-2xl p-12 text-center cursor-pointer transition-all
                  ${m?"border-blue-400 bg-blue-50":"border-slate-200 hover:border-blue-300 hover:bg-slate-50"}
                `,children:[e.jsx("div",{className:`
                  w-16 h-16 rounded-2xl mx-auto mb-4 flex items-center justify-center transition-colors
                  ${m?"bg-blue-200":"bg-slate-100"}
                `,children:e.jsx(St,{size:28,className:m?"text-blue-600":"text-slate-400"})}),e.jsx("p",{className:"text-slate-700 font-medium mb-1",children:m?"Drop your PDF here":"Drag & drop your Flying Blue PDF"}),e.jsx("p",{className:"text-sm text-slate-400",children:"or click to browse"})]}),e.jsx("input",{ref:D,type:"file",accept:".pdf",onChange:B,className:"hidden"}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsx(Zt,{size:18,className:"text-emerald-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-emerald-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"ð Your PDF stays private"}),e.jsxs("p",{className:"text-emerald-700 text-xs leading-relaxed",children:["Your PDF is processed ",e.jsx("strong",{children:"entirely in your browser"})," â it's never uploaded to our servers. We only extract flight data (dates, routes, XP). Personal details like your name or Flying Blue number are not stored."]}),e.jsxs("button",{type:"button",onClick:()=>A(!0),className:"inline-flex items-center gap-1 mt-2 text-xs font-medium text-emerald-700 hover:text-emerald-900 transition-colors",children:["Read full Privacy Policy",e.jsx(Es,{size:12})]})]})]})]}),o==="parsing"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Qe,{size:48,className:"text-blue-500 animate-spin mb-4"}),e.jsx("p",{className:"text-slate-600 font-medium",children:"Parsing your Flying Blue data..."}),e.jsx("p",{className:"text-sm text-slate-400",children:"This may take a few seconds"})]}),o==="error"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center py-8",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-4",children:e.jsx(_e,{size:32,className:"text-red-500"})}),e.jsx("p",{className:"text-slate-800 font-medium mb-2",children:"Import Failed"}),e.jsx("p",{className:"text-sm text-slate-500 text-center max-w-md",children:g})]}),e.jsx("button",{onClick:ee,className:"w-full py-3 rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium transition-colors",children:"Try Again"})]}),o==="preview"&&h&&T&&e.jsxs("div",{className:"space-y-6",children:[(h.memberName||h.status)&&e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl bg-slate-50 border border-slate-100",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(Jt,{size:24,className:"text-blue-600"})}),e.jsxs("div",{children:[h.memberName&&e.jsx("p",{className:"font-bold text-slate-800",children:h.memberName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[h.status&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold uppercase ${h.status==="PLATINUM"?"bg-slate-800 text-white":h.status==="GOLD"?"bg-amber-100 text-amber-700":h.status==="SILVER"?"bg-slate-200 text-slate-600":"bg-blue-100 text-blue-600"}`,children:h.status}),h.memberNumber&&e.jsxs("span",{className:"text-slate-500",children:["#",h.memberNumber]})]})]})]}),T.oldestDate&&T.newestDate&&e.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(lt,{size:16,className:"text-slate-400"}),e.jsxs("span",{children:["PDF contains data from ",e.jsx("strong",{children:T.oldestDate})," to ",e.jsx("strong",{children:T.newestDate}),T.dataRangeMonths>0&&` (${T.dataRangeMonths} months)`]})]}),T.requalifications.length>0&&!T.suggestedCycleStart&&e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[T.requalifications.length," requalification event",T.requalifications.length>1?"s":""," detected"]})]}),T.suggestedCycleStart&&T.suggestedStatus&&e.jsx("div",{className:"p-4 rounded-xl bg-purple-50 border border-purple-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(De,{size:18,className:"text-purple-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-purple-800",children:"Qualification cycle detected"}),e.jsxs("p",{className:"text-sm mt-1 text-purple-600",children:["Your PDF shows a requalification to ",e.jsx("strong",{children:T.suggestedStatus})," in ",e.jsx("strong",{children:T.suggestedCycleStart}),"."]}),e.jsxs("label",{className:"flex items-center gap-2 mt-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:H=>z(H.target.checked),className:"w-4 h-4 rounded border-purple-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("span",{className:"text-sm text-purple-800",children:["Set my qualification cycle to start ",T.suggestedCycleStart," as ",T.suggestedStatus]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-emerald-50 border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(le,{size:18,className:"text-emerald-600"}),e.jsx("span",{className:"font-bold text-emerald-800",children:"Flights"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-emerald-600",children:"Found:"}),e.jsx("span",{className:"font-bold text-emerald-800",children:T.flights.length})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-emerald-600",children:"New:"}),e.jsx("span",{className:"font-bold text-emerald-800",children:T.newFlights.length})]}),T.duplicateFlights>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Duplicates:"}),e.jsx("span",{className:"text-slate-400",children:T.duplicateFlights})]}),e.jsx("div",{className:"border-t border-emerald-200 my-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-emerald-600",children:"Total XP:"}),e.jsx("span",{className:"font-bold text-emerald-800",children:T.totalFlightXP})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-emerald-600",children:"SAF XP:"}),e.jsx("span",{className:"font-bold text-emerald-800",children:T.totalFlightSafXP})]})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-blue-50 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ge,{size:18,className:"text-blue-600"}),e.jsx("span",{className:"font-bold text-blue-800",children:"Miles"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-blue-600",children:"Months:"}),e.jsx("span",{className:"font-bold text-blue-800",children:T.miles.length})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-blue-600",children:"New:"}),e.jsx("span",{className:"font-bold text-blue-800",children:T.newMiles.length})]}),T.updatedMiles.length>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Updates:"}),e.jsx("span",{className:"text-slate-400",children:T.updatedMiles.length})]}),e.jsx("div",{className:"border-t border-blue-200 my-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-blue-600",children:"Earned:"}),e.jsx("span",{className:"font-bold text-blue-800",children:T.totalMilesEarned.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-blue-600",children:"Debit:"}),e.jsxs("span",{className:"font-bold text-red-500",children:["-",T.totalMilesDebit.toLocaleString()]})]})]})]})]}),T.flights.length>0&&e.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>C(!P),className:"w-full px-4 py-3 flex items-center justify-between bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Flight Details (",T.flights.length,")"]}),P?e.jsx(cs,{size:18}):e.jsx(nt,{size:18})]}),P&&e.jsx("div",{className:"max-h-48 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-slate-500",children:"Date"}),e.jsx("th",{className:"px-3 py-2 text-left text-slate-500",children:"Route"}),e.jsx("th",{className:"px-3 py-2 text-left text-slate-500",children:"Flight"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-500",children:"Miles"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-500",children:"XP"})]})}),e.jsx("tbody",{children:T.flights.map((H,ie)=>{const ue=n.some(be=>be.date===H.date&&be.route===H.route);return e.jsxs("tr",{className:`border-t border-slate-100 ${ue?"opacity-40":""}`,children:[e.jsx("td",{className:"px-3 py-2 font-mono",children:H.date}),e.jsx("td",{className:"px-3 py-2 font-bold",children:H.route}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:H.flightNumber}),e.jsx("td",{className:"px-3 py-2 text-right",children:H.earnedMiles.toLocaleString()}),e.jsxs("td",{className:"px-3 py-2 text-right font-bold text-blue-600",children:["+",H.earnedXP]})]},ie)})})]})})]}),T.duplicateFlights>0&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-amber-50 border border-amber-100",children:[e.jsx(_e,{size:18,className:"text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsxs("p",{className:"font-medium",children:[T.duplicateFlights," duplicate flights will be skipped"]}),e.jsx("p",{className:"text-amber-600",children:"These flights already exist in your data (matched by date + route)."})]})]}),T.hasXpDiscrepancy&&T.xpDiscrepancy!==null&&e.jsx("div",{className:`p-4 rounded-xl border ${T.xpDiscrepancy>0?"bg-blue-50 border-blue-100":"bg-amber-50 border-amber-100"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(lt,{size:18,className:`flex-shrink-0 mt-0.5 ${T.xpDiscrepancy>0?"text-blue-500":"text-amber-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${T.xpDiscrepancy>0?"text-blue-800":"text-amber-800"}`,children:"XP discrepancy detected"}),e.jsxs("p",{className:`text-sm mt-1 ${T.xpDiscrepancy>0?"text-blue-600":"text-amber-600"}`,children:["Your official Flying Blue balance is ",e.jsxs("strong",{children:[T.pdfTotalXP," XP"]}),", but imported flights total ",e.jsxs("strong",{children:[T.calculatedXP," XP"]}),".",T.xpDiscrepancy>0?` The ${T.xpDiscrepancy} XP difference likely comes from credit card bonuses, status bonuses, or older flights not in this PDF.`:" This is normal â older flights in the PDF don't count towards your current qualification period."]}),T.xpDiscrepancy>0&&e.jsxs("label",{className:"flex items-center gap-2 mt-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:H=>U(H.target.checked),className:"w-4 h-4 rounded border-blue-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-blue-800",children:["Add +",T.xpDiscrepancy," XP correction to match your actual balance"]})]})]})]})}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-100",children:[e.jsx(lt,{size:18,className:"text-slate-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-slate-600 space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Note:"}),' All flights are imported with "Economy" cabin. You can edit the cabin class later in the Flight Ledger.']}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Tip:"})," If your PDF doesn't cover your full qualification period, you can manually add older flights in the Flight Ledger, or add an XP correction in the XP Engine."]})]})]})]})]}),o==="preview"&&T&&e.jsx("div",{className:"p-6 border-t border-slate-100 bg-slate-50",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ee,className:"flex-1 py-3 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-slate-700 font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:$,disabled:T.newFlights.length===0&&T.miles.length===0,className:"flex-1 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(je,{size:18}),"Import ",T.newFlights.length," Flights & ",T.miles.length," Months"]})]})}),o==="feedback"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(je,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Import successful!"}),e.jsxs("p",{className:"text-emerald-100 text-sm",children:[k?.flights?`${k.flights} flights`:"",k?.flights&&k?.miles?" Â· ":"",k?.miles?`${k.miles.toLocaleString()} miles`:""]})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-slate-600 mb-4",children:"Quick question: how was the import process?"}),e.jsx("div",{className:"flex gap-3 mb-4",children:[{value:"easy",icon:e.jsx(ni,{size:24}),label:"Easy"},{value:"okay",icon:e.jsx(ri,{size:24}),label:"Okay"},{value:"confusing",icon:e.jsx(ii,{size:24}),label:"Confusing"}].map(H=>e.jsxs("button",{onClick:()=>j(H.value),className:`flex-1 flex flex-col items-center gap-2 p-4 rounded-xl border-2 transition-all ${F===H.value?"border-brand-500 bg-brand-50 text-brand-600":"border-slate-200 text-slate-400 hover:border-slate-300 hover:text-slate-500"}`,children:[H.icon,e.jsx("span",{className:"text-sm font-medium",children:H.label})]},H.value))}),e.jsx("textarea",{value:R,onChange:H=>X(H.target.value),placeholder:"Any details? (optional)",className:"w-full px-4 py-3 border border-slate-200 rounded-xl text-sm text-slate-700 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none",rows:2}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx("button",{onClick:oe,className:"px-4 py-2 text-slate-500 hover:text-slate-700 font-medium text-sm transition-colors",children:"Skip"}),e.jsxs("button",{onClick:Q,disabled:L,className:"inline-flex items-center gap-2 px-5 py-2 bg-brand-600 hover:bg-brand-700 text-white font-medium text-sm rounded-lg transition-colors disabled:opacity-50",children:[L?e.jsx(Qe,{size:16,className:"animate-spin"}):e.jsx(es,{size:16}),"Send"]})]})]})]})]}),v&&e.jsxs("div",{className:"absolute inset-0 bg-white z-10 flex flex-col rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200 bg-slate-50 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(Zt,{size:20,className:"text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Privacy Policy"}),e.jsx("p",{className:"text-xs text-slate-500",children:"How we handle your data"})]})]}),e.jsx("button",{onClick:()=>A(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Ce,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6 text-sm",children:[e.jsx("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:e.jsx("p",{className:"font-medium text-emerald-800",children:"ð Your Flying Blue PDFs are processed entirely in your browser. The PDF file is never uploaded to our servers."})}),e.jsxs("section",{children:[e.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"PDF Import & Processing"}),e.jsx("p",{className:"text-slate-600 mb-3",children:"When you import a Flying Blue PDF:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-emerald-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Client-side processing:"})," The PDF is parsed entirely in your browser using JavaScript. No server is involved."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-emerald-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Data extraction:"})," We extract only flight data: dates, routes, cabin class, XP earned, and miles. Personal details like your name or Flying Blue number are not stored."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-emerald-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"No file storage:"})," The original PDF is never saved â not on our servers, not in your browser. Only the extracted flight records are kept."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-emerald-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Your choice:"})," Extracted data is stored locally (Local Mode) or synced to your account (Cloud Mode), depending on your preference."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"Data Storage"}),e.jsx("p",{className:"text-slate-600 mb-3",children:"SkyStatus offers two storage modes:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Local Mode:"})," Data stays only in your browser. We have zero access. Use export/import to backup."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Cloud Mode:"})," Data syncs to your account via Supabase with encryption and row-level security. Only you can access your data."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"Your Rights (GDPR)"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-400 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Export:"})," Download all your data anytime (Data Settings â Export JSON)"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-400 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Delete:"})," Remove all data permanently (Data Settings â Delete All Data)"]})]})]})]}),e.jsx("section",{className:"pt-4 border-t border-slate-200",children:e.jsxs("p",{className:"text-slate-500 text-xs",children:["Questions? Read the"," ",e.jsx("a",{href:"/privacy",className:"text-blue-600 hover:underline",onClick:()=>A(!1),children:"full Privacy Policy"})," ","or visit our"," ",e.jsx("a",{href:"/faq",className:"text-blue-600 hover:underline",onClick:()=>A(!1),children:"FAQ page"})," ","to contact us."]})})]})}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-200 bg-slate-50 flex-shrink-0",children:e.jsx("button",{onClick:()=>A(!1),className:"w-full py-2.5 bg-slate-900 hover:bg-slate-800 text-white font-medium rounded-xl transition-colors",children:"Got it, continue"})})]})]})},kr=Object.freeze(Object.defineProperty({__proto__:null,default:As},Symbol.toStringTag,{value:"Module"})),Is=({isOpen:t,onClose:s})=>{const[a,n]=d.useState(""),[l,r]=d.useState(""),[i,x]=d.useState(""),[c,o]=d.useState(!1),[u,m]=d.useState("idle"),{trackContactFormSubmit:p}=rt(),h=async g=>{if(g.preventDefault(),!!i.trim()){o(!0),m("idle");try{const S=["**Contact Form Submission**","",`**From:** ${a||"Not provided"}`,`**Email:** ${l||"Not provided"}`,"","**Message:**",i].join(`
`);await xs({trigger:"contact_form",message:S,page:window.location.pathname})?(m("success"),p("contact"),setTimeout(()=>{n(""),r(""),x(""),m("idle"),s()},2e3)):m("error")}catch(S){console.error("Error submitting contact form:",S),m("error")}finally{o(!1)}}},b=()=>{c||(n(""),r(""),x(""),m("idle"),s())};return t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:b}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Contact Support"}),e.jsx("button",{onClick:b,disabled:c,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(Ce,{size:20,className:"text-slate-500"})})]}),e.jsx("form",{onSubmit:h,className:"p-6 space-y-4",children:u==="success"?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx("div",{className:"p-3 bg-emerald-100 rounded-full mb-4",children:e.jsx(je,{size:32,className:"text-emerald-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Message Sent!"}),e.jsx("p",{className:"text-slate-600",children:"We'll get back to you as soon as possible."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contact-name",className:"block text-sm font-medium text-slate-700 mb-1",children:["Name ",e.jsx("span",{className:"text-slate-400",children:"(optional)"})]}),e.jsx("input",{type:"text",id:"contact-name",value:a,onChange:g=>n(g.target.value),placeholder:"Your name",disabled:c,className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent disabled:bg-slate-50 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contact-email",className:"block text-sm font-medium text-slate-700 mb-1",children:["Email ",e.jsx("span",{className:"text-slate-400",children:"(optional, for reply)"})]}),e.jsx("input",{type:"email",id:"contact-email",value:l,onChange:g=>r(g.target.value),placeholder:"your@email.com",disabled:c,className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent disabled:bg-slate-50 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contact-message",className:"block text-sm font-medium text-slate-700 mb-1",children:["Message ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"contact-message",value:i,onChange:g=>x(g.target.value),placeholder:"How can we help?",rows:4,required:!0,disabled:c,className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none disabled:bg-slate-50 disabled:opacity-50"})]}),u==="error"&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:[e.jsx(Nt,{size:18}),e.jsx("span",{children:"Something went wrong. Please try again."})]}),e.jsx("button",{type:"submit",disabled:c||!i.trim(),className:"w-full flex items-center justify-center gap-2 bg-brand-600 hover:bg-brand-700 text-white font-semibold py-3 px-6 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:18,className:"animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{size:18}),"Send Message"]})}),e.jsx("p",{className:"text-xs text-center text-slate-400",children:"We typically respond within 24 hours."})]})})]})]}):null},hc=({item:t,isOpen:s,onToggle:a})=>e.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:a,className:"w-full flex items-center justify-between p-3 text-left bg-white hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"font-medium text-slate-900 pr-4 text-sm",children:t.question}),s?e.jsx(nt,{size:18,className:"text-slate-400 flex-shrink-0"}):e.jsx(we,{size:18,className:"text-slate-400 flex-shrink-0"})]}),s&&e.jsx("div",{className:"px-3 pb-3 bg-slate-50 border-t border-slate-100",children:e.jsx("div",{className:"pt-3 text-slate-600 leading-relaxed text-sm",children:t.answer})})]}),Cr=({isOpen:t,onClose:s})=>{const[a,n]=d.useState(new Set),[l,r]=d.useState(0),[i,x]=d.useState(!1),c=u=>{const m=new Set(a);m.has(u)?m.delete(u):m.add(u),n(m)},o=[{title:"Using SkyStatus",icon:e.jsx(De,{size:18}),items:[{question:"How do I enter my current status and XP?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"To match your current Flying Blue status with SkyStatus:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Import your Flying Blue PDF"})," (recommended) â this automatically extracts all your flights, XP, and miles."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Or enter manually:"}),' Go to XP Qualification â set your cycle start month â enter your current XP balance as "rollover XP".']})]}),e.jsxs("p",{className:"mt-2 p-2 bg-blue-50 rounded-lg text-xs",children:[e.jsx("strong",{children:"Tip:"}),' Find your current XP on flyingblue.com under "My Account".']})]})},{question:"How do I import my Flying Blue PDF?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Step 1:"})," Log in at flyingblue.com â My Account â Activity overview"]}),e.jsxs("p",{className:"mt-2 p-2 bg-amber-50 rounded-lg border border-amber-200",children:[e.jsx("strong",{className:"text-amber-700",children:"â ï¸ Important:"})," Click the ",e.jsx("strong",{children:'"More"'})," button at the bottom repeatedly until ALL your activities are loaded. Flying Blue only exports what's visible on screen!"]}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Step 2:"})," Scroll back up and click the ",e.jsx("strong",{children:'"Download"'})," button"]}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Step 3:"}),' Click "Import PDF" here, drag your PDF in, review and import.']})]})},{question:"Why doesn't my XP match exactly with Flying Blue?",answer:e.jsx("p",{children:"Small differences can occur due to timing delays, bonus XP from promotions, rounding, or partner flight variations. Use the correction function in XP Qualification to adjust."})},{question:"Does SkyStatus support Ultimate status tracking?",answer:e.jsx("p",{children:'Yes! SkyStatus fully supports Ultimate tracking. Select "Ultimate" in your cycle settings, enter your UXP rollover, and track your progress with dedicated Ultimate Requalification monitoring, UXP Rollover Forecast (900 cap), and waste indicators (1800 total cap).'})}]},{title:"Qualification Cycle",icon:e.jsx(Je,{size:18}),items:[{question:"What is a qualification year?",answer:e.jsx("p",{children:"Your personal 12-month period for earning XP. It starts when you first earn XP (new members), after a level-up (first of next month), or stays the same after requalification."})},{question:'How does XP "payment" work on level-up?',answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"When you reach a threshold, that amount is deducted. Thresholds: ExplorerâSilver: 100 XP, SilverâGold: 180 XP, GoldâPlatinum: 300 XP."}),e.jsx("p",{className:"mt-1 text-xs",children:"Example: 250 XP as Silver + 50 XP flight = 300 XP â Pay 180 â Become Gold with 120 XP"})]})},{question:"What is rollover XP?",answer:e.jsx("p",{children:"XP remaining after requalification carries to next year. Maximum rollover: 300 XP. For UXP, max rollover is 900 UXP."})},{question:"What is soft landing?",answer:e.jsx("p",{children:"You can only drop one level per year if you don't requalify. PlatinumâGold, GoldâSilver, etc. Ultimate always drops to Platinum first."})}]},{title:"Miles & Value",icon:e.jsx(Ss,{size:18}),items:[{question:"How is cost-per-mile calculated?",answer:e.jsx("p",{children:"CPM = Total costs / Total miles earned. Lower is better. Example: â¬1,200 spent / 100,000 miles = 1.2 cents/mile."})},{question:"What is a good redemption value?",answer:e.jsxs("p",{children:["<","1.0Â¢ = Poor, 1.0-1.5Â¢ = Average, 1.5-2.5Â¢ = Good, ",">","2.5Â¢ = Excellent. Business class usually gives best value."]})}]},{title:"Flying Blue Basics",icon:e.jsx(le,{size:18}),items:[{question:"What are the status levels?",answer:e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Explorer:"})," Base level, 4x Miles"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Silver (100 XP):"})," 6x Miles, 1 extra bag, SkyTeam Elite"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gold (180 XP):"})," 7x Miles, Lounge+1, SkyPriority"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Platinum (300 XP):"})," 8x Miles, 2 bags, all seats free, start earning UXP"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ultimate (900 UXP):"})," 9x Miles, Lounge+8, 4 upgrade vouchers"]})]})},{question:"What is the difference between XP and Miles?",answer:e.jsxs("p",{children:[e.jsx("strong",{children:"Miles:"})," Reward currency for redemptions. ",e.jsx("strong",{children:"XP:"})," Determines your status level, resets yearly."]})},{question:"What is UXP?",answer:e.jsx("p",{children:"Ultimate XP â earned only on KLM/Air France flights and SAF purchases. Counts toward Ultimate status. Every UXP is also XP, but not vice versa."})}]},{title:"Data & Privacy",icon:e.jsx(Zt,{size:18}),items:[{question:"Is my data safe?",answer:e.jsxs("p",{children:["Yes. Encrypted storage, TLS/SSL connections, row-level security. We never sell or share your data. ",e.jsx("a",{href:"/privacy",className:"text-brand-600 hover:underline",children:"Read Privacy Policy"})]})},{question:"Can I use SkyStatus without an account?",answer:e.jsx("p",{children:"Yes! Local Mode stores data only in your browser. No account needed, complete privacy. Downside: data lost if cache is cleared, no sync."})}]}];return t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-brand-100 rounded-lg",children:e.jsx(vt,{className:"text-brand-600",size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Help & FAQ"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Quick answers to common questions"})]})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:e.jsx(Ce,{size:20,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex gap-1 p-2 bg-slate-100 border-b border-slate-200 overflow-x-auto",children:o.map((u,m)=>e.jsxs("button",{onClick:()=>r(m),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors ${l===m?"bg-white text-brand-600 shadow-sm":"text-slate-600 hover:bg-white/50"}`,children:[u.icon,e.jsx("span",{className:"hidden sm:inline",children:u.title})]},m))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-2",children:o[l].items.map((u,m)=>{const p=`${l}-${m}`;return e.jsx(hc,{item:u,isOpen:a.has(p),onToggle:()=>c(p)},p)})})}),e.jsxs("div",{className:"p-4 border-t border-slate-200 bg-slate-50 flex items-center justify-between",children:[e.jsxs("a",{href:"/faq",onClick:s,className:"text-sm text-brand-600 hover:underline flex items-center gap-1",children:["View full FAQ page ",e.jsx(Es,{size:14})]}),e.jsx("button",{onClick:()=>x(!0),className:"text-sm text-slate-500 hover:text-slate-700",children:"Contact support"})]}),e.jsx(Is,{isOpen:i,onClose:()=>x(!1)})]})]}):null},pc=({onDismiss:t})=>{const[s,a]=d.useState(""),[n,l]=d.useState(!1),[r,i]=d.useState(!1),x=async()=>{s.trim()&&(l(!0),await xs({trigger:To(),message:s.trim(),page:"dashboard"}),Ro(),l(!1),i(!0),setTimeout(()=>{t()},2e3))},c=()=>{_o(),t()};return r?e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl border border-emerald-200 p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(Qt,{size:20,className:"text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-emerald-800",children:"Thanks for your feedback!"}),e.jsx("p",{className:"text-sm text-emerald-600",children:"Your input helps make SkyStatus better."})]})]})}):e.jsxs("div",{className:"bg-gradient-to-r from-brand-50 to-indigo-50 rounded-2xl border border-brand-200 p-6 relative",children:[e.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 transition-colors",title:"Ask me later",children:e.jsx(Ce,{size:18})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-brand-100 rounded-full flex items-center justify-center",children:e.jsx(Ua,{size:20,className:"text-brand-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-1",children:"Help improve SkyStatus"}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"You've been using SkyStatus for a while now. What's working well? What could be better?"}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:"Your feedback...",className:"w-full px-4 py-3 border border-slate-200 rounded-xl text-sm text-slate-700 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none bg-white",rows:3}),e.jsxs("div",{className:"flex justify-end gap-3 mt-3",children:[e.jsx("button",{onClick:c,className:"px-4 py-2 text-slate-500 hover:text-slate-700 font-medium text-sm transition-colors",children:"Not now"}),e.jsxs("button",{onClick:x,disabled:n||!s.trim(),className:"inline-flex items-center gap-2 px-5 py-2 bg-brand-600 hover:bg-brand-700 text-white font-medium text-sm rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[n?e.jsx(Qe,{size:16,className:"animate-spin"}):e.jsx(es,{size:16}),"Send feedback"]})]})]})]})]})},bc=(t,s)=>{if(s)return"Progress to requalify";switch(t){case"Explorer":return"Progress to Silver";case"Silver":return"Progress to Gold";case"Gold":return"Progress to Platinum";case"Platinum":return"Progress to requalify";case"Ultimate":return"Progress to requalify";default:return"Progress"}},Mr=t=>{switch(t){case"Explorer":return 100;case"Silver":return 180;case"Gold":return 300;case"Platinum":return 300;case"Ultimate":return 300;default:return 100}},cl=(t,s=!1)=>{if(s)return{meshGradient:"from-slate-800 via-slate-700/90 to-slate-800",accentColor:"text-white",iconColor:"text-amber-300/80",progressBar:"from-slate-500 to-slate-400",projectedBar:"from-slate-600 to-slate-500",cardBg:"bg-slate-800",borderColor:"border-slate-600"};switch(t){case"Platinum":return{meshGradient:"from-blue-100/80 via-slate-100/50 to-white",accentColor:"text-blue-900",iconColor:"text-blue-600",progressBar:"from-blue-600 to-indigo-600",projectedBar:"from-blue-300 to-indigo-300"};case"Gold":return{meshGradient:"from-amber-100/80 via-orange-50/50 to-white",accentColor:"text-amber-900",iconColor:"text-amber-600",progressBar:"from-amber-500 to-orange-500",projectedBar:"from-amber-300 to-orange-300"};case"Silver":return{meshGradient:"from-slate-100/80 via-gray-100/50 to-white",accentColor:"text-slate-700",iconColor:"text-slate-500",progressBar:"from-slate-500 to-gray-500",projectedBar:"from-slate-300 to-gray-300"};default:return{meshGradient:"from-emerald-100/80 via-teal-50/50 to-white",accentColor:"text-emerald-800",iconColor:"text-emerald-600",progressBar:"from-emerald-500 to-teal-500",projectedBar:"from-emerald-300 to-teal-300"}}},gc=(t,s,a)=>{if(t>=900)return{percentage:100,message:"You've achieved Ultimate!",sentiment:"positive"};if(s>=900)return{percentage:100,message:"Ultimate secured with booked flights!",sentiment:"positive"};const l=Math.round(s/900*100);if(l>=70){const i=900-s;return{percentage:l,message:`Only ${i} UXP to go â you're almost there!`,sentiment:"positive"}}if(l>=40){const i=a>0?Math.ceil((900-s)/a):900-s;return{percentage:l,message:`${i} UXP/month on KLM/AF to reach Ultimate`,sentiment:"neutral"}}const r=Math.ceil((900-s)/40);return{percentage:l,message:`Book ${r} more KLM/AF flights to unlock Ultimate`,sentiment:"encouraging"}},us=t=>{if(t.length===0)return null;const s=new Date().toISOString().slice(0,10);for(const a of t)if(s>=a.startDate&&s<=a.endDate)return a;for(const a of t)if(a.endDate>=s)return a;return t[t.length-1]},Ks=({title:t,value:s,subtitle:a,icon:n,badgeText:l,badgeColor:r="slate",tooltip:i})=>{const x={blue:"bg-blue-50/40 border-blue-100 hover:border-blue-200",amber:"bg-amber-50/40 border-amber-100 hover:border-amber-200",emerald:"bg-emerald-50/40 border-emerald-100 hover:border-emerald-200",violet:"bg-violet-50/40 border-violet-100 hover:border-violet-200",slate:"bg-slate-50/40 border-slate-100 hover:border-slate-200"},c={blue:"text-blue-600 bg-white shadow-sm",amber:"text-amber-600 bg-white shadow-sm",emerald:"text-emerald-600 bg-white shadow-sm",violet:"text-violet-600 bg-white shadow-sm",slate:"text-slate-600 bg-white shadow-sm"},o=x[r]||x.slate,u=c[r]||c.slate;return e.jsxs("div",{className:`p-5 rounded-3xl border shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] transition-all duration-300 group ${o} h-full flex flex-col justify-between`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:`p-3 rounded-2xl ${u}`,children:e.jsx(n,{size:20,strokeWidth:2.5})}),l&&e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-lg bg-white/60 text-slate-500 border border-slate-100/50",children:l})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("p",{className:"text-slate-600 text-xs font-bold uppercase tracking-wider",children:t}),i&&e.jsx(me,{text:i})]}),e.jsx("h3",{className:"text-2xl font-black text-slate-800 tracking-tight",children:s}),a&&e.jsx("p",{className:"text-xs text-slate-400 mt-1 font-medium",children:a})]})]})},st=300,rs=300,Mt=900,Re=900,Ca=1800,fc=({actualStatus:t,projectedStatus:s,actualXP:a,projectedTotalXP:n,targetXP:l,rolloverOut:r,hasProjectedUpgrade:i,cycleStartDate:x,cycleEndDate:c,isUltimate:o=!1,actualUXP:u=0,projectedUXP:m=0})=>{const p=new Date,h=new Date(c),b=new Date(x),g=Math.max(0,Math.ceil((h.getTime()-p.getTime())/(1e3*60*60*24))),S=Math.ceil((h.getTime()-b.getTime())/(1e3*60*60*24)),P=S-g,C=Math.min(100,P/S*100),w=Math.max(0,l-a),f=a>=l,D=n>=l,_=f?a-l:0,N=D?n-l:0,F=t==="Platinum"?Math.min(st,Math.max(0,a-rs)):0,j=s==="Platinum"?Math.min(st,Math.max(0,n-rs)):0,v=s==="Platinum"&&t!=="Platinum"?Math.min(st,Math.max(0,n-rs)):null,A=!o&&t==="Platinum"?Math.max(0,a-rs-st):0,R=!o&&s==="Platinum"?Math.max(0,n-rs-st):0,X=o?Math.max(0,u-Ca):0,L=o?Math.max(0,m-Ca):0,G=o?Math.min(Mt,Math.max(0,u-Re)):0,k=o?Math.min(Mt,Math.max(0,m-Re)):0,y=o?u<Re&&m<Re?{status:"critical",label:"Action needed"}:u<Re&&m>=Re?{status:"good",label:"On track"}:L>200?{status:"warning",label:"Optimize timing"}:L>0?{status:"good",label:"Minor UXP waste"}:G>=Mt?{status:"optimal",label:"Maximized"}:{status:"optimal",label:"Healthy"}:!f&&!D?{status:"critical",label:"Action needed"}:!f&&D?{status:"good",label:"On track"}:R>100?{status:"warning",label:"Optimize timing"}:R>0?{status:"good",label:"Minor waste"}:f&&j>=st?{status:"optimal",label:"Maximized"}:{status:"optimal",label:"Healthy"},U={optimal:"text-emerald-600 bg-emerald-50",good:"text-blue-600 bg-blue-50",warning:"text-amber-600 bg-amber-50",critical:"text-red-600 bg-red-50"},M=Y=>Y.toLocaleDateString("en-US",{month:"short",day:"numeric"}),K=(()=>{if(o){if(u<Re&&m<Re){const Y=Re-u;return{icon:e.jsx(_e,{size:16}),text:`Book ${Y} UXP worth of KLM/AF flights`,subtext:`${g} days left to secure your Ultimate status`}}if(u<Re&&m>=Re){const Y=m-u;return{icon:e.jsx(le,{size:16}),text:"Stay on track with scheduled KLM/AF flights",subtext:`${Y} UXP from upcoming trips will secure Ultimate requalification`}}if(L>100)return{icon:e.jsx(Ps,{size:16}),text:`${L} UXP will be lost to cap`,subtext:"Consider postponing KLM/AF flights to next cycle if possible"};if(G>=Mt&&L===0)return{icon:e.jsx(je,{size:16}),text:"Perfect! Maximum UXP rollover locked in",subtext:"Additional KLM/AF flights this cycle would waste UXP"};if(G<Mt){const Y=Mt-G;return{icon:e.jsx(Be,{size:16}),text:`Room for ${Y} more UXP rollover`,subtext:"Extra KLM/AF flights carry UXP over to next year"}}return null}if(!f&&!D)return{icon:e.jsx(_e,{size:16}),text:`Book ${w} XP worth of flights`,subtext:`${g} days left to secure your ${t} status`};if(!f&&D){const Y=n-a;return{icon:e.jsx(le,{size:16}),text:"Stay on track with scheduled flights",subtext:`${Y} XP from upcoming trips will secure requalification`}}if(R>50)return{icon:e.jsx(Ps,{size:16}),text:`${R} XP will exceed cap`,subtext:"Consider timing flights for next cycle if optimizing"};if(f&&j>=st&&R===0)return{icon:e.jsx(je,{size:16}),text:"Perfect! Maximum rollover locked in",subtext:"Additional XP won't carry over, but you've hit the sweet spot"};if(f&&j<st){const Y=st-j;return{icon:e.jsx(Be,{size:16}),text:`Room for ${Y} more rollover XP`,subtext:"Extra flights this cycle carry over to next year"}}return null})();return e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(oi,{size:20,className:"text-slate-400"}),"Risk Monitor"]}),e.jsx("span",{className:`text-[10px] font-bold px-2.5 py-1 rounded-lg uppercase tracking-wide ${U[y.status]}`,children:y.label})]}),e.jsxs("div",{className:"mb-5 p-3 rounded-xl bg-slate-50/50 border border-slate-100/50",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] text-slate-500 mb-2",children:[e.jsx("span",{className:"font-medium",children:M(b)}),e.jsxs("span",{className:"font-bold text-slate-700 flex items-center gap-1",children:[e.jsx(et,{size:10}),g," days left"]}),e.jsx("span",{className:"font-medium",children:M(h)})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-slate-400 to-slate-500 rounded-full transition-all duration-500",style:{width:`${C}%`}})})]}),e.jsxs("div",{className:"space-y-4",children:[o?e.jsxs("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200/50 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 flex items-center gap-1",children:[e.jsx(ze,{size:12}),"Ultimate Requalification"]}),u>=Re?e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-emerald-600",children:[e.jsx(je,{size:12}),"Secured"]}):m>=Re?e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-blue-600",children:[e.jsx(Ee,{size:12}),"On track"]}):e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-amber-600",children:[e.jsx(_e,{size:12}),"Action needed"]})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("div",{children:e.jsx("div",{className:"text-2xl font-black text-slate-800",children:"Ultimate"})}),e.jsx("div",{className:"text-right",children:u>=Re?e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-emerald-600",children:["+",u-Re]}),e.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-medium",children:"UXP buffer"})]}):m>=Re?e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["+",m-Re]}),e.jsxs("div",{className:"text-[10px] text-blue-400 uppercase font-medium flex items-center gap-0.5 justify-end",children:[e.jsx(Ee,{size:9}),"projected buffer"]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-amber-600",children:Re-u}),e.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-medium",children:"UXP needed"})]})})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-300/50",children:[e.jsxs("div",{className:"flex justify-between text-[9px] text-slate-400 mb-1",children:[e.jsxs("span",{children:["Progress to ",Re," UXP"]}),e.jsxs("span",{children:[u," / ",Re]})]}),e.jsx("div",{className:"h-1.5 bg-slate-300 rounded-full overflow-hidden",children:e.jsxs("div",{className:"relative h-full",children:[m>u&&e.jsx("div",{className:"absolute inset-y-0 left-0 bg-slate-400 rounded-full",style:{width:`${Math.min(100,m/Re*100)}%`}}),e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full ${u>=Re?"bg-emerald-500":"bg-slate-500"}`,style:{width:`${Math.min(100,u/Re*100)}%`}})]})})]})]}):e.jsxs("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-slate-50 to-slate-100/50 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"Requalification Status"}),f?e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-emerald-600",children:[e.jsx(je,{size:12}),"Secured"]}):D?e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-blue-600",children:[e.jsx(Ee,{size:12}),"On track"]}):e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-amber-600",children:[e.jsx(_e,{size:12}),"Action needed"]})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-black text-slate-800",children:t}),i&&e.jsxs("div",{className:"text-xs text-blue-600 font-medium flex items-center gap-1 mt-0.5",children:[e.jsx(Ee,{size:10}),"â ",s," projected"]})]}),e.jsx("div",{className:"text-right",children:f?e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-emerald-600",children:["+",_]}),e.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-medium",children:"XP buffer"})]}):D?e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["+",N]}),e.jsxs("div",{className:"text-[10px] text-blue-400 uppercase font-medium flex items-center gap-0.5 justify-end",children:[e.jsx(Ee,{size:9}),"projected buffer"]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-amber-600",children:w}),e.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-medium",children:"XP needed"})]})})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-200/50",children:[e.jsxs("div",{className:"flex justify-between text-[9px] text-slate-400 mb-1",children:[e.jsxs("span",{children:["Progress to ",l," XP"]}),e.jsxs("span",{children:[a," / ",l]})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsxs("div",{className:"relative h-full",children:[n>a&&e.jsx("div",{className:"absolute inset-y-0 left-0 bg-blue-300 rounded-full",style:{width:`${Math.min(100,n/l*100)}%`}}),e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full ${f?"bg-emerald-500":"bg-slate-400"}`,style:{width:`${Math.min(100,a/l*100)}%`}})]})})]})]}),o?e.jsxs("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-slate-50 to-slate-100/50 border border-slate-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 flex items-center gap-1",children:[e.jsx(ze,{size:12}),"UXP Rollover Forecast"]}),e.jsxs("span",{className:"text-[10px] font-medium text-slate-400",children:["Cap: ",Mt," UXP"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/60 rounded-xl p-3 border border-white",children:[e.jsx("div",{className:"text-[10px] font-bold uppercase text-slate-400 mb-1",children:"Actual"}),e.jsx("div",{className:"text-xl font-black text-slate-800",children:G}),e.jsx("div",{className:"text-[10px] text-slate-500",children:"UXP â next cycle"})]}),e.jsxs("div",{className:"bg-white/60 rounded-xl p-3 border border-white",children:[e.jsxs("div",{className:"text-[10px] font-bold uppercase text-slate-500 flex items-center gap-1 mb-1",children:[e.jsx(Ee,{size:10}),"Projected"]}),e.jsx("div",{className:"text-xl font-black text-slate-800",children:k}),e.jsx("div",{className:"text-[10px] text-slate-500",children:"UXP â next cycle"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"h-2.5 bg-slate-200 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 bg-slate-300 rounded-full transition-all duration-500",style:{width:`${Math.min(100,k/Mt*100)}%`}}),e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-slate-500 to-slate-600 rounded-full transition-all duration-500",style:{width:`${Math.min(100,G/Mt*100)}%`}})]}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-[9px] text-slate-400",children:"0"}),e.jsxs("span",{className:"text-[9px] text-slate-400",children:[Mt," UXP max"]})]})]})]}):(t==="Platinum"||s==="Platinum")&&e.jsxs("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-blue-50/50 to-indigo-50/50 border border-blue-100/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"Rollover Forecast"}),e.jsxs("span",{className:"text-[10px] font-medium text-slate-400",children:["Cap: ",st," XP"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/60 rounded-xl p-3 border border-white",children:[e.jsx("div",{className:"text-[10px] font-bold uppercase text-slate-400 mb-1",children:"Actual"}),e.jsx("div",{className:"text-xl font-black text-slate-800",children:F}),e.jsx("div",{className:"text-[10px] text-slate-500",children:F===0&&t==="Platinum"?(v??j)>0?"On track via scheduled":`Need ${rs-a+1}+ more XP`:"XP â next cycle"})]}),e.jsxs("div",{className:"bg-white/60 rounded-xl p-3 border border-white",children:[e.jsxs("div",{className:"text-[10px] font-bold uppercase text-blue-500 flex items-center gap-1 mb-1",children:[e.jsx(Ee,{size:10}),"Projected"]}),e.jsx("div",{className:"text-xl font-black text-slate-800",children:v!==null?v:j}),e.jsx("div",{className:"text-[10px] text-slate-500",children:"XP â next cycle"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"h-2.5 bg-slate-200 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 bg-blue-300 rounded-full transition-all duration-500",style:{width:`${Math.min(100,(v??j)/st*100)}%`}}),e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full transition-all duration-500",style:{width:`${Math.min(100,F/st*100)}%`}})]}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-[9px] text-slate-400",children:"0"}),e.jsxs("span",{className:"text-[9px] text-slate-400",children:[st," XP max"]})]})]})]}),o&&(X>0||L>0)&&e.jsxs("div",{className:`p-4 rounded-2xl border ${X>0?"bg-red-50 border-red-100":"bg-amber-50 border-amber-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 flex items-center gap-1",children:[e.jsx(ze,{size:12}),"UXP Waste"]}),e.jsx(_e,{size:14,className:X>0?"text-red-500":"text-amber-500"})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"flex gap-4",children:[X>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-black text-red-600",children:["-",X]}),e.jsx("div",{className:"text-[10px] text-red-600/70 uppercase font-medium",children:"Already lost"})]}),L>0&&L!==X&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-black text-amber-600",children:["-",L]}),e.jsxs("div",{className:"text-[10px] text-amber-600/70 uppercase font-medium flex items-center gap-0.5",children:[e.jsx(Ee,{size:9}),"Projected"]})]})]}),e.jsxs("div",{className:"text-[10px] text-slate-500 text-right max-w-[140px]",children:["UXP above ",Ca," cannot roll over to next cycle"]})]})]}),!o&&(A>0||R>0)&&e.jsxs("div",{className:`p-4 rounded-2xl border ${A>0?"bg-red-50 border-red-100":"bg-amber-50 border-amber-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"XP Waste"}),e.jsx(_e,{size:14,className:A>0?"text-red-500":"text-amber-500"})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"flex gap-4",children:[A>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-black text-red-600",children:["-",A]}),e.jsx("div",{className:"text-[10px] text-red-600/70 uppercase font-medium",children:"Already lost"})]}),R>0&&R!==A&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-black text-amber-600",children:["-",R]}),e.jsxs("div",{className:"text-[10px] text-amber-600/70 uppercase font-medium flex items-center gap-0.5",children:[e.jsx(Ee,{size:9}),"Projected"]})]})]}),e.jsxs("div",{className:"text-[10px] text-slate-500 text-right max-w-[140px]",children:["XP above ",st," cannot roll over after requalification"]})]})]}),o&&X===0&&L===0&&e.jsx("div",{className:"p-4 rounded-2xl bg-emerald-50/50 border border-emerald-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-emerald-100 text-emerald-600",children:e.jsx(je,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-emerald-800",children:"No UXP waste"}),e.jsx("div",{className:"text-[10px] text-emerald-600/70",children:"All earned UXP is being utilized efficiently"})]})]})}),!o&&A===0&&R===0&&f&&e.jsx("div",{className:"p-4 rounded-2xl bg-emerald-50/50 border border-emerald-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-emerald-100 text-emerald-600",children:e.jsx(je,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-emerald-800",children:"No XP waste"}),e.jsx("div",{className:"text-[10px] text-emerald-600/70",children:"All earned XP is being utilized efficiently"})]})]})}),K&&e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-violet-50 to-purple-50/50 border border-violet-100/50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-violet-100 text-violet-600 shrink-0",children:K.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-violet-900",children:K.text}),K.subtext&&e.jsx("div",{className:"text-[11px] text-violet-600/70 mt-0.5",children:K.subtext})]})]})})]})]})},Il=d.lazy(()=>ia(()=>Promise.resolve().then(()=>kr),void 0)),Ll=()=>e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 flex items-center gap-3",children:[e.jsx(Qe,{size:24,className:"animate-spin text-blue-500"}),e.jsx("span",{className:"text-slate-600",children:"Loading..."})]})}),jc=({state:t,navigateTo:s,onPdfImport:a,demoStatus:n})=>{const{format:l}=Ke(),{setViewMode:r}=it(),[i,x]=d.useState(!1),c=d.useMemo(()=>ga(t.milesData,t.currentMonth,t.redemptions,t.targetCPM),[t.milesData,t.currentMonth,t.redemptions,t.targetCPM]),o=d.useMemo(()=>Yt(t.qualificationSettings??null),[t.qualificationSettings]),{cycles:u}=d.useMemo(()=>Lt(t.xpData,t.xpRollover,t.flights,t.manualLedger,o),[t.xpData,t.xpRollover,t.flights,t.manualLedger,o]),m=d.useMemo(()=>us(u),[u]),p=m?.isUltimate??!1,h=m?.actualStatus??"Explorer",b=n??ms(h,p),g=n==="Ultimate"||p,S=m?.actualXP??0,P=t.hasPdfBaseline&&t.displayXP!==void 0?t.displayXP:S,C=Mr(b),w=cl(b,g),f=d.useMemo(()=>{if(!m)return P;const k=m.ledger.reduce((y,U)=>y+(U.xpMonth??0),0),I=m.rolloverIn+k;return Math.max(I,P)},[m,P]),D=f>P,_=Math.min(100,Math.round(P/C*100)),N=Math.max(0,C-P),F=m?.endDate?new Date(m.endDate):new Date,j=new Date,v=Math.max(0,(F.getFullYear()-j.getFullYear())*12+(F.getMonth()-j.getMonth())),A=P>=C,R=A||_>=50&&v>=6||_>=75,X=F.toLocaleDateString("en-US",{month:"long",year:"numeric"}),L=c.netCurrent*t.targetCPM,G=()=>{switch(b){case"Ultimate":return e.jsx(ze,{className:"text-amber-400",size:28});case"Platinum":return e.jsx(le,{className:"text-blue-500 rotate-45",size:28});case"Gold":return e.jsx(le,{className:"text-amber-500 rotate-45",size:28});case"Silver":return e.jsx(le,{className:"text-slate-400 rotate-45",size:28});default:return e.jsx(le,{className:"text-emerald-500 rotate-45",size:28})}};return t.flights.length===0?e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-br from-brand-500 to-blue-600 rounded-3xl p-8 text-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl",children:e.jsx(le,{className:"rotate-45",size:28})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to SkyStatus"})]}),e.jsx("p",{className:"text-white/80 text-lg mb-6",children:"Track your Flying Blue status and see how close you are to your next level."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center gap-2 bg-white text-brand-600 px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all",children:[e.jsx(St,{size:20}),"Import PDF"]}),e.jsxs("button",{onClick:()=>s("addFlight"),className:"flex items-center justify-center gap-2 bg-white/20 text-white px-6 py-3 rounded-xl font-bold border border-white/30 hover:bg-white/30 transition-all",children:[e.jsx(Ta,{size:20}),"Add Flight"]})]})]}),a&&i&&e.jsx(d.Suspense,{fallback:e.jsx(Ll,{}),children:e.jsx(Il,{isOpen:i,onClose:()=>x(!1),onImport:a,existingFlights:t.flights,existingMiles:t.milesData,existingQualificationSettings:t.qualificationSettings,existingStatus:b,existingActiveCycleStart:m?.startDate?.slice(0,7)||null,existingRolloverXP:m?.rolloverIn??null})})]}):e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Status"}),e.jsxs("button",{onClick:()=>r("full"),className:"flex items-center gap-1.5 text-sm font-medium text-slate-500 hover:text-slate-700 transition-colors",children:[e.jsx(Ds,{size:16}),"Full analytics",e.jsx(we,{size:16})]})]}),e.jsxs("div",{className:`relative overflow-hidden rounded-3xl p-6 sm:p-8 shadow-xl border ${g?"bg-slate-800 border-slate-700":"bg-white border-slate-100"}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${w.meshGradient}`}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-2xl ${g?"bg-slate-700":"bg-white/80"} shadow-sm`,children:G()}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-3xl font-black ${w.accentColor}`,children:b}),e.jsxs("p",{className:`text-sm font-medium ${g?"text-slate-400":"text-slate-500"}`,children:["Valid until ",X]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:`text-sm font-semibold ${g?"text-slate-300":"text-slate-600"}`,children:"Your progress"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`text-sm font-bold ${w.accentColor}`,children:[P," / ",C," XP"]}),D&&e.jsxs("span",{className:`text-xs ml-1.5 ${g?"text-slate-400":"text-blue-500"}`,children:["(",f," projected)"]})]})]}),e.jsx("div",{className:`relative w-full h-4 rounded-full overflow-hidden ${g?"bg-slate-700":"bg-slate-100"}`,children:e.jsx("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${w.progressBar} rounded-full transition-all duration-1000`,style:{width:`${_}%`}})}),e.jsx("div",{className:"mt-3",children:A?e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(je,{size:18}),e.jsxs("span",{className:"font-semibold",children:["You've secured ",b," for next year!"]})]}):R?e.jsxs("div",{className:`flex items-center gap-2 ${g?"text-emerald-400":"text-emerald-600"}`,children:[e.jsx(je,{size:18}),e.jsxs("span",{className:"font-semibold",children:["On track â ",N," XP to go",e.jsxs("span",{className:`font-normal ${g?"text-slate-400":"text-slate-500"}`,children:[" â¢ ",v," months left"]})]})]}):e.jsxs("div",{className:`flex items-center gap-2 ${g?"text-amber-400":"text-amber-600"}`,children:[e.jsx(Nt,{size:18}),e.jsxs("span",{className:"font-semibold",children:[N," XP needed",e.jsxs("span",{className:`font-normal ${g?"text-slate-400":"text-slate-500"}`,children:[" â¢ ",v," months left"]})]})]})})]}),e.jsxs("button",{onClick:()=>s("mileageRun"),className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-semibold transition-all ${g?"bg-slate-700 text-white hover:bg-slate-600":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[e.jsx(Je,{size:18}),"Plan flights to reach your goal",e.jsx(we,{size:18})]})]})]}),e.jsxs("button",{onClick:()=>s("miles"),className:"w-full text-left bg-white rounded-2xl border border-slate-100 shadow-sm p-6 hover:border-slate-200 hover:shadow-md transition-all group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-blue-50 rounded-xl group-hover:bg-blue-100 transition-colors",children:e.jsx(Oe,{className:"text-blue-600",size:22})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"Your Miles"})]}),e.jsx(we,{size:18,className:"text-slate-300 group-hover:text-slate-500 transition-colors"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-black text-slate-900",children:ne(c.netCurrent)}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Miles balance"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-black text-emerald-600",children:l(L)}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Estimated value"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center gap-2 bg-slate-100 hover:bg-slate-200 text-slate-700 px-4 py-3 rounded-xl font-semibold transition-all",children:[e.jsx(St,{size:18}),"Import PDF"]}),e.jsxs("button",{onClick:()=>s("addFlight"),className:"flex items-center justify-center gap-2 bg-brand-600 hover:bg-brand-700 text-white px-4 py-3 rounded-xl font-semibold transition-all",children:[e.jsx(Ta,{size:18}),"Add Flight"]})]}),e.jsx("div",{className:"text-center pt-4",children:e.jsx("button",{onClick:()=>r("full"),className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Want more details? Switch to Full View â"})}),a&&i&&e.jsx(d.Suspense,{fallback:e.jsx(Ll,{}),children:e.jsx(Il,{isOpen:i,onClose:()=>x(!1),onImport:a,existingFlights:t.flights,existingMiles:t.milesData,existingQualificationSettings:t.qualificationSettings,existingStatus:b,existingActiveCycleStart:m?.startDate?.slice(0,7)||null,existingRolloverXP:m?.rolloverIn??null})})]})},$l=({state:t,navigateTo:s,onUpdateCurrentMonth:a,onPdfImport:n,demoStatus:l})=>{const{format:r,symbol:i,formatPrecise:x}=Ke(),{isSimpleMode:c}=it(),[o,u]=d.useState(!1),[m,p]=d.useState(t.flights.length>0),[h,b]=d.useState(!1),[g,S]=d.useState(!1);d.useEffect(()=>{t.flights.length>0&&!m&&p(!0)},[t.flights.length,m]),d.useEffect(()=>{Do(),S(Uo())},[]);const P=d.useMemo(()=>ga(t.milesData,t.currentMonth,t.redemptions,t.targetCPM),[t.milesData,t.currentMonth,t.redemptions,t.targetCPM]),C=d.useMemo(()=>Yt(t.qualificationSettings??null),[t.qualificationSettings]),{cycles:w}=d.useMemo(()=>Lt(t.xpData,t.xpRollover,t.flights,t.manualLedger,C),[t.xpData,t.xpRollover,t.flights,t.manualLedger,C]),f=d.useMemo(()=>us(w),[w]),D=f?.isUltimate??!1,_=f?.projectedUltimate??!1,N=l==="Ultimate"||D,F=l==="Ultimate"||_,j=f?.actualStatus??"Explorer",v=f?.projectedStatus??j,A=l??ms(j,D),R=l??vr(v,_),X=f?.actualXP??0,L=t.hasPdfBaseline&&t.displayXP!==void 0?t.displayXP:X;f?.rolloverIn;const G=f?.rolloverOut??0,k=f?.actualUXP??0,I=t.hasPdfBaseline&&t.displayUXP!==void 0?t.displayUXP:k,y=f?.projectedUXP??0,U=N||A==="Platinum"&&L>=600,M=d.useMemo(()=>{if(!f)return 12;const Z=new Date(f.endDate),ee=new Date,T=(Z.getFullYear()-ee.getFullYear())*12+(Z.getMonth()-ee.getMonth());return Math.max(0,T)},[f]),z=d.useMemo(()=>U?gc(I,y,M):null,[U,I,y,M]),K=d.useMemo(()=>{if(!f)return L;const Z=f.ledger.reduce((T,ce)=>T+(ce.xpMonth??0),0),ee=f.rolloverIn+Z;return Math.max(ee,L)},[f,L]),Y=R!==A,O=f?new Date(f.endDate).getFullYear():new Date().getFullYear(),V=cl(A,N),J=Mr(A),q=P.globalCPM/100,B=d.useMemo(()=>[...t.redemptions].sort((Z,ee)=>Z.date<ee.date?1:Z.date>ee.date?-1:0),[t.redemptions]),$=Math.min(100,L/J*100),Q=Math.min(100,K/J*100),oe=t.flights.length===0;if(c)return e.jsx(jc,{state:t,navigateTo:s,onPdfImport:n,demoStatus:l});if((oe||o)&&n&&!m)return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-12",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Welcome to SkyStatus"}),e.jsx("p",{className:"text-slate-500 mt-[2px] font-medium",children:"Track your Flying Blue status and optimize your loyalty strategy"})]})}),e.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-brand-500 to-blue-600 p-8 md:p-12 shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10",children:e.jsx(le,{size:200,className:"text-white rotate-45"})}),e.jsxs("div",{className:"relative z-10 max-w-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm",children:e.jsx(Be,{className:"text-white",size:28})}),e.jsx("span",{className:"text-white/80 font-semibold text-sm uppercase tracking-wider",children:"Get Started"})]}),e.jsx("h3",{className:"text-3xl md:text-4xl font-black text-white mb-4",children:"Import your Flying Blue history"}),e.jsx("p",{className:"text-white/80 text-lg mb-8 leading-relaxed",children:"Download your transaction history PDF from Flying Blue and import it here. We'll automatically extract all your flights, miles, and XP data."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center justify-center gap-3 bg-white text-brand-600 px-8 py-4 rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx(St,{size:22}),"Import PDF"]}),e.jsxs("button",{onClick:()=>s("addFlight"),className:"flex items-center justify-center gap-3 bg-white/20 text-white px-8 py-4 rounded-2xl font-bold text-lg backdrop-blur-sm border border-white/30 hover:bg-white/30 transition-all",children:[e.jsx(Ta,{size:22}),"Add manually"]})]}),e.jsxs("button",{onClick:()=>b(!0),className:"mt-6 flex items-center gap-2 text-white/70 hover:text-white transition-colors text-sm font-medium",children:[e.jsx(vt,{size:16}),"Need help? Read the FAQ"]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 md:p-8 border border-slate-200",children:[e.jsxs("h4",{className:"font-bold text-slate-900 text-lg mb-4 flex items-center gap-2",children:[e.jsx(wt,{size:20,className:"text-brand-500"}),"How to download your Flying Blue PDF"]}),e.jsxs("ol",{className:"space-y-3 text-slate-600",children:[e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("span",{children:["Log in to ",e.jsx("a",{href:"https://www.flyingblue.com",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 font-semibold hover:underline",children:"flyingblue.com"})]})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("span",{children:["Go to ",e.jsx("strong",{children:"My Account"})," â ",e.jsx("strong",{children:"Activity overview"})]})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-amber-700 font-semibold",children:"â ï¸ Important:"})," Click the ",e.jsx("strong",{children:'"More"'})," button repeatedly until ",e.jsx("em",{children:"all"})," your activities are visible on screen. Flying Blue only downloads what's currently displayed!"]})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-sm font-bold",children:"4"}),e.jsxs("span",{children:["Scroll back up and click ",e.jsx("strong",{children:'"Download"'})," to save the PDF"]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-800",children:[e.jsx("strong",{children:"Note:"}),` If you don't click "More" to load all activities first, your PDF will only contain recent transactions and your flight history will be incomplete.`]})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>p(!0),className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Skip for now â view empty dashboard â"})}),n&&e.jsx(As,{isOpen:o,onClose:()=>u(!1),onImport:(Z,ee,T,ce,fe)=>{n?.(Z,ee,T,ce,fe)},existingFlights:t.flights,existingMiles:t.milesData,existingQualificationSettings:t.qualificationSettings,existingStatus:A,existingActiveCycleStart:f?.startDate?.slice(0,7)||null,existingRolloverXP:f?.rolloverIn??null}),e.jsx(Cr,{isOpen:h,onClose:()=>b(!1)})]});const se=e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Command Center"}),e.jsxs("p",{className:"text-slate-500 mt-[2px] font-medium",children:["Loyalty status overview for"," ",e.jsxs("span",{className:"font-bold text-brand-600",children:["CY ",O]})]})]}),e.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[e.jsxs("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-1 flex items-center gap-1.5",children:[e.jsx(et,{size:12}),"Current ledger",e.jsx(me,{text:"Choose the month that matches your Flying Blue activity statement. This controls which XP and miles data is displayed."})]}),e.jsx("input",{type:"month",value:t.currentMonth,onChange:Z=>a(Z.target.value),className:"font-mono text-sm font-bold text-slate-700 bg-white px-3 py-1.5 rounded-lg border border-slate-200 shadow-sm outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 cursor-pointer transition-all hover:border-slate-300"})]})]}),g&&e.jsx(pc,{onDismiss:()=>S(!1)}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8 items-start",children:[e.jsxs("div",{className:"xl:col-span-7 flex flex-col gap-6",children:[e.jsxs("div",{className:`relative overflow-hidden rounded-[2.5rem] pl-10 pr-8 py-8 shadow-xl border ${N?"border-slate-600 bg-slate-800":"border-slate-100 bg-white"}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${V.meshGradient}`}),e.jsx("div",{className:"absolute top-1 right-0 p-12 opacity-10",children:N?e.jsx(ze,{size:180,className:"text-slate-400"}):e.jsx(De,{size:180,className:V.iconColor})}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start mb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(le,{className:`${N?"text-slate-400":V.iconColor} rotate-45`,size:22}),e.jsx("span",{className:"text-xs font-extrabold tracking-widest uppercase text-slate-400",children:"SkyTeam Alliance"})]}),e.jsxs("h3",{className:`text-4xl font-black tracking-tight flex items-center gap-3 ${V.accentColor}`,children:[N?"Ultimate":A,N?e.jsx(ze,{size:32,className:"text-slate-300"}):A==="Platinum"?e.jsx(je,{size:32,className:"text-emerald-500"}):null]}),Y&&!N&&e.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[e.jsx(Ee,{size:12,className:"text-blue-500"}),e.jsxs("span",{className:"text-xs font-bold text-blue-600",children:["Projected: ",R]})]}),F&&!N&&A==="Platinum"&&e.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[e.jsx(ze,{size:12,className:"text-slate-500"}),e.jsx("span",{className:"text-xs font-bold text-slate-600",children:"Projected: Ultimate"})]})]}),e.jsxs("div",{className:`text-xs font-bold uppercase tracking-widest px-3 py-1.5 rounded-full backdrop-blur-sm border ${N?"text-slate-300 bg-slate-800/60 border-slate-600":"text-slate-400/80 bg-white/60 border-white/40"}`,children:[O," cycle"]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-widest mb-2.5 text-slate-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[bc(A,A==="Platinum"),e.jsx(me,{text:"Actual XP earned from flown flights vs. the XP required to maintain or achieve your target status this cycle."})]}),e.jsxs("span",{children:["Target: ",J," XP"]})]}),e.jsxs("div",{className:`relative w-full rounded-full h-[20px] shadow-inner border overflow-hidden ${N?"bg-slate-800 border-slate-700":"bg-white/70 border-white/50"}`,children:[K>L&&e.jsx("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${V.projectedBar} opacity-50 transition-all duration-1000 ease-out`,style:{width:`${Q}%`}}),e.jsx("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${V.progressBar} shadow-md transition-all duration-1000 ease-out`,style:{width:`${$}%`}})]}),e.jsxs("div",{className:"flex justify-between items-end mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-5xl font-black tracking-tighter ${V.accentColor}`,children:L}),e.jsxs("div",{className:"text-xs font-bold uppercase mt-1 ml-1 flex items-center gap-1 text-slate-400",children:["Actual XP",K>L&&e.jsxs("span",{className:`font-medium flex items-center gap-0.5 ${N?"text-amber-400":"text-blue-500"}`,children:[e.jsx(Ee,{size:10}),K," projected"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-2xl font-bold ${V.accentColor}`,children:[Math.min(300,G)," XP"]}),e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Next rollover"})]})]})]}),U&&e.jsxs("div",{className:`mb-6 p-4 rounded-2xl border ${N?"bg-slate-700/30 border-slate-600/30":"bg-gradient-to-r from-slate-50 to-slate-100/50 border-slate-200/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{size:16,className:N?"text-slate-300":"text-slate-600"}),e.jsx("span",{className:`text-xs font-bold uppercase tracking-wide ${N?"text-slate-300":"text-slate-700"}`,children:"Ultimate Progress"}),e.jsx(me,{text:"UXP is earned from KLM and Air France operated flights only. Earn 900 UXP as Platinum to unlock Ultimate status."})]}),e.jsxs("span",{className:`text-sm font-bold ${N?"text-slate-300":"text-slate-700"}`,children:[I," / 900 UXP"]})]}),e.jsxs("div",{className:`relative h-2.5 rounded-full overflow-hidden ${N?"bg-slate-600":"bg-slate-200/50"}`,children:[y>I&&e.jsx("div",{className:"absolute inset-y-0 left-0 bg-slate-400/40 rounded-full transition-all duration-500",style:{width:`${Math.min(y/900*100,100)}%`}}),e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-slate-400 to-slate-300 rounded-full transition-all duration-500",style:{width:`${Math.min(I/900*100,100)}%`}})]}),z&&e.jsxs("div",{className:`mt-3 flex items-center gap-2 ${z.sentiment==="positive"?N?"text-emerald-400":"text-emerald-600":z.sentiment==="neutral"?N?"text-slate-300":"text-slate-600":N?"text-slate-300":"text-blue-600"}`,children:[z.sentiment==="positive"?e.jsx(je,{size:14}):e.jsx(Ie,{size:14}),e.jsx("span",{className:"text-xs font-medium",children:z.message})]})]}),e.jsxs("div",{className:`pt-6 border-t flex items-center justify-between ${N?"border-slate-700":"border-slate-200/60"}`,children:[e.jsxs("div",{className:`flex items-center gap-2 text-xs font-semibold ${N?"text-slate-400":"text-slate-500"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${N?"bg-slate-300":"bg-emerald-500"}`}),e.jsx("span",{children:"Qualification active"})]}),e.jsxs("button",{onClick:()=>s("xp"),className:`flex items-center gap-2 px-6 py-3 rounded-2xl font-bold text-sm transition-all shadow-lg hover:shadow-xl hover:-translate-y-0.5 ${N?"bg-slate-600 text-white hover:bg-slate-500":"bg-blue-900 text-white hover:bg-blue-800"}`,children:["XP Engine",e.jsx(we,{size:16,className:N?"text-slate-300":"text-blue-300"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Ks,{title:"Net miles balance",value:ne(P.netCurrent),subtitle:`Projected: ${ne(P.netProjected)}`,icon:Oe,badgeText:"Accumulating",badgeColor:"blue",tooltip:"Current redeemable Flying Blue miles. Projected balance includes future flights already added to your ledger."}),e.jsx(Ks,{title:"Acquisition cost",value:e.jsxs("span",{className:"font-mono text-[15px] tracking-tight",children:[i,q.toFixed(5)]}),subtitle:"Avg cost per mile",icon:Je,badgeText:"Efficiency",badgeColor:"emerald",tooltip:"Weighted average cost of all miles earned through subscriptions, credit cards, flights and other sources."}),e.jsx(Ks,{title:"Total investment",value:r(P.totalCost),subtitle:"Lifetime spend",icon:le,badgeText:"Portfolio",badgeColor:"violet",tooltip:"Total cash spent on activities that generated Flying Blue miles."}),e.jsx(Ks,{title:"Est. portfolio value",value:r(P.netCurrent*P.targetCPM),subtitle:"At target CPM",icon:Be,badgeText:"Asset",badgeColor:"amber",tooltip:"Hypothetical valuation of your miles based on your chosen target redemption rate."})]})]}),e.jsxs("div",{className:"xl:col-span-5 flex flex-col gap-6",children:[e.jsx(fc,{actualStatus:A,projectedStatus:R,actualXP:L,projectedTotalXP:K,targetXP:J,rolloverOut:G,hasProjectedUpgrade:Y,cycleStartDate:f?.startDate??new Date().toISOString().slice(0,10),cycleEndDate:f?.endDate??new Date().toISOString().slice(0,10),isUltimate:N,actualUXP:I,projectedUXP:y}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 p-6 shadow-sm flex-1 flex flex-col max-h-[600px]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(ci,{size:20,className:"text-slate-400"}),"Recent activity"]}),e.jsx("button",{onClick:()=>s("redemption"),className:"text-xs font-bold text-brand-600 hover:text-brand-700 bg-brand-50 px-3 py-[6px] rounded-lg transition-colors relative top-[1px]",children:"View log"})]}),B.length>0?e.jsx("div",{className:"space-y-3 overflow-y-auto pr-2 custom-scrollbar",children:B.map(Z=>{const ee=Z.award_miles>0?(Z.cash_price_estimate-Z.surcharges)/Z.award_miles:0,T=q>0?ee-q:0,ce=qa(ee,t.targetCPM,q),fe=ce.icon;return e.jsxs("div",{className:"group flex flex-col gap-2 p-4 rounded-2xl bg-white border border-slate-100 shadow-sm hover:border-brand-200 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide truncate block w-full",children:Z.description||"Redemption"})}),e.jsx("div",{className:"text-[11px] font-medium text-slate-400",children:Z.date})]}),e.jsxs("div",{className:"text-right font-mono font-bold text-base text-slate-900 whitespace-nowrap",children:[i,ee.toFixed(4)]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1 pt-2 border-t border-slate-50",children:[e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider ${ce.color}`,children:[e.jsx(fe,{size:12}),ce.label]}),e.jsxs("div",{className:`text-[9px] font-bold ${T>=0?"text-emerald-600":"text-orange-500"}`,children:[T>=0?"+":"",T.toFixed(4)," vs base"]})]})]},Z.id)})}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400 py-8 border-2 border-dashed border-slate-100 rounded-2xl bg-slate-50/50",children:[e.jsx(le,{className:"text-slate-300 opacity-50 mb-2",size:32}),e.jsx("span",{className:"text-xs font-medium",children:"No redemptions logged"})]})]})]})]})]});return e.jsxs(e.Fragment,{children:[se,n&&e.jsx(As,{isOpen:o,onClose:()=>u(!1),onImport:(Z,ee,T,ce,fe)=>{n(Z,ee,T,ce,fe)},existingFlights:t.flights,existingMiles:t.milesData,existingQualificationSettings:t.qualificationSettings,existingStatus:A,existingActiveCycleStart:f?.startDate?.slice(0,7)||null,existingRolloverXP:f?.rolloverIn??null})]})},jt="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",Ol=({title:t,count:s,totalMiles:a,isExpanded:n,onToggle:l,variant:r="default"})=>{const i=r==="projected"?"bg-indigo-50/50 hover:bg-indigo-50":r==="past"?"bg-slate-50/50 hover:bg-slate-100/50":"bg-slate-50 hover:bg-slate-100";return e.jsx("tr",{className:`${i} cursor-pointer transition-colors`,onClick:l,children:e.jsx("td",{colSpan:8,className:"px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n?e.jsx(nt,{size:14,className:"text-slate-400"}):e.jsx(we,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-[11px] font-bold text-slate-600",children:t}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["(",s," months)"]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("span",{className:`text-[10px] font-medium ${a>=0?"text-emerald-600":"text-red-500"}`,children:[a>=0?"+":"",ne(a)," miles"]})})]})})})},Ys=({row:t,isProjected:s,isCurrent:a,isEditing:n,editForm:l,setEditForm:r,onStartEdit:i,onSaveEdit:x,onCancelEdit:c,onDelete:o,showBalance:u,compact:m})=>{const p=t.net,h=t.prevBalance&&t.prevBalance>0?p/t.prevBalance*100:0;if(n)return e.jsxs("tr",{className:"bg-blue-50/50",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"month",className:`w-full p-1.5 border rounded-lg text-[11px] ${jt}`,value:l.month,onChange:g=>r({...l,month:g.target.value})})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border rounded-lg text-[11px] text-right ${jt}`,value:l.miles_subscription,onChange:g=>r({...l,miles_subscription:Number(g.target.value)})})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border rounded-lg text-[11px] text-right ${jt}`,value:l.miles_amex,onChange:g=>r({...l,miles_amex:Number(g.target.value)})})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border rounded-lg text-[11px] text-right bg-slate-50 text-slate-400 ${jt}`,value:l.miles_flight,disabled:!0,title:"Edit via Flight Engine"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border rounded-lg text-[11px] text-right ${jt}`,value:l.miles_other,onChange:g=>r({...l,miles_other:Number(g.target.value)})})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border border-red-200 rounded-lg text-[11px] text-right text-red-600 font-bold ${jt}`,value:l.miles_debit,onChange:g=>r({...l,miles_debit:Number(g.target.value)})})}),u&&e.jsx("td",{className:"px-3 py-2"}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx("button",{onClick:x,className:"px-2 py-1 bg-emerald-500 text-white rounded-md text-[10px] font-bold hover:bg-emerald-600",children:e.jsx(xa,{size:12})}),e.jsx("button",{onClick:c,className:"px-2 py-1 bg-slate-200 text-slate-600 rounded-md text-[10px] font-bold hover:bg-slate-300",children:e.jsx(Ce,{size:12})})]})})]});const b=m?"py-2":"py-2.5";return e.jsxs("tr",{className:`group hover:bg-slate-50 transition-colors ${a?"bg-gradient-to-r from-blue-50/80 to-transparent":""}`,children:[e.jsx("td",{className:`px-3 ${b}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-mono text-[11px] ${s?"text-slate-400":"text-slate-700 font-medium"}`,children:t.month}),a&&e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500 text-white text-[8px] font-bold uppercase rounded",children:"Current"}),s&&e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-200 text-slate-500 text-[8px] font-bold uppercase rounded",children:"Proj"})]})}),e.jsx("td",{className:`px-3 ${b} text-right font-mono text-[11px] ${s?"text-slate-400 italic":"text-indigo-600/80"}`,children:t.miles_subscription>0?ne(t.miles_subscription):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-3 ${b} text-right font-mono text-[11px] ${s?"text-slate-400 italic":"text-blue-600/80"}`,children:t.miles_amex>0?ne(t.miles_amex):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-3 ${b} text-right font-mono text-[11px] ${s?"text-slate-400 italic":"text-slate-600"}`,children:t.miles_flight>0?ne(t.miles_flight):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-3 ${b} text-right font-mono text-[11px] ${s?"text-slate-400 italic":"text-slate-600"}`,children:t.miles_other>0?ne(t.miles_other):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-3 ${b} text-right font-mono text-[11px]`,children:t.miles_debit>0?e.jsxs("span",{className:"text-red-500 font-medium",children:["-",ne(t.miles_debit)]}):e.jsx("span",{className:"text-slate-300",children:"-"})}),u&&e.jsx("td",{className:`px-3 ${b}`,children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:`font-mono font-bold text-[11px] ${s?"text-blue-400":"text-blue-600"}`,children:ne(t.runningBalance)}),p!==0&&!s&&h>0&&e.jsxs("span",{className:`text-[9px] font-bold px-1 py-0.5 rounded ${p>0?"bg-emerald-50 text-emerald-600":"bg-red-50 text-red-500"}`,children:["+",h.toFixed(0),"%"]})]})}),e.jsx("td",{className:`px-3 ${b} text-center`,children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex justify-center gap-1",children:[e.jsx("button",{onClick:i,className:"p-1 hover:bg-white rounded-md text-slate-400 hover:text-blue-600 transition-colors",children:e.jsx(Kt,{size:12})}),e.jsx("button",{onClick:o,className:"p-1 hover:bg-white rounded-md text-slate-400 hover:text-red-600 transition-colors",children:e.jsx(ss,{size:12})})]})})]})},Fr=({data:t,onUpdate:s,currentMonth:a,variant:n="full",showQuickStats:l=!0,showAddButton:r=!1,onAddMonth:i,title:x="Transaction Ledger",subtitle:c="Detailed record of all accumulation and redemption."})=>{const{format:o}=Ke(),[u,m]=d.useState(null),[p,h]=d.useState({}),[b,g]=d.useState(!1),[S,P]=d.useState(!1),[C,w]=d.useState(()=>new Set(t.map(L=>L.month.slice(0,4)))),f=n==="compact",D=n==="full",_=a||new Date().toISOString().slice(0,7),N=d.useMemo(()=>{let X=0,L=0;const G=t.slice().sort((O,V)=>O.month.localeCompare(V.month)).map(O=>{const V=O.miles_subscription+O.miles_amex+O.miles_flight+O.miles_other,J=O.cost_subscription+O.cost_amex+O.cost_flight+O.cost_other,q=V-O.miles_debit;return L=X,X+=q,{...O,totalEarned:V,totalCost:J,net:q,runningBalance:X,prevBalance:L}}),k=parseInt(_.slice(5,7)),I=_.slice(0,4),y=G.find(O=>O.month===_),U=G.filter(O=>{if(O.month>=_)return!1;const V=O.month.slice(0,4),J=parseInt(O.month.slice(5,7));return V===I?k-J<=2&&k-J>0:V===String(parseInt(I)-1)&&k<=2?k+(12-J)<=2:!1}).slice(-2),M=G.filter(O=>O.month>=_?!1:!U.includes(O)),z=G.filter(O=>O.month>_),K=M.reduce((O,V)=>O+V.net,0),Y=z.reduce((O,V)=>O+V.net,0);return{currentRow:y,recentMonths:U,earlierMonths:M,projectedMonths:z,earlierTotal:K,projectedTotal:Y,allRows:G}},[t,_]),F=d.useMemo(()=>{const L=t.filter(y=>y.month<=_).map(y=>y.miles_subscription+y.miles_amex+y.miles_flight+y.miles_other-y.miles_debit),G=L.length>0?L.reduce((y,U)=>y+U,0)/L.length:0,k=Math.max(...L,0),I=[...L].reverse().findIndex(y=>y<=0);return{avgMonthly:G,bestMonth:k,positiveStreak:I===-1?L.length:I}},[t,_]),j=X=>{window.confirm("Delete this month record?")&&s(t.filter(L=>L.id!==X))},v=X=>{m(X.id),h({...X})},A=()=>{m(null),h({})},R=()=>{s(t.map(X=>X.id===u?{...X,...p}:X)),m(null)};if(f){const X=[...N.allRows].sort((I,y)=>y.month.localeCompare(I.month)),L=X.reduce((I,y)=>{const U=y.month.slice(0,4);return I[U]||(I[U]=[]),I[U].push(y),I},{}),G=Object.keys(L).sort((I,y)=>y.localeCompare(I)),k=G.reduce((I,y)=>{const U=L[y];return I[y]={earned:U.reduce((M,z)=>M+z.miles_subscription+z.miles_amex+z.miles_flight+z.miles_other,0),debit:U.reduce((M,z)=>M+z.miles_debit,0),cost:U.reduce((M,z)=>M+z.totalCost,0)},I},{});return e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{size:18,className:"text-slate-400"}),e.jsx("h3",{className:"font-bold text-slate-800",children:x})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-600 border border-indigo-100",children:[X.length," months"]})})]}),G.length>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>w(new Set(G)),className:"text-[10px] font-semibold px-2 py-1 rounded text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",children:"Expand all"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("button",{onClick:()=>w(new Set),className:"text-[10px] font-semibold px-2 py-1 rounded text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",children:"Collapse all"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold text-[9px] uppercase tracking-wider border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 w-28",children:"Month"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Sub"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Amex"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Flights"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Other"}),e.jsx("th",{className:"px-4 py-3 text-right text-red-400",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Cost"}),e.jsx("th",{className:"px-4 py-3 w-20"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:G.map(I=>{const y=L[I],U=C.has(I),M=k[I];return e.jsxs(Ue.Fragment,{children:[e.jsx("tr",{className:"bg-slate-100/80 cursor-pointer hover:bg-slate-100 transition-colors border-y border-slate-200",onClick:()=>{w(z=>{const K=new Set(z);return K.has(I)?K.delete(I):K.add(I),K})},children:e.jsx("td",{colSpan:8,className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[U?e.jsx(nt,{size:16,className:"text-slate-400"}):e.jsx(we,{size:16,className:"text-slate-400"}),e.jsx(et,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"font-bold text-slate-700",children:I})]}),e.jsxs("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-slate-200 text-slate-600",children:[y.length," months"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-slate-400 mr-1",children:"Earned:"}),e.jsxs("span",{className:"font-bold text-emerald-600",children:["+",ne(M.earned)]})]}),M.debit>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-slate-400 mr-1",children:"Spent:"}),e.jsxs("span",{className:"font-bold text-red-500",children:["-",ne(M.debit)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-slate-400 mr-1",children:"Cost:"}),e.jsx("span",{className:"font-bold text-slate-600",children:o(M.cost)})]})]})]})})}),U&&y.map(z=>{const K=u===z.id,Y=z.month===_,O=z.month>_,V=new Date(z.month+"-01").toLocaleDateString("en-US",{month:"short"});return K?e.jsxs("tr",{className:"bg-blue-50/50",children:[e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:"font-mono text-[11px] font-bold text-slate-700",children:V})}),e.jsx("td",{className:"px-2 py-1.5",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border border-slate-200 rounded-lg text-[11px] text-right focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${jt}`,value:p.miles_subscription,onChange:J=>h({...p,miles_subscription:Number(J.target.value)})})}),e.jsx("td",{className:"px-2 py-1.5",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border border-slate-200 rounded-lg text-[11px] text-right focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${jt}`,value:p.miles_amex,onChange:J=>h({...p,miles_amex:Number(J.target.value)})})}),e.jsx("td",{className:"px-2 py-1.5",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border border-slate-200 rounded-lg text-[11px] text-right bg-slate-50 text-slate-400 ${jt}`,value:p.miles_flight,disabled:!0,title:"Managed via flights"})}),e.jsx("td",{className:"px-2 py-1.5",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border border-slate-200 rounded-lg text-[11px] text-right focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${jt}`,value:p.miles_other,onChange:J=>h({...p,miles_other:Number(J.target.value)})})}),e.jsx("td",{className:"px-2 py-1.5",children:e.jsx("input",{type:"number",className:`w-full p-1.5 border border-red-200 rounded-lg text-[11px] text-right text-red-600 focus:outline-none focus:ring-2 focus:ring-red-100 focus:border-red-400 ${jt}`,value:p.miles_debit,onChange:J=>h({...p,miles_debit:Number(J.target.value)})})}),e.jsx("td",{className:"px-4 py-2.5 text-[10px] text-slate-400 text-right",children:"Auto"}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:R,className:"p-1.5 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:e.jsx(xa,{size:12})}),e.jsx("button",{onClick:A,className:"p-1.5 bg-slate-200 text-slate-600 rounded-lg hover:bg-slate-300 transition-colors",children:e.jsx(Ce,{size:12})})]})})]},z.id):e.jsxs("tr",{className:`transition-colors group ${O?"bg-blue-50/20":"hover:bg-slate-50/50"} ${Y?"bg-gradient-to-r from-blue-50/80 to-transparent":""}`,children:[e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium text-xs ${O?"text-slate-400":"text-slate-700"}`,children:V}),Y&&e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded bg-blue-500 text-white text-[8px] font-bold uppercase",children:"Now"}),O&&e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded bg-slate-200 text-slate-500 text-[8px] font-bold uppercase",children:"Proj"})]})}),e.jsx("td",{className:`px-4 py-2.5 text-right font-mono text-[11px] ${O?"text-slate-400":"text-indigo-600"}`,children:z.miles_subscription>0?ne(z.miles_subscription):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-4 py-2.5 text-right font-mono text-[11px] ${O?"text-slate-400":"text-blue-600"}`,children:z.miles_amex>0?ne(z.miles_amex):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-4 py-2.5 text-right font-mono text-[11px] ${O?"text-slate-400":"text-slate-600"}`,children:z.miles_flight>0?ne(z.miles_flight):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:`px-4 py-2.5 text-right font-mono text-[11px] ${O?"text-slate-400":"text-slate-600"}`,children:z.miles_other>0?ne(z.miles_other):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:"px-4 py-2.5 text-right font-mono text-[11px]",children:z.miles_debit>0?e.jsxs("span",{className:"text-red-500 font-medium",children:["-",ne(z.miles_debit)]}):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:"px-4 py-2.5 text-right font-mono text-[10px] text-slate-500",children:z.totalCost>0?o(z.totalCost):e.jsx("span",{className:"text-slate-300",children:"-"})}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>v(z),className:"p-1 rounded-lg text-slate-300 hover:text-blue-600 hover:bg-blue-50 transition-colors opacity-0 group-hover:opacity-100",title:"Edit entry",children:e.jsx(Kt,{size:14})}),e.jsx("button",{onClick:()=>j(z.id),className:"p-1 rounded-lg text-slate-300 hover:text-red-500 hover:bg-red-50 transition-colors opacity-0 group-hover:opacity-100",title:"Delete entry",children:e.jsx(ss,{size:14})})]})})]},z.id)})]},I)})})]})})]})}return e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 flex flex-col sm:flex-row sm:items-center justify-between gap-3 bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[x,e.jsx(me,{text:"Detailed record of accumulated (inflow) and spent (outflow) miles per month."})]}),l&&e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Avg: ",e.jsxs("span",{className:"font-bold text-slate-600",children:[ne(Math.round(F.avgMonthly)),"/mo"]})]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Best: ",e.jsx("span",{className:"font-bold text-emerald-600",children:ne(F.bestMonth)})]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Streak: ",e.jsxs("span",{className:"font-bold text-blue-600",children:[F.positiveStreak," mo"]})]})]}),!l&&c&&e.jsx("p",{className:"text-[11px] text-slate-400 mt-0.5",children:c})]}),r&&i&&e.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 bg-slate-900 text-white px-3 py-1.5 rounded-lg text-[11px] font-bold hover:bg-slate-800 transition-colors shadow-sm",children:[e.jsx(ks,{size:12})," Add Month"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs text-left",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold text-[9px] uppercase tracking-wider border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2.5 w-32",children:"Month"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Sub"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Amex"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Flights"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Other"}),e.jsx("th",{className:"px-3 py-2.5 text-right text-red-400",children:"Debit"}),D&&e.jsx("th",{className:"px-3 py-2.5 text-right text-blue-500",children:"Balance"}),e.jsx("th",{className:"px-3 py-2.5 w-20 text-center",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-50",children:[N.earlierMonths.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ol,{title:`Earlier in ${N.earlierMonths[0]?.month.slice(0,4)||""}`,count:N.earlierMonths.length,totalMiles:N.earlierTotal,isExpanded:b,onToggle:()=>g(!b),variant:"past"}),b&&N.earlierMonths.map(X=>e.jsx(Ys,{row:X,isProjected:!1,isCurrent:!1,isEditing:u===X.id,editForm:p,setEditForm:h,onStartEdit:()=>v(X),onSaveEdit:R,onCancelEdit:A,onDelete:()=>j(X.id),showBalance:D,compact:f},X.id))]}),N.recentMonths.map(X=>e.jsx(Ys,{row:X,isProjected:!1,isCurrent:!1,isEditing:u===X.id,editForm:p,setEditForm:h,onStartEdit:()=>v(X),onSaveEdit:R,onCancelEdit:A,onDelete:()=>j(X.id),showBalance:D,compact:f},X.id)),N.currentRow&&e.jsx(Ys,{row:N.currentRow,isProjected:!1,isCurrent:!0,isEditing:u===N.currentRow.id,editForm:p,setEditForm:h,onStartEdit:()=>v(N.currentRow),onSaveEdit:R,onCancelEdit:A,onDelete:()=>j(N.currentRow.id),showBalance:D,compact:f},N.currentRow.id),N.projectedMonths.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ol,{title:"Projected",count:N.projectedMonths.length,totalMiles:N.projectedTotal,isExpanded:S,onToggle:()=>P(!S),variant:"projected"}),S&&N.projectedMonths.map(X=>e.jsx(Ys,{row:X,isProjected:!0,isCurrent:!1,isEditing:u===X.id,editForm:p,setEditForm:h,onStartEdit:()=>v(X),onSaveEdit:R,onCancelEdit:A,onDelete:()=>j(X.id),showBalance:D,compact:f},X.id))]})]})]})})]})},Gl="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",yc=({data:t,currentMonth:s})=>{const a=t.filter(r=>r.month<=s).slice(-12),l=a.length>1&&a[a.length-1].cpmActual<a[0].cpmActual?"#10b981":"#3b82f6";return e.jsx("div",{className:"h-16 w-full mt-4 opacity-80",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(tl,{data:a,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCpm",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:l,stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:l,stopOpacity:0})]})}),e.jsx(sl,{type:"monotone",dataKey:"cpmActual",stroke:l,strokeWidth:2,fillOpacity:1,fill:"url(#colorCpm)"})]})})})},Nc=({cost:t,value:s})=>{const{format:a}=Ke(),n=Math.max(t,s)*1.1,l=[{name:"Cost",amount:t,fill:"#94a3b8"},{name:"Value",amount:s,fill:"#6366f1"}];return e.jsx("div",{className:"h-20 w-full mt-2",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(ua,{data:l,layout:"vertical",barSize:10,margin:{top:0,right:40,left:0,bottom:0},children:[e.jsx(Xt,{type:"number",hide:!0,domain:[0,n]}),e.jsx(Et,{type:"category",dataKey:"name",tick:{fontSize:10,fontWeight:"bold",fill:"#64748b"},width:40,tickLine:!1,axisLine:!1}),e.jsx(ft,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)",fontSize:"12px"},formatter:r=>a(r)}),e.jsx(Dt,{dataKey:"amount",radius:[0,4,4,0],background:{fill:"#f1f5f9",radius:[0,4,4,0]}})]})})})},vc=({source:t,targetCPM:s})=>{const{symbol:a}=Ke(),n=m=>`${a}${m.toFixed(4)}`,l=t.cpm===0&&t.miles>0,r=t.cpm>0&&t.cpm<=s,i=t.cpm>s&&t.cpm<=s*1.5,x=t.cpm>0?s/t.cpm*100:l?200:0,c=Math.min(100,x),o=l||r?"bg-emerald-500":i?"bg-amber-500":"bg-red-400",u=l||r?"text-emerald-600":i?"text-amber-600":"text-red-500";return e.jsxs("div",{className:"p-3 bg-slate-50/50 rounded-xl border border-slate-100 hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:t.label}),e.jsx("div",{className:`font-mono font-bold text-xs ${u}`,children:n(t.cpm)})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm",children:ne(t.miles)}),e.jsx("div",{className:"text-[10px] text-slate-400",children:"miles"})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${o} rounded-full transition-all duration-700 ease-out`,style:{width:`${c}%`}})}),e.jsx("div",{className:"flex justify-between items-center mt-1",children:l?e.jsx("span",{className:"text-[9px] text-emerald-600 font-semibold",children:"Free acquisition â"}):r?e.jsx("span",{className:"text-[9px] text-emerald-600 font-medium",children:"Below target â"}):e.jsxs("span",{className:"text-[9px] text-slate-400",children:[Math.round(x),"% efficiency"]})})]})},Kl=({title:t,value:s,subtitle:a,icon:n,trend:l,trendLabel:r,color:i="blue",tooltip:x,children:c})=>{const o={blue:"bg-blue-50 text-blue-700 border-blue-100",emerald:"bg-emerald-50 text-emerald-700 border-emerald-100",violet:"bg-violet-50 text-violet-700 border-violet-100",amber:"bg-amber-50 text-amber-700 border-amber-100"},u=o[i]||o.blue;return e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] border border-slate-100 shadow-sm relative group z-0 hover:z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:`p-2.5 rounded-xl ${u} transition-transform group-hover:scale-110 duration-300`,children:e.jsx(n,{size:20})}),l&&e.jsxs("div",{className:"flex items-center gap-1 text-[9px] font-bold uppercase tracking-wider bg-slate-50 px-2 py-1 rounded-lg border border-slate-100 text-slate-500",children:[l==="up"?e.jsx(Ie,{size:10,className:"text-emerald-500"}):e.jsx(Za,{size:10,className:"text-blue-500"}),r]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:t}),x&&e.jsx(me,{text:x})]}),e.jsx("div",{className:"text-2xl font-black text-slate-900 tracking-tight mb-0.5",children:s}),e.jsx("p",{className:"text-[11px] font-medium text-slate-400",children:a})]}),c]})},wc=({record:t,onSave:s,onClose:a})=>{const{symbol:n}=Ke(),[l,r]=d.useState({miles_subscription:t.miles_subscription,miles_amex:t.miles_amex,miles_other:t.miles_other,cost_subscription:t.cost_subscription,cost_amex:t.cost_amex,cost_other:t.cost_other}),i=c=>{const[o,u]=c.split("-");return new Date(parseInt(o),parseInt(u)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})},x=c=>{c.preventDefault(),s({...t,...l})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-100",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Edit Miles"}),e.jsx("p",{className:"text-xs text-slate-500",children:i(t.month)})]}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-slate-100 rounded-lg",children:e.jsx(Ce,{size:20,className:"text-slate-400"})})]}),e.jsxs("form",{onSubmit:x,className:"p-5 space-y-5",children:[e.jsxs("div",{className:"bg-indigo-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-700 font-medium text-sm",children:[e.jsx(Bs,{size:16}),"Subscription"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Miles"}),e.jsx("input",{type:"number",value:l.miles_subscription||"",onChange:c=>r(o=>({...o,miles_subscription:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-slate-500 mb-1",children:["Cost (",n,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.cost_subscription||"",onChange:c=>r(o=>({...o,cost_subscription:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 font-medium text-sm",children:[e.jsx(Bt,{size:16}),"Credit Card / Amex"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Miles"}),e.jsx("input",{type:"number",value:l.miles_amex||"",onChange:c=>r(o=>({...o,miles_amex:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-slate-500 mb-1",children:["Cost (",n,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.cost_amex||"",onChange:c=>r(o=>({...o,cost_amex:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-700 font-medium text-sm",children:[e.jsx(Cs,{size:16}),"Other / Bonus"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Miles"}),e.jsx("input",{type:"number",value:l.miles_other||"",onChange:c=>r(o=>({...o,miles_other:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-slate-500 mb-1",children:["Cost (",n,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.cost_other||"",onChange:c=>r(o=>({...o,cost_other:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 py-2.5 border border-slate-200 rounded-xl font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700",children:"Save Changes"})]})]})]})})},Sc=({data:t,onUpdate:s,currentMonth:a,redemptions:n,targetCPM:l})=>{const{setViewMode:r}=it(),{format:i}=Ke(),[x,c]=d.useState(null),o=d.useMemo(()=>ga(t,a,n,l),[t,a,n,l]),u=d.useMemo(()=>[...t].sort((P,C)=>C.month.localeCompare(P.month)).slice(0,6).map(P=>{const C=P.miles_subscription+P.miles_amex+P.miles_flight+P.miles_other-P.miles_debit;return{record:P,month:P.month,total:C,flights:P.miles_flight,amex:P.miles_amex,subscription:P.miles_subscription,other:P.miles_other,burned:P.miles_debit}}).filter(P=>P.total!==0||P.burned>0),[t]),m=d.useMemo(()=>[...n].sort((S,P)=>P.month.localeCompare(S.month)).slice(0,3),[n]),p=o.netCurrent*l,h=o.netProjected*l,b=S=>{const[P,C]=S.split("-");return new Date(parseInt(P),parseInt(C)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})},g=S=>{s(t.map(P=>P.id===S.id?S:P)),c(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 max-w-3xl mx-auto pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Miles Balance"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Your Flying Blue miles overview"})]}),e.jsxs("button",{onClick:()=>r("full"),className:"flex items-center gap-1.5 text-sm font-medium text-slate-500 hover:text-slate-700 transition-colors",children:[e.jsx(Ds,{size:16}),"Full details",e.jsx(we,{size:16})]})]}),e.jsxs("div",{className:"relative overflow-hidden rounded-3xl p-6 sm:p-8 bg-gradient-to-br from-blue-600 to-indigo-700 shadow-xl",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,...')] opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-32 -mt-32"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:e.jsx(Oe,{className:"text-white",size:20})}),e.jsx("span",{className:"text-blue-100 text-sm font-medium",children:"Flying Blue Balance"})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("h3",{className:"text-5xl font-black text-white tracking-tight",children:ne(o.netCurrent)}),e.jsx("span",{className:"text-xl text-blue-200 font-medium",children:"Miles"})]}),o.netProjected>o.netCurrent&&e.jsxs("p",{className:"text-blue-200 text-sm flex items-center gap-1",children:[e.jsx(Ie,{size:14}),ne(o.netProjected)," projected"]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-white/20 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-200 text-xs font-medium mb-1",children:"Estimated Value"}),e.jsx("p",{className:"text-white text-xl font-bold",children:i(p)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-blue-200 text-xs font-medium mb-1",children:"Projected Value"}),e.jsx("p",{className:"text-white text-xl font-bold",children:i(h)})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg",children:e.jsx(Ie,{className:"text-emerald-600",size:16})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"Total Earned"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:ne(o.earnedAll||0)}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"All time"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-red-50 rounded-lg",children:e.jsx(Ps,{className:"text-red-500",size:16})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"Total Redeemed"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:ne(o.redeemedMiles||0)}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"All time"})]})]}),u.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Be,{size:18,className:"text-amber-500"}),"Recent Activity"]}),e.jsx("span",{className:"text-xs text-slate-400",children:"Tap to edit"})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:u.map(S=>e.jsxs("button",{onClick:()=>c(S.record),className:"w-full px-5 py-4 text-left hover:bg-slate-50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"font-semibold text-slate-900 flex items-center gap-2",children:[e.jsx(et,{size:14,className:"text-slate-400"}),b(S.month)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-bold ${S.total>=0?"text-emerald-600":"text-red-500"}`,children:[S.total>=0?"+":"",ne(S.total)]}),e.jsx(Kt,{size:14,className:"text-slate-300 group-hover:text-slate-500 transition-colors"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[S.flights>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-lg",children:[e.jsx(le,{size:12,className:"rotate-45"}),ne(S.flights)," flights"]}),S.amex>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-slate-100 text-slate-700 px-2 py-1 rounded-lg",children:[e.jsx(Bt,{size:12}),ne(S.amex)," Amex"]}),S.subscription>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-indigo-50 text-indigo-700 px-2 py-1 rounded-lg",children:[e.jsx(Bs,{size:12}),ne(S.subscription)," subscription"]}),S.other>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-amber-50 text-amber-700 px-2 py-1 rounded-lg",children:[e.jsx(Cs,{size:12}),ne(S.other)," other"]}),S.burned>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-red-50 text-red-600 px-2 py-1 rounded-lg",children:[e.jsx(Ps,{size:12}),"-",ne(S.burned)," redeemed"]})]})]},S.month))})]}),m.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b border-slate-100",children:e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Cs,{size:18,className:"text-indigo-500"}),"Recent Redemptions"]})}),e.jsx("div",{className:"divide-y divide-slate-100",children:m.map(S=>e.jsxs("div",{className:"px-5 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:S.description}),e.jsx("p",{className:"text-xs text-slate-500",children:new Date(S.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-red-500",children:["-",ne(S.miles_redeemed||0)]}),S.estimated_value&&S.estimated_value>0&&e.jsxs("p",{className:"text-xs text-slate-400",children:[i(S.estimated_value)," value"]})]})]},S.id))})]}),u.length===0&&m.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-8 text-center",children:[e.jsx(Oe,{size:40,className:"text-slate-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:"No miles activity yet"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Import your Flying Blue PDF or add miles manually"})]}),e.jsx("div",{className:"text-center pt-4",children:e.jsx("button",{onClick:()=>r("full"),className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Need CPM analysis or detailed charts? Switch to Full View â"})})]}),x&&e.jsx(wc,{record:x,onSave:g,onClose:()=>c(null)})]})},Pc=({data:t,onUpdate:s,currentMonth:a,onUpdateCurrentMonth:n,targetCPM:l,onUpdateTargetCPM:r,redemptions:i})=>{const{isSimpleMode:x}=it(),{format:c,symbol:o}=Ke(),u=Number.isFinite(l)?l:0,m=j=>`${o}${j.toFixed(4)}`,[p,h]=d.useState(()=>localStorage.getItem("skystatus_valuation_guide_expanded")==="true"),b=()=>{const j=!p;h(j),localStorage.setItem("skystatus_valuation_guide_expanded",String(j))},g=d.useMemo(()=>ga(t,a,i,u),[t,a,i,u]),S=d.useMemo(()=>{const j=t.reduce((v,A)=>(v.subscription.miles+=A.miles_subscription,v.subscription.cost+=A.cost_subscription,v.amex.miles+=A.miles_amex,v.amex.cost+=A.cost_amex,v.flights.miles+=A.miles_flight,v.flights.cost+=A.cost_flight,v.other.miles+=A.miles_other,v.other.cost+=A.cost_other,v),{subscription:{miles:0,cost:0},amex:{miles:0,cost:0},flights:{miles:0,cost:0},other:{miles:0,cost:0}});return[{key:"subscription",label:"Subscription",...j.subscription},{key:"amex",label:"Amex / Cards",...j.amex},{key:"flights",label:"Flying",...j.flights},{key:"other",label:"Other",...j.other}].map(v=>({...v,cpm:v.miles>0?v.cost/v.miles:0}))},[t]),P=d.useMemo(()=>{let j=0;return t.slice().sort((v,A)=>v.month.localeCompare(A.month)).map(v=>{const A=v.miles_subscription+v.miles_amex+v.miles_flight+v.miles_other,R=v.cost_subscription+v.cost_amex+v.cost_flight+v.cost_other,X=A>0?R/A:0,L=v.month>a;return j+=A-v.miles_debit,{month:v.month,isProjected:L,earnedActual:L?0:A,earnedProjected:L?A:0,redeemed:v.miles_debit,cpmActual:v.month<=a?X:null,cpmProjected:v.month>=a?X:null,runningBalance:j}})},[t,a]),C=()=>{const j={id:ba(),month:new Date().toISOString().slice(0,7),miles_subscription:0,miles_amex:0,miles_flight:0,miles_other:0,miles_debit:0,cost_subscription:0,cost_amex:0,cost_flight:0,cost_other:0};s([...t,j])},w=()=>{const j=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),v=document.createElement("a");v.href=URL.createObjectURL(j),v.download="miles_ledger.json",v.click()},f=j=>{const v=j.target.files?.[0];if(v){const A=new FileReader;A.onload=R=>{try{const X=JSON.parse(R.target?.result);Array.isArray(X)&&s(X)}catch{alert("Invalid JSON")}},A.readAsText(v)}},D=g.netProjected>0?g.netCurrent/g.netProjected*100:0,_=g.netProjected*l,N=g.totalBurnValue>0?g.totalBurnValue:_,F=g.globalCPM/100;return x?e.jsx(Sc,{data:t,onUpdate:s,currentMonth:a,redemptions:i,targetCPM:l}):e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 pb-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-end gap-4 border-b border-slate-100 pb-5",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"Miles Engine"}),e.jsx("p",{className:"text-slate-500 mt-0.5 text-sm font-medium",children:"Financial backbone of your loyalty portfolio"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl px-3 py-2 flex flex-col shadow-sm",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wide",children:"Current Ledger"}),e.jsx("input",{type:"month",value:a,onChange:j=>n(j.target.value),className:"text-sm font-bold text-slate-800 outline-none bg-transparent cursor-pointer"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white border border-indigo-200 rounded-xl px-3 py-2 flex flex-col shadow-sm w-36 group hover:border-indigo-300 hover:shadow-md transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-[9px] font-bold text-indigo-500 uppercase tracking-wide flex items-center gap-1",children:[e.jsx(Be,{size:10}),"Target CPM"]}),e.jsx(me,{text:"How much is a mile worth to you? This affects all value calculations. Scroll down to 'How do you value a mile?' for presets and guidance."})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-indigo-400 font-medium",children:o}),e.jsx("input",{type:"number",step:"0.001",value:l,onChange:j=>r(parseFloat(j.target.value)),className:`text-sm font-bold text-indigo-700 outline-none bg-transparent w-full ${Gl}`})]})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-white border border-slate-200 p-1 rounded-xl shadow-sm",children:[e.jsxs("label",{className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-lg cursor-pointer transition-all",children:[e.jsx(St,{size:16}),e.jsx("input",{type:"file",className:"hidden",accept:".json",onChange:f})]}),e.jsx("button",{onClick:w,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-lg transition-all",children:e.jsx(vs,{size:16})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-[1.5rem] p-6 shadow-lg shadow-slate-200/50 border border-slate-100 flex flex-col justify-between relative group z-0 hover:z-10",children:[e.jsxs("div",{className:"absolute inset-0 rounded-[1.5rem] overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[300px] h-[300px] bg-blue-100/40 rounded-full blur-[80px] -mr-24 -mt-24 opacity-80"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[200px] h-[200px] bg-indigo-50/60 rounded-full blur-[60px] -ml-16 -mb-16 opacity-60"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-white shadow-sm rounded-xl text-blue-600 border border-blue-50",children:e.jsx(Oe,{size:20,strokeWidth:2.5})}),e.jsx("span",{className:"text-[10px] font-extrabold text-blue-900/60 uppercase tracking-widest",children:"Flying Blue Portfolio"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("h3",{className:"text-5xl font-black tracking-tighter text-blue-900",children:ne(g.netCurrent)}),e.jsx("span",{className:"text-base font-bold text-blue-900/40",children:"Miles"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-[9px] font-bold uppercase tracking-wider text-slate-400 mb-1.5",children:[e.jsx("span",{children:"Current"}),e.jsxs("span",{children:["Projected: ",ne(g.netProjected)]})]}),e.jsx("div",{className:"relative w-full h-2.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full shadow-md transition-all duration-1000",style:{width:`${Math.min(100,D)}%`}})})]})]}),e.jsxs("div",{className:"relative z-10 pt-4 mt-3 border-t border-slate-100/50 flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx("p",{className:"text-slate-400 text-[9px] font-bold uppercase tracking-wider",children:"Projected Value"}),e.jsx(me,{text:"Theoretical value of your projected miles balance, calculated at your Target CPM."})]}),e.jsx("p",{className:"text-lg font-bold text-slate-800",children:c(_)})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-end mb-0.5",children:[e.jsx("p",{className:"text-slate-400 text-[9px] font-bold uppercase tracking-wider",children:"Total Investment"}),e.jsx(me,{text:"Total cash actually spent on subscriptions, fees and surcharges."})]}),e.jsx("p",{className:"text-lg font-bold text-slate-800 bg-slate-50 px-2.5 py-0.5 rounded-lg border border-slate-100 inline-block",children:c(g.totalCost)})]})]})]}),e.jsxs(Kl,{title:"Acquisition Cost",value:m(F),subtitle:"Average CPM (All time)",icon:Ge,color:"emerald",tooltip:"Weighted average cost of every mile you've accumulated. Lower is better.",children:[e.jsx(yc,{data:P,currentMonth:a}),e.jsxs("div",{className:"flex justify-between items-center text-[9px] font-bold uppercase text-slate-400 mt-1",children:[e.jsx("span",{children:"12 Month Trend"}),e.jsx("span",{className:g.cpmProjected<g.cpmCurrent?"text-emerald-500":"text-slate-400",children:g.cpmProjected<g.cpmCurrent?"â Improving":"Stable"})]})]}),e.jsxs(Kl,{title:"Realized Savings",value:e.jsxs("span",{className:g.savingsCurrent>=0?"text-emerald-600":"text-red-500",children:[g.savingsCurrent>=0?"+":"",c(g.savingsCurrent)]}),subtitle:"vs Target CPM",icon:di,color:"violet",tooltip:"Difference between the theoretical value of your miles and what you actually paid for them.",children:[e.jsx(Nc,{cost:g.totalCost,value:N}),e.jsxs("div",{className:"flex justify-between items-center text-[9px] font-bold uppercase text-slate-400 mt-1",children:[e.jsx("span",{children:"Investment"}),e.jsx("span",{children:"Est. Value"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-[1.5rem] border border-indigo-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-100/50 rounded-full blur-2xl -mr-16 -mt-16"}),e.jsxs("button",{onClick:b,className:"relative w-full p-5 flex items-center justify-between text-left hover:bg-indigo-100/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white shadow-sm rounded-xl text-indigo-600 border border-indigo-100",children:e.jsx(Je,{size:18,strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:"How do you value a mile?"}),e.jsx("p",{className:"text-[10px] text-indigo-600 font-medium",children:p?"Click to collapse":`Current: ${o}${l.toFixed(3)} per mile`})]})]}),e.jsx(nt,{size:20,className:`text-indigo-400 transition-transform duration-200 ${p?"rotate-180":""}`})]}),p&&e.jsxs("div",{className:"relative px-5 pb-5 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 pt-2 border-t border-indigo-100/50",children:[e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed max-w-xl",children:"Your target CPM (cost per mile) determines how SkyStatus calculates the value of your portfolio. Set this to the redemption rate you typically aim for when booking award flights."})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"hidden sm:flex items-center gap-1",children:[{value:.008,label:"Conservative",color:"text-slate-500"},{value:.012,label:"Average",color:"text-blue-600"},{value:.018,label:"Aspirational",color:"text-indigo-600"}].map(j=>e.jsxs("button",{onClick:()=>r(j.value),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${Math.abs(l-j.value)<.001?"bg-white shadow-sm border border-indigo-200 text-indigo-700":"bg-white/50 hover:bg-white text-slate-500 hover:text-slate-700"}`,children:[j.label,e.jsxs("span",{className:"block text-[9px] font-medium opacity-70",children:[o,j.value.toFixed(3)]})]},j.value))}),e.jsxs("div",{className:"bg-white rounded-xl px-4 py-3 shadow-sm border border-indigo-100 min-w-[120px]",children:[e.jsx("label",{className:"text-[9px] font-bold text-indigo-400 uppercase tracking-wide block mb-1",children:"Target CPM"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm text-indigo-400 font-medium",children:o}),e.jsx("input",{type:"number",step:"0.001",min:"0.001",value:l,onChange:j=>r(parseFloat(j.target.value)||.012),className:`text-lg font-black text-indigo-700 outline-none bg-transparent w-20 ${Gl}`})]})]})]})]}),e.jsxs("details",{className:"mt-4 group",children:[e.jsxs("summary",{className:"text-xs font-medium text-indigo-600 cursor-pointer hover:text-indigo-800 transition-colors flex items-center gap-1.5",children:[e.jsx(vt,{size:14}),"What's a good target CPM?",e.jsx(nt,{size:14,className:"transition-transform group-open:rotate-180 ml-auto"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3 text-[11px]",children:[e.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-200/50 hover:border-slate-300 transition-colors",children:[e.jsxs("div",{className:"font-bold text-slate-700 mb-1",children:[o,"0.006 - ",o,"0.010"]}),e.jsx("div",{className:"text-slate-500",children:"Conservative. Easy to achieve on most economy redemptions within Europe."})]}),e.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-blue-200/50 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"font-bold text-blue-700 mb-1",children:[o,"0.012 - ",o,"0.015"]}),e.jsx("div",{className:"text-slate-500",children:"Average. Typical for business class on medium-haul or good economy deals on long-haul."})]}),e.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-indigo-200/50 hover:border-indigo-300 transition-colors",children:[e.jsxs("div",{className:"font-bold text-indigo-700 mb-1",children:[o,"0.018+"]}),e.jsx("div",{className:"text-slate-500",children:"Aspirational. Achievable on premium cabin long-haul or La PremiÃ¨re. Requires strategic booking."})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:["Monthly Flow",e.jsx(me,{text:"Inflow (Earned) vs Outflow (Burned) of miles per month."})]}),e.jsxs("div",{className:"flex gap-3 text-[10px] font-medium",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})," Earned (Act)"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-200 rounded-full"})," Earned (Proj)"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full"})," Burned"]})]})]}),e.jsx("div",{className:"h-56",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(ua,{data:P,children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"month",tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(Et,{tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(ft,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"},cursor:{fill:"#f8fafc"}}),e.jsx(Dt,{dataKey:"earnedActual",stackId:"a",fill:"#3b82f6",radius:[0,0,0,0]}),e.jsx(Dt,{dataKey:"earnedProjected",stackId:"a",fill:"#bfdbfe",radius:[4,4,0,0]}),e.jsx(Dt,{dataKey:"redeemed",fill:"#f87171",radius:[4,4,0,0]})]})})})]}),e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] shadow-sm border border-slate-100",children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm mb-4 flex items-center gap-2",children:["Cost Efficiency Trend (CPM)",e.jsx(me,{text:"Are your miles getting cheaper or more expensive to acquire over time?"})]}),e.jsx("div",{className:"h-48",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(un,{data:P,children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"month",tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(Et,{tick:{fontSize:10,fill:"#64748b"},tickFormatter:j=>`${o}${j.toFixed(3)}`,axisLine:!1,tickLine:!1}),e.jsx(ft,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"},formatter:j=>m(j)}),e.jsx(ta,{type:"monotone",dataKey:"cpmActual",stroke:"#0f172a",strokeWidth:2,dot:{r:3,fill:"#0f172a"},connectNulls:!0}),e.jsx(ta,{type:"monotone",dataKey:"cpmProjected",stroke:"#94a3b8",strokeWidth:2,strokeDasharray:"5 5",dot:{r:3,fill:"#94a3b8"},connectNulls:!0})]})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h3",{className:"font-bold text-slate-800 text-sm",children:"Source Efficiency"}),e.jsx(me,{text:"Breakdown of CPM per source. Green = below target. Full bar = 100% efficient."})]}),e.jsx("div",{className:"space-y-2",children:S.map(j=>e.jsx(vc,{source:j,targetCPM:u},j.key))})]}),e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h3",{className:"font-bold text-slate-800 text-sm",children:"ROI & Leverage"}),e.jsx(me,{text:"Efficiency Multiplier. How many Euros of value you get for every Euro spent."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Portfolio Leverage"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-3xl font-black text-indigo-600",children:[g.roiMultiplier.toFixed(1),"x"]}),e.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"multiplier"})]}),e.jsxs("p",{className:"text-[11px] text-slate-400 mt-1.5 leading-relaxed",children:["For every"," ",e.jsxs("span",{className:"font-bold text-slate-600",children:[o,"1"]})," spent, you realize"," ",e.jsxs("span",{className:"font-bold text-slate-600",children:[o,g.roiMultiplier.toFixed(2)]})," ","in value."]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-100",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Total Value Created"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:c(g.totalBurnValue)}),g.redeemedMiles>0&&e.jsxs("p",{className:"text-[10px] text-slate-400 mt-0.5",children:["from ",ne(g.redeemedMiles)," redeemed miles"]})]})]})]})]})]}),e.jsx(Fr,{data:t,onUpdate:s,currentMonth:a,variant:"full",showQuickStats:!0,showAddButton:!0,onAddMonth:C,title:"Transaction Ledger"})]})},Xs="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",Ar=(t,s=!1)=>{if(s)return{blob1:"bg-slate-700/40",blob2:"bg-slate-600/30",accentText:"text-slate-700",subText:"text-slate-500",iconBg:"bg-slate-100 text-slate-700 border-slate-200",gaugeStart:"#475569",gaugeEnd:"#64748b",icon:e.jsx(ze,{size:20,strokeWidth:2.5}),badge:"bg-slate-800 text-white border-slate-700",progressBar:"from-slate-500 to-slate-400",accentColor:"text-slate-700"};switch(t){case"Platinum":return{blob1:"bg-blue-100/60",blob2:"bg-indigo-100/60",accentText:"text-blue-900",subText:"text-blue-600",iconBg:"bg-blue-50 text-blue-600 border-blue-100",gaugeStart:"#3b82f6",gaugeEnd:"#6366f1",icon:e.jsx(le,{size:20,strokeWidth:2.5}),badge:"bg-slate-800 text-white border-slate-700",progressBar:"from-blue-600 to-indigo-600",accentColor:"text-blue-600"};case"Gold":return{blob1:"bg-amber-100/60",blob2:"bg-yellow-100/60",accentText:"text-amber-900",subText:"text-amber-600",iconBg:"bg-amber-50 text-amber-600 border-amber-100",gaugeStart:"#f59e0b",gaugeEnd:"#eab308",icon:e.jsx(Rs,{size:20,strokeWidth:2.5}),badge:"bg-amber-100 text-amber-800 border-amber-200",progressBar:"from-amber-500 to-orange-500",accentColor:"text-amber-600"};case"Silver":return{blob1:"bg-slate-100/60",blob2:"bg-gray-100/60",accentText:"text-slate-700",subText:"text-slate-500",iconBg:"bg-slate-100 text-slate-600 border-slate-200",gaugeStart:"#64748b",gaugeEnd:"#94a3b8",icon:e.jsx(je,{size:20,strokeWidth:2.5}),badge:"bg-slate-100 text-slate-700 border-slate-200",progressBar:"from-slate-500 to-gray-500",accentColor:"text-slate-600"};default:return{blob1:"bg-emerald-100/60",blob2:"bg-teal-100/60",accentText:"text-emerald-800",subText:"text-emerald-600",iconBg:"bg-emerald-50 text-emerald-600 border-emerald-100",gaugeStart:"#10b981",gaugeEnd:"#14b8a6",icon:e.jsx(xi,{size:20,strokeWidth:2.5}),badge:"bg-emerald-100 text-emerald-700 border-emerald-200",progressBar:"from-emerald-500 to-teal-500",accentColor:"text-emerald-600"}}},Yl=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short"}),kc=t=>{switch(t){case"Explorer":return"Silver";case"Silver":return"Gold";case"Gold":return"Platinum";default:return null}},Ma=({label:t,theme:s,variant:a="default"})=>e.jsxs("span",{className:`inline-flex items-center justify-center h-5 px-2 rounded text-[9px] font-bold tracking-wider uppercase border shadow-sm ${a==="levelup"?"bg-emerald-100 text-emerald-700 border-emerald-200":a==="projected"?"bg-blue-100 text-blue-700 border-blue-200 opacity-70":s.badge} opacity-90`,children:[a==="levelup"&&e.jsx(Pt,{size:10,className:"mr-1"}),a==="projected"&&e.jsx(Ee,{size:10,className:"mr-1"}),t]}),Fa=({val:t,field:s,month:a,onChange:n,className:l=""})=>e.jsx("div",{className:"relative group w-full h-full",children:e.jsx("input",{type:"number",value:t===0?"":t,placeholder:"-",onFocus:r=>r.target.select(),onChange:r=>n(a,s,r.target.value===""?0:Number(r.target.value)),className:`
        w-full bg-transparent text-right py-2 px-2 
        font-mono text-xs transition-all duration-200
        focus:outline-none focus:bg-white focus:ring-2 focus:ring-blue-100 focus:text-blue-700 rounded-md
        placeholder:text-slate-200 hover:bg-slate-50
        ${t!==0?"text-slate-700 font-bold":"text-slate-400"}
        ${Xs}
        ${l}
      `,inputMode:"numeric"})}),Cc=({initialValues:t,onSave:s,onCancel:a,onShowFaq:n})=>{const l=new Date,r=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,[i,x]=d.useState(t?.cycleStartMonth||r),[c,o]=d.useState(t?.startingStatus||"Explorer"),[u,m]=d.useState(t?.startingXP||0),[p,h]=d.useState(t?.startingUXP||0),[b,g]=d.useState(t?.ultimateCycleType||"qualification"),S=()=>{s({cycleStartMonth:i,startingStatus:c,startingXP:Math.max(0,Math.min(300,u)),startingUXP:Math.max(0,Math.min(900,p)),ultimateCycleType:b})},P=!!t,C=c==="Platinum"||c==="Ultimate";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 mb-5",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-amber-100 shadow-sm",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Cycle Start Month"}),e.jsx("input",{type:"month",value:i,onChange:w=>x(w.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-slate-800 font-medium focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1.5",children:"When did your current status period begin?"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-amber-100 shadow-sm",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Status at Start"}),e.jsxs("select",{value:c,onChange:w=>o(w.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-slate-800 font-medium focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white",children:[e.jsx("option",{value:"Explorer",children:"Explorer"}),e.jsx("option",{value:"Silver",children:"Silver (100 XP)"}),e.jsx("option",{value:"Gold",children:"Gold (180 XP)"}),e.jsx("option",{value:"Platinum",children:"Platinum (300 XP)"}),e.jsx("option",{value:"Ultimate",children:"Ultimate (900 UXP)"})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1.5",children:"What status did you have when this cycle started?"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-amber-100 shadow-sm",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Starting XP (Rollover)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",max:"300",value:u===0?"":u,placeholder:"0",onChange:w=>m(w.target.value===""?0:Number(w.target.value)),className:`flex-1 px-3 py-2 border border-slate-200 rounded-lg text-slate-800 font-medium focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent ${Xs}`}),e.jsx("span",{className:"text-slate-500 font-medium",children:"XP"})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1.5",children:"Your XP balance at cycle start (max 300)"})]})]}),C&&e.jsx("div",{className:"grid gap-4 md:grid-cols-3 mb-5",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 flex items-center gap-1.5",children:[e.jsx(ze,{size:12,className:"text-slate-400"}),"Starting UXP (Rollover)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",max:"900",value:p===0?"":p,placeholder:"0",onChange:w=>h(w.target.value===""?0:Number(w.target.value)),className:`flex-1 px-3 py-2 border border-slate-200 rounded-lg text-slate-800 font-medium focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-transparent ${Xs}`}),e.jsx("span",{className:"text-slate-500 font-medium",children:"UXP"})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1.5",children:"Your UXP balance at cycle start (max 900)"})]})}),C&&e.jsx("div",{className:"mb-5 p-4 bg-slate-50 rounded-xl border border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-200 rounded-lg",children:e.jsx(ze,{size:18,className:"text-slate-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-700",children:"Ultimate Progress Cycle"}),e.jsxs("div",{className:"group relative",children:[e.jsx(lt,{size:14,className:"text-slate-400 cursor-help"}),e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-slate-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity w-64 pointer-events-none z-10",children:"Flying Blue is transitioning from calendar year to qualification cycle for Ultimate status. If you earned Ultimate before 2024, your UXP may still be calculated per calendar year."})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Does your Ultimate progress run differently from your status cycle?"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer border transition-colors ${b==="qualification"?"bg-slate-700 text-white border-slate-700":"bg-white text-slate-600 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"radio",name:"ultimateCycle",value:"qualification",checked:b==="qualification",onChange:()=>g("qualification"),className:"sr-only"}),e.jsx("span",{className:"text-sm font-medium",children:"Qualification cycle"}),e.jsx("span",{className:`text-xs ${b==="qualification"?"text-slate-300":"text-slate-400"}`,children:"(default)"})]}),e.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer border transition-colors ${b==="calendar"?"bg-slate-700 text-white border-slate-700":"bg-white text-slate-600 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"radio",name:"ultimateCycle",value:"calendar",checked:b==="calendar",onChange:()=>g("calendar"),className:"sr-only"}),e.jsx("span",{className:"text-sm font-medium",children:"Calendar year"}),e.jsx("span",{className:`text-xs ${b==="calendar"?"text-slate-300":"text-slate-400"}`,children:"(legacy)"})]})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 pt-4 border-t border-amber-200/50",children:[e.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600",children:[e.jsx(vt,{size:14,className:"text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Tip:"})," Your cycle start date is when your current status began. Check your status expiry date on Flying Blue and count back 12 months."]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:n,className:"inline-flex items-center gap-2 px-4 py-2 text-amber-600 hover:text-amber-700 font-medium text-sm transition-colors whitespace-nowrap",children:[e.jsx(vt,{size:16}),"Need help?"]}),a&&e.jsx("button",{onClick:a,className:"inline-flex items-center gap-2 px-4 py-2 text-slate-600 hover:text-slate-700 font-medium text-sm transition-colors whitespace-nowrap",children:P?"Cancel":"Skip for now"}),e.jsxs("button",{onClick:S,className:"inline-flex items-center gap-2 px-5 py-2 bg-amber-500 text-white rounded-lg font-medium text-sm hover:bg-amber-600 transition-colors whitespace-nowrap shadow-sm",children:[e.jsx(je,{size:16}),P?"Save Changes":"Save & Continue"]})]})]})]})},Mc=({actualStatus:t,actualXP:s,actualXPToNext:a,projectedStatus:n,projectedXP:l,projectedXPToNext:r,nextStatus:i,currentCycle:x,theme:c,isLevelUpCycle:o,levelUpIsActual:u,hasProjectedUpgrade:m,hasProjectedXPDifference:p,actualProgress:h,projectedProgress:b,isUltimate:g,projectedUltimate:S,actualUXP:P,projectedUXP:C})=>e.jsx("div",{className:"lg:col-span-4 h-full",children:e.jsxs("div",{className:"relative h-full bg-white rounded-[2.5rem] p-8 shadow-xl shadow-slate-200/50 border border-slate-100 flex flex-col justify-between overflow-visible group z-0 hover:z-10",children:[e.jsx("div",{className:`absolute top-0 right-0 w-[300px] h-[300px] ${c.blob1} rounded-full blur-[80px] -mr-20 -mt-20 pointer-events-none opacity-80`}),e.jsx("div",{className:`absolute bottom-0 left-0 w-[250px] h-[250px] ${c.blob2} rounded-full blur-[60px] -ml-20 -mb-20 pointer-events-none opacity-60`}),e.jsxs("div",{className:"relative z-10 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-extrabold tracking-[0.2em] uppercase text-slate-400",children:"Current Status"}),e.jsx(me,{text:"Your actual status based on flown flights only. Scheduled flights are shown as projections."})]}),e.jsx("h3",{className:`text-4xl font-black tracking-tight ${g?"text-slate-800":c.accentText}`,children:g?"Ultimate":t}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:o&&u?e.jsxs("span",{children:["Started as ",x.startStatus,".",e.jsxs("span",{className:"text-emerald-600 font-medium",children:[" ","Leveled up to ",t,"!"]})]}):e.jsxs("span",{children:["Started as ",x.startStatus," in this cycle."]})}),m&&e.jsx("div",{className:"mt-3 flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-blue-50 border border-blue-100 rounded-lg",children:[e.jsx(Je,{size:12,className:"text-blue-500"}),e.jsxs("span",{className:"text-[10px] font-bold text-blue-700 uppercase tracking-wide",children:["Projected: ",n]})]})})]}),e.jsx("div",{className:`p-2.5 rounded-2xl border shadow-sm ${c.iconBg}`,children:c.icon})]}),e.jsx("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center my-6",children:e.jsxs("div",{className:"relative w-56 h-56",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90 drop-shadow-xl",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"xpGaugeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:c.gaugeStart}),e.jsx("stop",{offset:"100%",stopColor:c.gaugeEnd})]}),e.jsxs("linearGradient",{id:"xpGaugeProjected",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:c.gaugeStart,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:c.gaugeEnd,stopOpacity:"0.3"})]})]}),e.jsx("circle",{cx:"112",cy:"112",r:"100",fill:"none",stroke:"#f1f5f9",strokeWidth:"12",strokeLinecap:"round"}),p&&e.jsx("circle",{cx:"112",cy:"112",r:"100",fill:"none",stroke:"url(#xpGaugeProjected)",strokeWidth:"12",strokeDasharray:628,strokeDashoffset:628-628*b/100,strokeLinecap:"round",className:"transition-all duration-1000 ease-out"}),e.jsx("circle",{cx:"112",cy:"112",r:"100",fill:"none",stroke:"url(#xpGaugeGradient)",strokeWidth:"12",strokeDasharray:628,strokeDashoffset:628-628*h/100,strokeLinecap:"round",className:"transition-all duration-1000 ease-out"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:`text-6xl font-black tracking-tighter tabular-nums ${c.accentText}`,children:s}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-[0.2em] mt-2 text-slate-400",children:"Actual XP"}),p&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-blue-500",children:[e.jsx(Ee,{size:10}),e.jsxs("span",{className:"text-xs font-medium",children:[l," projected"]})]})]})]})}),(t==="Platinum"||g)&&e.jsxs("div",{className:"relative z-10 mb-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 rounded-2xl border border-slate-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{size:16,className:"text-slate-600"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 uppercase tracking-wide",children:"Ultimate Progress"}),e.jsx(me,{text:"UXP (Ultimate XP) is earned from KLM and Air France operated flights only. Earn 900 UXP as Platinum to unlock Ultimate status."})]}),e.jsxs("span",{className:"text-sm font-bold text-slate-700",children:[P," / 900 UXP"]})]}),e.jsxs("div",{className:"relative h-3 bg-slate-200/50 rounded-full overflow-hidden",children:[C>P&&e.jsx("div",{className:"absolute inset-y-0 left-0 bg-slate-300/40 rounded-full transition-all duration-500",style:{width:`${Math.min(C/900*100,100)}%`}}),e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-slate-500 to-slate-600 rounded-full transition-all duration-500",style:{width:`${Math.min(P/900*100,100)}%`}})]}),e.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[g?e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-700",children:[e.jsx(je,{size:14}),e.jsx("span",{className:"text-xs font-semibold",children:"Ultimate status achieved!"})]}):e.jsxs("span",{className:"text-xs text-slate-600",children:[900-P," UXP to Ultimate"]}),S&&!g&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-slate-200/50 rounded-full",children:[e.jsx(Be,{size:10,className:"text-slate-600"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-700",children:"Projected"})]})]})]}),e.jsx("div",{className:"relative z-10 pt-6 border-t border-slate-100",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-wider mb-1",children:"Target Status"}),t==="Platinum"&&a===0?e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 font-bold text-lg",children:[e.jsx(je,{size:20}),e.jsx("span",{children:"Secured"})]}):t==="Platinum"&&a>0?e.jsxs("div",{children:[e.jsxs("div",{className:`text-lg font-bold ${c.accentText}`,children:[a," ",e.jsx("span",{className:`text-sm font-medium ${c.subText}`,children:"XP to requalify"})]}),r===0&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-500 text-xs mt-0.5",children:[e.jsx(Ee,{size:10}),e.jsx("span",{children:"Secured with scheduled flights"})]})]}):a===0?e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 font-bold text-lg",children:[e.jsx(je,{size:20}),e.jsx("span",{children:"Secured"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:`text-lg font-bold ${c.accentText}`,children:[a," ",e.jsxs("span",{className:`text-sm font-medium ${c.subText}`,children:["XP to ",i]})]}),r===0&&m&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-500 text-xs mt-0.5",children:[e.jsx(Ee,{size:10}),e.jsxs("span",{children:[n," projected"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-end mb-1",children:[e.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-wider",children:"Next Rollover"}),e.jsx(me,{text:"Projected XP/UXP carried over to the next qualification cycle. Based on scheduled flights."})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsxs("p",{className:`text-xl font-black ${x.rolloverOut>0?c.accentText:"text-slate-300"}`,children:[x.rolloverOut," ",e.jsx("span",{className:"text-sm font-bold text-slate-400",children:"XP"})]}),(t==="Platinum"||g)&&e.jsxs("p",{className:`text-xl font-black ${x.uxpRolloverOut>0?"text-slate-600":"text-slate-300"}`,children:[x.uxpRolloverOut??0," ",e.jsx("span",{className:"text-sm font-bold text-slate-400",children:"UXP"})]})]})]})]})})]})}),Fc=({chartData:t,avgNeeded:s})=>e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm flex-1 min-h-[300px]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(xn,{size:18,className:"text-slate-400"}),"Progression"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[10px] font-bold px-2 py-1 rounded bg-blue-500 text-white border border-blue-600",children:"Actual XP"}),e.jsx("span",{className:"text-[10px] font-bold px-2 py-1 rounded bg-blue-100 text-blue-600 border border-blue-200",children:"Scheduled XP"}),s>0&&e.jsxs("span",{className:"text-[10px] font-bold px-2 py-1 rounded bg-amber-50 text-amber-600 border border-amber-100 flex items-center gap-1",children:["Target: ~",s,"/mo"]})]})]}),e.jsx("div",{className:"h-[240px] w-full",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(ua,{data:t,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"monthLabel",tick:{fontSize:11,fill:"#94a3b8",fontWeight:600},tickLine:!1,axisLine:!1}),e.jsx(Et,{tick:{fontSize:11,fill:"#94a3b8",fontWeight:600},tickLine:!1,axisLine:!1}),e.jsx(ft,{cursor:{fill:"#f8fafc"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)"},content:({active:a,payload:n,label:l})=>{if(a&&n&&n.length){const r=n.find(x=>x.dataKey==="actualXP")?.value??0,i=n.find(x=>x.dataKey==="projectedXP")?.value??0;return e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-slate-100",children:[e.jsx("p",{className:"font-bold text-slate-800 mb-1",children:l}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Actual: ",r," XP"]}),Number(i)>0&&e.jsxs("p",{className:"text-sm text-blue-400",children:["Scheduled: ",i," XP"]})]})}return null}}),e.jsx(Dt,{dataKey:"actualXP",stackId:"xp",fill:"#0ea5e9",radius:[0,0,0,0],barSize:40}),e.jsx(Dt,{dataKey:"projectedXP",stackId:"xp",fill:"#0ea5e9",fillOpacity:.3,stroke:"#0ea5e9",strokeWidth:1,strokeDasharray:"4 4",radius:[6,6,0,0],barSize:40}),s>0&&e.jsx(os,{y:s,stroke:"#f59e0b",strokeDasharray:"3 3",label:{value:`Avg. needed: ${s} XP`,position:"insideTopRight",fill:"#f59e0b",fontSize:10,fontWeight:"bold"}})]})})})]}),Ac=({currentCycle:t,enhancedLedger:s,flights:a,manualLedger:n,theme:l,isLevelUpCycle:r,levelUpIsActual:i,isChained:x,onManualCellChange:c,showUXP:o=!1})=>{const u=m=>{const p={amexXp:0,bonusSafXp:0,miscXp:0,correctionXp:0};return n[m]?{...p,...n[m]}:p};return e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/30",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:"XP Ledger"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Flights are calculated automatically. Scheduled flights shown with"," ",e.jsx(Ee,{size:10,className:"inline"})," icon."]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&t.levelUpMonth&&e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-bold shadow-sm ${i?"bg-emerald-50 border border-emerald-200 text-emerald-700":"bg-blue-50 border border-blue-200 text-blue-700"}`,children:[i?e.jsx(Pt,{size:14}):e.jsx(Ee,{size:14}),"Level-up ",i?"achieved":"projected"," in"," ",new Date(t.levelUpMonth+"-01").toLocaleDateString("en-US",{month:"short"})]}),x&&e.jsxs("div",{className:"flex items-center gap-2 bg-white border border-slate-200 text-slate-600 px-3 py-1.5 rounded-lg text-xs font-bold shadow-sm",children:[e.jsx(xn,{size:14}),"Chained from previous cycle"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs text-left",children:[e.jsx("thead",{className:"bg-white text-slate-400 font-bold uppercase tracking-wider text-[10px] border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 min-w-[140px]",children:"Month"}),e.jsx("th",{className:"px-2 py-4 text-right w-24 text-sky-700",children:"Flights XP"}),e.jsx("th",{className:"px-2 py-4 text-right w-24 text-slate-500",children:"SAF Bonus"}),e.jsx("th",{className:"px-2 py-4 text-right w-24 text-indigo-500",children:"Amex XP"}),e.jsx("th",{className:"px-2 py-4 text-right w-24 text-slate-500",children:"Misc XP"}),e.jsx("th",{className:"px-2 py-4 text-right w-28 text-red-400",children:"Event"}),e.jsx("th",{className:"px-4 py-4 text-right bg-slate-50 border-l border-slate-100 text-slate-700",children:"Total"}),e.jsx("th",{className:"px-4 py-4 text-right bg-blue-50/30 text-blue-900",children:"Cumul."}),o&&e.jsx("th",{className:"px-4 py-4 text-right bg-amber-50/30 text-amber-700 border-l border-amber-100/50",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(ze,{size:10}),"UXP"]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:s.map(({row:m,autoCorrection:p,isLevelUpMonth:h})=>{const b=u(m.month),g=a.filter(v=>v.date.slice(0,7)===m.month),S=g.reduce((v,A)=>v+(A.earnedXP??0),0),P=g.reduce((v,A)=>v+(A.safXp??0),0),C=g.length,w=new Date().toISOString().slice(0,10),f=g.filter(v=>v.date<w).length,D=C-f,_=m.monthTotal??m.xpMonth??0,N=m.isFullyFlown??!1,F=m.isFuture??!1,j=p!==0;return e.jsxs("tr",{className:`group transition-colors border-b border-slate-50 last:border-0 ${h&&i?"bg-emerald-50/30 hover:bg-emerald-50/50":h&&!i?"bg-blue-50/30 hover:bg-blue-50/50":F?"opacity-60 bg-slate-50/30":"hover:bg-slate-50"}`,children:[e.jsx("td",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between w-full min-w-[120px]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-bold ${h&&i?"text-emerald-700":h&&!i?"text-blue-700":F?"text-slate-400":"text-slate-700"}`,children:m.monthLabel}),f>0&&e.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-sky-50 text-sky-600 rounded text-[9px] font-bold border border-sky-100",children:[e.jsx(le,{size:8,className:"fill-current"}),f]}),D>0&&e.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-blue-50 text-blue-500 rounded text-[9px] font-bold border border-blue-100",children:[e.jsx(Ee,{size:8}),D]})]}),h&&i&&e.jsx(Ma,{label:`â ${t.endStatus}`,theme:l,variant:"levelup"}),h&&!i&&e.jsx(Ma,{label:`â ${t.endStatus}`,theme:l,variant:"projected"}),!h&&m.hitPlatinum&&e.jsx(Ma,{label:"PLAT",theme:l})]})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("div",{className:"flex justify-end pr-2",children:S>0?e.jsx("span",{className:`font-bold px-2 py-1 rounded-md tabular-nums border ${N?"text-sky-700 bg-sky-50/50 border-sky-100/50":"text-blue-500 bg-blue-50/50 border-blue-100/50"}`,children:S}):e.jsx("span",{className:"text-slate-300 text-xs px-2 py-1",children:"-"})})}),e.jsx("td",{className:"px-2 py-1 relative",children:e.jsxs("div",{className:"flex flex-col items-end justify-center h-full",children:[e.jsx(Fa,{val:b.bonusSafXp,field:"bonusSafXp",month:m.month,onChange:c}),P>0&&e.jsx("div",{className:"absolute bottom-1 right-2 pointer-events-none",children:e.jsxs("span",{className:"text-[9px] font-medium text-emerald-600 bg-emerald-50 px-1 py-0.5 rounded border border-emerald-100/50 flex items-center gap-1",children:["Flight: +",P]})})]})}),e.jsx("td",{className:"px-2 py-1",children:e.jsx(Fa,{val:b.amexXp,field:"amexXp",month:m.month,onChange:c,className:"text-indigo-600"})}),e.jsx("td",{className:"px-2 py-1",children:e.jsx(Fa,{val:b.miscXp,field:"miscXp",month:m.month,onChange:c})}),e.jsx("td",{className:"px-2 py-1 text-right align-top",children:e.jsxs("div",{className:"flex flex-col items-end pr-2 gap-0.5 min-h-[32px]",children:[j&&e.jsxs("span",{className:`text-[10px] font-semibold ${h&&i?"text-emerald-600":h&&!i?"text-blue-600":"text-red-500"}`,children:[h?"Level up":"Adjustment",": ",p," XP"]}),b.correctionXp!==0&&e.jsxs("span",{className:"text-[10px] text-red-400",children:["Manual: ",b.correctionXp>0?"+":"",b.correctionXp," XP"]}),!j&&b.correctionXp===0&&e.jsx("span",{className:"text-slate-300 text-[11px]",children:"-"})]})}),e.jsx("td",{className:"px-4 py-3 text-right tabular-nums border-l border-slate-100 bg-slate-50/30",children:e.jsx("span",{className:`font-bold text-sm ${_>0?"text-slate-800":_<0?"text-red-500":"text-slate-300"}`,children:_!==0?_:"-"})}),e.jsx("td",{className:`px-4 py-3 text-right tabular-nums font-bold text-sm ${h&&i?"bg-emerald-50/50 text-emerald-800":h&&!i?"bg-blue-50/50 text-blue-800":"bg-blue-50/10 text-blue-900/80"}`,children:m.cumulative}),o&&e.jsx("td",{className:"px-4 py-3 text-right tabular-nums border-l border-amber-100/50 bg-amber-50/10",children:e.jsx("span",{className:`font-medium text-sm ${(m.uxp??0)>0?"text-amber-700":"text-slate-300"}`,children:(m.uxp??0)>0?m.uxp:"-"})})]},m.month)})})]})})]})},ql=t=>{switch(t){case"Explorer":return 100;case"Silver":return 180;case"Gold":return 300;case"Platinum":return 300;case"Ultimate":return 300;default:return 100}},Xc=t=>{switch(t){case"Explorer":return"Silver";case"Silver":return"Gold";case"Gold":return"Platinum";case"Platinum":return"Ultimate";default:return null}},Ec=t=>{if(t.length===0)return null;const s=new Date().toISOString().slice(0,10);for(const a of t)if(s>=a.startDate&&s<=a.endDate)return a;for(const a of t)if(a.endDate>=s)return a;return t[t.length-1]},Dc=({data:t,rollover:s,flights:a,manualLedger:n,qualificationSettings:l,demoStatus:r,displayXP:i,hasPdfBaseline:x=!1})=>{const{setViewMode:c}=it(),o=d.useMemo(()=>Yt(l),[l]),{cycles:u}=d.useMemo(()=>Lt(t,s,a,n,o),[t,s,a,n,o]),m=d.useMemo(()=>Ec(u),[u]);if(!m)return e.jsx("div",{className:"text-center py-12 text-slate-500",children:"No qualification data available. Import your Flying Blue PDF to get started."});const p=m.isUltimate??!1,h=m.actualStatus??"Explorer",b=r??ms(h,p),g=r==="Ultimate"||p,S=m.actualXP??0,P=x&&i!==void 0?i:S,C=ql(b),w=Ar(b,g),f=Xc(b),D=d.useMemo(()=>{const M=m.ledger.reduce((z,K)=>z+(K.xpMonth??0),0);return m.rolloverIn+M},[m]),_=Math.max(D,P),N=_>P,F=Math.min(100,Math.round(P/C*100)),j=Math.max(0,C-P),v=new Date(m.endDate),A=new Date,R=Math.max(0,(v.getFullYear()-A.getFullYear())*12+(v.getMonth()-A.getMonth())),X=P>=C,L=X||F>=50&&R>=6||F>=75,G=v.toLocaleDateString("en-US",{month:"long",year:"numeric"}),k=d.useMemo(()=>{const M=new Date().toISOString().slice(0,10);return[...a].sort((z,K)=>K.date.localeCompare(z.date)).slice(0,8).map(z=>({...z,displayXP:z.xp??z.earnedXP??0,isBooked:z.status==="booked"||z.date>M}))},[a]),I=d.useMemo(()=>m.ledger.filter(M=>(M.xpMonth??0)>0).slice(-6).map(M=>({month:M.month,xp:M.xpMonth??0,flights:M.flightsCount??0})),[m]),y=()=>{switch(b){case"Ultimate":return e.jsx(ze,{className:"text-amber-400",size:28});case"Platinum":return e.jsx(le,{className:"text-blue-500 rotate-45",size:28});case"Gold":return e.jsx(le,{className:"text-amber-500 rotate-45",size:28});case"Silver":return e.jsx(le,{className:"text-slate-400 rotate-45",size:28});default:return e.jsx(le,{className:"text-emerald-500 rotate-45",size:28})}},U=R>0?Math.ceil(j/R):0;return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 max-w-3xl mx-auto pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Status Progress"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Your qualification cycle overview"})]}),e.jsxs("button",{onClick:()=>c("full"),className:"flex items-center gap-1.5 text-sm font-medium text-slate-500 hover:text-slate-700 transition-colors",children:[e.jsx(Ds,{size:16}),"Full details",e.jsx(we,{size:16})]})]}),e.jsxs("div",{className:`relative overflow-hidden rounded-3xl p-6 sm:p-8 shadow-xl border ${g?"bg-slate-800 border-slate-700":"bg-white border-slate-100"}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${w.meshGradient}`}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-2xl ${g?"bg-slate-700":"bg-white/80"} shadow-sm`,children:y()}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-3xl font-black ${w.accentColor}`,children:b}),e.jsxs("p",{className:`text-sm font-medium ${g?"text-slate-400":"text-slate-500"}`,children:["Valid until ",G]})]})]}),e.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-semibold px-3 py-1.5 rounded-full ${g?"bg-slate-700 text-slate-300":"bg-slate-100 text-slate-600"}`,children:[e.jsx(et,{size:12}),R," months left"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:`text-sm font-semibold ${g?"text-slate-300":"text-slate-600"}`,children:"Your progress"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`text-sm font-bold ${w.accentColor}`,children:[P," / ",C," XP"]}),N&&e.jsxs("span",{className:`text-xs ml-1.5 ${g?"text-slate-400":"text-blue-500"}`,children:["(",_," projected)"]})]})]}),e.jsxs("div",{className:`relative w-full h-4 rounded-full overflow-hidden ${g?"bg-slate-700":"bg-slate-100"}`,children:[N&&e.jsx("div",{className:`absolute inset-y-0 left-0 ${g?"bg-slate-600":"bg-blue-200"} rounded-full transition-all duration-1000`,style:{width:`${Math.min(100,_/C*100)}%`}}),e.jsx("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${w.progressBar} rounded-full transition-all duration-1000`,style:{width:`${F}%`}})]}),e.jsx("div",{className:"mt-3",children:X?e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(je,{size:18}),e.jsxs("span",{className:"font-semibold",children:["You've secured ",b," for next year!"]})]}):L?e.jsxs("div",{className:`flex items-center gap-2 ${g?"text-emerald-400":"text-emerald-600"}`,children:[e.jsx(je,{size:18}),e.jsxs("span",{className:"font-semibold",children:["On track â ",j," XP to go"]})]}):e.jsxs("div",{className:`flex items-center gap-2 ${g?"text-amber-400":"text-amber-600"}`,children:[e.jsx(Nt,{size:18}),e.jsxs("span",{className:"font-semibold",children:[j," XP needed to requalify"]})]})})]}),e.jsxs("div",{className:`grid grid-cols-3 gap-2 sm:gap-4 p-4 rounded-xl ${g?"bg-slate-700/50":"bg-slate-50"}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-xl sm:text-2xl font-bold ${w.accentColor}`,children:m.rolloverIn}),e.jsx("p",{className:`text-[10px] sm:text-xs font-medium ${g?"text-slate-400":"text-slate-500"}`,children:"Rollover XP"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-xl sm:text-2xl font-bold ${w.accentColor}`,children:P-m.rolloverIn}),e.jsx("p",{className:`text-[10px] sm:text-xs font-medium ${g?"text-slate-400":"text-slate-500"}`,children:"Earned this cycle"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-xl sm:text-2xl font-bold ${w.accentColor}`,children:Math.min(300,m.rolloverOut??0)}),e.jsx("p",{className:`text-[10px] sm:text-xs font-medium ${g?"text-slate-400":"text-slate-500"}`,children:"Next rollover"})]})]})]})]}),!X&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-5 border border-blue-100",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2.5 bg-blue-100 rounded-xl",children:e.jsx(Je,{className:"text-blue-600",size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:U>0?`Earn ~${U} XP per month to requalify`:"Plan your next flights"}),e.jsx("p",{className:"text-sm text-slate-600 mb-3",children:f?`Reach ${C} XP to keep ${b}, or ${ql(f)} XP to upgrade to ${f}.`:`You need ${j} more XP in ${R} months.`}),e.jsxs("button",{onClick:()=>{c("full")},className:"inline-flex items-center gap-2 text-sm font-semibold text-blue-600 hover:text-blue-700",children:["Use XP Planner to find flights",e.jsx(ht,{size:16})]})]})]})}),I.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-100",children:e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Be,{size:18,className:"text-amber-500"}),"Monthly Activity"]})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:I.map((M,z)=>e.jsxs("div",{className:"text-center p-3 bg-slate-50 rounded-xl",children:[e.jsx("p",{className:"text-xs text-slate-500 font-medium mb-1",children:new Date(M.month+"-01").toLocaleDateString("en-US",{month:"short"})}),e.jsxs("p",{className:"text-lg font-bold text-slate-900",children:["+",M.xp]}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"XP"})]},M.month))})})]}),k.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Ie,{size:18,className:"text-blue-500"}),"Recent Flights"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[k.length," of ",a.length," flights"]})]})}),e.jsx("div",{className:"divide-y divide-slate-100",children:k.map((M,z)=>e.jsxs("div",{className:"px-6 py-3 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${M.isBooked?"bg-blue-50":"bg-slate-100"}`,children:e.jsx(le,{size:16,className:`rotate-45 ${M.isBooked?"text-blue-500":"text-slate-600"}`})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-slate-900",children:[M.route,M.isBooked&&e.jsx("span",{className:"ml-2 text-[10px] font-bold text-blue-500 bg-blue-50 px-1.5 py-0.5 rounded",children:"BOOKED"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[new Date(M.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),M.airline&&` â¢ ${M.airline}`]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-bold ${M.isBooked?"text-blue-500":"text-slate-900"}`,children:[M.isBooked?`~${M.displayXP}`:`+${M.displayXP}`," XP"]}),M.cabin&&e.jsx("p",{className:"text-xs text-slate-400",children:M.cabin})]})]},M.id||z))})]}),k.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-8 text-center",children:[e.jsx(le,{size:40,className:"text-slate-300 mx-auto mb-3 rotate-45"}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:"No flights yet"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Import your Flying Blue PDF or add flights manually"})]}),e.jsx("div",{className:"text-center pt-4",children:e.jsx("button",{onClick:()=>c("full"),className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Need to edit flights or see the full ledger? Switch to Full View â"})})]})},Bc=({data:t,baseData:s,onUpdate:a,rollover:n,onUpdateRollover:l,uxpRollover:r,onUpdateUxpRollover:i,flights:x,onUpdateFlights:c,manualLedger:o,onUpdateManualLedger:u,qualificationSettings:m,onUpdateQualificationSettings:p,demoStatus:h,displayXP:b,displayUXP:g,hasPdfBaseline:S=!1})=>{const{isSimpleMode:P}=it(),C=d.useMemo(()=>Yt(m),[m]),{cycles:w}=d.useMemo(()=>Lt(t,n,x,o,C),[t,n,x,o,C]),f=ae=>{const te=new Date().toISOString().slice(0,10);for(let xe=0;xe<ae.length;xe++){const qe=ae[xe];if(te>=qe.startDate&&te<=qe.endDate)return xe}for(let xe=0;xe<ae.length;xe++)if(ae[xe].endDate>=te)return xe;return ae.length-1},[D,_]=d.useState(()=>w.length>0?f(w):0),[N,F]=d.useState(!1),[j,v]=d.useState(!1),[A,R]=d.useState(!1),X=!m&&!A||j,L=d.useMemo(()=>w.length===0?"":w.map(ae=>`${ae.startDate}-${ae.endDate}`).join("|"),[w]);if(d.useEffect(()=>{if(w.length===0){_(0);return}const ae=f(w);_(ae)},[L]),P)return e.jsx(Dc,{data:t,rollover:n,flights:x,manualLedger:o,qualificationSettings:m,demoStatus:h,displayXP:b,hasPdfBaseline:S});if(w.length===0)return null;const G=D<w.length?D:Math.max(0,w.length-1),k=w[G],I=k.isUltimate??!1,y=k.projectedUltimate??!1,U=h==="Ultimate",M=k.actualStatus??k.startStatus,z=h??ms(M,I),K=k.actualXP??0,Y=S&&b!==void 0?b:K,O=k.actualXPToNext??0,V=d.useMemo(()=>{const ae=k.ledger.reduce((te,xe)=>te+(xe.xpMonth??0),0);return k.rolloverIn+ae},[k]),J=Math.max(V,Y),q=k.projectedStatus??k.endStatus,$=h??vr(q,y,U||I||z==="Ultimate",J),Q=k.projectedXPToNext??0,oe=J,se=$!==z,Z=J!==Y,ee=I||z==="Ultimate",T=y||$==="Ultimate",ce=Ar(z,ee),fe=kc(z),Se=k.endedByLevelUp??!1,Te=k.levelUpIsActual??!1,Me=D>0,H=d.useMemo(()=>k.ledger.reduce((ae,te)=>{const xe=te.monthTotal??te.xpMonth??0;return ae+xe},0),[k]),ie=d.useMemo(()=>k.ledger.reduce((ae,te)=>ae+(te.actualXP??0),0),[k]),ue=d.useMemo(()=>z==="Explorer"?100:z==="Silver"?180:300,[z]),be=Math.min(100,Y/ue*100),ve=Math.min(100,oe/ue*100),Ye=ae=>{const te=D+ae;te>=0&&te<w.length&&_(te)},he=ae=>{const te=Math.max(0,Math.min(300,ae));l(Number.isFinite(te)?te:0)},Ae=ae=>{const te=Math.max(0,Math.min(900,ae));i(Number.isFinite(te)?te:0)},bt=ae=>{const te={amexXp:0,bonusSafXp:0,miscXp:0,correctionXp:0};return o[ae]?{...te,...o[ae]}:te},ot=(ae,te,xe)=>{u(qe=>{const Rt=bt(ae);return{...qe,[ae]:{...Rt,[te]:xe}}})},gt=d.useMemo(()=>{const ae=k.ledger;let te=k.rolloverIn??0;return ae.map(xe=>{const qe=xe.monthTotal??xe.xpMonth??0,Ve=xe.cumulative-te-qe;te=xe.cumulative;const _t=Se&&k.levelUpMonth===xe.month;return{row:xe,autoCorrection:Ve,isLevelUpMonth:_t}})},[k,Se]),W=d.useMemo(()=>{const ae=new Date().toISOString().slice(0,7);return k.ledger.map(te=>{const xe=te.month>ae,qe=te.monthTotal??te.xpMonth??0,Rt=te.actualXP??0,Ve=te.projectedXP??0;return{...te,xp:qe,actualXP:Rt,projectedXP:Ve,isFuture:xe}})},[k]),pe=d.useMemo(()=>{const te=W.filter(xe=>xe.isFuture).length;return O>0&&te>0?Math.ceil(O/te):0},[W,O]),Fe=()=>Se&&Te?e.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded uppercase tracking-wide border border-emerald-100",children:[e.jsx(Pt,{size:12}),"Level-up achieved"]}):Se&&!Te?e.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded uppercase tracking-wide border border-blue-100",children:[e.jsx(Ee,{size:12}),"Level-up projected"]}):e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:"Standard cycle"});return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-end gap-4 border-b border-slate-100 pb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"XP Engine"}),e.jsx("p",{className:"text-slate-500 mt-1 font-medium",children:"Manage your qualification cycle"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>v(!j),className:`p-2 rounded-lg transition-all ${j?"bg-amber-100 text-amber-600":"hover:bg-slate-100 text-slate-400 hover:text-slate-600"}`,title:j?"Close cycle settings":"Edit cycle settings",children:e.jsx(mi,{size:20})}),e.jsxs("div",{className:"hidden md:flex items-center space-x-4 bg-white border border-slate-200 p-1.5 rounded-xl shadow-sm",children:[e.jsx("button",{onClick:()=>Ye(-1),disabled:D===0,className:"p-2 hover:bg-slate-50 rounded-lg text-slate-400 hover:text-slate-700 transition-all disabled:opacity-30",children:e.jsx(ts,{size:20})}),e.jsxs("div",{className:"flex flex-col items-center w-48",children:[e.jsx("span",{className:"text-sm font-bold text-slate-800 tabular-nums",children:Yl(k.startDate)}),e.jsxs("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider",children:["to ",Yl(k.endDate)]}),Fe()]}),e.jsx("button",{onClick:()=>Ye(1),disabled:D===w.length-1,className:"p-2 hover:bg-slate-50 rounded-lg text-slate-400 hover:text-slate-700 transition-all disabled:opacity-30",children:e.jsx(we,{size:20})})]})]})]}),X&&e.jsx("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-amber-100 rounded-xl text-amber-600 flex-shrink-0",children:e.jsx(mn,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-lg mb-2",children:m?"Edit your cycle settings":"Set up your Flying Blue cycle"}),e.jsxs("p",{className:"text-slate-600 text-sm mb-5",children:[m?"Update your qualification year settings below.":"To accurately track your XP, tell us when your qualification year started, what status you had, and your current XP balance."," ","Find this info at"," ",e.jsx("a",{href:"https://www.flyingblue.com",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:underline font-medium",children:"flyingblue.com"}),"."]}),e.jsx(Cc,{initialValues:m,onSave:ae=>{p(ae),v(!1)},onCancel:()=>{v(!1),m||R(!0)},onShowFaq:()=>F(!0)})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx(Mc,{actualStatus:z,actualXP:Y,actualXPToNext:O,projectedStatus:$,projectedXP:oe,projectedXPToNext:Q,nextStatus:fe,nextStatusThreshold:ue,currentCycle:k,theme:ce,isLevelUpCycle:Se,levelUpIsActual:Te,hasProjectedUpgrade:se,hasProjectedXPDifference:Z,actualProgress:be,projectedProgress:ve,isUltimate:ee,projectedUltimate:T,actualUXP:U?Math.max(k.actualUXP??0,950):k.actualUXP??0,projectedUXP:U?Math.max(k.projectedUXP??0,1e3):k.projectedUXP??0}),e.jsxs("div",{className:"lg:col-span-8 flex flex-col gap-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 h-[140px]",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm flex flex-col justify-between hover:border-slate-200 transition-colors relative z-0 hover:z-10",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Rollover (Start)"}),e.jsx(me,{text:"XP and UXP balances carried over from the previous qualification cycle."})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[Me?e.jsx("span",{className:"text-3xl font-black text-slate-800",children:k.rolloverIn}):e.jsx("input",{type:"number",value:n,onChange:ae=>he(Number(ae.target.value)),className:`text-3xl font-black text-slate-800 w-20 bg-transparent border-b-2 border-slate-100 focus:border-blue-500 focus:outline-none ${Xs}`}),e.jsx("span",{className:"text-sm font-bold text-slate-400",children:"XP"})]}),(z==="Platinum"||k.isUltimate)&&e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[Me?e.jsx("span",{className:"text-3xl font-black text-slate-600",children:k.uxpRolloverIn??0}):e.jsx("input",{type:"number",value:r,onChange:ae=>Ae(Number(ae.target.value)),className:`text-3xl font-black text-slate-600 w-20 bg-transparent border-b-2 border-slate-100 focus:border-slate-400 focus:outline-none ${Xs}`}),e.jsx("span",{className:"text-sm font-bold text-slate-400",children:"UXP"})]})]})]}),e.jsx("div",{className:"p-2.5 bg-slate-50 rounded-xl text-slate-500 border border-slate-100",children:e.jsx(za,{size:20})})]}),Me&&e.jsx("div",{className:"text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded w-fit uppercase tracking-wide",children:"Auto chained from previous cycle"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm flex flex-col justify-between hover:border-slate-200 transition-colors relative z-0 hover:z-10",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Cycle Performance"}),e.jsx(me,{text:"XP earned this cycle. Actual = flown flights. Projected = including scheduled flights."})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-4xl font-black text-slate-800",children:ie}),e.jsx("span",{className:"text-sm font-bold text-slate-400",children:"XP actual"})]}),H>ie&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-500 text-xs mt-1",children:[e.jsx(Ee,{size:10}),e.jsxs("span",{children:[H," XP projected"]})]})]}),e.jsx("div",{className:"p-2.5 bg-amber-50 rounded-xl text-amber-500 border border-amber-100",children:e.jsx(Ie,{size:20})})]}),e.jsxs("div",{className:"w-full bg-slate-100 h-1.5 rounded-full overflow-hidden relative",children:[H>ie&&e.jsx("div",{className:"absolute h-full bg-amber-200 rounded-full",style:{width:`${Math.min(100,H/300*100)}%`}}),e.jsx("div",{className:"absolute h-full bg-amber-400 rounded-full",style:{width:`${Math.min(100,ie/300*100)}%`}})]})]})]}),e.jsx(Fc,{chartData:W,avgNeeded:pe})]})]}),e.jsx(Ac,{currentCycle:k,enhancedLedger:gt,flights:x,manualLedger:o,theme:ce,isLevelUpCycle:Se,levelUpIsActual:Te,isChained:Me,onManualCellChange:ot,showUXP:z==="Platinum"||k.isUltimate}),e.jsx(Cr,{isOpen:N,onClose:()=>F(!1)})]})},Ot="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",qs=({title:t,value:s,subtitle:a,icon:n,color:l="blue",tooltip:r,highlight:i=!1})=>{const x={blue:"bg-blue-50 text-blue-700 border-blue-100",emerald:"bg-emerald-50 text-emerald-700 border-emerald-100",violet:"bg-violet-50 text-violet-700 border-violet-100",amber:"bg-amber-50 text-amber-700 border-amber-100",slate:"bg-slate-50 text-slate-700 border-slate-100",indigo:"bg-indigo-50 text-indigo-700 border-indigo-100"},c=x[l]||x.slate;return e.jsxs("div",{className:`bg-white p-5 rounded-[1.5rem] border border-slate-100 shadow-sm flex flex-col justify-between group hover:shadow-md transition-all z-0 hover:z-10 relative ${i?"ring-2 ring-indigo-100":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:t}),r&&e.jsx(me,{text:r})]}),e.jsx("div",{className:"text-2xl font-black text-slate-900 tracking-tight",children:s})]}),e.jsx("div",{className:`p-2.5 rounded-xl ${c}`,children:e.jsx(n,{size:18})})]}),e.jsx("p",{className:`text-xs font-medium ${a?.includes("+")?"text-emerald-600 font-bold":"text-slate-400"}`,children:a})]})},Aa=({icon:t,label:s,value:a,color:n="slate"})=>{const l={slate:"bg-slate-50 text-slate-600 border-slate-200",emerald:"bg-emerald-50 text-emerald-600 border-emerald-200",amber:"bg-amber-50 text-amber-600 border-amber-200",indigo:"bg-indigo-50 text-indigo-600 border-indigo-200"};return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-xl border text-xs font-medium ${l[n]}`,children:[e.jsx(t,{size:12}),e.jsxs("span",{className:"text-slate-500",children:[s,":"]}),e.jsx("span",{className:"font-bold",children:a})]})},Rc=({redemptions:t,onUpdate:s,baselineCpm:a,targetCpm:n})=>{const{format:l,symbol:r}=Ke(),{trackRedemption:i,trackRedemptionRemove:x,trackCalculator:c}=rt(),[o,u]=d.useState({date:new Date().toISOString().slice(0,10),description:"",award_miles:0,cash_price_estimate:0,surcharges:0}),[m,p]=d.useState("date"),[h,b]=d.useState("desc"),[g,S]=d.useState("all"),[P,C]=d.useState(null),[w,f]=d.useState({}),D=d.useMemo(()=>Nr(t,n,a),[t,a,n]),_=a/100,N=D.lifetime.avgBurnCpm/100,F=N-_,j=d.useMemo(()=>{if(D.processed.length===0)return{totalValue:0,totalMilesUsed:0,totalSurcharges:0,roiMultiplier:0,bestRedemption:null,worstRedemption:null,profitableCount:0,lossCount:0,valueOverTime:[]};const y=D.processed.reduce(($,Q)=>$+Q.value,0),U=D.processed.reduce(($,Q)=>$+Q.award_miles,0),M=D.processed.reduce(($,Q)=>$+Q.surcharges,0),z=U*_,K=z>0?y/z:0,Y=[...D.processed].sort(($,Q)=>Q.cpm-$.cpm),O=Y[0],V=Y[Y.length-1],J=D.processed.filter($=>$.cpm/100>=_).length,q=D.processed.length-J,B=[...D.processed].sort(($,Q)=>$.date.localeCompare(Q.date)).reduce(($,Q)=>{const oe=$.length>0?$[$.length-1].cumValue:0;return $.push({date:Q.date,cumValue:oe+Q.value}),$},[]);return{totalValue:y,totalMilesUsed:U,totalSurcharges:M,roiMultiplier:K,bestRedemption:O,worstRedemption:V,profitableCount:J,lossCount:q,valueOverTime:B}},[D.processed,_]),v=d.useMemo(()=>{let y=[...D.processed];return g==="profitable"?y=y.filter(U=>U.cpm/100>=_):g==="loss"&&(y=y.filter(U=>U.cpm/100<_)),y.sort((U,M)=>{let z,K;switch(m){case"date":return h==="desc"?M.date.localeCompare(U.date):U.date.localeCompare(M.date);case"award_miles":z=U.award_miles,K=M.award_miles;break;case"cpm":z=U.cpm,K=M.cpm;break;case"value":z=U.value,K=M.value;break;default:return 0}return h==="desc"?K-z:z-K}),y},[D.processed,m,h,g,_]),A=()=>{if(!o.description||!o.award_miles)return;const y={id:ba(),date:o.date||new Date().toISOString().slice(0,10),description:o.description,award_miles:Number(o.award_miles),cash_price_estimate:Number(o.cash_price_estimate),surcharges:Number(o.surcharges),override_cpm:void 0},U=Number(o.cash_price_estimate)/Number(o.award_miles);let M="poor";U>.02?M="excellent":U>.015?M="good":U>.01&&(M="fair"),i(Number(o.award_miles),M),c("redemption"),s([y,...t]),u({date:new Date().toISOString().slice(0,10),description:"",award_miles:0,cash_price_estimate:0,surcharges:0})},R=y=>{m===y?b(h==="desc"?"asc":"desc"):(p(y),b("desc"))},X=y=>{C(y.id),f({date:y.date,description:y.description,award_miles:y.award_miles,cash_price_estimate:y.cash_price_estimate,surcharges:y.surcharges})},L=()=>{C(null),f({})},G=()=>{P&&(s(t.map(y=>y.id===P?{...y,date:w.date||y.date,description:w.description||y.description,award_miles:Number(w.award_miles)||y.award_miles,cash_price_estimate:Number(w.cash_price_estimate)||0,surcharges:Number(w.surcharges)||0}:y)),C(null),f({}))},k=d.useMemo(()=>{const y=Number(o.award_miles)||0,U=Number(o.cash_price_estimate)||0,M=Number(o.surcharges)||0;if(y<=0)return null;const z=U-M,K=z/y,Y=qa(K,n,_);return{euroPerMile:K,valuation:Y,netValue:z}},[o,_,n]),I=d.useMemo(()=>[...new Set(t.map(y=>y.description))].slice(0,3),[t]);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 pb-12",children:[e.jsx("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsxs("span",{className:"px-3 py-1 rounded-full bg-orange-50 text-orange-600 text-[10px] font-bold uppercase tracking-wide border border-orange-100 flex items-center gap-1.5",children:[e.jsx(da,{size:12,fill:"currentColor"})," Burn Optimizer"]})}),e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Redemption Analyzer"}),e.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Track value of spent miles vs your acquisition cost."})]}),D.processed.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-start",children:[e.jsx(Aa,{icon:le,label:"Redemptions",value:D.processed.length,color:"indigo"}),e.jsx(Aa,{icon:ws,label:"Best",value:j.bestRedemption?`${r}${(j.bestRedemption.cpm/100).toFixed(4)}`:"-",color:"emerald"}),e.jsx(Aa,{icon:Ie,label:"ROI",value:`${j.roiMultiplier.toFixed(1)}x`,color:j.roiMultiplier>=1?"emerald":"amber"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(qs,{title:"Total Value Created",value:l(j.totalValue),subtitle:`${ne(j.totalMilesUsed)} miles redeemed`,icon:De,color:"indigo",tooltip:"Sum of (Cash Price - Surcharges) for all redemptions.",highlight:!0}),e.jsx(qs,{title:"Baseline (CPM)",value:`${r}${_.toFixed(4)}`,subtitle:"Your acquisition cost",icon:Je,color:"slate",tooltip:"Your average cost per mile from Miles Engine. Redemptions below this lose money."}),e.jsx(qs,{title:"Avg. Redemption",value:`${r}${N.toFixed(4)}`,subtitle:`${F>=0?"+":""}${r}${F.toFixed(4)} vs baseline`,icon:Ie,color:F>=0?"emerald":"amber",tooltip:"Average value realized per mile across all redemptions."}),e.jsx(qs,{title:"ROI Multiplier",value:`${j.roiMultiplier.toFixed(1)}x`,subtitle:j.roiMultiplier>=1?"Profitable overall":"Below break-even",icon:Pt,color:j.roiMultiplier>=1?"emerald":"amber",tooltip:"Total Value / (Miles Ã Baseline CPM). Above 1x = profit."})]}),D.processed.length>0&&e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ws,{size:18,className:"text-amber-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"Performance Range"}),e.jsx(me,{text:"The spread between your best and worst redemptions."})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),e.jsxs("span",{className:"text-slate-500",children:["Profitable (",j.profitableCount,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),e.jsxs("span",{className:"text-slate-500",children:["Loss (",j.lossCount,")"]})]})]})]}),e.jsxs("div",{className:"relative h-12 bg-slate-100 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-slate-400 z-10",style:{left:`${Math.min(95,Math.max(5,_/((j.bestRedemption?.cpm||1)/100)*100))}%`},children:e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 text-[9px] font-bold text-slate-500 whitespace-nowrap",children:"Baseline"})}),D.processed.map((y,U)=>{const M=(j.bestRedemption?.cpm||1)/100,z=Math.min(95,Math.max(5,y.cpm/100/M*100)),K=y.cpm/100>=_;return e.jsx("div",{className:`absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 border-white shadow-md cursor-pointer hover:scale-125 transition-transform ${K?"bg-emerald-500":"bg-red-400"}`,style:{left:`${z}%`},title:`${y.description}: ${r}${(y.cpm/100).toFixed(4)}`},y.id)})]}),e.jsxs("div",{className:"flex justify-between mt-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-red-500 uppercase",children:"Worst"}),e.jsxs("div",{className:"text-lg font-black text-slate-800",children:[r,((j.worstRedemption?.cpm||0)/100).toFixed(4)]}),e.jsx("div",{className:"text-[10px] text-slate-400 truncate max-w-[120px]",children:j.worstRedemption?.description||"-"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] font-bold text-emerald-500 uppercase",children:"Best"}),e.jsxs("div",{className:"text-lg font-black text-slate-800",children:[r,((j.bestRedemption?.cpm||0)/100).toFixed(4)]}),e.jsx("div",{className:"text-[10px] text-slate-400 truncate max-w-[120px]",children:j.bestRedemption?.description||"-"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-lg shadow-slate-200/50 sticky top-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(ks,{size:16,className:"text-slate-400"}),"New Redemption"]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1.5 flex items-center gap-1",children:[e.jsx(et,{size:10})," Date"]}),e.jsx("input",{type:"date",value:o.date,onChange:y=>u({...o,date:y.target.value}),className:"w-full p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium text-slate-800 focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1.5 block",children:"Description"}),e.jsx("input",{type:"text",placeholder:"e.g. AMS-JFK Business Class",value:o.description,onChange:y=>u({...o,description:y.target.value}),className:"w-full p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium text-slate-800 focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 outline-none transition-all"}),I.length>0&&!o.description&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:I.map((y,U)=>e.jsx("button",{onClick:()=>u({...o,description:y}),className:"text-[10px] px-2 py-1 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg transition-colors",children:y},U))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1.5 flex items-center gap-1",children:[e.jsx(_s,{size:10})," Miles Used"]}),e.jsx("input",{type:"number",placeholder:"0",value:o.award_miles||"",onChange:y=>u({...o,award_miles:Number(y.target.value)}),className:`w-full p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold text-slate-800 focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 outline-none transition-all ${Ot}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1.5 flex items-center gap-1",children:[e.jsx(ui,{size:10})," Surcharges"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",placeholder:"0",value:o.surcharges||"",onChange:y=>u({...o,surcharges:Number(y.target.value)}),className:`w-full p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium text-slate-800 focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 outline-none transition-all pr-8 ${Ot}`}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs",children:r})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1.5 flex items-center gap-1",children:[e.jsx(Je,{size:10})," Cash Price Equivalent"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",placeholder:"0",value:o.cash_price_estimate||"",onChange:y=>u({...o,cash_price_estimate:Number(y.target.value)}),className:`w-full p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium text-slate-800 focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 outline-none transition-all pr-8 ${Ot}`}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs",children:r})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"What would this ticket cost in cash?"})]}),k&&e.jsxs("div",{className:`rounded-xl p-4 border transition-all duration-300 ${k.valuation.label==="Legendary"?"bg-violet-50 border-violet-200":k.valuation.label==="Excellent"?"bg-emerald-50 border-emerald-200":k.valuation.label==="Good"?"bg-blue-50 border-blue-200":k.valuation.label==="Fair"?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Projected Value"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl font-black text-slate-900",children:[r,k.euroPerMile.toFixed(4)]}),e.jsx("span",{className:"text-xs text-slate-500",children:"per mile"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider flex items-center gap-1.5 ${k.valuation.color}`,children:[k.valuation.icon&&e.jsx(k.valuation.icon,{size:12}),k.valuation.label]})})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200/50",children:e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{className:"text-slate-500",children:["vs Baseline (",r,_.toFixed(4),")"]}),e.jsxs("span",{className:`font-bold ${k.euroPerMile>=_?"text-emerald-600":"text-red-500"}`,children:[k.euroPerMile>=_?"+":"",((k.euroPerMile-_)/_*100).toFixed(0),"%"]})]})})]}),e.jsxs("button",{onClick:A,disabled:!o.description||!o.award_miles,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-colors shadow-lg shadow-slate-200 flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ks,{size:16})," Add Redemption"]})]})}),j.valueOverTime.length>1&&e.jsxs("div",{className:"bg-white p-5 rounded-[1.5rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Be,{size:14,className:"text-indigo-500"}),e.jsx("h3",{className:"font-bold text-slate-800 text-sm",children:"Cumulative Value"})]}),e.jsx("div",{className:"h-24",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(tl,{data:j.valueOverTime,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"valueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),e.jsx(sl,{type:"monotone",dataKey:"cumValue",stroke:"#6366f1",strokeWidth:2,fill:"url(#valueGradient)"})]})})}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-1",children:[e.jsx("span",{children:j.valueOverTime[0]?.date}),e.jsx("span",{className:"font-bold text-indigo-600",children:l(j.totalValue)})]})]})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:["Value Map",e.jsx(me,{text:"Scatter plot of all redemptions. Dots above the dashed line are profitable."})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Higher dots = better value per mile"})]}),e.jsxs("div",{className:"flex gap-3 text-[10px] font-medium",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500"})," Above baseline"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-400"})," Below baseline"]})]})]}),e.jsx("div",{className:"h-72 w-full",children:D.processed.length>0?e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(hn,{margin:{top:20,right:20,bottom:20,left:0},children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{type:"number",dataKey:"award_miles",name:"Miles",tick:{fontSize:10,fill:"#94a3b8"},axisLine:!1,tickLine:!1,tickFormatter:y=>`${(y/1e3).toFixed(0)}k`}),e.jsx(Et,{type:"number",dataKey:"value",name:"Value",tick:{fontSize:10,fill:"#94a3b8"},axisLine:!1,tickLine:!1,tickFormatter:y=>`${r}${y}`}),e.jsx(ft,{cursor:{strokeDasharray:"3 3"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"},content:({active:y,payload:U})=>{if(y&&U&&U.length){const M=U[0].payload;return e.jsxs("div",{className:"bg-slate-900 text-white p-3 rounded-xl shadow-xl text-xs",children:[e.jsx("p",{className:"font-bold mb-1",children:M.description}),e.jsxs("p",{children:["Miles: ",ne(M.award_miles)]}),e.jsxs("p",{children:["Value: ",l(M.value)]}),e.jsxs("p",{className:"text-emerald-400 font-bold",children:[r,(M.cpm/100).toFixed(4),"/mi"]})]})}return null}}),e.jsx(os,{segment:[{x:0,y:0},{x:Math.max(...D.processed.map(y=>y.award_miles))*1.1,y:Math.max(...D.processed.map(y=>y.award_miles))*1.1*_}],stroke:"#94a3b8",strokeDasharray:"5 5",strokeWidth:2}),e.jsx(os,{segment:[{x:0,y:0},{x:Math.max(...D.processed.map(y=>y.award_miles))*1.1,y:Math.max(...D.processed.map(y=>y.award_miles))*1.1*n}],stroke:"#f59e0b",strokeDasharray:"3 3",strokeOpacity:.5}),e.jsx(pn,{name:"Redemptions",data:D.processed,children:D.processed.map((y,U)=>{const M=y.cpm/100>=_;return e.jsx(Zs,{fill:M?"#10b981":"#f87171",r:8},`cell-${U}`)})})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{size:48,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"Add redemptions to see the value map"})]})})})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100 bg-slate-50/30 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Oe,{size:18,className:"text-slate-400"}),"Redemption Log",D.processed.length>0&&e.jsxs("span",{className:"text-xs font-medium text-slate-400 bg-white px-2 py-0.5 rounded-lg border border-slate-200",children:[v.length," of ",D.processed.length]})]}),D.processed.length>0&&e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:g,onChange:y=>S(y.target.value),className:"text-xs bg-white border border-slate-200 rounded-lg px-2 py-1.5 text-slate-600 font-medium focus:outline-none focus:ring-2 focus:ring-indigo-500/20",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"profitable",children:"Profitable"}),e.jsx("option",{value:"loss",children:"Loss"})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold text-[10px] uppercase tracking-wider border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3",children:"Description"}),e.jsx("th",{className:"px-5 py-3 text-right cursor-pointer hover:text-slate-600 transition-colors",onClick:()=>R("award_miles"),children:e.jsxs("span",{className:"flex items-center justify-end gap-1",children:["Miles",m==="award_miles"&&e.jsx(Na,{size:10})]})}),e.jsx("th",{className:"px-5 py-3 text-right cursor-pointer hover:text-slate-600 transition-colors",onClick:()=>R("value"),children:e.jsxs("span",{className:"flex items-center justify-end gap-1",children:["Value",m==="value"&&e.jsx(Na,{size:10})]})}),e.jsx("th",{className:"px-5 py-3 text-right cursor-pointer hover:text-slate-600 transition-colors",onClick:()=>R("cpm"),children:e.jsxs("span",{className:"flex items-center justify-end gap-1",children:["CPM",m==="cpm"&&e.jsx(Na,{size:10})]})}),e.jsx("th",{className:"px-5 py-3",children:"Verdict"}),e.jsx("th",{className:"px-5 py-3 w-10"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-50",children:[v.map(y=>{const U=y.cpm/100,M=U-_,z=qa(U,n,_),K=_>0?M/_*100:0,Y=P===y.id,O=t.find(V=>V.id===y.id);return Y&&O?e.jsxs("tr",{className:"bg-blue-50/50",children:[e.jsxs("td",{className:"px-5 py-3",children:[e.jsx("input",{type:"text",value:w.description||"",onChange:V=>f({...w,description:V.target.value}),className:`w-full p-1.5 border border-slate-200 rounded-lg text-xs font-medium focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${Ot}`,placeholder:"Description"}),e.jsx("input",{type:"date",value:w.date||"",onChange:V=>f({...w,date:V.target.value}),className:`w-full mt-1 p-1 border border-slate-200 rounded text-[10px] focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${Ot}`})]}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("input",{type:"number",value:w.award_miles||"",onChange:V=>f({...w,award_miles:Number(V.target.value)}),className:`w-full p-1.5 border border-slate-200 rounded-lg text-xs text-right focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${Ot}`})}),e.jsxs("td",{className:"px-3 py-3",children:[e.jsx("input",{type:"number",value:w.cash_price_estimate||"",onChange:V=>f({...w,cash_price_estimate:Number(V.target.value)}),className:`w-full p-1.5 border border-slate-200 rounded-lg text-xs text-right focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${Ot}`,placeholder:"Cash value",step:"0.01"}),e.jsx("input",{type:"number",value:w.surcharges||"",onChange:V=>f({...w,surcharges:Number(V.target.value)}),className:`w-full mt-1 p-1 border border-slate-200 rounded text-[10px] text-right focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 ${Ot}`,placeholder:"Surcharges",step:"0.01"})]}),e.jsx("td",{className:"px-5 py-3 text-center text-slate-400 text-xs",children:"â"}),e.jsx("td",{className:"px-5 py-3 text-center text-slate-400 text-xs",children:"â"}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:G,className:"p-1.5 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:e.jsx(xa,{size:12})}),e.jsx("button",{onClick:L,className:"p-1.5 bg-slate-200 text-slate-600 rounded-lg hover:bg-slate-300 transition-colors",children:e.jsx(Ce,{size:12})})]})})]},y.id):e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[e.jsxs("td",{className:"px-5 py-3",children:[e.jsx("div",{className:"font-bold text-slate-800",children:y.description}),e.jsx("div",{className:"text-[10px] text-slate-400",children:y.date})]}),e.jsx("td",{className:"px-5 py-3 text-right font-mono text-slate-600 text-xs",children:ne(y.award_miles)}),e.jsx("td",{className:"px-5 py-3 text-right font-mono text-slate-600 text-xs",children:l(y.value)}),e.jsxs("td",{className:"px-5 py-3 text-right",children:[e.jsxs("div",{className:"font-bold text-slate-900",children:[r,U.toFixed(4)]}),e.jsxs("div",{className:`text-[10px] font-medium ${M>=0?"text-emerald-600":"text-red-500"}`,children:[M>=0?"+":"",K.toFixed(0),"%"]})]}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide ${z.color}`,children:z.label})}),e.jsx("td",{className:"px-5 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>O&&X(O),className:"p-1 rounded-lg text-slate-300 hover:text-blue-600 hover:bg-blue-50 transition-colors",title:"Edit redemption",children:e.jsx(Kt,{size:14})}),e.jsx("button",{onClick:()=>{x(1),s(t.filter(V=>V.id!==y.id))},className:"p-1 rounded-lg text-slate-300 hover:text-red-500 hover:bg-red-50 transition-colors",title:"Delete redemption",children:e.jsx(ss,{size:14})})]})})]},y.id)}),v.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-5 py-12 text-center text-slate-400 text-xs",children:D.processed.length===0?"No redemptions recorded yet.":"No redemptions match this filter."})})]}),v.length>0&&e.jsx("tfoot",{className:"bg-slate-50 border-t border-slate-200",children:e.jsxs("tr",{className:"font-bold text-slate-700",children:[e.jsx("td",{className:"px-5 py-3 text-xs uppercase tracking-wider",children:"Total"}),e.jsx("td",{className:"px-5 py-3 text-right font-mono text-xs",children:ne(v.reduce((y,U)=>y+U.award_miles,0))}),e.jsx("td",{className:"px-5 py-3 text-right font-mono text-xs",children:l(v.reduce((y,U)=>y+U.value,0))}),e.jsxs("td",{className:"px-5 py-3 text-right text-xs",children:[r,(v.reduce((y,U)=>y+U.value,0)/Math.max(1,v.reduce((y,U)=>y+U.award_miles,0))).toFixed(4)]}),e.jsx("td",{colSpan:2})]})})]})})]})]})]})]})},_c=$e+300,We=({title:t,value:s,subtext:a,icon:n,colorClass:l,tooltip:r,trend:i})=>e.jsxs("div",{className:"bg-white p-5 rounded-3xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] flex flex-col justify-between h-full group hover:shadow-md transition-all relative z-0 hover:z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wider",children:t}),r&&e.jsx(me,{text:r})]}),e.jsx("div",{className:`p-2 rounded-xl ${l.bg} ${l.text} group-hover:scale-110 transition-transform`,children:e.jsx(n,{size:18})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-3xl font-black text-slate-900 tracking-tight flex items-center gap-2",children:[s,i&&e.jsxs("span",{className:`text-xs font-bold px-1.5 py-0.5 rounded ${i>0?"bg-emerald-50 text-emerald-600":"bg-red-50 text-red-500"}`,children:[i>0?"+":"",i,"%"]})]}),a&&e.jsx("div",{className:"text-xs font-medium text-slate-500 mt-1",children:a})]})]}),Vs=({active:t,onClick:s,icon:a,label:n})=>e.jsxs("button",{onClick:s,className:`flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold transition-all ${t?"bg-slate-900 text-white shadow-lg":"bg-white text-slate-600 border border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:[e.jsx(a,{size:16}),n]}),Uc=({icon:t,title:s,description:a,color:n="blue"})=>{const l={blue:"bg-blue-50 border-blue-100 text-blue-600",emerald:"bg-emerald-50 border-emerald-100 text-emerald-600",amber:"bg-amber-50 border-amber-100 text-amber-600",violet:"bg-violet-50 border-violet-100 text-violet-600"};return e.jsxs("div",{className:`p-4 rounded-2xl border ${l[n]} flex items-start gap-3`,children:[e.jsx("div",{className:"p-2 rounded-xl bg-white/60",children:e.jsx(t,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:s}),e.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:a})]})]})},Tc=({xpData:t,rollover:s,redemptions:a,milesData:n,currentMonth:l,targetCPM:r})=>{const{format:i,symbol:x}=Ke(),{trackAnalyticsSection:c}=rt(),[o,u]=d.useState("overview"),m=N=>{c(N),u(N)};d.useEffect(()=>{c("overview")},[]);const p=N=>N===0?`${x}0.0000`:`${x}${N.toFixed(4)}`,h=d.useMemo(()=>{if(n.length===0)return null;const N=[...n].sort((q,B)=>q.month.localeCompare(B.month));let F=0;const j=N.map(q=>{const B=q.miles_subscription+q.miles_amex+q.miles_flight+q.miles_other,$=q.miles_debit;F+=B-$;const Q=q.cost_subscription+q.cost_amex+q.cost_flight+q.cost_other,oe=B>0?Q/B:0;return{month:q.month,earned:B,burned:$,net:B-$,balance:F,cpm:oe,subscription:q.miles_subscription,amex:q.miles_amex,flight:q.miles_flight,other:q.miles_other}}),v=N.reduce((q,B)=>(q.subscription+=B.miles_subscription,q.amex+=B.miles_amex,q.flight+=B.miles_flight,q.other+=B.miles_other,q.costSubscription+=B.cost_subscription,q.costAmex+=B.cost_amex,q.costFlight+=B.cost_flight,q.costOther+=B.cost_other,q.totalBurned+=B.miles_debit,q),{subscription:0,amex:0,flight:0,other:0,costSubscription:0,costAmex:0,costFlight:0,costOther:0,totalBurned:0}),A=v.subscription+v.amex+v.flight+v.other,R=v.costSubscription+v.costAmex+v.costFlight+v.costOther,X=A>0?R/A:0,L=[{name:"Subscription",value:v.subscription,cost:v.costSubscription,fill:"#6366f1"},{name:"Amex/Cards",value:v.amex,cost:v.costAmex,fill:"#3b82f6"},{name:"Flying",value:v.flight,cost:v.costFlight,fill:"#10b981"},{name:"Other",value:v.other,cost:v.costOther,fill:"#f59e0b"}].filter(q=>q.value>0),G=[{name:"Subscription",cpm:v.subscription>0?v.costSubscription/v.subscription:0,miles:v.subscription},{name:"Amex/Cards",cpm:v.amex>0?v.costAmex/v.amex:0,miles:v.amex},{name:"Flying",cpm:v.flight>0?v.costFlight/v.flight:0,miles:v.flight},{name:"Other",cpm:v.other>0?v.costOther/v.other:0,miles:v.other}].filter(q=>q.miles>0).sort((q,B)=>q.cpm-B.cpm),k=j.filter(q=>q.month<=l),I=k[0]?.balance||0,y=k[k.length-1]?.balance||0,U=I>0?(y-I)/I*100:0,M=k.length>0?k.reduce((q,B)=>q+B.earned,0)/k.length:0,z=k.length>0?k.reduce((q,B)=>q+B.burned,0)/k.length:0,K=y,Y=z>0?Math.round(K/z):1/0,O=G.length>0?G[0]:null,V=k.slice(-3),J=V.length>=2?(V[V.length-1].earned-V[0].earned)/Math.max(1,V[0].earned)*100:0;return{balanceHistory:j,sourceBreakdown:L,sourceCPM:G,totalEarned:A,totalCost:R,totalBurned:v.totalBurned,avgCPM:X,currentBalance:K,growthRate:U,avgMonthlyEarn:M,avgMonthlyBurn:z,monthsRunway:Y,bestSource:O,momTrend:J}},[n,l]),b=d.useMemo(()=>nl(t,s),[t,s]),g=Object.keys(b).map(Number).sort((N,F)=>N-F);let S=0,P=0;const C=g.map(N=>{const F=b[N],j=F.totalXP-F.rolloverIn,v=Math.max(0,F.totalXP-_c);return S+=j,P+=v,{year:N,totalXP:F.totalXP,rolloverIn:F.rolloverIn,earned:j,rolloverOut:F.rolloverOut,waste:v,utilized:F.totalXP-v}}),w=S>0?(S-P)/S*100:100,f=d.useMemo(()=>{if(a.length===0)return null;const N=a.map(X=>{const L=X.cash_price_estimate-X.surcharges,G=X.award_miles>0?L/X.award_miles:0;return{...X,cpm:G,value:L}}),F=N.reduce((X,L)=>X+L.value,0),j=N.reduce((X,L)=>X+L.award_miles,0),v=j>0?F/j:0,A=N.reduce((X,L)=>L.cpm>(X?.cpm||0)?L:X,N[0]),R=N.reduce((X,L)=>L.cpm<(X?.cpm||1/0)?L:X,N[0]);return{processed:N,totalValue:F,totalMilesUsed:j,avgCPM:v,bestRedemption:A,worstRedemption:R,count:N.length}},[a]),D=[{name:"Utilized",value:S-P,fill:"#3b82f6"},{name:"Wasted (Cap)",value:P,fill:"#cbd5e1"}],_=d.useMemo(()=>{const N=[];return h&&(h.bestSource&&h.bestSource.cpm===0?N.push({icon:Be,title:`${h.bestSource.name} is your best source`,description:`Free miles! ${ne(h.bestSource.miles)} miles at ${x}0.0000 CPM`,color:"emerald"}):h.bestSource&&N.push({icon:Ge,title:`${h.bestSource.name} is most efficient`,description:`Lowest CPM at ${p(h.bestSource.cpm)} per mile`,color:"blue"}),h.growthRate>50&&N.push({icon:Ie,title:`Portfolio grew ${h.growthRate.toFixed(0)}%`,description:"Strong accumulation momentum across tracked months",color:"emerald"}),h.monthsRunway<12&&h.monthsRunway>0?N.push({icon:_e,title:`${h.monthsRunway} months runway`,description:"At current burn rate, consider slowing redemptions",color:"amber"}):h.monthsRunway>=24&&N.push({icon:Oe,title:"Healthy runway",description:`${h.monthsRunway===1/0?"Unlimited":h.monthsRunway+"+ months"} at current burn rate`,color:"blue"})),w<80?N.push({icon:_e,title:`${(100-w).toFixed(0)}% XP above cap`,description:`${P} XP exceeded rollover limits â you over-achieved!`,color:"amber"}):w>=95&&N.push({icon:je,title:"Excellent XP management",description:"Near-perfect utilization of earned XP",color:"emerald"}),f&&f.avgCPM>r&&N.push({icon:Je,title:"Redemptions beat target",description:`Avg ${p(f.avgCPM)} vs ${p(r)} target`,color:"emerald"}),N.slice(0,4)},[h,w,P,f,r]);return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-12",children:[e.jsx("div",{className:"bg-white p-6 rounded-[2.5rem] border border-slate-100 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Analytics Center"}),e.jsx("p",{className:"text-slate-500 mt-1 font-medium",children:"Deep dive into your loyalty efficiency and value creation."})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(Vs,{active:o==="overview",onClick:()=>m("overview"),icon:Ht,label:"Overview"}),e.jsx(Vs,{active:o==="miles",onClick:()=>m("miles"),icon:Oe,label:"Miles"}),e.jsx(Vs,{active:o==="xp",onClick:()=>m("xp"),icon:Pt,label:"XP"}),e.jsx(Vs,{active:o==="redemptions",onClick:()=>m("redemptions"),icon:De,label:"Redemptions"})]})]})}),o==="overview"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(We,{title:"Portfolio Value",value:i((h?.currentBalance||0)*r),subtext:`${ne(h?.currentBalance||0)} miles @ target CPM`,icon:Oe,colorClass:{bg:"bg-blue-50",text:"text-blue-600"},tooltip:"Current miles balance valued at your target redemption rate."}),e.jsx(We,{title:"Lifetime Value Created",value:i(f?.totalValue||0),subtext:`${f?.count||0} redemptions`,icon:De,colorClass:{bg:"bg-indigo-50",text:"text-indigo-600"},tooltip:"Sum of (Cash Price - Taxes) for all redemptions."}),e.jsx(We,{title:"XP Efficiency",value:`${w.toFixed(0)}%`,subtext:w>=90?"Well optimized":`${P} XP above cap`,icon:w>=90?je:_e,colorClass:w>=90?{bg:"bg-emerald-50",text:"text-emerald-600"}:{bg:"bg-amber-50",text:"text-amber-600"},tooltip:"XP earned beyond the 300 rollover cap doesn't carry over. This isn't lost progress â you still reached your status! It means you could achieve the same result with fewer flights."}),e.jsx(We,{title:"Acquisition Cost",value:p(h?.avgCPM||0),subtext:"Weighted average CPM",icon:Ge,colorClass:{bg:"bg-violet-50",text:"text-violet-600"},tooltip:"Average cost per mile across all sources."})]}),_.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(mn,{size:20,className:"text-amber-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"Key Insights"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:_.map((N,F)=>e.jsx(Uc,{...N},F))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h&&e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(Oe,{size:18,className:"text-slate-400"}),"Miles Balance Trend",e.jsx(me,{text:"Your miles portfolio value over time."})]}),e.jsx("div",{className:"h-[250px]",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(tl,{data:h.balanceHistory,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"balanceGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"month",tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(Et,{tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1,tickFormatter:N=>`${(N/1e3).toFixed(0)}k`}),e.jsx(ft,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"},formatter:N=>[ne(N),"Balance"]}),e.jsx(sl,{type:"monotone",dataKey:"balance",stroke:"#3b82f6",strokeWidth:2,fill:"url(#balanceGradient)"})]})})})]}),h&&h.sourceBreakdown.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(hl,{size:18,className:"text-slate-400"}),"Source Diversification",e.jsx(me,{text:"Where your miles come from."})]}),e.jsxs("div",{className:"h-[250px] flex items-center",children:[e.jsx("div",{className:"w-1/2 h-full",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(fl,{children:[e.jsx(jl,{data:h.sourceBreakdown,innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",stroke:"none",children:h.sourceBreakdown.map((N,F)=>e.jsx(Zs,{fill:N.fill},`cell-${F}`))}),e.jsx(ft,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"},formatter:N=>[ne(N),"Miles"]})]})})}),e.jsx("div",{className:"w-1/2 space-y-2",children:h.sourceBreakdown.map((N,F)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:N.fill}}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:N.name})]}),e.jsxs("span",{className:"text-xs font-bold text-slate-800",children:[(N.value/h.totalEarned*100).toFixed(0),"%"]})]},F))})]})]})]})]}),o==="miles"&&h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(We,{title:"Current Balance",value:ne(h.currentBalance),subtext:`Worth ${i(h.currentBalance*r)}`,icon:Oe,colorClass:{bg:"bg-blue-50",text:"text-blue-600"},trend:h.momTrend>0?Math.round(h.momTrend):void 0}),e.jsx(We,{title:"Avg Monthly Earn",value:ne(Math.round(h.avgMonthlyEarn)),subtext:"Miles per month",icon:Ie,colorClass:{bg:"bg-emerald-50",text:"text-emerald-600"}}),e.jsx(We,{title:"Total Invested",value:i(h.totalCost),subtext:`For ${ne(h.totalEarned)} miles`,icon:Bt,colorClass:{bg:"bg-violet-50",text:"text-violet-600"}}),e.jsx(We,{title:"Burn Runway",value:h.monthsRunway===1/0?"â":`${h.monthsRunway} mo`,subtext:`Avg burn: ${ne(Math.round(h.avgMonthlyBurn))}/mo`,icon:Za,colorClass:{bg:"bg-amber-50",text:"text-amber-600"}})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(Ht,{size:18,className:"text-slate-400"}),"Earn vs Burn",e.jsx(me,{text:"Monthly miles inflow (earned) vs outflow (burned)."})]}),e.jsx("div",{className:"h-[300px]",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(Si,{data:h.balanceHistory,children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"month",tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(Et,{tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(ft,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"}}),e.jsx(Dt,{dataKey:"earned",fill:"#3b82f6",radius:[4,4,0,0],name:"Earned"}),e.jsx(Dt,{dataKey:"burned",fill:"#f87171",radius:[4,4,0,0],name:"Burned"}),e.jsx(ta,{type:"monotone",dataKey:"balance",stroke:"#0f172a",strokeWidth:2,dot:!1,name:"Balance"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(Ge,{size:18,className:"text-slate-400"}),"Source Efficiency",e.jsx(me,{text:"CPM comparison by source. Lower is better."})]}),e.jsxs("div",{className:"space-y-3",children:[h.sourceCPM.map((N,F)=>{const j=Math.max(...h.sourceCPM.map(X=>X.cpm),r),v=j>0?N.cpm/j*100:0,A=F===0,R=N.cpm>r;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-medium text-slate-600",children:N.name}),e.jsx("span",{className:`text-xs font-bold ${A?"text-emerald-600":R?"text-amber-600":"text-slate-700"}`,children:p(N.cpm)})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${N.cpm===0||A?"bg-emerald-500":R?"bg-amber-400":"bg-blue-500"}`,style:{width:N.cpm===0?"5%":`${Math.max(5,v)}%`}})}),e.jsxs("div",{className:"text-[10px] text-slate-400",children:[ne(N.miles)," miles",N.cpm===0&&" â¢ Free!"]})]},N.name)}),e.jsx("div",{className:"pt-2 border-t border-slate-100 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center text-[10px]",children:[e.jsx("span",{className:"text-slate-400",children:"Target CPM"}),e.jsx("span",{className:"font-bold text-slate-600",children:p(r)})]})})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(Ps,{size:18,className:"text-slate-400"}),"CPM Trend Over Time",e.jsx(me,{text:"Are your miles getting cheaper? Downward trend is good."})]}),e.jsx("div",{className:"h-[200px]",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(un,{data:h.balanceHistory.filter(N=>N.cpm>0),children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"month",tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(Et,{tick:{fontSize:10,fill:"#64748b"},axisLine:!1,tickLine:!1,tickFormatter:N=>`${x}${N.toFixed(3)}`}),e.jsx(ft,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontSize:"11px"},formatter:N=>[p(N),"CPM"]}),e.jsx(os,{y:r,stroke:"#f59e0b",strokeDasharray:"5 5"}),e.jsx(ta,{type:"monotone",dataKey:"cpm",stroke:"#0f172a",strokeWidth:2,dot:{r:3,fill:"#0f172a"}})]})})})]})]}),o==="xp"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(We,{title:"Total XP Generated",value:S,subtext:"Cumulative earned XP",icon:Pt,colorClass:{bg:"bg-amber-50",text:"text-amber-600"}}),e.jsx(We,{title:"XP Efficiency",value:`${w.toFixed(1)}%`,subtext:P>0?`${P} XP above cap`:"Perfectly optimized!",icon:w>=90?je:_e,colorClass:w>=90?{bg:"bg-emerald-50",text:"text-emerald-600"}:{bg:"bg-amber-50",text:"text-amber-600"},tooltip:"XP beyond the 300 rollover cap doesn't carry over â but you still earned your status!"}),e.jsx(We,{title:"Years Tracked",value:g.length,subtext:`${g[0]||"-"} - ${g[g.length-1]||"-"}`,icon:Ht,colorClass:{bg:"bg-blue-50",text:"text-blue-600"}}),e.jsx(We,{title:"Avg XP / Year",value:g.length>0?Math.round(S/g.length):0,subtext:"Average annual earnings",icon:Je,colorClass:{bg:"bg-violet-50",text:"text-violet-600"}})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(Ht,{size:18,className:"text-slate-400"}),"XP Source History",e.jsx(me,{text:"Year-over-year XP breakdown. Light = rollover, Dark = new earnings."})]}),e.jsxs("div",{className:"flex gap-4 text-[10px] font-bold uppercase tracking-wider",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-slate-600",children:[e.jsx("div",{className:"w-2.5 h-2.5 bg-blue-500 rounded-sm"})," Earned"]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-slate-600",children:[e.jsx("div",{className:"w-2.5 h-2.5 bg-sky-200 rounded-sm"})," Rollover"]})]})]}),e.jsx("div",{className:"h-[300px]",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(ua,{data:C,barSize:40,children:[e.jsx(zt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Xt,{dataKey:"year",tick:{fontSize:12,fill:"#64748b",fontWeight:600},axisLine:!1,tickLine:!1}),e.jsx(Et,{tick:{fontSize:12,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(ft,{cursor:{fill:"#f8fafc"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"}}),e.jsx(os,{y:$e,stroke:"#0f172a",strokeDasharray:"3 3",strokeOpacity:.2}),e.jsx(Dt,{dataKey:"rolloverIn",stackId:"a",fill:"#bae6fd",radius:[0,0,4,4],name:"Rollover In"}),e.jsx(Dt,{dataKey:"earned",stackId:"a",fill:"#3b82f6",radius:[4,4,0,0],name:"XP Earned"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(hl,{size:18,className:"text-slate-400"}),"Rollover Efficiency",e.jsx(me,{text:"Shows how much of your earned XP stayed within the 300 rollover cap. XP above this cap doesn't carry over, but you still earned your status â this metric helps optimize future flight timing."})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative h-[200px]",children:[e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col pointer-events-none",children:[e.jsxs("span",{className:"text-3xl font-black text-slate-800",children:[w.toFixed(0),"%"]}),e.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Efficiency"})]}),e.jsx(at,{width:"100%",height:"100%",children:e.jsx(fl,{children:e.jsx(jl,{data:D,innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",stroke:"none",children:D.map((N,F)=>e.jsx(Zs,{fill:N.fill},`cell-${F}`))})})})]}),e.jsx("div",{className:"mt-4",children:P>0?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-xl border border-blue-100",children:[e.jsx(lt,{className:"text-blue-500 shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-blue-800 uppercase",children:"Over-achieved"}),e.jsxs("p",{className:"text-[11px] text-blue-600/80 leading-tight",children:[P," XP exceeded rollover cap (max 300/cycle)"]})]})]}):e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-emerald-50 rounded-xl border border-emerald-100",children:[e.jsx(je,{className:"text-emerald-500 shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-emerald-800 uppercase",children:"Optimized"}),e.jsx("p",{className:"text-[11px] text-emerald-600/80 leading-tight",children:"All XP within rollover limits"})]})]})})]})]})]}),o==="redemptions"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(We,{title:"Total Value Created",value:i(f?.totalValue||0),subtext:`${f?.count||0} redemptions`,icon:De,colorClass:{bg:"bg-indigo-50",text:"text-indigo-600"}}),e.jsx(We,{title:"Miles Redeemed",value:ne(f?.totalMilesUsed||0),subtext:"Total lifetime burns",icon:le,colorClass:{bg:"bg-blue-50",text:"text-blue-600"}}),e.jsx(We,{title:"Avg Redemption CPM",value:p(f?.avgCPM||0),subtext:`Target: ${p(r)}`,icon:Je,colorClass:{bg:"bg-emerald-50",text:"text-emerald-600"}}),e.jsx(We,{title:"Best Redemption",value:p(f?.bestRedemption?.cpm||0),subtext:f?.bestRedemption?.description||"-",icon:Be,colorClass:{bg:"bg-amber-50",text:"text-amber-600"}})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:["Redemption Value Map",e.jsx(me,{text:"Scatter plot of all redemptions. Higher CPM = better value."})]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Visualizing the quality of your burns"})]}),e.jsxs("div",{className:"flex gap-4 text-xs font-medium bg-slate-50 p-2 rounded-xl mt-2 md:mt-0",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500"})," Exceptional"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"})," Good"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500"})," Poor"]})]})]}),e.jsx("div",{className:"h-[400px]",children:f&&f.processed.length>0?e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(hn,{margin:{top:20,right:20,bottom:20,left:0},children:[e.jsx(zt,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(Xt,{type:"number",dataKey:"award_miles",name:"Miles",tick:{fontSize:12,fill:"#64748b"},tickLine:!1,axisLine:!1,tickFormatter:N=>`${(N/1e3).toFixed(0)}k`,label:{value:"Cost (Miles)",position:"insideBottom",offset:-10,fontSize:11,fill:"#94a3b8"}}),e.jsx(Et,{type:"number",dataKey:"cpm",name:"CPM",tick:{fontSize:12,fill:"#64748b"},tickFormatter:N=>`${x}${N.toFixed(3)}`,tickLine:!1,axisLine:!1,label:{value:`Value (${x}/mile)`,angle:-90,position:"insideLeft",fontSize:11,fill:"#94a3b8"}}),e.jsx(Pi,{type:"number",dataKey:"value",range:[100,500]}),e.jsx(os,{y:r,stroke:"#f59e0b",strokeDasharray:"5 5",label:{value:"Target",position:"right",fontSize:10,fill:"#f59e0b"}}),e.jsx(ft,{cursor:{strokeDasharray:"3 3"},content:({active:N,payload:F})=>{if(N&&F&&F.length){const j=F[0].payload;return e.jsxs("div",{className:"bg-slate-900 text-white p-3 shadow-xl rounded-xl text-xs border border-slate-700/50",children:[e.jsx("p",{className:"font-bold text-sm mb-2",children:j.description}),e.jsxs("div",{className:"space-y-1 text-slate-300",children:[e.jsxs("p",{children:["Cost: ",e.jsx("span",{className:"text-white font-mono",children:ne(j.award_miles)})," miles"]}),e.jsxs("p",{children:["Value: ",e.jsx("span",{className:"text-white font-mono",children:i(j.value)})]}),e.jsxs("p",{children:["CPM: ",e.jsx("span",{className:"text-emerald-400 font-mono font-bold",children:p(j.cpm)})]})]})]})}return null}}),e.jsx(pn,{name:"Redemptions",data:f.processed,children:f.processed.map((N,F)=>{let j="#ef4444";return N.cpm>.02?j="#10b981":N.cpm>.01&&(j="#3b82f6"),e.jsx(Zs,{fill:j},`cell-${F}`)})})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{size:48,className:"mx-auto mb-2 opacity-30"}),e.jsx("p",{children:"No redemptions logged yet"})]})})})]})]})]})},Xr=t=>{const s=new Date(t),a=new Date;return a.setHours(0,0,0,0),s.setHours(0,0,0,0),s>=a?"scheduled":"completed"},zc=t=>{const[s,a]=t.split("-");return new Date(parseInt(s),parseInt(a)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})},Ic=t=>{const s=new Map;return t.forEach(a=>{const n=a.date.slice(0,7),l=s.get(n)||[];s.set(n,[...l,a])}),Array.from(s.entries()).sort((a,n)=>n[0].localeCompare(a[0])).map(([a,n])=>{const l=n.sort((r,i)=>new Date(i.date).getTime()-new Date(r.date).getTime());return{monthKey:a,flights:l,totalXP:l.reduce((r,i)=>r+(i.earnedXP||0)+(i.safXp||0),0),scheduledCount:l.filter(r=>Xr(r.date)==="scheduled").length}})},Lc=({flight:t,onSave:s,onClose:a})=>{const[n,l]=d.useState({date:t.date,route:t.route,airline:t.airline,cabin:t.cabin,earnedXP:t.earnedXP,safXp:t.safXp||0}),r=i=>{i.preventDefault(),s({...t,...n})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-100",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Edit Flight"}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-slate-100 rounded-lg",children:e.jsx(Ce,{size:20,className:"text-slate-400"})})]}),e.jsxs("form",{onSubmit:r,className:"p-5 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:n.date,onChange:i=>l(x=>({...x,date:i.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Route"}),e.jsx("input",{type:"text",value:n.route,onChange:i=>l(x=>({...x,route:i.target.value.toUpperCase()})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Airline"}),e.jsx("input",{type:"text",value:n.airline,onChange:i=>l(x=>({...x,airline:i.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Cabin"}),e.jsxs("select",{value:n.cabin,onChange:i=>l(x=>({...x,cabin:i.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:border-blue-500 bg-white",children:[e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Premium Economy",children:"Premium Economy"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"First",children:"First"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"XP"}),e.jsx("input",{type:"number",value:n.earnedXP,onChange:i=>l(x=>({...x,earnedXP:Number(i.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"SAF XP"}),e.jsx("input",{type:"number",value:n.safXp,onChange:i=>l(x=>({...x,safXp:Number(i.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-blue-500"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 py-2.5 border border-slate-200 rounded-xl font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700",children:"Save Changes"})]})]})]})})},$c=({flight:t,onConfirm:s,onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-sm w-full p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ss,{className:"text-red-500",size:24})}),e.jsx("h3",{className:"font-bold text-slate-900 text-lg mb-2",children:"Delete Flight?"}),e.jsxs("p",{className:"text-slate-500 text-sm mb-6",children:[t.route," on ",new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),e.jsx("br",{}),"This cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 py-2.5 border border-slate-200 rounded-xl font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{onClick:s,className:"flex-1 py-2.5 bg-red-500 text-white rounded-xl font-medium hover:bg-red-600",children:"Delete"})]})]})}),Oc=({flights:t,onChange:s})=>{const[a,n]=d.useState(new Set),[l,r]=d.useState(null),[i,x]=d.useState(null),c=d.useMemo(()=>Ic(t),[t]);Ue.useEffect(()=>{c.length>0&&a.size===0&&n(new Set(c.slice(0,2).map(p=>p.monthKey)))},[c]);const o=p=>{n(h=>{const b=new Set(h);return b.has(p)?b.delete(p):b.add(p),b})},u=p=>{s(t.map(h=>h.id===p.id?p:h)),r(null)},m=()=>{i&&(s(t.filter(p=>p.id!==i.id)),x(null))};return t.length===0?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b border-slate-100",children:e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-blue-500 rotate-45"}),"Flight Ledger",e.jsxs("span",{className:"text-sm font-normal text-slate-400",children:[t.length," flight",t.length!==1?"s":""]})]})}),e.jsx("div",{className:"divide-y divide-slate-100",children:c.map(p=>{const h=a.has(p.monthKey);return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>o(p.monthKey),className:"w-full px-5 py-3 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h?e.jsx(nt,{size:18,className:"text-slate-400"}):e.jsx(we,{size:18,className:"text-slate-400"}),e.jsx("span",{className:"font-semibold text-slate-900",children:zc(p.monthKey)}),e.jsxs("span",{className:"text-xs text-slate-400",children:[p.flights.length," flight",p.flights.length!==1?"s":""]}),p.scheduledCount>0&&e.jsxs("span",{className:"text-[10px] font-bold text-blue-500 bg-blue-50 px-1.5 py-0.5 rounded",children:[p.scheduledCount," BOOKED"]})]}),e.jsxs("span",{className:"font-bold text-blue-600",children:["+",p.totalXP," XP"]})]}),h&&e.jsx("div",{className:"px-5 pb-4 space-y-2",children:p.flights.map(b=>{const g=Xr(b.date)==="scheduled";return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl border transition-colors group ${g?"bg-blue-50/50 border-blue-100":"bg-slate-50 border-slate-100 hover:bg-slate-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${g?"bg-blue-100":"bg-white"}`,children:e.jsx(le,{size:16,className:`rotate-45 ${g?"text-blue-500":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-slate-900",children:b.route}),g&&e.jsx("span",{className:"text-[9px] font-bold text-blue-500 bg-blue-100 px-1.5 py-0.5 rounded",children:"BOOKED"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[new Date(b.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," â¢ ",b.airline," â¢ ",b.cabin==="Premium Economy"?"Premium":b.cabin]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-bold ${g?"text-blue-500":"text-slate-900"}`,children:["+",b.earnedXP," XP"]}),(b.safXp??0)>0&&e.jsxs("p",{className:"text-[10px] text-emerald-600 flex items-center justify-end gap-0.5",children:[e.jsx(ea,{size:10}),"+",b.safXp," SAF"]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>r(b),className:"p-1.5 rounded-lg text-slate-400 hover:text-blue-600 hover:bg-blue-50 transition-colors",title:"Edit",children:e.jsx(Kt,{size:14})}),e.jsx("button",{onClick:()=>x(b),className:"p-1.5 rounded-lg text-slate-400 hover:text-red-500 hover:bg-red-50 transition-colors",title:"Delete",children:e.jsx(ss,{size:14})})]})]})]},b.id)})})]},p.monthKey)})})]}),l&&e.jsx(Lc,{flight:l,onSave:u,onClose:()=>r(null)}),i&&e.jsx($c,{flight:i,onConfirm:m,onClose:()=>x(null)})]})},Gc=t=>new Date(t).getMonth()===9,ys=t=>{const s=new Date(t),a=new Date;return a.setHours(0,0,0,0),s.setHours(0,0,0,0),s>=a?"scheduled":"completed"},Kc=t=>{const[s,a]=t.split("-");return new Date(parseInt(s),parseInt(a)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})},Yc=t=>{const s=new Map;return t.forEach(n=>{const l=n.date.slice(0,7),r=s.get(l)||[];s.set(l,[...r,n])}),Array.from(s.entries()).sort((n,l)=>l[0].localeCompare(n[0])).map(([n,l])=>{const r=l.sort((i,x)=>new Date(x.date).getTime()-new Date(i.date).getTime());return{monthKey:n,flights:r,totalXP:r.reduce((i,x)=>i+(x.earnedXP||0),0),totalSafXP:r.reduce((i,x)=>i+(x.safXp||0),0),totalMiles:r.reduce((i,x)=>i+(x.earnedMiles||0),0),flownCount:r.filter(i=>ys(i.date)==="completed").length,scheduledCount:r.filter(i=>ys(i.date)==="scheduled").length}})},qc=({name:t})=>{const s=t.toUpperCase().replace(/[^A-Z]/g,"");let a="";return s.includes("KLM")?a="klm.com":s.includes("AIRFRANCE")||s.includes("AF")?a="airfrance.com":s.includes("DELTA")||s.includes("DL")?a="delta.com":s.includes("TRANSAVIA")||s.includes("HV")?a="transavia.com":s.includes("VIRGIN")||s.includes("VS")?a="virginatlantic.com":s.includes("KOREAN")||s.includes("KE")?a="koreanair.com":s.includes("TAROM")?a="tarom.ro":s.includes("KENYA")?a="kenya-airways.com":s.includes("ITA")?a="itaspa.com":(s.includes("SAS")||s.includes("SK"))&&(a="flysas.com"),a?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("img",{src:`https://logo.clearbit.com/${a}?size=40`,alt:t,className:"w-4 h-4 object-contain rounded-full bg-white shadow-sm border border-slate-100",onError:n=>{n.target.style.display="none"}}),e.jsx("span",{className:"text-[11px] font-bold text-slate-600",children:t})]}):e.jsx("span",{className:"text-[11px] font-bold text-slate-600",children:t})},Vc=({flight:t,onSave:s,onClose:a})=>{const{symbol:n}=Ke(),[l,r]=d.useState({date:t.date,origin:t.route.split("-")[0],destination:t.route.split("-")[1],airline:t.airline,cabin:t.cabin,ticketPrice:t.ticketPrice,earnedMiles:t.earnedMiles,earnedXP:t.earnedXP,safXp:t.safXp,flightNumber:t.flightNumber||""}),i=o=>{o.preventDefault(),s({...t,date:l.date,route:`${l.origin.toUpperCase()}-${l.destination.toUpperCase()}`,airline:l.airline,cabin:l.cabin,ticketPrice:l.ticketPrice,earnedMiles:l.earnedMiles,earnedXP:l.earnedXP,safXp:l.safXp,flightNumber:l.flightNumber||void 0})},x="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400",c="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-1";return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(Kt,{size:18,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-slate-800",children:"Edit Flight"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.route," â¢ ",t.date]})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Ce,{size:20,className:"text-slate-400"})})]}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Date"}),e.jsx("input",{type:"date",value:l.date,onChange:o=>r({...l,date:o.target.value}),className:x,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Origin"}),e.jsx("input",{type:"text",value:l.origin,onChange:o=>r({...l,origin:o.target.value.toUpperCase()}),className:`${x} font-mono uppercase`,maxLength:3,placeholder:"AMS",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Destination"}),e.jsx("input",{type:"text",value:l.destination,onChange:o=>r({...l,destination:o.target.value.toUpperCase()}),className:`${x} font-mono uppercase`,maxLength:3,placeholder:"JFK",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Airline"}),e.jsx("input",{type:"text",value:l.airline,onChange:o=>r({...l,airline:o.target.value.toUpperCase()}),className:`${x} uppercase`,placeholder:"KLM",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Flight #"}),e.jsx("input",{type:"text",value:l.flightNumber,onChange:o=>r({...l,flightNumber:o.target.value.toUpperCase()}),className:`${x} uppercase font-mono`,placeholder:"KL1775",maxLength:10})]}),e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Cabin"}),e.jsxs("select",{value:l.cabin,onChange:o=>r({...l,cabin:o.target.value}),className:x,children:[e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Premium Economy",children:"Premium Economy"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"First",children:"First"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Ticket Price (",n,")"]}),e.jsx("input",{type:"number",value:l.ticketPrice,onChange:o=>r({...l,ticketPrice:parseFloat(o.target.value)||0}),className:x,step:"0.01",min:"0",placeholder:"0.00"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Miles Earned"}),e.jsx("input",{type:"number",value:l.earnedMiles,onChange:o=>r({...l,earnedMiles:parseInt(o.target.value)||0}),className:x,min:"0",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:c,children:"XP Earned"}),e.jsx("input",{type:"number",value:l.earnedXP,onChange:o=>r({...l,earnedXP:parseInt(o.target.value)||0}),className:x,min:"0",placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["SAF XP Bonus",e.jsx("span",{className:"ml-2 font-normal normal-case text-slate-400",children:"(Sustainable Aviation Fuel)"})]}),e.jsx("input",{type:"number",value:l.safXp,onChange:o=>r({...l,safXp:parseInt(o.target.value)||0}),className:x,min:"0",placeholder:"0"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2.5 border border-slate-200 text-slate-600 rounded-lg font-medium hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(xa,{size:16}),"Save Changes"]})]})]})]})})},Hc=({group:t,isExpanded:s,onToggle:a})=>{const n=t.scheduledCount>0,l=t.flownCount>0;return e.jsx("tr",{className:"bg-slate-100/80 cursor-pointer hover:bg-slate-100 transition-colors border-y border-slate-200",onClick:a,children:e.jsx("td",{colSpan:10,className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s?e.jsx(nt,{size:16,className:"text-slate-400"}):e.jsx(we,{size:16,className:"text-slate-400"}),e.jsx(et,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"font-bold text-slate-700",children:Kc(t.monthKey)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsxs("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-600 border border-emerald-100",children:[t.flownCount," flown"]}),n&&e.jsxs("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-blue-50 text-blue-600 border border-blue-100",children:[t.scheduledCount," scheduled"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-slate-400 mr-1",children:"XP:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:["+",t.totalXP]}),t.totalSafXP>0&&e.jsxs("span",{className:"ml-1 text-emerald-600",children:["(+",t.totalSafXP," SAF)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-slate-400 mr-1",children:"Miles:"}),e.jsx("span",{className:"font-bold text-slate-600",children:ne(t.totalMiles)})]})]})]})})})},Wc=({flights:t,onChange:s,xpData:a=[],currentRollover:n=0})=>{const{isSimpleMode:l}=it(),{format:r,symbol:i}=Ke(),x=d.useMemo(()=>Yc(t),[t]),[c,o]=d.useState(()=>new Set(x.map(N=>N.monthKey))),[u,m]=d.useState(null),[p,h]=d.useState(null);if(l)return e.jsx(Oc,{flights:t,onChange:s});const b=N=>{o(F=>{const j=new Set(F);return j.has(N)?j.delete(N):j.add(N),j})},g=()=>{o(new Set(x.map(N=>N.monthKey)))},S=()=>{o(new Set)},P=N=>{const F=nl(a,n),j=new Date(N.date),v=j.getMonth()>=10?j.getFullYear()+1:j.getFullYear(),A=F[v];if(!A)return null;const R=600,X=A.totalXP,L=Math.max(0,X-R);if(L>0){const G=Math.min(N.earnedXP,L);return{isBeneficial:!0,savedXP:G,message:`Moving to Nov saves ${G} XP from waste cap.`}}return{isBeneficial:!1,savedXP:0,message:"No waste detected. Moving hurts rollover."}},C=N=>{s(t.filter(F=>F.id!==N.id))},w=N=>{h(N)},f=N=>{s(t.map(F=>F.id===N.id?N:F)),h(null)},D=t.filter(N=>ys(N.date)==="scheduled").length,_=t.filter(N=>ys(N.date)==="completed").length;return e.jsxs(e.Fragment,{children:[p&&e.jsx(Vc,{flight:p,onSave:f,onClose:()=>h(null)}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden mt-8",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-slate-400"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"Flight Ledger"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_>0&&e.jsxs("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-600 border border-emerald-100",children:[_," flown"]}),D>0&&e.jsxs("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-blue-50 text-blue-600 border border-blue-100",children:[D," scheduled"]})]})]}),x.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:g,className:"text-[10px] font-semibold px-2 py-1 rounded text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",children:"Expand all"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("button",{onClick:S,className:"text-[10px] font-semibold px-2 py-1 rounded text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",children:"Collapse all"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold text-[9px] uppercase tracking-wider border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 w-24",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Date"}),e.jsx("th",{className:"px-4 py-3",children:"Route"}),e.jsx("th",{className:"px-4 py-3",children:"Airline"}),e.jsx("th",{className:"px-4 py-3",children:"Cabin"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Miles"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"XP"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"SAF"}),e.jsx("th",{className:"px-4 py-3 w-20"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-50",children:[x.map(N=>{const F=c.has(N.monthKey);return e.jsxs(Ue.Fragment,{children:[e.jsx(Hc,{group:N,isExpanded:F,onToggle:()=>b(N.monthKey)}),F&&N.flights.map(j=>{const v=Gc(j.date),A=v&&u===j.id?P(j):null,X=ys(j.date)==="scheduled";return e.jsxs(Ue.Fragment,{children:[e.jsxs("tr",{className:`transition-colors group ${X?"bg-blue-50/20":"hover:bg-slate-50/50"}`,children:[e.jsx("td",{className:"px-4 py-2.5",children:X?e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-blue-50 text-blue-600 text-[9px] font-bold uppercase border border-blue-100",children:[e.jsx(Ee,{size:10})," Sched"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-emerald-50 text-emerald-600 text-[9px] font-bold uppercase border border-emerald-100",children:[e.jsx(je,{size:10})," Flown"]})}),e.jsx("td",{className:`px-4 py-2.5 font-mono text-[11px] ${X?"text-slate-400":"text-slate-600"}`,children:j.date}),e.jsx("td",{className:`px-4 py-2.5 font-bold text-xs ${X?"text-slate-500":"text-slate-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:j.route}),j.flightNumber&&e.jsx("span",{className:"font-mono text-[10px] text-slate-400 font-normal",children:j.flightNumber})]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx(qc,{name:j.airline})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[9px] font-bold uppercase ${X?"bg-slate-100 text-slate-400":"bg-slate-100 text-slate-500"}`,children:j.cabin==="Premium Economy"?"Prem":j.cabin==="Business"?"Biz":j.cabin==="First"?"1st":"Eco"})}),e.jsx("td",{className:`px-4 py-2.5 text-right font-mono text-[11px] ${X?"text-slate-400":"text-slate-600"}`,children:r(j.ticketPrice)}),e.jsx("td",{className:`px-4 py-2.5 text-right font-mono text-[11px] ${X?"text-slate-400":"text-slate-600"}`,children:ne(j.earnedMiles)}),e.jsxs("td",{className:`px-4 py-2.5 text-right font-bold text-xs ${X?"text-blue-400":"text-blue-600"}`,children:["+",j.earnedXP]}),e.jsx("td",{className:`px-4 py-2.5 text-right text-[11px] font-bold ${j.safXp>0?X?"text-emerald-400":"text-emerald-600":"text-slate-300"}`,children:j.safXp>0?`+${j.safXp}`:"-"}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[v&&e.jsx("button",{onClick:()=>m(u===j.id?null:j.id??""),className:`p-1 rounded-lg transition-colors ${u===j.id?"bg-indigo-100 text-indigo-600":"text-slate-300 hover:text-indigo-600 hover:bg-indigo-50"}`,title:"Analyze Shift to November",children:e.jsx(hi,{size:14})}),e.jsx("button",{onClick:()=>w(j),className:"p-1 rounded-lg text-slate-300 hover:text-blue-600 hover:bg-blue-50 transition-colors opacity-0 group-hover:opacity-100",title:"Edit flight",children:e.jsx(Kt,{size:14})}),e.jsx("button",{onClick:()=>C(j),className:"p-1 rounded-lg text-slate-300 hover:text-red-500 hover:bg-red-50 transition-colors opacity-0 group-hover:opacity-100",title:"Delete flight",children:e.jsx(ss,{size:14})})]})})]}),A&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"px-4 py-0",children:e.jsxs("div",{className:"mb-2 bg-indigo-50/50 rounded-lg border border-indigo-100 p-2.5 flex items-center justify-between animate-in fade-in slide-in-from-top-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${A.isBeneficial?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:A.isBeneficial?e.jsx(je,{size:14}):e.jsx(Nt,{size:14})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-700 uppercase tracking-wide",children:"Shift Analysis (Oct â Nov)"}),e.jsx("p",{className:"text-[11px] text-slate-600",children:A.message})]})]}),A.isBeneficial&&e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"block text-lg font-black text-emerald-600",children:["+",A.savedXP," XP"]}),e.jsx("span",{className:"text-[9px] font-bold text-emerald-500 uppercase",children:"Rollover Gain"})]})]})})})]},j.id??`${j.date}-${j.route}`)})]},N.monthKey)}),t.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:10,className:"px-6 py-10 text-center text-slate-400",children:[e.jsx(le,{size:28,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-xs",children:"No flights recorded yet."})]})})]})]})})]})]})},dt={AMS:{lat:52.3086,lon:4.7639,name:"Amsterdam Schiphol",country:"NL"},CDG:{lat:49.0097,lon:2.5479,name:"Paris Charles de Gaulle",country:"FR"},BRU:{lat:50.9014,lon:4.4844,name:"Brussels",country:"BE"},CRL:{lat:50.4592,lon:4.4538,name:"Brussels South Charleroi",country:"BE"},ANR:{lat:51.1894,lon:4.4603,name:"Antwerp",country:"BE"},LGG:{lat:50.6374,lon:5.4432,name:"LiÃ¨ge",country:"BE"},OST:{lat:51.1989,lon:2.8622,name:"Ostend-Bruges",country:"BE"},LUX:{lat:49.6233,lon:6.2044,name:"Luxembourg",country:"LU"},RTM:{lat:51.9569,lon:4.4372,name:"Rotterdam The Hague",country:"NL"},EIN:{lat:51.4501,lon:5.3745,name:"Eindhoven",country:"NL"},GRQ:{lat:53.1197,lon:6.5794,name:"Groningen Eelde",country:"NL"},MST:{lat:50.9117,lon:5.7703,name:"Maastricht Aachen",country:"NL"},ORY:{lat:48.7233,lon:2.3794,name:"Paris Orly",country:"FR"},NCE:{lat:43.6653,lon:7.215,name:"Nice CÃ´te d'Azur",country:"FR"},LYS:{lat:45.7256,lon:5.0811,name:"Lyon-Saint ExupÃ©ry",country:"FR"},MRS:{lat:43.4367,lon:5.215,name:"Marseille Provence",country:"FR"},TLS:{lat:43.6291,lon:1.3638,name:"Toulouse-Blagnac",country:"FR"},BOD:{lat:44.8283,lon:-.7156,name:"Bordeaux-MÃ©rignac",country:"FR"},NTE:{lat:47.1532,lon:-1.6107,name:"Nantes Atlantique",country:"FR"},SXB:{lat:48.5383,lon:7.6282,name:"Strasbourg",country:"FR"},MPL:{lat:43.5761,lon:3.9631,name:"Montpellier",country:"FR"},BES:{lat:48.4479,lon:-4.4214,name:"Brest Bretagne",country:"FR"},BIQ:{lat:43.4684,lon:-1.5233,name:"Biarritz",country:"FR"},AJA:{lat:41.9237,lon:8.7932,name:"Ajaccio Napoleon Bonaparte",country:"FR"},BIA:{lat:42.5527,lon:9.4837,name:"Bastia Poretta",country:"FR"},CLY:{lat:42.5305,lon:8.7937,name:"Calvi",country:"FR"},FSC:{lat:41.5006,lon:9.0978,name:"Figari",country:"FR"},LIL:{lat:50.5617,lon:3.0894,name:"Lille",country:"FR"},RNS:{lat:48.0694,lon:-1.7347,name:"Rennes",country:"FR"},ETZ:{lat:48.9821,lon:6.2513,name:"Metz-Nancy-Lorraine",country:"FR"},CFE:{lat:45.7867,lon:3.1631,name:"Clermont-Ferrand",country:"FR"},PGF:{lat:42.7404,lon:2.8706,name:"Perpignan",country:"FR"},TLN:{lat:43.0973,lon:6.146,name:"Toulon-HyÃ¨res",country:"FR"},PUF:{lat:43.38,lon:-.4186,name:"Pau PyrÃ©nÃ©es",country:"FR"},LDE:{lat:43.1787,lon:-.0064,name:"Tarbes-Lourdes",country:"FR"},RDZ:{lat:44.4079,lon:2.4827,name:"Rodez",country:"FR"},LRH:{lat:46.1792,lon:-1.1953,name:"La Rochelle",country:"FR"},PIS:{lat:46.5877,lon:.3066,name:"Poitiers",country:"FR"},TUF:{lat:47.4322,lon:.7276,name:"Tours",country:"FR"},CMF:{lat:45.6381,lon:5.8803,name:"ChambÃ©ry",country:"FR"},GNB:{lat:45.3629,lon:5.3294,name:"Grenoble",country:"FR"},EGC:{lat:44.8253,lon:.5186,name:"Bergerac",country:"FR"},DCM:{lat:43.5563,lon:2.2892,name:"Castres",country:"FR"},AVN:{lat:43.9073,lon:4.9018,name:"Avignon",country:"FR"},BVA:{lat:49.4544,lon:2.1128,name:"Paris Beauvais",country:"FR"},PTP:{lat:16.2653,lon:-61.5318,name:"Pointe-Ã -Pitre (Guadeloupe)",country:"GP"},FDF:{lat:14.591,lon:-61.0032,name:"Fort-de-France (Martinique)",country:"MQ"},CAY:{lat:4.8192,lon:-52.3604,name:"Cayenne (French Guiana)",country:"GF"},RUN:{lat:-20.8871,lon:55.5103,name:"Saint-Denis (RÃ©union)",country:"RE"},DZA:{lat:-12.8047,lon:45.2811,name:"Dzaoudzi (Mayotte)",country:"YT"},NOU:{lat:-22.0146,lon:166.2129,name:"NoumÃ©a (New Caledonia)",country:"NC"},PPT:{lat:-17.5537,lon:-149.6069,name:"Papeete (Tahiti)",country:"PF"},SBH:{lat:17.9044,lon:-62.8436,name:"St. BarthÃ©lemy",country:"BL"},SFG:{lat:18.0999,lon:-63.0472,name:"St. Martin Grand Case",country:"MF"},LHR:{lat:51.4706,lon:-.4619,name:"London Heathrow",country:"GB"},LGW:{lat:51.1481,lon:-.1903,name:"London Gatwick",country:"GB"},LCY:{lat:51.505,lon:.0544,name:"London City",country:"GB"},STN:{lat:51.885,lon:.235,name:"London Stansted",country:"GB"},LTN:{lat:51.8747,lon:-.3683,name:"London Luton",country:"GB"},SEN:{lat:51.5714,lon:.6956,name:"London Southend",country:"GB"},MAN:{lat:53.3629,lon:-2.2733,name:"Manchester",country:"GB"},BHX:{lat:52.4539,lon:-1.7481,name:"Birmingham",country:"GB"},EDI:{lat:55.95,lon:-3.3725,name:"Edinburgh",country:"GB"},GLA:{lat:55.8719,lon:-4.4331,name:"Glasgow",country:"GB"},ABZ:{lat:57.2019,lon:-2.2043,name:"Aberdeen",country:"GB"},NCL:{lat:55.0375,lon:-1.6917,name:"Newcastle",country:"GB"},BRS:{lat:51.3827,lon:-2.7191,name:"Bristol",country:"GB"},SOU:{lat:50.9503,lon:-1.3568,name:"Southampton",country:"GB"},NWI:{lat:52.6758,lon:1.2828,name:"Norwich",country:"GB"},HUY:{lat:53.5744,lon:-.3508,name:"Humberside",country:"GB"},MME:{lat:54.5092,lon:-1.4322,name:"Teesside",country:"GB"},INV:{lat:57.5425,lon:-4.0475,name:"Inverness",country:"GB"},CWL:{lat:51.3967,lon:-3.3433,name:"Cardiff",country:"GB"},BHD:{lat:54.6189,lon:-5.8725,name:"George Best Belfast City",country:"GB"},BFS:{lat:54.6575,lon:-6.2158,name:"Belfast International",country:"GB"},LPL:{lat:53.3336,lon:-2.8497,name:"Liverpool",country:"GB"},LBA:{lat:53.8659,lon:-1.6606,name:"Leeds Bradford",country:"GB"},EMA:{lat:52.8311,lon:-1.3281,name:"East Midlands",country:"GB"},EXT:{lat:50.7344,lon:-3.4139,name:"Exeter",country:"GB"},BOH:{lat:50.78,lon:-1.8425,name:"Bournemouth",country:"GB"},DSA:{lat:53.4747,lon:-1.0106,name:"Doncaster Sheffield",country:"GB"},PIK:{lat:55.5094,lon:-4.5867,name:"Glasgow Prestwick",country:"GB"},JER:{lat:49.2078,lon:-2.1956,name:"Jersey",country:"JE"},GCI:{lat:49.435,lon:-2.602,name:"Guernsey",country:"GG"},IOM:{lat:54.0833,lon:-4.6239,name:"Isle of Man",country:"IM"},DUB:{lat:53.4213,lon:-6.2701,name:"Dublin",country:"IE"},ORK:{lat:51.8413,lon:-8.4911,name:"Cork",country:"IE"},SNN:{lat:52.702,lon:-8.9248,name:"Shannon",country:"IE"},KIR:{lat:52.1809,lon:-9.5238,name:"Kerry",country:"IE"},NOC:{lat:53.9103,lon:-8.8186,name:"Ireland West Knock",country:"IE"},FRA:{lat:50.0333,lon:8.5706,name:"Frankfurt",country:"DE"},MUC:{lat:48.3538,lon:11.7861,name:"Munich",country:"DE"},BER:{lat:52.3622,lon:13.5007,name:"Berlin Brandenburg",country:"DE"},HAM:{lat:53.6304,lon:9.9882,name:"Hamburg",country:"DE"},DUS:{lat:51.2895,lon:6.7668,name:"DÃ¼sseldorf",country:"DE"},CGN:{lat:50.8659,lon:7.1427,name:"Cologne Bonn",country:"DE"},STR:{lat:48.6899,lon:9.222,name:"Stuttgart",country:"DE"},HAJ:{lat:52.4602,lon:9.6835,name:"Hanover",country:"DE"},NUE:{lat:49.4987,lon:11.078,name:"Nuremberg",country:"DE"},BRE:{lat:53.0475,lon:8.7867,name:"Bremen",country:"DE"},LEJ:{lat:51.4324,lon:12.2416,name:"Leipzig/Halle",country:"DE"},DRS:{lat:51.1328,lon:13.7672,name:"Dresden",country:"DE"},DTM:{lat:51.5183,lon:7.6122,name:"Dortmund",country:"DE"},FMO:{lat:52.1346,lon:7.6848,name:"MÃ¼nster OsnabrÃ¼ck",country:"DE"},PAD:{lat:51.6141,lon:8.6163,name:"Paderborn",country:"DE"},HHN:{lat:49.9487,lon:7.2639,name:"Frankfurt Hahn",country:"DE"},NRN:{lat:51.6024,lon:6.1422,name:"Weeze",country:"DE"},FKB:{lat:48.7794,lon:8.0805,name:"Karlsruhe/Baden-Baden",country:"DE"},MAD:{lat:40.4719,lon:-3.5626,name:"Madrid-Barajas",country:"ES"},BCN:{lat:41.2971,lon:2.0785,name:"Barcelona-El Prat",country:"ES"},AGP:{lat:36.6749,lon:-4.4991,name:"MÃ¡laga",country:"ES"},VLC:{lat:39.4893,lon:-.4816,name:"Valencia",country:"ES"},BIO:{lat:43.3011,lon:-2.9106,name:"Bilbao",country:"ES"},ALC:{lat:38.2822,lon:-.5582,name:"Alicante",country:"ES"},PMI:{lat:39.5517,lon:2.7388,name:"Palma de Mallorca",country:"ES"},SVQ:{lat:37.418,lon:-5.8931,name:"Seville",country:"ES"},IBZ:{lat:38.8729,lon:1.3731,name:"Ibiza",country:"ES"},MAH:{lat:39.8626,lon:4.2186,name:"Menorca",country:"ES"},TFS:{lat:28.0445,lon:-16.5725,name:"Tenerife South",country:"ES"},TFN:{lat:28.4827,lon:-16.3415,name:"Tenerife North",country:"ES"},LPA:{lat:27.9319,lon:-15.3866,name:"Gran Canaria",country:"ES"},ACE:{lat:28.9455,lon:-13.6052,name:"Lanzarote",country:"ES"},FUE:{lat:28.4527,lon:-13.8638,name:"Fuerteventura",country:"ES"},SPC:{lat:28.6265,lon:-17.7556,name:"La Palma",country:"ES"},GRX:{lat:37.1887,lon:-3.7772,name:"Granada",country:"ES"},XRY:{lat:36.7446,lon:-6.0601,name:"Jerez de la Frontera",country:"ES"},SDR:{lat:43.4271,lon:-3.82,name:"Santander",country:"ES"},OVD:{lat:43.5636,lon:-6.0346,name:"Asturias",country:"ES"},SCQ:{lat:42.8963,lon:-8.4151,name:"Santiago de Compostela",country:"ES"},VGO:{lat:42.2318,lon:-8.6268,name:"Vigo",country:"ES"},ZAZ:{lat:41.6662,lon:-1.0415,name:"Zaragoza",country:"ES"},MJV:{lat:37.7749,lon:-.8123,name:"Murcia",country:"ES"},REU:{lat:41.1474,lon:1.1672,name:"Reus",country:"ES"},GRO:{lat:41.901,lon:2.7606,name:"Girona",country:"ES"},LIS:{lat:38.7742,lon:-9.1342,name:"Lisbon",country:"PT"},OPO:{lat:41.2481,lon:-8.6814,name:"Porto",country:"PT"},FAO:{lat:37.0144,lon:-7.9659,name:"Faro",country:"PT"},FNC:{lat:32.6979,lon:-16.7745,name:"Funchal (Madeira)",country:"PT"},PDL:{lat:37.7412,lon:-25.6979,name:"Ponta Delgada (Azores)",country:"PT"},TER:{lat:38.7618,lon:-27.0908,name:"Terceira (Azores)",country:"PT"},HOR:{lat:38.5199,lon:-28.7159,name:"Horta (Azores)",country:"PT"},GIB:{lat:36.1512,lon:-5.3497,name:"Gibraltar",country:"GI"},FCO:{lat:41.8003,lon:12.2389,name:"Rome Fiumicino",country:"IT"},CIA:{lat:41.7994,lon:12.5949,name:"Rome Ciampino",country:"IT"},MXP:{lat:45.6306,lon:8.7281,name:"Milan Malpensa",country:"IT"},LIN:{lat:45.4451,lon:9.2767,name:"Milan Linate",country:"IT"},BGY:{lat:45.6739,lon:9.7042,name:"Milan Bergamo",country:"IT"},VCE:{lat:45.5053,lon:12.3519,name:"Venice Marco Polo",country:"IT"},TSF:{lat:45.6484,lon:12.1944,name:"Venice Treviso",country:"IT"},BLQ:{lat:44.535,lon:11.2887,name:"Bologna",country:"IT"},NAP:{lat:40.8844,lon:14.2908,name:"Naples",country:"IT"},FLR:{lat:43.81,lon:11.2051,name:"Florence",country:"IT"},PSA:{lat:43.6839,lon:10.3927,name:"Pisa",country:"IT"},TRN:{lat:45.2008,lon:7.6496,name:"Turin",country:"IT"},GOA:{lat:44.4133,lon:8.855,name:"Genoa",country:"IT"},VRN:{lat:45.3957,lon:10.8885,name:"Verona",country:"IT"},CTA:{lat:37.4667,lon:15.0664,name:"Catania",country:"IT"},PMO:{lat:38.176,lon:13.091,name:"Palermo",country:"IT"},OLB:{lat:40.8987,lon:9.5176,name:"Olbia",country:"IT"},CAG:{lat:39.2515,lon:9.0543,name:"Cagliari",country:"IT"},AHO:{lat:40.6321,lon:8.2907,name:"Alghero",country:"IT"},BRI:{lat:41.1389,lon:16.7606,name:"Bari",country:"IT"},BDS:{lat:40.6576,lon:17.947,name:"Brindisi",country:"IT"},TPS:{lat:37.9114,lon:12.488,name:"Trapani",country:"IT"},CIY:{lat:36.9946,lon:14.6072,name:"Comiso",country:"IT"},SUF:{lat:38.9054,lon:16.2423,name:"Lamezia Terme",country:"IT"},REG:{lat:38.0712,lon:15.6516,name:"Reggio Calabria",country:"IT"},AOI:{lat:43.6163,lon:13.3623,name:"Ancona",country:"IT"},PEG:{lat:43.0959,lon:12.5132,name:"Perugia",country:"IT"},TRS:{lat:45.8275,lon:13.4722,name:"Trieste",country:"IT"},RMI:{lat:44.0203,lon:12.6117,name:"Rimini",country:"IT"},PMF:{lat:44.8245,lon:10.2964,name:"Parma",country:"IT"},ZRH:{lat:47.4647,lon:8.5492,name:"ZÃ¼rich",country:"CH"},GVA:{lat:46.2381,lon:6.1089,name:"Geneva",country:"CH"},BSL:{lat:47.59,lon:7.5292,name:"EuroAirport Basel-Mulhouse",country:"CH"},BRN:{lat:46.9141,lon:7.4972,name:"Bern",country:"CH"},LUG:{lat:46.004,lon:8.9106,name:"Lugano",country:"CH"},VIE:{lat:48.1103,lon:16.5697,name:"Vienna",country:"AT"},SZG:{lat:47.7933,lon:13.0043,name:"Salzburg",country:"AT"},INN:{lat:47.2602,lon:11.3439,name:"Innsbruck",country:"AT"},GRZ:{lat:46.9911,lon:15.4396,name:"Graz",country:"AT"},LNZ:{lat:48.2332,lon:14.1875,name:"Linz",country:"AT"},KLU:{lat:46.6425,lon:14.3377,name:"Klagenfurt",country:"AT"},CPH:{lat:55.6179,lon:12.656,name:"Copenhagen",country:"DK"},BLL:{lat:55.7403,lon:9.1518,name:"Billund",country:"DK"},AAL:{lat:57.0928,lon:9.8492,name:"Aalborg",country:"DK"},AAR:{lat:56.299,lon:10.619,name:"Aarhus",country:"DK"},OSL:{lat:60.1976,lon:11.1004,name:"Oslo Gardermoen",country:"NO"},BGO:{lat:60.2934,lon:5.2181,name:"Bergen",country:"NO"},SVG:{lat:58.8767,lon:5.6378,name:"Stavanger",country:"NO"},TRD:{lat:63.4578,lon:10.9242,name:"Trondheim",country:"NO"},TOS:{lat:69.6833,lon:18.9189,name:"TromsÃ¸",country:"NO"},BOO:{lat:67.2692,lon:14.3653,name:"BodÃ¸",country:"NO"},AES:{lat:62.5625,lon:6.1197,name:"Ãlesund",country:"NO"},KRS:{lat:58.2042,lon:8.0853,name:"Kristiansand",country:"NO"},HAU:{lat:59.3453,lon:5.2083,name:"Haugesund",country:"NO"},ARN:{lat:59.6519,lon:17.9186,name:"Stockholm Arlanda",country:"SE"},GOT:{lat:57.6628,lon:12.2798,name:"Gothenburg Landvetter",country:"SE"},MMX:{lat:55.5363,lon:13.3762,name:"MalmÃ¶",country:"SE"},LLA:{lat:65.5438,lon:22.122,name:"LuleÃ¥",country:"SE"},UME:{lat:63.7919,lon:20.2828,name:"UmeÃ¥",country:"SE"},VBY:{lat:57.6628,lon:18.3462,name:"Visby",country:"SE"},LPI:{lat:58.4132,lon:15.5256,name:"LinkÃ¶ping",country:"SE"},NYO:{lat:58.7886,lon:16.9122,name:"Stockholm Skavsta",country:"SE"},HEL:{lat:60.3172,lon:24.9633,name:"Helsinki-Vantaa",country:"FI"},TMP:{lat:61.4147,lon:23.6044,name:"Tampere",country:"FI"},TKU:{lat:60.5141,lon:22.2628,name:"Turku",country:"FI"},OUL:{lat:64.9301,lon:25.3546,name:"Oulu",country:"FI"},RVN:{lat:66.5648,lon:25.8304,name:"Rovaniemi",country:"FI"},KEF:{lat:63.985,lon:-22.6056,name:"ReykjavÃ­k KeflavÃ­k",country:"IS"},AKU:{lat:65.6597,lon:-18.0727,name:"Akureyri",country:"IS"},TLL:{lat:59.4133,lon:24.8328,name:"Tallinn",country:"EE"},TRT:{lat:58.3075,lon:26.6904,name:"Tartu",country:"EE"},RIX:{lat:56.9236,lon:23.9711,name:"Riga",country:"LV"},VNO:{lat:54.6341,lon:25.2858,name:"Vilnius",country:"LT"},KUN:{lat:54.9639,lon:24.0848,name:"Kaunas",country:"LT"},PLQ:{lat:55.9733,lon:21.0939,name:"Palanga",country:"LT"},WAW:{lat:52.1657,lon:20.9671,name:"Warsaw Chopin",country:"PL"},WMI:{lat:52.4511,lon:20.6518,name:"Warsaw Modlin",country:"PL"},KRK:{lat:50.0777,lon:19.7848,name:"KrakÃ³w",country:"PL"},GDN:{lat:54.3776,lon:18.4662,name:"GdaÅsk",country:"PL"},WRO:{lat:51.1027,lon:16.8858,name:"WrocÅaw",country:"PL"},POZ:{lat:52.421,lon:16.8263,name:"PoznaÅ",country:"PL"},KTW:{lat:50.4743,lon:19.08,name:"Katowice",country:"PL"},RZE:{lat:50.11,lon:22.019,name:"RzeszÃ³w",country:"PL"},SZZ:{lat:53.5847,lon:14.9022,name:"Szczecin",country:"PL"},LCJ:{lat:51.7219,lon:19.3981,name:"ÅÃ³dÅº",country:"PL"},BZG:{lat:53.0968,lon:17.9777,name:"Bydgoszcz",country:"PL"},PRG:{lat:50.1008,lon:14.26,name:"Prague",country:"CZ"},BRQ:{lat:49.1513,lon:16.6944,name:"Brno",country:"CZ"},OSR:{lat:49.6963,lon:18.1111,name:"Ostrava",country:"CZ"},BTS:{lat:48.1702,lon:17.2127,name:"Bratislava",country:"SK"},KSC:{lat:48.6631,lon:21.2411,name:"KoÅ¡ice",country:"SK"},BUD:{lat:47.4369,lon:19.2556,name:"Budapest",country:"HU"},DEB:{lat:47.4889,lon:21.6153,name:"Debrecen",country:"HU"},OTP:{lat:44.5722,lon:26.1022,name:"Bucharest Otopeni",country:"RO"},BBU:{lat:44.5032,lon:26.1021,name:"Bucharest BÄneasa",country:"RO"},CLJ:{lat:46.7852,lon:23.6862,name:"Cluj-Napoca",country:"RO"},TSR:{lat:45.8099,lon:21.3379,name:"TimiÈoara",country:"RO"},IAS:{lat:47.1785,lon:27.6206,name:"IaÈi",country:"RO"},SBZ:{lat:45.7856,lon:24.0913,name:"Sibiu",country:"RO"},SUJ:{lat:47.7033,lon:22.8857,name:"Satu Mare",country:"RO"},OMR:{lat:47.0252,lon:21.9025,name:"Oradea",country:"RO"},CND:{lat:44.3622,lon:28.4883,name:"ConstanÈa",country:"RO"},TGM:{lat:46.4677,lon:24.4125,name:"TÃ¢rgu MureÈ",country:"RO"},CRA:{lat:44.3181,lon:23.8889,name:"Craiova",country:"RO"},SOF:{lat:42.6967,lon:23.4114,name:"Sofia",country:"BG"},VAR:{lat:43.2321,lon:27.8251,name:"Varna",country:"BG"},BOJ:{lat:42.5696,lon:27.5152,name:"Burgas",country:"BG"},PDV:{lat:42.0678,lon:24.8508,name:"Plovdiv",country:"BG"},LJU:{lat:46.2237,lon:14.4576,name:"Ljubljana",country:"SI"},ZAG:{lat:45.7429,lon:16.0688,name:"Zagreb",country:"HR"},SPU:{lat:43.5389,lon:16.298,name:"Split",country:"HR"},DBV:{lat:42.5614,lon:18.2682,name:"Dubrovnik",country:"HR"},PUY:{lat:44.8935,lon:13.9222,name:"Pula",country:"HR"},ZAD:{lat:44.1083,lon:15.3467,name:"Zadar",country:"HR"},RJK:{lat:45.2169,lon:14.5703,name:"Rijeka",country:"HR"},OSI:{lat:45.4627,lon:18.8102,name:"Osijek",country:"HR"},BEG:{lat:44.8184,lon:20.3091,name:"Belgrade",country:"RS"},INI:{lat:43.3372,lon:21.8536,name:"NiÅ¡",country:"RS"},PRN:{lat:42.5728,lon:21.0358,name:"Pristina",country:"XK"},SJJ:{lat:43.8246,lon:18.3315,name:"Sarajevo",country:"BA"},TZL:{lat:44.4587,lon:18.7248,name:"Tuzla",country:"BA"},TGD:{lat:42.3594,lon:19.2519,name:"Podgorica",country:"ME"},TIV:{lat:42.4047,lon:18.7233,name:"Tivat",country:"ME"},SKP:{lat:41.9616,lon:21.6214,name:"Skopje",country:"MK"},OHD:{lat:41.18,lon:20.7423,name:"Ohrid",country:"MK"},TIA:{lat:41.4147,lon:19.7206,name:"Tirana",country:"AL"},ATH:{lat:37.9364,lon:23.9445,name:"Athens",country:"GR"},SKG:{lat:40.5197,lon:22.9709,name:"Thessaloniki",country:"GR"},HER:{lat:35.3397,lon:25.1803,name:"Heraklion (Crete)",country:"GR"},CHQ:{lat:35.5317,lon:24.1497,name:"Chania (Crete)",country:"GR"},RHO:{lat:36.4054,lon:28.0862,name:"Rhodes",country:"GR"},KGS:{lat:36.7933,lon:27.0917,name:"Kos",country:"GR"},CFU:{lat:39.6019,lon:19.9117,name:"Corfu",country:"GR"},JMK:{lat:37.4351,lon:25.3481,name:"Mykonos",country:"GR"},JTR:{lat:36.3992,lon:25.4793,name:"Santorini",country:"GR"},ZTH:{lat:37.7509,lon:20.8843,name:"Zakynthos",country:"GR"},KVA:{lat:40.9133,lon:24.6192,name:"Kavala",country:"GR"},SMI:{lat:37.69,lon:26.9117,name:"Samos",country:"GR"},MJT:{lat:39.0567,lon:26.5983,name:"Mytilene (Lesbos)",country:"GR"},EFL:{lat:38.12,lon:20.5006,name:"Kefalonia",country:"GR"},PVK:{lat:38.9256,lon:20.7653,name:"Preveza",country:"GR"},VOL:{lat:39.2197,lon:22.7944,name:"Volos",country:"GR"},IOA:{lat:39.6964,lon:20.8225,name:"Ioannina",country:"GR"},LCA:{lat:34.8751,lon:33.6249,name:"Larnaca",country:"CY"},PFO:{lat:34.718,lon:32.4857,name:"Paphos",country:"CY"},ECN:{lat:35.1547,lon:33.4961,name:"Ercan (North Cyprus)",country:"CY"},IST:{lat:41.2753,lon:28.752,name:"Istanbul",country:"TR"},SAW:{lat:40.8986,lon:29.3092,name:"Istanbul Sabiha GÃ¶kÃ§en",country:"TR"},AYT:{lat:36.8987,lon:30.8005,name:"Antalya",country:"TR"},ADB:{lat:38.2924,lon:27.157,name:"Izmir",country:"TR"},ESB:{lat:40.1281,lon:32.9951,name:"Ankara EsenboÄa",country:"TR"},DLM:{lat:36.7131,lon:28.7925,name:"Dalaman",country:"TR"},BJV:{lat:37.2506,lon:27.6643,name:"Bodrum",country:"TR"},GZT:{lat:36.9472,lon:37.4787,name:"Gaziantep",country:"TR"},TZX:{lat:40.995,lon:39.7897,name:"Trabzon",country:"TR"},VAN:{lat:38.4682,lon:43.3323,name:"Van",country:"TR"},KYA:{lat:37.979,lon:32.5619,name:"Konya",country:"TR"},ASR:{lat:38.7704,lon:35.4954,name:"Kayseri",country:"TR"},ADA:{lat:36.9822,lon:35.2804,name:"Adana",country:"TR"},DIY:{lat:37.8939,lon:40.201,name:"DiyarbakÄ±r",country:"TR"},ERZ:{lat:39.9565,lon:41.1702,name:"Erzurum",country:"TR"},SZF:{lat:41.2545,lon:36.5671,name:"Samsun",country:"TR"},SVO:{lat:55.9726,lon:37.4146,name:"Moscow Sheremetyevo",country:"RU"},DME:{lat:55.4088,lon:37.9063,name:"Moscow Domodedovo",country:"RU"},VKO:{lat:55.5915,lon:37.2615,name:"Moscow Vnukovo",country:"RU"},LED:{lat:59.8003,lon:30.2625,name:"St. Petersburg",country:"RU"},KIV:{lat:46.9277,lon:28.9313,name:"ChiÈinÄu",country:"MD"},IEV:{lat:50.4019,lon:30.4497,name:"Kyiv Zhuliany",country:"UA"},KBP:{lat:50.345,lon:30.8947,name:"Kyiv Boryspil",country:"UA"},ODS:{lat:46.4268,lon:30.6765,name:"Odessa",country:"UA"},LWO:{lat:49.8125,lon:23.9561,name:"Lviv",country:"UA"},TBS:{lat:41.6692,lon:44.9547,name:"Tbilisi",country:"GE"},BUS:{lat:41.6103,lon:41.5997,name:"Batumi",country:"GE"},KUT:{lat:42.1767,lon:42.4826,name:"Kutaisi",country:"GE"},EVN:{lat:40.1473,lon:44.3959,name:"Yerevan",country:"AM"},GYD:{lat:40.4675,lon:50.0467,name:"Baku",country:"AZ"},MSQ:{lat:53.8825,lon:28.0307,name:"Minsk",country:"BY"},ALA:{lat:43.3521,lon:77.0405,name:"Almaty",country:"KZ"},NQZ:{lat:51.0222,lon:71.4669,name:"Astana",country:"KZ"},TAS:{lat:41.2579,lon:69.2812,name:"Tashkent",country:"UZ"},DXB:{lat:25.2532,lon:55.3657,name:"Dubai",country:"AE"},AUH:{lat:24.433,lon:54.6511,name:"Abu Dhabi",country:"AE"},SHJ:{lat:25.3286,lon:55.5172,name:"Sharjah",country:"AE"},DOH:{lat:25.2731,lon:51.6081,name:"Doha Hamad",country:"QA"},BAH:{lat:26.2708,lon:50.6336,name:"Bahrain",country:"BH"},KWI:{lat:29.2266,lon:47.9689,name:"Kuwait",country:"KW"},MCT:{lat:23.5933,lon:58.2844,name:"Muscat",country:"OM"},SLL:{lat:17.0387,lon:54.0914,name:"Salalah",country:"OM"},RUH:{lat:24.9578,lon:46.6989,name:"Riyadh",country:"SA"},JED:{lat:21.6796,lon:39.1565,name:"Jeddah",country:"SA"},DMM:{lat:26.4712,lon:49.7979,name:"Dammam",country:"SA"},MED:{lat:24.5534,lon:39.7051,name:"Medina",country:"SA"},AMM:{lat:31.7226,lon:35.9932,name:"Amman Queen Alia",country:"JO"},AQJ:{lat:29.6116,lon:35.0181,name:"Aqaba",country:"JO"},BEY:{lat:33.8209,lon:35.4884,name:"Beirut",country:"LB"},TLV:{lat:32.0114,lon:34.8867,name:"Tel Aviv Ben Gurion",country:"IL"},SDV:{lat:32.1147,lon:34.7822,name:"Tel Aviv Sde Dov",country:"IL"},IKA:{lat:35.4161,lon:51.1522,name:"Tehran Imam Khomeini",country:"IR"},THR:{lat:35.6892,lon:51.3134,name:"Tehran Mehrabad",country:"IR"},ISU:{lat:35.5456,lon:45.3168,name:"Sulaymaniyah",country:"IQ"},EBL:{lat:36.2376,lon:43.9632,name:"Erbil",country:"IQ"},BGW:{lat:33.2625,lon:44.2346,name:"Baghdad",country:"IQ"},BSR:{lat:30.5491,lon:47.6621,name:"Basra",country:"IQ"},DAM:{lat:33.4115,lon:36.5156,name:"Damascus",country:"SY"},CAI:{lat:30.1219,lon:31.4056,name:"Cairo",country:"EG"},HRG:{lat:27.1783,lon:33.7994,name:"Hurghada",country:"EG"},SSH:{lat:27.9773,lon:34.395,name:"Sharm El Sheikh",country:"EG"},LXR:{lat:25.6708,lon:32.7069,name:"Luxor",country:"EG"},ASW:{lat:23.9644,lon:32.82,name:"Aswan",country:"EG"},ALY:{lat:31.1839,lon:29.9489,name:"Alexandria Borg El Arab",country:"EG"},ALG:{lat:36.691,lon:3.2154,name:"Algiers",country:"DZ"},ORN:{lat:35.624,lon:-.6211,name:"Oran",country:"DZ"},CZL:{lat:36.2761,lon:6.6204,name:"Constantine",country:"DZ"},AAE:{lat:36.8222,lon:7.8092,name:"Annaba",country:"DZ"},TUN:{lat:36.851,lon:10.2272,name:"Tunis-Carthage",country:"TN"},DJE:{lat:33.875,lon:10.7755,name:"Djerba",country:"TN"},MIR:{lat:35.7581,lon:10.7547,name:"Monastir",country:"TN"},SFA:{lat:34.718,lon:10.691,name:"Sfax",country:"TN"},NBE:{lat:36.0758,lon:10.4386,name:"Enfidha",country:"TN"},CMN:{lat:33.3675,lon:-7.5897,name:"Casablanca Mohammed V",country:"MA"},RAK:{lat:31.6069,lon:-8.0363,name:"Marrakech",country:"MA"},AGA:{lat:30.325,lon:-9.4131,name:"Agadir",country:"MA"},FEZ:{lat:33.9272,lon:-4.978,name:"Fes",country:"MA"},TNG:{lat:35.7269,lon:-5.9169,name:"Tangier",country:"MA"},RBA:{lat:34.0515,lon:-6.7515,name:"Rabat",country:"MA"},NDR:{lat:34.9888,lon:-3.0282,name:"Nador",country:"MA"},OUD:{lat:34.7872,lon:-1.924,name:"Oujda",country:"MA"},ESU:{lat:31.3975,lon:-9.6817,name:"Essaouira",country:"MA"},OZZ:{lat:30.9391,lon:-6.9094,name:"Ouarzazate",country:"MA"},ERH:{lat:31.9475,lon:-4.3983,name:"Errachidia",country:"MA"},TTP:{lat:28.4485,lon:-11.1613,name:"Tan Tan",country:"MA"},EUN:{lat:27.1517,lon:-13.2192,name:"LaÃ¢youne",country:"EH"},TIP:{lat:32.6635,lon:13.159,name:"Tripoli",country:"LY"},BEN:{lat:32.0968,lon:20.2695,name:"Benghazi",country:"LY"},DSS:{lat:14.7397,lon:-17.4902,name:"Dakar Blaise Diagne",country:"SN"},ABJ:{lat:5.2614,lon:-3.9262,name:"Abidjan",country:"CI"},ACC:{lat:5.6052,lon:-.1668,name:"Accra Kotoka",country:"GH"},LOS:{lat:6.5774,lon:3.3212,name:"Lagos",country:"NG"},ABV:{lat:9.0068,lon:7.2632,name:"Abuja",country:"NG"},PHC:{lat:5.0154,lon:6.9496,name:"Port Harcourt",country:"NG"},KAN:{lat:12.0476,lon:8.5246,name:"Kano",country:"NG"},DKR:{lat:14.6697,lon:-17.0728,name:"Dakar LÃ©opold SÃ©dar Senghor",country:"SN"},COO:{lat:6.3573,lon:2.3844,name:"Cotonou",country:"BJ"},LFW:{lat:6.1656,lon:1.2545,name:"LomÃ©",country:"TG"},OUA:{lat:12.3532,lon:-1.5124,name:"Ouagadougou",country:"BF"},BKO:{lat:12.5335,lon:-7.9499,name:"Bamako",country:"ML"},NIM:{lat:13.4815,lon:2.1835,name:"Niamey",country:"NE"},CKY:{lat:9.5769,lon:-13.612,name:"Conakry",country:"GN"},FNA:{lat:8.6164,lon:-13.1955,name:"Freetown Lungi",country:"SL"},ROB:{lat:6.2338,lon:-10.3623,name:"Monrovia Roberts",country:"LR"},BJL:{lat:13.338,lon:-16.6522,name:"Banjul",country:"GM"},RAI:{lat:14.9245,lon:-23.4935,name:"Praia",country:"CV"},SID:{lat:16.7414,lon:-22.9494,name:"Sal",country:"CV"},BVC:{lat:16.1365,lon:-22.8889,name:"Boa Vista",country:"CV"},NKC:{lat:18.0969,lon:-15.9486,name:"Nouakchott",country:"MR"},DLA:{lat:4.0061,lon:9.7195,name:"Douala",country:"CM"},NSI:{lat:3.7226,lon:11.5533,name:"YaoundÃ© Nsimalen",country:"CM"},LBV:{lat:.4586,lon:9.4123,name:"Libreville",country:"GA"},POG:{lat:-.7117,lon:8.7543,name:"Port-Gentil",country:"GA"},SSG:{lat:3.7553,lon:8.7087,name:"Malabo",country:"GQ"},FIH:{lat:-4.3858,lon:15.4446,name:"Kinshasa",country:"CD"},FBM:{lat:-11.5913,lon:27.5309,name:"Lubumbashi",country:"CD"},BZV:{lat:-4.2517,lon:15.253,name:"Brazzaville",country:"CG"},PNR:{lat:-4.8161,lon:11.8866,name:"Pointe-Noire",country:"CG"},BGF:{lat:4.3985,lon:18.5188,name:"Bangui",country:"CF"},NDJ:{lat:12.1337,lon:15.034,name:"N'Djamena",country:"TD"},STP:{lat:.3782,lon:6.7121,name:"SÃ£o TomÃ©",country:"ST"},LAD:{lat:-8.8584,lon:13.2312,name:"Luanda",country:"AO"},NBO:{lat:-1.3192,lon:36.9278,name:"Nairobi Jomo Kenyatta",country:"KE"},MBA:{lat:-4.0348,lon:39.5942,name:"Mombasa",country:"KE"},ADD:{lat:8.9779,lon:38.7993,name:"Addis Ababa Bole",country:"ET"},DAR:{lat:-6.8781,lon:39.2026,name:"Dar es Salaam",country:"TZ"},JRO:{lat:-3.4294,lon:37.0745,name:"Kilimanjaro",country:"TZ"},ZNZ:{lat:-6.222,lon:39.2249,name:"Zanzibar",country:"TZ"},EBB:{lat:.0424,lon:32.4435,name:"Entebbe",country:"UG"},KGL:{lat:-1.9686,lon:30.1395,name:"Kigali",country:"RW"},BJM:{lat:-3.324,lon:29.3185,name:"Bujumbura",country:"BI"},ASM:{lat:15.2919,lon:38.9107,name:"Asmara",country:"ER"},JIB:{lat:11.5473,lon:43.1595,name:"Djibouti",country:"DJ"},MGQ:{lat:2.0144,lon:45.305,name:"Mogadishu",country:"SO"},SEZ:{lat:-4.6743,lon:55.5218,name:"MahÃ© (Seychelles)",country:"SC"},MRU:{lat:-20.4302,lon:57.6836,name:"Mauritius",country:"MU"},TNR:{lat:-18.7969,lon:47.4788,name:"Antananarivo",country:"MG"},NOS:{lat:-13.3121,lon:48.3148,name:"Nosy Be",country:"MG"},HAH:{lat:-11.5337,lon:43.2719,name:"Moroni (Comoros)",country:"KM"},JNB:{lat:-26.1392,lon:28.246,name:"Johannesburg O.R. Tambo",country:"ZA"},CPT:{lat:-33.9649,lon:18.6017,name:"Cape Town",country:"ZA"},DUR:{lat:-29.6144,lon:31.1197,name:"Durban King Shaka",country:"ZA"},PLZ:{lat:-33.9849,lon:25.6173,name:"Port Elizabeth",country:"ZA"},GRJ:{lat:-34.0056,lon:22.3789,name:"George",country:"ZA"},BFN:{lat:-29.0927,lon:26.3024,name:"Bloemfontein",country:"ZA"},ELS:{lat:-33.0356,lon:27.8259,name:"East London",country:"ZA"},HRE:{lat:-17.9318,lon:31.0928,name:"Harare",country:"ZW"},VFA:{lat:-18.0959,lon:25.839,name:"Victoria Falls",country:"ZW"},LUN:{lat:-15.3308,lon:28.4526,name:"Lusaka",country:"ZM"},LVI:{lat:-17.8218,lon:25.8227,name:"Livingstone",country:"ZM"},LLW:{lat:-13.7894,lon:33.7811,name:"Lilongwe",country:"MW"},BLZ:{lat:-15.6791,lon:34.974,name:"Blantyre",country:"MW"},MPM:{lat:-25.9208,lon:32.5726,name:"Maputo",country:"MZ"},GBE:{lat:-24.5552,lon:25.9182,name:"Gaborone",country:"BW"},WDH:{lat:-22.4799,lon:17.4709,name:"Windhoek Hosea Kutako",country:"NA"},MQP:{lat:-25.3832,lon:31.1056,name:"Mbombela/Kruger",country:"ZA"},PEK:{lat:40.0799,lon:116.6031,name:"Beijing Capital",country:"CN"},PKX:{lat:39.5098,lon:116.4105,name:"Beijing Daxing",country:"CN"},PVG:{lat:31.1434,lon:121.8052,name:"Shanghai Pudong",country:"CN"},SHA:{lat:31.1979,lon:121.3363,name:"Shanghai Hongqiao",country:"CN"},CAN:{lat:23.3924,lon:113.2988,name:"Guangzhou",country:"CN"},SZX:{lat:22.6393,lon:113.8107,name:"Shenzhen",country:"CN"},CTU:{lat:30.5785,lon:103.9471,name:"Chengdu Shuangliu",country:"CN"},TFU:{lat:30.3197,lon:104.4469,name:"Chengdu Tianfu",country:"CN"},CKG:{lat:29.7192,lon:106.6417,name:"Chongqing",country:"CN"},XIY:{lat:34.4371,lon:108.7519,name:"Xi'an",country:"CN"},HGH:{lat:30.2295,lon:120.4344,name:"Hangzhou",country:"CN"},NKG:{lat:31.742,lon:118.862,name:"Nanjing",country:"CN"},WUH:{lat:30.7838,lon:114.2081,name:"Wuhan",country:"CN"},CSX:{lat:28.1892,lon:113.22,name:"Changsha",country:"CN"},TAO:{lat:36.2661,lon:120.3744,name:"Qingdao",country:"CN"},XMN:{lat:24.544,lon:118.1278,name:"Xiamen",country:"CN"},KMG:{lat:25.1019,lon:102.9292,name:"Kunming",country:"CN"},SYX:{lat:18.3029,lon:109.4122,name:"Sanya",country:"CN"},HAK:{lat:19.9349,lon:110.459,name:"Haikou",country:"CN"},DLC:{lat:38.9657,lon:121.5386,name:"Dalian",country:"CN"},TSN:{lat:39.1246,lon:117.3462,name:"Tianjin",country:"CN"},URC:{lat:43.9071,lon:87.4742,name:"ÃrÃ¼mqi",country:"CN"},HRB:{lat:45.6234,lon:126.25,name:"Harbin",country:"CN"},SHE:{lat:41.6398,lon:123.4833,name:"Shenyang",country:"CN"},CGO:{lat:34.5197,lon:113.8408,name:"Zhengzhou",country:"CN"},HKG:{lat:22.308,lon:113.9185,name:"Hong Kong",country:"HK"},MFM:{lat:22.1496,lon:113.592,name:"Macau",country:"MO"},TPE:{lat:25.0777,lon:121.2328,name:"Taipei Taoyuan",country:"TW"},TSA:{lat:25.0694,lon:121.5525,name:"Taipei Songshan",country:"TW"},KHH:{lat:22.5771,lon:120.35,name:"Kaohsiung",country:"TW"},NRT:{lat:35.772,lon:140.3929,name:"Tokyo Narita",country:"JP"},HND:{lat:35.5494,lon:139.7798,name:"Tokyo Haneda",country:"JP"},KIX:{lat:34.432,lon:135.2304,name:"Osaka Kansai",country:"JP"},ITM:{lat:34.7854,lon:135.4385,name:"Osaka Itami",country:"JP"},NGO:{lat:34.8584,lon:136.805,name:"Nagoya Chubu",country:"JP"},FUK:{lat:33.5859,lon:130.4511,name:"Fukuoka",country:"JP"},CTS:{lat:42.7752,lon:141.6924,name:"Sapporo New Chitose",country:"JP"},OKA:{lat:26.1958,lon:127.6459,name:"Okinawa Naha",country:"JP"},ICN:{lat:37.4691,lon:126.4505,name:"Seoul Incheon",country:"KR"},GMP:{lat:37.5583,lon:126.7906,name:"Seoul Gimpo",country:"KR"},PUS:{lat:35.1795,lon:128.9381,name:"Busan",country:"KR"},CJU:{lat:33.5113,lon:126.4929,name:"Jeju",country:"KR"},ULN:{lat:47.8431,lon:106.7666,name:"Ulaanbaatar",country:"MN"},FNJ:{lat:39.2241,lon:125.67,name:"Pyongyang",country:"KP"},SIN:{lat:1.3644,lon:103.9915,name:"Singapore Changi",country:"SG"},BKK:{lat:13.69,lon:100.7501,name:"Bangkok Suvarnabhumi",country:"TH"},DMK:{lat:13.9126,lon:100.6068,name:"Bangkok Don Mueang",country:"TH"},HKT:{lat:8.1132,lon:98.3169,name:"Phuket",country:"TH"},CNX:{lat:18.7668,lon:98.9626,name:"Chiang Mai",country:"TH"},USM:{lat:9.5478,lon:100.0623,name:"Koh Samui",country:"TH"},KBV:{lat:8.0992,lon:98.9862,name:"Krabi",country:"TH"},HDY:{lat:6.9332,lon:100.393,name:"Hat Yai",country:"TH"},KUL:{lat:2.7456,lon:101.7099,name:"Kuala Lumpur",country:"MY"},SZB:{lat:3.1308,lon:101.5494,name:"Kuala Lumpur Subang",country:"MY"},PEN:{lat:5.2971,lon:100.2768,name:"Penang",country:"MY"},LGK:{lat:6.3297,lon:99.7286,name:"Langkawi",country:"MY"},BKI:{lat:5.9372,lon:116.0514,name:"Kota Kinabalu",country:"MY"},KCH:{lat:1.4847,lon:110.3473,name:"Kuching",country:"MY"},JHB:{lat:1.6411,lon:103.6697,name:"Johor Bahru Senai",country:"MY"},MYY:{lat:4.3222,lon:113.987,name:"Miri",country:"MY"},BWN:{lat:4.9442,lon:114.9283,name:"Bandar Seri Begawan",country:"BN"},CGK:{lat:-6.1256,lon:106.6558,name:"Jakarta Soekarno-Hatta",country:"ID"},HLP:{lat:-6.2669,lon:106.891,name:"Jakarta Halim",country:"ID"},DPS:{lat:-8.7482,lon:115.1672,name:"Bali Ngurah Rai",country:"ID"},SUB:{lat:-7.3798,lon:112.7868,name:"Surabaya",country:"ID"},JOG:{lat:-7.7882,lon:110.4317,name:"Yogyakarta",country:"ID"},MES:{lat:3.558,lon:98.6711,name:"Medan Kualanamu",country:"ID"},UPG:{lat:-5.0617,lon:119.554,name:"Makassar",country:"ID"},BPN:{lat:-1.2683,lon:116.8943,name:"Balikpapan",country:"ID"},PDG:{lat:-.8747,lon:100.352,name:"Padang",country:"ID"},PKU:{lat:.4607,lon:101.4447,name:"Pekanbaru",country:"ID"},PLM:{lat:-2.8983,lon:104.6999,name:"Palembang",country:"ID"},BTH:{lat:1.1212,lon:104.1186,name:"Batam",country:"ID"},MNL:{lat:14.5086,lon:121.0197,name:"Manila Ninoy Aquino",country:"PH"},CEB:{lat:10.3075,lon:123.9794,name:"Cebu",country:"PH"},CRK:{lat:15.1859,lon:120.5603,name:"Clark",country:"PH"},DVO:{lat:7.1255,lon:125.6456,name:"Davao",country:"PH"},SGN:{lat:10.8188,lon:106.6519,name:"Ho Chi Minh City",country:"VN"},HAN:{lat:21.2212,lon:105.8072,name:"Hanoi",country:"VN"},DAD:{lat:16.0439,lon:108.1994,name:"Da Nang",country:"VN"},CXR:{lat:11.9984,lon:109.2193,name:"Nha Trang Cam Ranh",country:"VN"},PQC:{lat:10.1698,lon:103.9931,name:"Phu Quoc",country:"VN"},VDO:{lat:21.1178,lon:107.4144,name:"Van Don",country:"VN"},RGN:{lat:16.9073,lon:96.1332,name:"Yangon",country:"MM"},MDL:{lat:21.7022,lon:95.9779,name:"Mandalay",country:"MM"},NYT:{lat:19.6235,lon:96.2011,name:"Naypyidaw",country:"MM"},PNH:{lat:11.5466,lon:104.8441,name:"Phnom Penh",country:"KH"},REP:{lat:13.4107,lon:103.8128,name:"Siem Reap",country:"KH"},VTE:{lat:17.9883,lon:102.5633,name:"Vientiane",country:"LA"},LPQ:{lat:19.8973,lon:102.1613,name:"Luang Prabang",country:"LA"},DIL:{lat:-8.5465,lon:125.526,name:"Dili",country:"TL"},DEL:{lat:28.5562,lon:77.1,name:"Delhi Indira Gandhi",country:"IN"},BOM:{lat:19.0896,lon:72.8656,name:"Mumbai",country:"IN"},MAA:{lat:12.9941,lon:80.1709,name:"Chennai",country:"IN"},BLR:{lat:13.1986,lon:77.7066,name:"Bengaluru",country:"IN"},HYD:{lat:17.2403,lon:78.4294,name:"Hyderabad",country:"IN"},CCU:{lat:22.6547,lon:88.4467,name:"Kolkata",country:"IN"},COK:{lat:10.152,lon:76.4019,name:"Kochi",country:"IN"},GOI:{lat:15.3808,lon:73.8314,name:"Goa",country:"IN"},AMD:{lat:23.0772,lon:72.6347,name:"Ahmedabad",country:"IN"},TRV:{lat:8.4821,lon:76.9201,name:"Thiruvananthapuram",country:"IN"},JAI:{lat:26.8242,lon:75.8122,name:"Jaipur",country:"IN"},PNQ:{lat:18.5821,lon:73.9197,name:"Pune",country:"IN"},GAU:{lat:26.1061,lon:91.5859,name:"Guwahati",country:"IN"},IXC:{lat:30.6735,lon:76.7885,name:"Chandigarh",country:"IN"},LKO:{lat:26.7606,lon:80.8893,name:"Lucknow",country:"IN"},VNS:{lat:25.4524,lon:82.8593,name:"Varanasi",country:"IN"},CMB:{lat:7.1808,lon:79.8841,name:"Colombo Bandaranaike",country:"LK"},HRI:{lat:6.2844,lon:81.1239,name:"Mattala (Hambantota)",country:"LK"},DAC:{lat:23.8433,lon:90.3978,name:"Dhaka",country:"BD"},CGP:{lat:22.2496,lon:91.8133,name:"Chittagong",country:"BD"},KTM:{lat:27.6966,lon:85.3591,name:"Kathmandu",country:"NP"},ISB:{lat:33.6167,lon:73.0991,name:"Islamabad",country:"PK"},KHI:{lat:24.9065,lon:67.1608,name:"Karachi",country:"PK"},LHE:{lat:31.5216,lon:74.4036,name:"Lahore",country:"PK"},MLE:{lat:4.1918,lon:73.529,name:"MalÃ© (Maldives)",country:"MV"},PBH:{lat:27.4033,lon:89.4246,name:"Paro (Bhutan)",country:"BT"},SYD:{lat:-33.9399,lon:151.1753,name:"Sydney",country:"AU"},MEL:{lat:-37.669,lon:144.841,name:"Melbourne",country:"AU"},BNE:{lat:-27.3842,lon:153.1175,name:"Brisbane",country:"AU"},PER:{lat:-31.9403,lon:115.967,name:"Perth",country:"AU"},ADL:{lat:-34.945,lon:138.5306,name:"Adelaide",country:"AU"},CBR:{lat:-35.3069,lon:149.1946,name:"Canberra",country:"AU"},OOL:{lat:-28.1644,lon:153.5047,name:"Gold Coast",country:"AU"},CNS:{lat:-16.8858,lon:145.7552,name:"Cairns",country:"AU"},DRW:{lat:-12.4147,lon:130.8769,name:"Darwin",country:"AU"},HBA:{lat:-42.8361,lon:147.5103,name:"Hobart",country:"AU"},TSV:{lat:-19.2525,lon:146.7656,name:"Townsville",country:"AU"},AVV:{lat:-38.0394,lon:144.4697,name:"Avalon",country:"AU"},AKL:{lat:-37.0082,lon:174.785,name:"Auckland",country:"NZ"},WLG:{lat:-41.3272,lon:174.8053,name:"Wellington",country:"NZ"},CHC:{lat:-43.4894,lon:172.5322,name:"Christchurch",country:"NZ"},ZQN:{lat:-45.0211,lon:168.7392,name:"Queenstown",country:"NZ"},DUD:{lat:-45.9281,lon:170.1975,name:"Dunedin",country:"NZ"},NAN:{lat:-17.7554,lon:177.4431,name:"Nadi (Fiji)",country:"FJ"},SUV:{lat:-18.0433,lon:178.5592,name:"Suva (Fiji)",country:"FJ"},APW:{lat:-13.8297,lon:-171.9968,name:"Apia (Samoa)",country:"WS"},TBU:{lat:-21.2411,lon:-175.1497,name:"Nuku'alofa (Tonga)",country:"TO"},VLI:{lat:-17.6993,lon:168.3199,name:"Port Vila (Vanuatu)",country:"VU"},GUM:{lat:13.4834,lon:144.796,name:"Guam",country:"GU"},POM:{lat:-5.8624,lon:147.22,name:"Port Moresby",country:"PG"},JFK:{lat:40.6398,lon:-73.7789,name:"New York JFK",country:"US"},EWR:{lat:40.6925,lon:-74.1687,name:"Newark Liberty",country:"US"},LGA:{lat:40.7772,lon:-73.8726,name:"New York LaGuardia",country:"US"},BOS:{lat:42.3643,lon:-71.0052,name:"Boston Logan",country:"US"},PHL:{lat:39.8719,lon:-75.2411,name:"Philadelphia",country:"US"},IAD:{lat:38.9445,lon:-77.4558,name:"Washington Dulles",country:"US"},DCA:{lat:38.8521,lon:-77.0377,name:"Washington Reagan",country:"US"},BWI:{lat:39.1754,lon:-76.6683,name:"Baltimore/Washington",country:"US"},PIT:{lat:40.4915,lon:-80.2329,name:"Pittsburgh",country:"US"},CLE:{lat:41.4117,lon:-81.8498,name:"Cleveland",country:"US"},BUF:{lat:42.9405,lon:-78.7322,name:"Buffalo",country:"US"},ROC:{lat:43.1189,lon:-77.6724,name:"Rochester",country:"US"},SYR:{lat:43.1112,lon:-76.1063,name:"Syracuse",country:"US"},ALB:{lat:42.7483,lon:-73.8017,name:"Albany",country:"US"},PVD:{lat:41.7326,lon:-71.4204,name:"Providence",country:"US"},BDL:{lat:41.9389,lon:-72.6832,name:"Hartford",country:"US"},PWM:{lat:43.6462,lon:-70.3093,name:"Portland (Maine)",country:"US"},MHT:{lat:42.9326,lon:-71.4357,name:"Manchester",country:"US"},BTV:{lat:44.472,lon:-73.1533,name:"Burlington",country:"US"},ATL:{lat:33.6367,lon:-84.4281,name:"Atlanta Hartsfield-Jackson",country:"US"},CLT:{lat:35.214,lon:-80.9431,name:"Charlotte",country:"US"},MIA:{lat:25.7932,lon:-80.2906,name:"Miami",country:"US"},FLL:{lat:26.0726,lon:-80.1527,name:"Fort Lauderdale",country:"US"},MCO:{lat:28.4294,lon:-81.309,name:"Orlando",country:"US"},TPA:{lat:27.9755,lon:-82.5332,name:"Tampa",country:"US"},RSW:{lat:26.5362,lon:-81.7552,name:"Fort Myers",country:"US"},PBI:{lat:26.6832,lon:-80.0956,name:"West Palm Beach",country:"US"},JAX:{lat:30.4941,lon:-81.6879,name:"Jacksonville",country:"US"},RDU:{lat:35.8801,lon:-78.788,name:"Raleigh-Durham",country:"US"},GSP:{lat:34.8957,lon:-82.2189,name:"Greenville-Spartanburg",country:"US"},CHS:{lat:32.8986,lon:-80.0405,name:"Charleston",country:"US"},SAV:{lat:32.1276,lon:-81.2021,name:"Savannah",country:"US"},MYR:{lat:33.6797,lon:-78.9283,name:"Myrtle Beach",country:"US"},BNA:{lat:36.1263,lon:-86.6774,name:"Nashville",country:"US"},MEM:{lat:35.0424,lon:-89.9767,name:"Memphis",country:"US"},MSY:{lat:29.9934,lon:-90.258,name:"New Orleans",country:"US"},SDF:{lat:38.1744,lon:-85.736,name:"Louisville",country:"US"},CVG:{lat:39.0489,lon:-84.6678,name:"Cincinnati",country:"US"},CMH:{lat:39.998,lon:-82.8919,name:"Columbus",country:"US"},IND:{lat:39.7173,lon:-86.2944,name:"Indianapolis",country:"US"},BHM:{lat:33.5629,lon:-86.7535,name:"Birmingham",country:"US"},ORD:{lat:41.9786,lon:-87.9048,name:"Chicago O'Hare",country:"US"},MDW:{lat:41.7868,lon:-87.7522,name:"Chicago Midway",country:"US"},DTW:{lat:42.2124,lon:-83.3534,name:"Detroit",country:"US"},MSP:{lat:44.882,lon:-93.2218,name:"Minneapolis-St. Paul",country:"US"},STL:{lat:38.7487,lon:-90.37,name:"St. Louis",country:"US"},MCI:{lat:39.2976,lon:-94.7139,name:"Kansas City",country:"US"},MKE:{lat:42.9472,lon:-87.8966,name:"Milwaukee",country:"US"},OMA:{lat:41.3032,lon:-95.8941,name:"Omaha",country:"US"},DSM:{lat:41.534,lon:-93.6631,name:"Des Moines",country:"US"},FAR:{lat:46.9207,lon:-96.8158,name:"Fargo",country:"US"},FSD:{lat:43.582,lon:-96.7419,name:"Sioux Falls",country:"US"},GRR:{lat:42.8808,lon:-85.5228,name:"Grand Rapids",country:"US"},LAN:{lat:42.7787,lon:-84.5874,name:"Lansing",country:"US"},FNT:{lat:42.9654,lon:-83.7436,name:"Flint",country:"US"},TVC:{lat:44.7412,lon:-85.5821,name:"Traverse City",country:"US"},CID:{lat:41.8847,lon:-91.7108,name:"Cedar Rapids",country:"US"},ICT:{lat:37.6499,lon:-97.4331,name:"Wichita",country:"US"},DFW:{lat:32.8968,lon:-97.038,name:"Dallas/Fort Worth",country:"US"},DAL:{lat:32.8471,lon:-96.8518,name:"Dallas Love Field",country:"US"},IAH:{lat:29.9844,lon:-95.3414,name:"Houston Intercontinental",country:"US"},HOU:{lat:29.6454,lon:-95.2789,name:"Houston Hobby",country:"US"},AUS:{lat:30.1945,lon:-97.6699,name:"Austin",country:"US"},SAT:{lat:29.5337,lon:-98.4698,name:"San Antonio",country:"US"},ELP:{lat:31.8072,lon:-106.3778,name:"El Paso",country:"US"},PHX:{lat:33.4373,lon:-112.0078,name:"Phoenix",country:"US"},TUS:{lat:32.1161,lon:-110.941,name:"Tucson",country:"US"},ABQ:{lat:35.0402,lon:-106.6094,name:"Albuquerque",country:"US"},LAS:{lat:36.0801,lon:-115.1522,name:"Las Vegas",country:"US"},DEN:{lat:39.8561,lon:-104.6737,name:"Denver",country:"US"},SLC:{lat:40.7884,lon:-111.9778,name:"Salt Lake City",country:"US"},OKC:{lat:35.3931,lon:-97.6007,name:"Oklahoma City",country:"US"},TUL:{lat:36.1984,lon:-95.8881,name:"Tulsa",country:"US"},COS:{lat:38.8058,lon:-104.7008,name:"Colorado Springs",country:"US"},BOI:{lat:43.5644,lon:-116.2228,name:"Boise",country:"US"},LAX:{lat:33.9425,lon:-118.4081,name:"Los Angeles",country:"US"},SFO:{lat:37.6188,lon:-122.3754,name:"San Francisco",country:"US"},SJC:{lat:37.3626,lon:-121.9291,name:"San Jose",country:"US"},OAK:{lat:37.7126,lon:-122.2197,name:"Oakland",country:"US"},SAN:{lat:32.7336,lon:-117.1897,name:"San Diego",country:"US"},SEA:{lat:47.4502,lon:-122.3088,name:"Seattle-Tacoma",country:"US"},PDX:{lat:45.5898,lon:-122.5951,name:"Portland",country:"US"},SMF:{lat:38.6954,lon:-121.5908,name:"Sacramento",country:"US"},SNA:{lat:33.6757,lon:-117.8682,name:"Orange County (John Wayne)",country:"US"},ONT:{lat:34.0559,lon:-117.6011,name:"Ontario",country:"US"},BUR:{lat:34.2007,lon:-118.3585,name:"Burbank",country:"US"},LGB:{lat:33.8177,lon:-118.1516,name:"Long Beach",country:"US"},PSP:{lat:33.8297,lon:-116.5067,name:"Palm Springs",country:"US"},RNO:{lat:39.4991,lon:-119.7681,name:"Reno",country:"US"},FAT:{lat:36.7762,lon:-119.7181,name:"Fresno",country:"US"},SBA:{lat:34.4262,lon:-119.8403,name:"Santa Barbara",country:"US"},GEG:{lat:47.6199,lon:-117.5338,name:"Spokane",country:"US"},HNL:{lat:21.3187,lon:-157.9225,name:"Honolulu",country:"US"},OGG:{lat:20.8986,lon:-156.4305,name:"Maui Kahului",country:"US"},KOA:{lat:19.7388,lon:-156.0456,name:"Kona",country:"US"},LIH:{lat:21.976,lon:-159.339,name:"Kauai Lihue",country:"US"},ITO:{lat:19.7214,lon:-155.0485,name:"Hilo",country:"US"},ANC:{lat:61.1744,lon:-149.9964,name:"Anchorage",country:"US"},FAI:{lat:64.8151,lon:-147.8561,name:"Fairbanks",country:"US"},JNU:{lat:58.355,lon:-134.5763,name:"Juneau",country:"US"},YYZ:{lat:43.6777,lon:-79.6248,name:"Toronto Pearson",country:"CA"},YYC:{lat:51.1215,lon:-114.0076,name:"Calgary",country:"CA"},YVR:{lat:49.1967,lon:-123.1815,name:"Vancouver",country:"CA"},YUL:{lat:45.4706,lon:-73.7408,name:"MontrÃ©al Trudeau",country:"CA"},YOW:{lat:45.3225,lon:-75.6692,name:"Ottawa",country:"CA"},YEG:{lat:53.3097,lon:-113.58,name:"Edmonton",country:"CA"},YWG:{lat:49.91,lon:-97.2399,name:"Winnipeg",country:"CA"},YHZ:{lat:44.8808,lon:-63.5086,name:"Halifax",country:"CA"},YQB:{lat:46.7911,lon:-71.3933,name:"QuÃ©bec City",country:"CA"},YXE:{lat:52.1708,lon:-106.6997,name:"Saskatoon",country:"CA"},YQR:{lat:50.4319,lon:-104.6656,name:"Regina",country:"CA"},YYJ:{lat:48.6469,lon:-123.4258,name:"Victoria",country:"CA"},YKA:{lat:50.7022,lon:-120.4444,name:"Kamloops",country:"CA"},YLW:{lat:49.9561,lon:-119.3778,name:"Kelowna",country:"CA"},YXX:{lat:49.0253,lon:-122.3608,name:"Abbotsford",country:"CA"},YQT:{lat:48.3719,lon:-89.3239,name:"Thunder Bay",country:"CA"},YSB:{lat:46.625,lon:-80.7989,name:"Sudbury",country:"CA"},YQM:{lat:46.1122,lon:-64.6786,name:"Moncton",country:"CA"},YYT:{lat:47.6186,lon:-52.7519,name:"St. John's",country:"CA"},YZF:{lat:62.4628,lon:-114.4403,name:"Yellowknife",country:"CA"},YXY:{lat:60.7096,lon:-135.0672,name:"Whitehorse",country:"CA"},MEX:{lat:19.4363,lon:-99.0721,name:"Mexico City",country:"MX"},CUN:{lat:21.0365,lon:-86.8771,name:"CancÃºn",country:"MX"},GDL:{lat:20.5218,lon:-103.3111,name:"Guadalajara",country:"MX"},MTY:{lat:25.7785,lon:-100.1069,name:"Monterrey",country:"MX"},TIJ:{lat:32.5411,lon:-116.97,name:"Tijuana",country:"MX"},SJD:{lat:23.1518,lon:-109.7215,name:"San JosÃ© del Cabo",country:"MX"},PVR:{lat:20.6801,lon:-105.2543,name:"Puerto Vallarta",country:"MX"},MID:{lat:20.937,lon:-89.6577,name:"MÃ©rida",country:"MX"},ACA:{lat:16.7571,lon:-99.7539,name:"Acapulco",country:"MX"},CZM:{lat:20.5224,lon:-86.9256,name:"Cozumel",country:"MX"},ZIH:{lat:17.6017,lon:-101.4606,name:"Ixtapa/Zihuatanejo",country:"MX"},HMO:{lat:29.0959,lon:-111.0478,name:"Hermosillo",country:"MX"},BJX:{lat:20.9935,lon:-101.4808,name:"LeÃ³n/Guanajuato",country:"MX"},CUL:{lat:24.7645,lon:-107.4752,name:"CuliacÃ¡n",country:"MX"},QRO:{lat:20.6173,lon:-100.1858,name:"QuerÃ©taro",country:"MX"},VER:{lat:19.1459,lon:-96.1873,name:"Veracruz",country:"MX"},OAX:{lat:16.9999,lon:-96.7266,name:"Oaxaca",country:"MX"},NAS:{lat:25.039,lon:-77.4662,name:"Nassau (Bahamas)",country:"BS"},FPO:{lat:26.5587,lon:-78.6956,name:"Freeport (Bahamas)",country:"BS"},HAV:{lat:22.9892,lon:-82.4091,name:"Havana",country:"CU"},VRA:{lat:23.0344,lon:-81.4353,name:"Varadero",country:"CU"},MBJ:{lat:18.5037,lon:-77.9134,name:"Montego Bay",country:"JM"},KIN:{lat:17.9357,lon:-76.7875,name:"Kingston",country:"JM"},SDQ:{lat:18.4297,lon:-69.6689,name:"Santo Domingo",country:"DO"},PUJ:{lat:18.5674,lon:-68.3634,name:"Punta Cana",country:"DO"},STI:{lat:19.4061,lon:-70.6047,name:"Santiago (DR)",country:"DO"},SJU:{lat:18.4394,lon:-66.0018,name:"San Juan",country:"PR"},AUA:{lat:12.5014,lon:-70.0152,name:"Aruba",country:"AW"},CUR:{lat:12.1889,lon:-68.9598,name:"CuraÃ§ao",country:"CW"},BON:{lat:12.131,lon:-68.2685,name:"Bonaire",country:"BQ"},SXM:{lat:18.041,lon:-63.1089,name:"St. Maarten",country:"SX"},ANU:{lat:17.1367,lon:-61.7926,name:"Antigua",country:"AG"},BGI:{lat:13.0746,lon:-59.4925,name:"Barbados",country:"BB"},POS:{lat:10.5954,lon:-61.3372,name:"Port of Spain (Trinidad)",country:"TT"},TAB:{lat:11.15,lon:-60.832,name:"Tobago",country:"TT"},GND:{lat:12.0042,lon:-61.7862,name:"Grenada",country:"GD"},UVF:{lat:13.7332,lon:-60.9526,name:"St. Lucia",country:"LC"},SVD:{lat:13.1443,lon:-61.2108,name:"St. Vincent",country:"VC"},SKB:{lat:17.3112,lon:-62.7187,name:"St. Kitts",country:"KN"},DOM:{lat:15.547,lon:-61.3,name:"Dominica",country:"DM"},EIS:{lat:18.4448,lon:-64.5428,name:"Tortola (BVI)",country:"VG"},STT:{lat:18.3373,lon:-64.9734,name:"St. Thomas (USVI)",country:"VI"},STX:{lat:17.7019,lon:-64.7986,name:"St. Croix (USVI)",country:"VI"},GCM:{lat:19.2928,lon:-81.3577,name:"Grand Cayman",country:"KY"},BDA:{lat:32.364,lon:-64.6787,name:"Bermuda",country:"BM"},GUA:{lat:14.5833,lon:-90.5275,name:"Guatemala City",country:"GT"},SAL:{lat:13.4409,lon:-89.0557,name:"San Salvador",country:"SV"},TGU:{lat:14.0608,lon:-87.2172,name:"Tegucigalpa",country:"HN"},SAP:{lat:15.4526,lon:-87.9236,name:"San Pedro Sula",country:"HN"},RTB:{lat:16.3168,lon:-86.523,name:"RoatÃ¡n",country:"HN"},MGA:{lat:12.1415,lon:-86.1682,name:"Managua",country:"NI"},SJO:{lat:9.9939,lon:-84.2088,name:"San JosÃ© (Costa Rica)",country:"CR"},LIR:{lat:10.5933,lon:-85.5444,name:"Liberia (Costa Rica)",country:"CR"},PTY:{lat:9.0714,lon:-79.3835,name:"Panama City Tocumen",country:"PA"},BZE:{lat:17.5391,lon:-88.3082,name:"Belize City",country:"BZ"},GRU:{lat:-23.4356,lon:-46.4731,name:"SÃ£o Paulo Guarulhos",country:"BR"},CGH:{lat:-23.6261,lon:-46.6564,name:"SÃ£o Paulo Congonhas",country:"BR"},GIG:{lat:-22.81,lon:-43.2505,name:"Rio de Janeiro GaleÃ£o",country:"BR"},SDU:{lat:-22.9105,lon:-43.1631,name:"Rio de Janeiro Santos Dumont",country:"BR"},BSB:{lat:-15.8711,lon:-47.9186,name:"BrasÃ­lia",country:"BR"},CNF:{lat:-19.6244,lon:-43.9719,name:"Belo Horizonte",country:"BR"},SSA:{lat:-12.9086,lon:-38.3225,name:"Salvador",country:"BR"},REC:{lat:-8.1265,lon:-34.9236,name:"Recife",country:"BR"},FOR:{lat:-3.7763,lon:-38.5323,name:"Fortaleza",country:"BR"},POA:{lat:-29.9944,lon:-51.1714,name:"Porto Alegre",country:"BR"},CWB:{lat:-25.5285,lon:-49.1758,name:"Curitiba",country:"BR"},FLN:{lat:-27.6703,lon:-48.5525,name:"FlorianÃ³polis",country:"BR"},NAT:{lat:-5.7681,lon:-35.3761,name:"Natal",country:"BR"},MAO:{lat:-3.0386,lon:-60.0497,name:"Manaus",country:"BR"},BEL:{lat:-1.3792,lon:-48.4764,name:"BelÃ©m",country:"BR"},VCP:{lat:-23.0074,lon:-47.1345,name:"Campinas",country:"BR"},IGU:{lat:-25.5961,lon:-54.4897,name:"Foz do IguaÃ§u",country:"BR"},EZE:{lat:-34.8222,lon:-58.5358,name:"Buenos Aires Ezeiza",country:"AR"},AEP:{lat:-34.5592,lon:-58.4156,name:"Buenos Aires Aeroparque",country:"AR"},COR:{lat:-31.3236,lon:-64.2081,name:"CÃ³rdoba",country:"AR"},MDZ:{lat:-32.8317,lon:-68.7928,name:"Mendoza",country:"AR"},BRC:{lat:-41.1512,lon:-71.1575,name:"Bariloche",country:"AR"},IGR:{lat:-25.7373,lon:-54.4734,name:"IguazÃº",country:"AR"},USH:{lat:-54.8433,lon:-68.2956,name:"Ushuaia",country:"AR"},FTE:{lat:-50.2803,lon:-72.0531,name:"El Calafate",country:"AR"},SCL:{lat:-33.393,lon:-70.7858,name:"Santiago",country:"CL"},IQQ:{lat:-20.5352,lon:-70.1813,name:"Iquique",country:"CL"},ANF:{lat:-23.4445,lon:-70.445,name:"Antofagasta",country:"CL"},CCP:{lat:-36.7727,lon:-73.0631,name:"ConcepciÃ³n",country:"CL"},PUQ:{lat:-53.0026,lon:-70.8546,name:"Punta Arenas",country:"CL"},IPC:{lat:-27.1648,lon:-109.4219,name:"Easter Island",country:"CL"},BOG:{lat:4.7016,lon:-74.1469,name:"BogotÃ¡",country:"CO"},MDE:{lat:6.1645,lon:-75.4231,name:"MedellÃ­n",country:"CO"},CLO:{lat:3.5432,lon:-76.3816,name:"Cali",country:"CO"},CTG:{lat:10.4424,lon:-75.513,name:"Cartagena",country:"CO"},BAQ:{lat:10.8896,lon:-74.7808,name:"Barranquilla",country:"CO"},SMR:{lat:11.1196,lon:-74.2306,name:"Santa Marta",country:"CO"},ADZ:{lat:12.5836,lon:-81.7112,name:"San AndrÃ©s",country:"CO"},LIM:{lat:-12.0219,lon:-77.1143,name:"Lima",country:"PE"},CUZ:{lat:-13.5357,lon:-71.9388,name:"Cusco",country:"PE"},AQP:{lat:-16.3411,lon:-71.583,name:"Arequipa",country:"PE"},UIO:{lat:-.1292,lon:-78.3575,name:"Quito",country:"EC"},GYE:{lat:-2.1574,lon:-79.8837,name:"Guayaquil",country:"EC"},GPS:{lat:-.4537,lon:-90.2659,name:"GalÃ¡pagos",country:"EC"},CCS:{lat:10.6012,lon:-66.9913,name:"Caracas",country:"VE"},VVI:{lat:-17.6448,lon:-63.1354,name:"Santa Cruz (Bolivia)",country:"BO"},LPB:{lat:-16.5133,lon:-68.1923,name:"La Paz",country:"BO"},ASU:{lat:-25.24,lon:-57.52,name:"AsunciÃ³n",country:"PY"},MVD:{lat:-34.8384,lon:-56.0308,name:"Montevideo",country:"UY"},PBM:{lat:5.4528,lon:-55.1878,name:"Paramaribo",country:"SR"},GEO:{lat:6.4985,lon:-58.2541,name:"Georgetown",country:"GY"}},Er=(t,s)=>{const a=dt[t],n=dt[s];if(!a||!n)return console.warn(`Missing airport data for: ${t} or ${s}`),0;const l=3959,r=a.lat*Math.PI/180,i=n.lat*Math.PI/180,x=i-r,c=(n.lon-a.lon)*Math.PI/180,o=Math.sin(x/2)*Math.sin(x/2)+Math.cos(r)*Math.cos(i)*Math.sin(c/2)*Math.sin(c/2),u=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return Math.round(l*u)},Jc=(t,s)=>{const a=dt[t],n=dt[s];return!a||!n?"International":a.country&&n.country&&a.country===n.country?"Domestic":"International"},Zc=(t,s)=>{const a=Jc(t,s),n=Er(t,s);return a==="Domestic"?"Domestic":n<2e3?"Medium":n<3500?"Long 1":n<5e3?"Long 2":"Long 3"},Qc={Domestic:{Economy:2,"Premium Economy":4,Business:6,First:10},Medium:{Economy:5,"Premium Economy":10,Business:15,First:25},"Long 1":{Economy:8,"Premium Economy":16,Business:24,First:40},"Long 2":{Economy:10,"Premium Economy":20,Business:30,First:50},"Long 3":{Economy:12,"Premium Economy":24,Business:36,First:60}},ed=(t,s)=>Qc[t][s],yt=(t,s,a)=>{const n=Er(t,s),l=Zc(t,s),r=ed(l,a);return{distance:n,band:l,xp:r}},Vl=[{code:"KLM",name:"KLM",revenue:!0},{code:"AF",name:"Air France",revenue:!0},{code:"HV",name:"Transavia",revenue:!1},{code:"DL",name:"Delta",revenue:!1},{code:"KE",name:"Korean Air",revenue:!1},{code:"AM",name:"AeromÃ©xico",revenue:!1},{code:"UX",name:"Air Europa",revenue:!1},{code:"SK",name:"SAS",revenue:!1},{code:"VS",name:"Virgin Atlantic",revenue:!1},{code:"VN",name:"Vietnam Airlines",revenue:!1},{code:"GA",name:"Garuda Indonesia",revenue:!1},{code:"CI",name:"China Airlines",revenue:!1},{code:"MU",name:"China Eastern",revenue:!1},{code:"KQ",name:"Kenya Airways",revenue:!1},{code:"ME",name:"MEA",revenue:!1},{code:"SV",name:"Saudia",revenue:!1},{code:"RO",name:"TAROM",revenue:!1},{code:"AR",name:"AerolÃ­neas Argentinas",revenue:!1},{code:"MF",name:"XiamenAir",revenue:!1}],td=["Economy","Premium Economy","Business","First"],sd=({onApply:t,currentStatus:s,existingFlights:a=[]})=>{const{setViewMode:n}=it(),{symbol:l}=Ke(),r=new Date().toISOString().slice(0,10),[i,x]=d.useState(1),[c,o]=d.useState(""),[u,m]=d.useState(!0),[p,h]=d.useState(r),[b,g]=d.useState("KLM"),[S,P]=d.useState("Economy"),[C,w]=d.useState(0),[f,D]=d.useState(0),[_,N]=d.useState(!1),F=Vl.find(M=>M.code===b),j=F?.revenue??!1,v=d.useMemo(()=>c.toUpperCase().replace(/[^A-Z\s\-]/g,"").split(/[\s\-]+/).filter(K=>K.length===3),[c]),A=d.useMemo(()=>{if(v.length<2)return[];if(!v.every(z=>dt[z]))return[];const M=[];for(let z=0;z<v.length-1;z++){const K=v[z],Y=v[z+1];if(K!==Y){const{xp:O,distance:V,band:J}=yt(K,Y,S);M.push({from:K,to:Y,xp:O,distance:V,band:J})}}if(u&&M.length>0){const z=[...M].reverse().map(K=>({from:K.to,to:K.from,xp:K.xp,distance:K.distance,band:K.band}));return[...M,...z]}return M},[v,S,u]),R=A.reduce((M,z)=>M+z.xp,0)+f,X=d.useMemo(()=>{if(!j||C<=0)return 0;const M=Ya(s);return Math.round(C*M)},[j,C,s]),L=v.length>=2&&v.every(M=>dt[M])&&p,G=b&&S,k=L&&G&&A.length>0,I=d.useMemo(()=>L?A.some(M=>a.some(z=>z.date===p&&z.route===`${M.from}-${M.to}`)):!1,[A,p,a,L]),y=()=>{if(!k)return;const z=["KL","KLM","AF"].includes(b.toUpperCase())&&(s==="Platinum"||s==="Ultimate"),K=A.map((Y,O)=>({date:p,route:`${Y.from}-${Y.to}`,airline:b,cabin:S,ticketPrice:A.length>1?C/A.length:C,earnedMiles:A.length>1?Math.round(X/A.length):X,earnedXP:Y.xp,safXp:O===0?f:0,flightNumber:"",uxp:z?Y.xp+(O===0?f:0):0}));t(K),N(!0),setTimeout(()=>{N(!1),o(""),w(0),D(0),x(1)},2e3)},U=d.useMemo(()=>{if(!c)return null;const M=v;if(M.length<2)return"Enter at least 2 airports (e.g. AMS JFK)";const z=M.find(K=>!dt[K]);return z?`Unknown airport: ${z}`:null},[c,v]);return _?e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-emerald-50 rounded-3xl p-12 text-center border border-emerald-100",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ct,{className:"text-emerald-600",size:32})}),e.jsx("h2",{className:"text-2xl font-bold text-emerald-900 mb-2",children:"Flight Added!"}),e.jsxs("p",{className:"text-emerald-700",children:["+",R," XP â¢ ",A.length," segment",A.length>1?"s":""]})]})}):e.jsxs("div",{className:"max-w-lg mx-auto animate-in fade-in duration-300",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Add Flight"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Quick add your Flying Blue flight"})]}),e.jsx("div",{className:"flex items-center gap-2 mb-8",children:[1,2,3].map(M=>e.jsxs(Ue.Fragment,{children:[e.jsx("button",{onClick:()=>M<i&&x(M),className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${M===i?"bg-blue-600 text-white":M<i?"bg-emerald-100 text-emerald-600 cursor-pointer hover:bg-emerald-200":"bg-slate-100 text-slate-400"}`,children:M<i?e.jsx(ct,{size:16}):M}),M<3&&e.jsx("div",{className:`flex-1 h-1 rounded ${M<i?"bg-emerald-200":"bg-slate-100"}`})]},M))}),i===1&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 shadow-sm space-y-5",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(_s,{size:18,className:"text-blue-500"}),"Where are you flying?"]}),e.jsxs("div",{children:[e.jsx("input",{type:"text",value:c,onChange:M=>o(M.target.value.toUpperCase()),placeholder:"AMS JFK or AMS CDG JFK",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 text-lg font-mono font-bold 
                         focus:border-blue-500 focus:outline-none transition-colors
                         placeholder:text-slate-300 placeholder:font-normal`,autoFocus:!0}),U?e.jsxs("p",{className:"mt-2 text-sm text-red-500 flex items-center gap-1",children:[e.jsx(Nt,{size:14}),U]}):v.length>=2&&e.jsxs("p",{className:"mt-2 text-sm text-emerald-600 flex items-center gap-1",children:[e.jsx(ct,{size:14}),v.join(" â ")]})]}),e.jsxs("button",{onClick:()=>m(!u),className:`w-full flex items-center justify-between px-4 py-3 rounded-xl border-2 transition-all ${u?"border-blue-200 bg-blue-50":"border-slate-200 bg-slate-50"}`,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Qa,{size:18,className:u?"text-blue-500":"text-slate-400"}),e.jsx("span",{className:`font-medium ${u?"text-blue-700":"text-slate-600"}`,children:"Return flight"})]}),e.jsx("div",{className:`w-12 h-7 rounded-full p-1 transition-colors ${u?"bg-blue-500":"bg-slate-300"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow transition-transform ${u?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:[e.jsx(et,{size:14,className:"inline mr-1.5"}),"Flight date"]}),e.jsx("input",{type:"date",value:p,onChange:M=>h(M.target.value),className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 
                         focus:border-blue-500 focus:outline-none transition-colors`})]})]}),e.jsxs("button",{onClick:()=>x(2),disabled:!L,className:`w-full py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${L?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-100 text-slate-400 cursor-not-allowed"}`,children:["Continue",e.jsx(we,{size:20})]})]}),i===2&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 shadow-sm space-y-5",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-blue-500 rotate-45"}),"Flight details"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Airline"}),e.jsx("select",{value:b,onChange:M=>g(M.target.value),className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 bg-white
                         focus:border-blue-500 focus:outline-none transition-colors font-medium`,children:Vl.map(M=>e.jsxs("option",{value:M.code,children:[M.name," (",M.code,")"]},M.code))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Cabin class"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:td.map(M=>e.jsx("button",{onClick:()=>P(M),className:`px-4 py-2.5 rounded-xl border-2 font-medium transition-all ${S===M?"border-blue-500 bg-blue-50 text-blue-700":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:M},M))})]}),j&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100",children:[e.jsxs("p",{className:"text-xs text-blue-600 font-medium flex items-center gap-1",children:[e.jsx(Be,{size:12}),"KLM/Air France earns miles based on ticket price"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:[e.jsx(ma,{size:14,className:"inline mr-1.5"}),"Ticket price"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:C||"",onChange:M=>w(Number(M.target.value)),placeholder:"0",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 font-mono
                               focus:border-blue-500 focus:outline-none transition-colors`}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400",children:l})]}),X>0&&e.jsxs("p",{className:"mt-1.5 text-sm text-blue-600",children:["â ",X.toLocaleString()," miles (",s," bonus)"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:[e.jsx(ea,{size:14,className:"inline mr-1.5 text-emerald-500"}),"SAF XP (optional)"]}),e.jsx("input",{type:"number",value:f||"",onChange:M=>D(Number(M.target.value)),placeholder:"0",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 font-mono
                             focus:border-blue-500 focus:outline-none transition-colors`})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>x(1),className:`px-6 py-4 rounded-xl font-bold border-2 border-slate-200 text-slate-600 
                       hover:bg-slate-50 transition-all flex items-center gap-2`,children:[e.jsx(ts,{size:20}),"Back"]}),e.jsxs("button",{onClick:()=>x(3),disabled:!G,className:`flex-1 py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${G?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-100 text-slate-400 cursor-not-allowed"}`,children:["Review",e.jsx(we,{size:20})]})]})]}),i===3&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-2xl p-6 text-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-blue-200 text-sm font-medium",children:"Total XP"}),e.jsxs("span",{className:"text-3xl font-black",children:["+",R]})]}),e.jsxs("div",{className:"space-y-2",children:[A.map((M,z)=>e.jsxs("div",{className:"flex items-center justify-between text-sm bg-white/10 rounded-lg px-3 py-2",children:[e.jsxs("span",{className:"font-mono",children:[M.from," â ",M.to]}),e.jsxs("span",{className:"font-bold",children:["+",M.xp," XP"]})]},z)),f>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm bg-emerald-500/20 rounded-lg px-3 py-2",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ea,{size:14}),"SAF Bonus"]}),e.jsxs("span",{className:"font-bold",children:["+",f," XP"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl p-5 border border-slate-200 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Date"}),e.jsx("p",{className:"font-semibold text-slate-900",children:new Date(p).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Airline"}),e.jsx("p",{className:"font-semibold text-slate-900",children:F?.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Cabin"}),e.jsx("p",{className:"font-semibold text-slate-900",children:S})]}),j&&C>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Miles earned"}),e.jsxs("p",{className:"font-semibold text-slate-900",children:["â",X.toLocaleString()]})]})]})}),I&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(Nt,{className:"text-amber-500 flex-shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-amber-800",children:"Possible duplicate"}),e.jsx("p",{className:"text-sm text-amber-700",children:"A similar flight already exists on this date."})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>x(2),className:`px-6 py-4 rounded-xl font-bold border-2 border-slate-200 text-slate-600 
                       hover:bg-slate-50 transition-all flex items-center gap-2`,children:[e.jsx(ts,{size:20}),"Back"]}),e.jsxs("button",{onClick:y,disabled:!k,className:`flex-1 py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${k?"bg-gradient-to-r from-emerald-500 to-emerald-600 text-white hover:from-emerald-600 hover:to-emerald-700 shadow-lg shadow-emerald-500/25":"bg-slate-100 text-slate-400 cursor-not-allowed"}`,children:[e.jsx(ct,{size:20}),"Add ",A.length," Flight",A.length>1?"s":""]})]})]}),e.jsx("div",{className:"text-center mt-8",children:e.jsx("button",{onClick:()=>n("full"),className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Need more options? Switch to Full View â"})})]})},Wa=[{code:"KLM",name:"KLM Royal Dutch Airlines",region:"Europe",revenueBasedMiles:!0,xpEligible:!0},{code:"AF",name:"Air France",region:"Europe",revenueBasedMiles:!0,xpEligible:!0},{code:"HV",name:"Transavia",region:"Europe",revenueBasedMiles:!1,xpEligible:!0,note:"XP only on Plus/Max fares"},{code:"SB",name:"Aircalin",region:"Pacific",revenueBasedMiles:!1,xpEligible:!0,note:"Limited routes"},{code:"XK",name:"Air Corsica",region:"Europe",revenueBasedMiles:!1,xpEligible:!0,note:"Paris-Corsica routes"},{code:"AR",name:"AerolÃ­neas Argentinas",region:"South America",revenueBasedMiles:!1,xpEligible:!0},{code:"AM",name:"AeromÃ©xico",region:"North America",revenueBasedMiles:!1,xpEligible:!0},{code:"UX",name:"Air Europa",region:"Europe",revenueBasedMiles:!1,xpEligible:!0},{code:"CI",name:"China Airlines",region:"Asia",revenueBasedMiles:!1,xpEligible:!0},{code:"MU",name:"China Eastern",region:"Asia",revenueBasedMiles:!1,xpEligible:!0},{code:"DL",name:"Delta Air Lines",region:"North America",revenueBasedMiles:!1,xpEligible:!0},{code:"GA",name:"Garuda Indonesia",region:"Asia",revenueBasedMiles:!1,xpEligible:!0},{code:"KQ",name:"Kenya Airways",region:"Africa",revenueBasedMiles:!1,xpEligible:!0},{code:"KE",name:"Korean Air",region:"Asia",revenueBasedMiles:!1,xpEligible:!0},{code:"ME",name:"Middle East Airlines",region:"Middle East",revenueBasedMiles:!1,xpEligible:!0},{code:"SK",name:"SAS Scandinavian",region:"Europe",revenueBasedMiles:!1,xpEligible:!0},{code:"SV",name:"Saudia",region:"Middle East",revenueBasedMiles:!1,xpEligible:!0},{code:"RO",name:"TAROM",region:"Europe",revenueBasedMiles:!1,xpEligible:!0},{code:"VN",name:"Vietnam Airlines",region:"Asia",revenueBasedMiles:!1,xpEligible:!0},{code:"VS",name:"Virgin Atlantic",region:"Europe",revenueBasedMiles:!1,xpEligible:!0},{code:"MF",name:"XiamenAir",region:"Asia",revenueBasedMiles:!1,xpEligible:!0}],Hl=t=>{const s=t.toUpperCase();return Wa.find(a=>a.code===s||a.code.startsWith(s)||s.startsWith(a.code.substring(0,2)))},Wl=["Economy","Premium Economy","Business","First"],Hs=({label:t,icon:s,children:a,rightElement:n,tooltip:l})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[s&&e.jsx(s,{size:12}),t]}),l&&e.jsx(me,{text:l})]}),e.jsxs("div",{className:"relative group",children:[a,n&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none text-xs font-medium",children:n})]})]}),qt="w-full rounded-xl border border-slate-200 bg-slate-50/30 px-3 py-2.5 text-sm font-medium text-slate-800 placeholder:text-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/10 focus:border-blue-500 focus:bg-white hover:border-slate-300 [color-scheme:light] [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",ad=({onApply:t,currentStatus:s,existingFlights:a=[]})=>{const{isSimpleMode:n}=it(),{trackFlight:l}=rt(),r=new Date().toISOString().slice(0,10),i=d.useRef(null),x=d.useRef(null),{format:c,symbol:o}=Ke(),[u,m]=d.useState({date:r,route:"",airline:"",cabin:"Economy",ticketPrice:0,earnedMiles:0,safXp:0,flightNumber:""}),[p,h]=d.useState(!1),[b,g]=d.useState([]),[S,P]=d.useState(!1),[C,w]=d.useState(null),[f,D]=d.useState(!1),[_,N]=d.useState(0),[F,j]=d.useState(!1),[v,A]=d.useState(""),[R,X]=d.useState([]),[L,G]=d.useState(null);if(d.useEffect(()=>{const B=localStorage.getItem("recentAirlines");if(B)try{X(JSON.parse(B))}catch{}},[]),d.useEffect(()=>{const B=$=>{x.current&&!x.current.contains($.target)&&j(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]),d.useEffect(()=>{const B=setTimeout(()=>{i.current?.focus()},100);return()=>clearTimeout(B)},[]),d.useEffect(()=>{if(b.length===0||!u.date){G(null);return}const B=b.filter($=>{const Q=`${$.from}-${$.to}`;return a.some(oe=>oe.date===u.date&&oe.route===Q)});if(B.length>0){const $=B.map(Q=>`${Q.from}-${Q.to}`).join(", ");G(`${$} on ${u.date} already exists`)}else G(null)},[b,u.date,a]),d.useEffect(()=>{let B=u.route.toUpperCase().replace(/[^A-Z]/g," ").trim().split(/\s+/).filter(ee=>ee.length===3);if(p&&B.length>=2){const ee=u.route.toUpperCase().replace(/[^A-Z]/g," ").trim().split(/\s+/).filter(T=>T.length===3);if(ee.length>=2){const T=[...ee].reverse();B=[...ee,...T.slice(1)]}}let $=0,Q=null;if(u.ticketPrice>0&&u.airline&&$o(u.airline)){const ee=Ya(s);$=Math.round(u.ticketPrice*ee),Q=`${s} Bonus (${ee}x)`}if($>0?(m(ee=>({...ee,earnedMiles:$})),w(Q)):w(null),B.length<2){g([]);return}if(!B.every(ee=>dt[ee]))return;const oe=[];let se=0;for(let ee=0;ee<B.length-1;ee++){const T=B[ee],ce=B[ee+1];if(T!==ce){const{xp:fe,distance:Se,band:Te}=yt(T,ce,u.cabin);oe.push({from:T,to:ce,distance:Se,xp:fe,band:Te}),se+=Se}}const Z=oe.map(ee=>{const T=se>0?ee.distance/se:0,ce=$>0?$:u.earnedMiles;return{...ee,allocatedPrice:u.ticketPrice*T,allocatedMiles:ce>0?Math.round(ce*T):Math.round(ee.distance),cabin:u.cabin}});g(Z)},[u.route,u.cabin,u.ticketPrice,u.airline,s,p]),n)return e.jsx(sd,{onApply:t,currentStatus:s,existingFlights:a});const k=b.reduce((B,$)=>B+$.xp,0),I=b.length>1,y=b.length>0&&u.date&&u.airline,U=k>0&&u.ticketPrice>0?u.ticketPrice/k:0,z=(B=>B===0?null:B<10?{label:"Legendary",color:"text-purple-600 bg-purple-50 border-purple-100"}:B<20?{label:"Good Deal",color:"text-emerald-600 bg-emerald-50 border-emerald-100"}:{label:"Standard",color:"text-slate-500 bg-slate-50 border-slate-100"})(U),K=(B,$)=>{g(Q=>Q.map((oe,se)=>{if(se!==B)return oe;const{xp:Z,band:ee}=yt(oe.from,oe.to,$);return{...oe,cabin:$,xp:Z,band:ee}}))},Y=B=>{m(Q=>({...Q,airline:B})),A(""),j(!1);const $=[B,...R.filter(Q=>Q!==B)].slice(0,5);X($),localStorage.setItem("recentAirlines",JSON.stringify($))},O=()=>{const B=v.toUpperCase();return B?Wa.filter($=>$.code.includes(B)||$.name.toUpperCase().includes(B)):Wa},V=B=>{if(B.preventDefault(),!y||S)return;P(!0);const Q=["KL","KLM","AF"].includes(u.airline.toUpperCase())&&(s==="Platinum"||s==="Ultimate"),oe=b.map((Z,ee)=>({date:u.date,route:`${Z.from}-${Z.to}`,airline:u.airline,cabin:Z.cabin,ticketPrice:Z.allocatedPrice,earnedMiles:u.earnedMiles>0?Z.allocatedMiles:0,earnedXP:Z.xp,safXp:ee===0?u.safXp:0,flightNumber:b.length===1?u.flightNumber:void 0,uxp:Q?Z.xp+(ee===0?u.safXp:0):0})),se=["AF","KLM","KL"].includes(u.airline.toUpperCase());oe.forEach(Z=>{l(Z.cabin,se)}),t(oe),N(oe.length),D(!0),setTimeout(()=>D(!1),2500),m(Z=>({...Z,route:"",ticketPrice:0,earnedMiles:0,safXp:0,flightNumber:""})),g([]),P(!1),G(null),setTimeout(()=>i.current?.focus(),100)},J=(B,$)=>{m(Q=>({...Q,[B]:$}))},q=Hl(u.airline);return e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-xl shadow-slate-200/40 border border-slate-100 overflow-hidden mb-8 transition-all hover:shadow-2xl hover:shadow-slate-200/50 relative",children:[f&&e.jsx("div",{className:"absolute top-4 right-4 z-50 animate-in fade-in slide-in-from-top-2 duration-300",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-emerald-500 text-white shadow-lg shadow-emerald-500/30",children:[e.jsx(je,{size:18}),e.jsx("span",{className:"text-sm font-bold",children:_===1?"Flight added!":`${_} flights added!`})]})}),e.jsxs("div",{className:"px-8 pt-8 pb-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-2xl bg-blue-50 text-blue-600 flex items-center justify-center border border-blue-100 shadow-sm",children:e.jsx(le,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:"New Flight Entry"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium mt-0.5",children:"Add a single flight or a multi-leg journey"})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[10px] font-bold uppercase tracking-wider border ${s==="Platinum"?"bg-blue-50 border-blue-200 text-blue-700":s==="Gold"?"bg-amber-50 border-amber-200 text-amber-700":s==="Silver"?"bg-slate-100 border-slate-300 text-slate-600":"bg-sky-50 border-sky-200 text-sky-700"}`,children:[e.jsx(De,{size:12}),s," (",Ya(s),"x miles)"]}),I?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-indigo-50 border border-indigo-100 text-indigo-700 text-[10px] font-bold uppercase tracking-wider animate-in fade-in",children:[e.jsx(pl,{size:14}),"Multi-Segment Detected"]}):e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-50 border border-emerald-100 text-emerald-700 text-[10px] font-bold uppercase tracking-wider",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Engine Ready"]})]})]}),e.jsx("div",{className:"p-8",children:e.jsxs("form",{onSubmit:V,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(Hs,{label:"Date",icon:et,tooltip:"Date of the first flight segment.",children:e.jsx("input",{type:"date",value:u.date,onChange:B=>J("date",B.target.value),className:`${qt} cursor-pointer`})})}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[e.jsx(_s,{size:12})," Route Chain"]}),e.jsx(me,{text:"Enter airport codes separated by spaces (e.g. AMS JFK). For multi-city, add more codes (AMS CDG BKK)."})]}),e.jsxs("button",{type:"button",onClick:()=>h(!p),className:`flex items-center gap-1 text-[10px] font-bold px-2 py-0.5 rounded transition-all ${p?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-400 hover:text-slate-600"}`,children:[e.jsx(Qa,{size:10})," Round Trip"]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{ref:i,type:"text",placeholder:"AMS JFK",value:u.route,onChange:B=>J("route",B.target.value.toUpperCase()),className:`${qt} uppercase tracking-wider font-bold text-slate-700 pl-9`}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:I?e.jsx(bl,{size:14}):e.jsx(ht,{size:14})})]})]}),e.jsxs("div",{className:"md:col-span-4",ref:x,children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[e.jsx(le,{size:12})," Airline"]}),e.jsx(me,{text:"Select operating airline. KLM/AF earn revenue-based miles. All SkyTeam partners earn XP."})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>j(!F),className:`${qt} text-left flex items-center justify-between cursor-pointer ${u.airline?"font-bold text-slate-700":""}`,children:[e.jsx("span",{className:"flex items-center gap-2",children:u.airline?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"uppercase",children:u.airline}),q&&e.jsx("span",{className:"text-slate-400 font-normal text-xs truncate",children:q.name})]}):e.jsx("span",{className:"text-slate-400",children:"Select airline..."})}),e.jsx(nt,{size:16,className:`text-slate-400 transition-transform ${F?"rotate-180":""}`})]}),q?.revenueBasedMiles&&e.jsx("div",{className:"absolute -top-1 -right-1 px-1.5 py-0.5 bg-blue-500 text-white text-[8px] font-bold rounded-full uppercase",children:"Revenue"}),F&&e.jsxs("div",{className:"absolute z-50 top-full left-0 right-0 mt-1 bg-white rounded-xl border border-slate-200 shadow-xl shadow-slate-200/50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("div",{className:"p-2 border-b border-slate-100",children:e.jsx("input",{type:"text",placeholder:"Search airlines...",value:v,onChange:B=>A(B.target.value),className:"w-full px-3 py-2 text-sm rounded-lg border border-slate-200 focus:outline-none focus:border-blue-400",autoFocus:!0})}),R.length>0&&!v&&e.jsxs("div",{className:"p-2 border-b border-slate-100",children:[e.jsxs("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-wider px-2 mb-1 flex items-center gap-1",children:[e.jsx(Ee,{size:10})," Recent"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:R.map(B=>(Hl(B),e.jsx("button",{type:"button",onClick:()=>Y(B),className:"px-2 py-1 text-xs font-bold bg-slate-100 hover:bg-blue-100 hover:text-blue-700 rounded-lg transition-colors",children:B},B)))})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[O().map((B,$)=>{const Q=B.code==="KLM"||B.code==="AF",oe=$===2&&!v,se=$===5&&!v;return e.jsxs(Ue.Fragment,{children:[oe&&e.jsx("div",{className:"px-4 py-1.5 bg-slate-50 text-[9px] font-bold text-slate-400 uppercase tracking-wider",children:"Flying Blue Family"}),se&&e.jsx("div",{className:"px-4 py-1.5 bg-slate-50 text-[9px] font-bold text-slate-400 uppercase tracking-wider",children:"SkyTeam Partners"}),e.jsxs("button",{type:"button",onClick:()=>Y(B.code),className:`w-full px-4 py-2.5 flex items-center justify-between hover:bg-blue-50 transition-colors text-left ${Q?"bg-blue-50/50":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-bold text-slate-700 w-10",children:B.code}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600",children:B.name}),e.jsx("div",{className:"text-[10px] text-slate-400",children:B.region})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[B.revenueBasedMiles&&e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded uppercase",children:"Revenue Miles"}),B.note&&e.jsx("span",{className:"text-[9px] text-amber-600 max-w-[80px] text-right",children:B.note}),Q&&e.jsx(Rs,{size:12,className:"text-amber-400 fill-amber-400"})]})]})]},B.code)}),O().length===0&&e.jsx("div",{className:"px-4 py-6 text-center text-slate-400 text-sm",children:"No airlines found"})]}),e.jsx("div",{className:"p-2 border-t border-slate-100 bg-slate-50",children:e.jsx("p",{className:"text-[10px] text-slate-400 text-center",children:"Can't find your airline? Type the code manually above."})})]})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Hs,{label:"Flight #",icon:le,tooltip:"Flight number (e.g. KL1775). Optional but useful for tracking.",children:e.jsx("input",{type:"text",placeholder:"KL1775",value:u.flightNumber,onChange:B=>J("flightNumber",B.target.value.toUpperCase()),className:`${qt} uppercase tracking-wider font-mono text-slate-600`,maxLength:10})})})]}),L&&e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-50 border border-amber-200 animate-in fade-in slide-in-from-top-1",children:[e.jsx(_e,{size:18,className:"text-amber-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Possible duplicate"}),e.jsx("p",{className:"text-xs text-amber-600",children:L})]})]}),e.jsx("div",{className:"h-px bg-slate-100"}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide mb-3 flex items-center gap-1.5",children:["Cabin Class",e.jsx(me,{text:"Affects XP calculation (Economy=Low, Business=High)."})]}),e.jsx("div",{className:"flex p-1 rounded-xl bg-slate-50 border border-slate-100",children:Wl.map(B=>{const $=u.cabin===B;return e.jsx("button",{type:"button",onClick:()=>J("cabin",B),className:`
                      flex-1 relative text-xs font-semibold py-2.5 px-2 rounded-lg transition-all duration-200
                      ${$?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}
                    `,children:B},B)})})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[e.jsx(ma,{size:12})," Total Price"]}),e.jsx(me,{text:"Total ticket price in Euro. Used to calculate revenue-based miles."})]}),z&&e.jsxs("span",{className:`text-[9px] font-bold px-1.5 py-0.5 rounded border ${z.color} flex items-center gap-1 animate-in fade-in`,children:[e.jsx(Ie,{size:8})," ",c(U),"/XP"]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"number",placeholder:"0",value:u.ticketPrice||"",onChange:B=>J("ticketPrice",Number(B.target.value)),className:`${qt} font-mono`,step:"0.01"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none text-xs font-medium",children:o})]})]}),e.jsx(Hs,{label:"Total Miles",icon:ht,rightElement:"Miles",tooltip:"Estimated miles earned. Auto-calculated for revenue tickets (AF/KLM) based on your status.",children:e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"number",placeholder:"0",value:u.earnedMiles||"",onChange:B=>J("earnedMiles",Number(B.target.value)),className:`${qt} font-mono text-blue-600 font-bold bg-blue-50/30 border-blue-100 focus:border-blue-400`}),C&&e.jsxs("div",{className:"absolute -bottom-5 right-0 text-[9px] text-blue-500 font-bold flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[e.jsx(Pt,{size:8,fill:"currentColor"})," ",C]})]})}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[e.jsx(De,{size:12})," Calculated XP"]}),e.jsx(me,{text:"Total XP for this trip. Auto-calculated based on distance bands (Domestic/Medium/Long) and cabin."})]}),e.jsxs("div",{className:`
                w-full rounded-xl border-2 px-3 py-2.5 font-mono font-black text-lg flex items-center justify-between
                transition-all duration-300
                ${k>0?"bg-emerald-50 border-emerald-200 text-emerald-600":"bg-slate-50/30 border-slate-200 text-slate-400"}
              `,children:[e.jsx("span",{children:k>0?`+${k}`:"0"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"XP"})]})]}),e.jsx(Hs,{label:"SAF XP",icon:ea,rightElement:"XP",tooltip:"Sustainable Aviation Fuel bonus XP. Enter manually if purchased.",children:e.jsx("input",{type:"number",placeholder:"0",value:u.safXp||"",onChange:B=>J("safXp",Number(B.target.value)),className:`${qt} font-mono`})})]}),e.jsxs("div",{className:`rounded-xl border transition-all duration-300 ${b.length>0?"bg-slate-50 border-slate-100 p-4":"bg-slate-50/50 border-dashed border-slate-200 p-4"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:I?"Multi-Segment Split":"Flight Preview"}),b.length>0?e.jsx("span",{className:"text-[10px] bg-white px-2 py-1 rounded border border-slate-200 text-slate-400",children:I?"Cost allocated by distance":"Direct Flight"}):e.jsx("span",{className:"text-[10px] text-slate-400",children:"Enter route to preview"})]}),b.length>0?e.jsxs("div",{className:"space-y-2",children:[b.map((B,$)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-white p-3 rounded-lg border border-slate-200/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"font-bold text-slate-700 w-24",children:[B.from," ",e.jsx("span",{className:"text-slate-300",children:"â"})," ",B.to]}),e.jsxs("div",{className:"text-slate-400 font-mono",children:[Math.round(B.distance),"mi"]}),e.jsx("div",{className:"px-1.5 py-0.5 bg-slate-100 rounded text-[10px] text-slate-500",children:B.band})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[I&&e.jsx("select",{value:B.cabin,onChange:Q=>K($,Q.target.value),className:"text-[10px] font-medium text-slate-600 bg-slate-50 border border-slate-200 rounded-md px-2 py-1 cursor-pointer hover:border-slate-300 focus:outline-none focus:ring-1 focus:ring-blue-500",children:Wl.map(Q=>e.jsx("option",{value:Q,children:Q},Q))}),e.jsx("div",{className:"font-mono text-slate-500",children:c(B.allocatedPrice)}),e.jsxs("div",{className:"font-bold text-emerald-600 w-12 text-right",children:["+",B.xp," XP"]})]})]},$)),I&&e.jsxs("p",{className:"text-[10px] text-slate-400 mt-2 flex items-center gap-1",children:[e.jsx(pl,{size:12}),"Tip: Adjust cabin per segment if aircraft types differ (e.g. no Premium Economy on short-haul feeders)"]})]}):e.jsx("div",{className:"flex items-center justify-center py-6 text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{size:24,className:"mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-xs",children:"Enter a valid route (e.g. AMS JFK)"})]})})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:!y||S,className:`
                w-full py-4 rounded-xl font-bold text-sm shadow-lg flex items-center justify-center gap-2 transition-all duration-200
                ${y?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-blue-500/20 hover:shadow-xl hover:shadow-blue-500/30 hover:-translate-y-0.5":"bg-slate-100 text-slate-400 cursor-not-allowed shadow-none"}
              `,children:S?e.jsx("span",{children:"Processing..."}):e.jsxs(e.Fragment,{children:[I?e.jsx(bl,{size:18}):e.jsx(ks,{size:18,strokeWidth:3}),e.jsx("span",{children:I?`Add ${b.length} Flights to Ledger`:"Confirm & Add Flight"})]})})})]})})]})},Jl=[{id:"subscription",label:"Subscription",description:"Flying Blue subscription miles",icon:Bs,color:"indigo"},{id:"amex",label:"Credit Card",description:"Amex, bank rewards, transfers",icon:Bt,color:"slate"},{id:"other",label:"Bonus / Other",description:"Promotions, gifts, partner offers",icon:Cs,color:"amber"}],ld=({record:t,onSave:s,onClose:a,currencySymbol:n})=>{const[l,r]=d.useState({miles_subscription:t.miles_subscription,miles_amex:t.miles_amex,miles_other:t.miles_other,cost_subscription:t.cost_subscription,cost_amex:t.cost_amex,cost_other:t.cost_other}),i=c=>{const[o,u]=c.split("-");return new Date(parseInt(o),parseInt(u)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})},x=c=>{c.preventDefault(),s({...t,...l})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-100",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Edit Miles"}),e.jsx("p",{className:"text-xs text-slate-500",children:i(t.month)})]}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-slate-100 rounded-lg",children:e.jsx(Ce,{size:20,className:"text-slate-400"})})]}),e.jsxs("form",{onSubmit:x,className:"p-5 space-y-5",children:[e.jsxs("div",{className:"bg-indigo-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-700 font-medium text-sm",children:[e.jsx(Bs,{size:16}),"Subscription"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Miles"}),e.jsx("input",{type:"number",value:l.miles_subscription||"",onChange:c=>r(o=>({...o,miles_subscription:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-slate-500 mb-1",children:["Cost (",n,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.cost_subscription||"",onChange:c=>r(o=>({...o,cost_subscription:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 font-medium text-sm",children:[e.jsx(Bt,{size:16}),"Credit Card / Amex"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Miles"}),e.jsx("input",{type:"number",value:l.miles_amex||"",onChange:c=>r(o=>({...o,miles_amex:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-slate-500 mb-1",children:["Cost (",n,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.cost_amex||"",onChange:c=>r(o=>({...o,cost_amex:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-700 font-medium text-sm",children:[e.jsx(Cs,{size:16}),"Other / Bonus"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Miles"}),e.jsx("input",{type:"number",value:l.miles_other||"",onChange:c=>r(o=>({...o,miles_other:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-slate-500 mb-1",children:["Cost (",n,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.cost_other||"",onChange:c=>r(o=>({...o,cost_other:Number(c.target.value)})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm font-mono focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 py-2.5 border border-slate-200 rounded-xl font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700",children:"Save Changes"})]})]})]})})},nd=({milesData:t,onUpdate:s})=>{const{setViewMode:a}=it(),{symbol:n}=Ke(),l=new Date().toISOString().slice(0,10),[r,i]=d.useState(1),[x,c]=d.useState("amex"),[o,u]=d.useState(l),[m,p]=d.useState(0),[h,b]=d.useState(0),[g,S]=d.useState(!1),[P,C]=d.useState(null),w=d.useMemo(()=>[...t].sort((R,X)=>X.month.localeCompare(R.month)).slice(0,5).map(R=>({record:R,month:R.month,subscription:R.miles_subscription,amex:R.miles_amex,other:R.miles_other,total:R.miles_subscription+R.miles_amex+R.miles_other})).filter(R=>R.total>0),[t]),f=R=>{s(t.map(X=>X.id===R.id?R:X)),C(null)},D=x,_=m>0&&o,N=D&&_,F=m>0&&h>0?h/m:0,j=()=>{if(!N)return;const R=o.slice(0,7),X=t.findIndex(G=>G.month===R);let L=[...t];if(X>=0){const G={...L[X]};switch(x){case"subscription":G.miles_subscription+=Number(m),G.cost_subscription+=Number(h);break;case"amex":G.miles_amex+=Number(m),G.cost_amex+=Number(h);break;case"other":G.miles_other+=Number(m),G.cost_other+=Number(h);break}L[X]=G}else{const G={id:ba(),month:R,miles_subscription:0,miles_amex:0,miles_flight:0,miles_other:0,miles_debit:0,cost_subscription:0,cost_amex:0,cost_flight:0,cost_other:0};switch(x){case"subscription":G.miles_subscription=Number(m),G.cost_subscription=Number(h);break;case"amex":G.miles_amex=Number(m),G.cost_amex=Number(h);break;case"other":G.miles_other=Number(m),G.cost_other=Number(h);break}L.push(G)}s(L),S(!0),setTimeout(()=>{S(!1),p(0),b(0),i(1)},2e3)},v=Jl.find(R=>R.id===x),A=R=>{const[X,L]=R.split("-");return new Date(parseInt(X),parseInt(L)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})};return g?e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-emerald-50 rounded-3xl p-12 text-center border border-emerald-100",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ct,{className:"text-emerald-600",size:32})}),e.jsx("h2",{className:"text-2xl font-bold text-emerald-900 mb-2",children:"Miles Added!"}),e.jsxs("p",{className:"text-emerald-700",children:["+",ne(m)," miles from ",v.label]})]})}):e.jsxs("div",{className:"max-w-lg mx-auto animate-in fade-in duration-300",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Add Miles"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Record miles from subscriptions, cards & bonuses"})]}),e.jsx("div",{className:"flex items-center gap-2 mb-8",children:[1,2,3].map(R=>e.jsxs(Ue.Fragment,{children:[e.jsx("button",{onClick:()=>R<r&&i(R),className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${R===r?"bg-indigo-600 text-white":R<r?"bg-emerald-100 text-emerald-600 cursor-pointer hover:bg-emerald-200":"bg-slate-100 text-slate-400"}`,children:R<r?e.jsx(ct,{size:16}):R}),R<3&&e.jsx("div",{className:`flex-1 h-1 rounded ${R<r?"bg-emerald-200":"bg-slate-100"}`})]},R))}),r===1&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2 mb-5",children:[e.jsx(Oe,{size:18,className:"text-indigo-500"}),"Where did you earn these miles?"]}),e.jsx("div",{className:"space-y-3",children:Jl.map(R=>{const X=x===R.id,L=R.icon;return e.jsxs("button",{onClick:()=>c(R.id),className:`w-full flex items-center gap-4 p-4 rounded-xl border-2 transition-all text-left ${X?"border-indigo-500 bg-indigo-50":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:[e.jsx("div",{className:`p-3 rounded-xl ${X?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-400"}`,children:e.jsx(L,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-semibold ${X?"text-indigo-900":"text-slate-700"}`,children:R.label}),e.jsx("p",{className:"text-xs text-slate-500",children:R.description})]}),X&&e.jsx("div",{className:"w-5 h-5 bg-indigo-500 rounded-full flex items-center justify-center",children:e.jsx(ct,{size:12,className:"text-white"})})]},R.id)})})]}),e.jsxs("button",{onClick:()=>i(2),disabled:!D,className:`w-full py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${D?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-slate-100 text-slate-400 cursor-not-allowed"}`,children:["Continue",e.jsx(we,{size:20})]})]}),r===2&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 shadow-sm space-y-5",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Ge,{size:18,className:"text-indigo-500"}),"Transaction details"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:[e.jsx(et,{size:14,className:"inline mr-1.5"}),"Transaction date"]}),e.jsx("input",{type:"date",value:o,onChange:R=>u(R.target.value),className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 
                         focus:border-indigo-500 focus:outline-none transition-colors`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:[e.jsx(Be,{size:14,className:"inline mr-1.5"}),"Miles earned"]}),e.jsx("input",{type:"number",value:m||"",onChange:R=>p(Number(R.target.value)),placeholder:"0",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 font-mono text-lg font-bold
                         focus:border-indigo-500 focus:outline-none transition-colors`,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:[e.jsx(ma,{size:14,className:"inline mr-1.5"}),"Cost (optional)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:h||"",onChange:R=>b(Number(R.target.value)),placeholder:"0.00",step:"0.01",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 font-mono
                           focus:border-indigo-500 focus:outline-none transition-colors`}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400",children:n})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1.5",children:"Subscription fee, transfer cost, etc."})]}),F>0&&e.jsxs("div",{className:"bg-slate-50 rounded-xl p-3 border border-slate-100 text-center",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Acquisition cost"}),e.jsxs("p",{className:"text-lg font-bold text-slate-900",children:[n,F.toFixed(4)," ",e.jsx("span",{className:"text-sm font-normal text-slate-500",children:"/ mile"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>i(1),className:`px-6 py-4 rounded-xl font-bold border-2 border-slate-200 text-slate-600 
                       hover:bg-slate-50 transition-all flex items-center gap-2`,children:[e.jsx(ts,{size:20}),"Back"]}),e.jsxs("button",{onClick:()=>i(3),disabled:!_,className:`flex-1 py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${_?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-slate-100 text-slate-400 cursor-not-allowed"}`,children:["Review",e.jsx(we,{size:20})]})]})]}),r===3&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-violet-700 rounded-2xl p-6 text-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-indigo-200 text-sm font-medium",children:"Miles to add"}),e.jsxs("span",{className:"text-3xl font-black",children:["+",ne(m)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm bg-white/10 rounded-lg px-3 py-2",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[Ue.createElement(v.icon,{size:14}),v.label]}),e.jsx("span",{className:"font-medium",children:A(o.slice(0,7))})]}),h>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm bg-white/10 rounded-lg px-3 py-2",children:[e.jsx("span",{children:"Cost"}),e.jsxs("span",{className:"font-bold",children:[n,h.toFixed(2)]})]}),F>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm bg-emerald-500/20 rounded-lg px-3 py-2",children:[e.jsx("span",{children:"Acquisition CPM"}),e.jsxs("span",{className:"font-bold",children:[n,F.toFixed(4),"/mi"]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>i(2),className:`px-6 py-4 rounded-xl font-bold border-2 border-slate-200 text-slate-600 
                       hover:bg-slate-50 transition-all flex items-center gap-2`,children:[e.jsx(ts,{size:20}),"Back"]}),e.jsxs("button",{onClick:j,className:`flex-1 py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all
                       bg-gradient-to-r from-emerald-500 to-emerald-600 text-white hover:from-emerald-600 hover:to-emerald-700 shadow-lg shadow-emerald-500/25`,children:[e.jsx(ct,{size:20}),"Add Miles"]})]})]}),w.length>0&&r===1&&e.jsxs("div",{className:"mt-8 bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Be,{size:18,className:"text-amber-500"}),"Recent Activity"]}),e.jsx("span",{className:"text-xs text-slate-400",children:"Tap to edit"})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:w.map(R=>e.jsxs("button",{onClick:()=>C(R.record),className:"w-full px-5 py-3 flex items-center justify-between hover:bg-slate-50 transition-colors group",children:[e.jsx("span",{className:"text-sm text-slate-600",children:A(R.month)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-bold text-emerald-600",children:["+",ne(R.total)]}),e.jsx(Kt,{size:14,className:"text-slate-300 group-hover:text-slate-500 transition-colors"})]})]},R.month))})]}),e.jsx("div",{className:"text-center mt-8",children:e.jsx("button",{onClick:()=>a("full"),className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Need detailed ledger or advanced options? Switch to Full View â"})}),P&&e.jsx(ld,{record:P,onSave:f,onClose:()=>C(null),currencySymbol:n})]})},rd=[{id:"subscription",label:"Subscription",icon:Bs},{id:"amex",label:"Amex / Bank",icon:Bt},{id:"other",label:"Other / Bonus",icon:pi}],Xa=({label:t,icon:s,children:a,rightElement:n,tooltip:l})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[s&&e.jsx(s,{size:12}),t]}),l&&e.jsx(me,{text:l})]}),e.jsxs("div",{className:"relative group",children:[a,n&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none text-xs font-bold",children:n})]})]}),id="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",Ea="w-full rounded-xl border border-slate-200 bg-slate-50/30 px-3 py-2.5 text-sm font-medium text-slate-800 placeholder:text-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 focus:bg-white hover:border-slate-300 [color-scheme:light] "+id,od=({milesData:t,onUpdate:s,currentMonth:a})=>{const{isSimpleMode:n}=it(),{trackMiles:l}=rt(),{symbol:r}=Ke(),i=new Date().toISOString().slice(0,10),[x,c]=d.useState({date:i,source:"amex",amount:0,cost:0}),[o,u]=d.useState(!1),[m,p]=d.useState(!1);if(n)return e.jsx(nd,{milesData:t,onUpdate:s});const h=x.date&&x.amount>0&&x.cost>=0,b=(S,P)=>{c(C=>({...C,[S]:P}))},g=S=>{if(S.preventDefault(),!h||o)return;u(!0);const P=x.date.slice(0,7),C=t.findIndex(f=>f.month===P);let w=[...t];if(C>=0){const f={...w[C]};switch(x.source){case"subscription":f.miles_subscription+=Number(x.amount),f.cost_subscription+=Number(x.cost);break;case"amex":f.miles_amex+=Number(x.amount),f.cost_amex+=Number(x.cost);break;case"other":f.miles_other+=Number(x.amount),f.cost_other+=Number(x.cost);break}w[C]=f}else{const f={id:ba(),month:P,miles_subscription:0,miles_amex:0,miles_flight:0,miles_other:0,miles_debit:0,cost_subscription:0,cost_amex:0,cost_flight:0,cost_other:0};switch(x.source){case"subscription":f.miles_subscription=Number(x.amount),f.cost_subscription=Number(x.cost);break;case"amex":f.miles_amex=Number(x.amount),f.cost_amex=Number(x.cost);break;case"other":f.miles_other=Number(x.amount),f.cost_other=Number(x.cost);break}w.push(f)}s(w),l(x.source),p(!0),setTimeout(()=>p(!1),2500),c({date:i,source:"amex",amount:0,cost:0}),u(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-xl shadow-slate-200/40 border border-slate-100 overflow-hidden transition-all hover:shadow-2xl hover:shadow-slate-200/50",children:[e.jsxs("div",{className:"px-8 pt-8 pb-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-2xl bg-indigo-50 text-indigo-600 flex items-center justify-center border border-indigo-100 shadow-sm",children:e.jsx(Oe,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:"Add Miles"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium mt-0.5",children:"Record non-flight accumulation (Amex, Subs, etc.)"})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-50 border border-emerald-100 text-emerald-700 text-[10px] font-bold uppercase tracking-wider",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Engine Active"]})]}),e.jsx("div",{className:"p-8",children:e.jsxs("form",{onSubmit:g,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[e.jsx("div",{className:"md:col-span-4",children:e.jsx(Xa,{label:"Transaction Date",icon:et,children:e.jsx("input",{type:"date",value:x.date,onChange:S=>b("date",S.target.value),className:`${Ea} cursor-pointer`})})}),e.jsxs("div",{className:"md:col-span-8",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide flex items-center gap-1.5",children:[e.jsx(Bt,{size:12})," Source Bucket"]}),e.jsx(me,{text:"Categorize your miles to track Acquisition Cost per source correctly."})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:rd.map(S=>{const P=x.source===S.id,C=S.icon;return e.jsxs("button",{type:"button",onClick:()=>b("source",S.id),className:`
                          flex items-center justify-center gap-2 py-2.5 px-3 rounded-xl border transition-all duration-200 text-xs font-bold
                          ${P?"bg-indigo-50 border-indigo-200 text-indigo-700 shadow-sm":"bg-white border-slate-200 text-slate-500 hover:border-slate-300 hover:bg-slate-50"}
                        `,children:[e.jsx(C,{size:14}),S.label]},S.id)})})]})]}),e.jsx("div",{className:"h-px bg-slate-100"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Xa,{label:"Miles Earned",icon:Ge,rightElement:"Miles",tooltip:"The amount of miles credited to your account.",children:e.jsx("input",{type:"number",className:`${Ea} text-right font-bold text-indigo-600 pr-16`,placeholder:"0",value:x.amount||"",onChange:S=>b("amount",Number(S.target.value))})}),e.jsx(Xa,{label:"Total Cost",icon:ma,rightElement:r,tooltip:"What did you pay for these miles? (e.g. monthly fee, surcharges).",children:e.jsx("input",{type:"number",className:`${Ea} text-right pr-12`,placeholder:"0.00",step:"0.01",value:x.cost||"",onChange:S=>b("cost",Number(S.target.value))})})]}),x.amount>0&&x.cost>0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-slate-500 bg-slate-50 p-3 rounded-xl border border-slate-100 border-dashed",children:[e.jsx("span",{children:"Acquisition CPM:"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[r,(x.cost/x.amount).toFixed(5)]}),e.jsx("span",{children:"/ mile"})]}),e.jsxs("div",{className:"pt-2 relative",children:[m&&e.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-emerald-500 text-white px-4 py-2 rounded-lg text-sm font-bold shadow-lg animate-in fade-in slide-in-from-bottom-2 duration-300",children:"â Miles added to ledger!"}),e.jsx("button",{type:"submit",disabled:!h||o,className:`
                  w-full py-4 rounded-xl font-bold text-sm shadow-lg shadow-indigo-500/20 flex items-center justify-center gap-2 transition-all duration-200
                  ${h?"bg-gradient-to-r from-indigo-600 to-violet-600 text-white hover:shadow-xl hover:shadow-indigo-500/30 hover:-translate-y-0.5":"bg-slate-100 text-slate-400 cursor-not-allowed shadow-none"}
                `,children:o?e.jsx("span",{children:"Processing..."}):e.jsxs(e.Fragment,{children:[e.jsx(ks,{size:18,strokeWidth:3}),e.jsx("span",{children:"Add Transaction to Ledger"})]})}),e.jsx("p",{className:"text-center text-[11px] text-slate-400 mt-4",children:"Updates specific source buckets in the Miles Engine ledger."})]})]})})]}),e.jsx(Fr,{data:t,onUpdate:s,currentMonth:a,variant:"compact",showQuickStats:!1,title:"Miles Ledger",subtitle:"Overview of accumulated miles and costs per month."})]})},Ft="w-full rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-medium text-slate-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all placeholder:text-slate-400 disabled:bg-slate-50 disabled:text-slate-500",Ws="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",cd=[{code:"AMS SIN",label:"Singapore",icon:"ð¸ð¬"},{code:"AMS JNB",label:"Johannesburg",icon:"ð¿ð¦"},{code:"AMS GRU",label:"SÃ£o Paulo",icon:"ð§ð·"},{code:"AMS NRT",label:"Tokyo",icon:"ð¯ðµ"},{code:"AMS LAX",label:"Los Angeles",icon:"ðºð¸"},{code:"AMS DXB",label:"Dubai",icon:"ð¦ðª"}],dd={Medium:2e3,"Long 1":3500,"Long 2":5e3},xd=(t,s,a)=>{const n=t.split(" ");if(n.length<2)return{xp:0,distance:0};let l=0,r=0;for(let i=0;i<n.length-1;i++){const x=yt(n[i],n[i+1],s);l+=x.xp,r+=x.distance}if(a)for(let i=n.length-1;i>0;i--){const x=yt(n[i],n[i-1],s);l+=x.xp,r+=x.distance}return{xp:l,distance:r}},md=t=>{switch(t){case"Ultimate":return{gradient:"from-violet-600 to-purple-700",lightGradient:"from-violet-50 to-purple-50",border:"border-violet-200",text:"text-violet-700",bg:"bg-violet-500",accent:"text-violet-600"};case"Platinum":return{gradient:"from-blue-600 to-indigo-700",lightGradient:"from-blue-50 to-indigo-50",border:"border-blue-200",text:"text-blue-700",bg:"bg-blue-500",accent:"text-blue-600"};case"Gold":return{gradient:"from-amber-500 to-orange-600",lightGradient:"from-amber-50 to-orange-50",border:"border-amber-200",text:"text-amber-700",bg:"bg-amber-500",accent:"text-amber-600"};case"Silver":return{gradient:"from-slate-400 to-slate-600",lightGradient:"from-slate-100 to-slate-200",border:"border-slate-300",text:"text-slate-700",bg:"bg-slate-500",accent:"text-slate-600"};default:return{gradient:"from-sky-400 to-blue-500",lightGradient:"from-sky-50 to-blue-50",border:"border-sky-200",text:"text-sky-700",bg:"bg-sky-500",accent:"text-sky-600"}}},ud=t=>t>=$e?{level:"Platinum",xp:$e}:t>=sa?{level:"Platinum",xp:$e}:t>=aa?{level:"Gold",xp:sa}:{level:"Silver",xp:aa},hd=(t,s)=>{if(s==="Domestic"||s==="Long 3")return null;const a=dd[s];if(!a)return null;const n=a-t;return n>0&&n<=150?{diff:n,message:`Only ${n}mi short of next band!`}:null},Zl=({title:t,value:s,subtitle:a,icon:n,badgeText:l,badgeColor:r="slate",tooltip:i})=>{const x={blue:"bg-blue-50/40 border-blue-100 hover:border-blue-200",amber:"bg-amber-50/40 border-amber-100 hover:border-amber-200",emerald:"bg-emerald-50/40 border-emerald-100 hover:border-emerald-200",violet:"bg-violet-50/40 border-violet-100 hover:border-violet-200",slate:"bg-slate-50/40 border-slate-100 hover:border-slate-200"},c={blue:"text-blue-600 bg-white shadow-sm",amber:"text-amber-600 bg-white shadow-sm",emerald:"text-emerald-600 bg-white shadow-sm",violet:"text-violet-600 bg-white shadow-sm",slate:"text-slate-600 bg-white shadow-sm"},o=x[r]||x.slate,u=c[r]||c.slate;return e.jsxs("div",{className:`p-5 rounded-3xl border shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] transition-all duration-300 group ${o}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:`p-3 rounded-2xl ${u}`,children:e.jsx(n,{size:20,strokeWidth:2.5})}),l&&e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-lg bg-white/60 text-slate-500 border border-slate-100/50",children:l})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:t}),i&&e.jsx(me,{text:i})]}),e.jsx("h3",{className:"text-2xl font-black text-slate-800 tracking-tight",children:s}),a&&e.jsx("p",{className:"text-xs text-slate-400 mt-1 font-medium",children:a})]})]})},pd=({actualXP:t,projectedXP:s,actualUXP:a,projectedUXP:n,runXP:l,runUXP:r,currentStatus:i,isUltimate:x=!1})=>{const o=x||i==="Ultimate"?"ultimate":i==="Platinum"?t>=600?"ultimate":"requalify":"upgrade",m=(()=>{switch(o){case"ultimate":return{xp:900,label:"Ultimate",isUXP:!0};case"requalify":return{xp:$e,label:"Platinum",isUXP:!1};case"upgrade":const F=ud(t);return{xp:F.xp,label:F.level,isUXP:!1}}})(),p=o==="ultimate"?{gradient:"from-violet-600 to-purple-600"}:md(o==="requalify"?i:m.label),h=o==="ultimate"?a:t,b=o==="ultimate"?r:l,g=h+b,S=s>t,P=s-t,C=n-a,w=o==="ultimate"?n+r:s+l,f=Math.max(0,m.xp-g),D=g>=m.xp,_=()=>{switch(o){case"ultimate":return"Ultimate Goal";case"requalify":return"Requalification";case"upgrade":return"Status Upgrade"}},N=()=>{switch(o){case"ultimate":return"This run gets you to Ultimate!";case"requalify":return"This run secures your Platinum!";case"upgrade":return`This run upgrades you to ${m.label}!`}};return e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-xl shadow-slate-200/50 overflow-hidden",children:[e.jsxs("div",{className:`bg-gradient-to-r ${p.gradient} p-5 text-white relative overflow-hidden`,children:[e.jsx("div",{className:"absolute top-0 right-0 opacity-10",children:o==="ultimate"?e.jsx(ze,{size:100}):e.jsx(De,{size:100})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(le,{size:14,className:"opacity-80"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider opacity-80",children:_()})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl font-black",children:m.label}),D&&b>0&&e.jsxs("span",{className:"flex items-center gap-1 bg-white/20 backdrop-blur-sm px-2 py-1 rounded-lg text-[10px] font-bold",children:[e.jsx(Be,{size:10}),o==="requalify"?"Secured!":"Achieved!"]})]})]})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 mb-1",children:o==="ultimate"?"Your UXP":"Your XP"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-black text-slate-800",children:h}),b>0&&e.jsxs(e.Fragment,{children:[e.jsx(ht,{size:16,className:"text-slate-300"}),e.jsx("span",{className:`text-2xl font-black ${D?"text-emerald-600":"text-slate-800"}`,children:g}),e.jsxs("span",{className:"text-sm font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-lg",children:["+",b]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 mb-1",children:"Target"}),e.jsxs("div",{className:"text-2xl font-black text-slate-800",children:[m.xp,o==="ultimate"&&e.jsx("span",{className:"text-sm font-bold text-slate-400 ml-1",children:"UXP"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] mb-1.5",children:[e.jsx("span",{className:"font-bold text-slate-400 uppercase",children:D?`${m.label} ${o==="requalify"?"Secured":"Achieved"}`:`To ${m.label}`}),e.jsx("span",{className:`font-bold ${D?"text-emerald-600":"text-slate-600"}`,children:D?"Complete!":`${f} ${o==="ultimate"?"UXP":"XP"} needed`})]}),e.jsxs("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full transition-all duration-500 ${D?"bg-gradient-to-r from-emerald-500 to-emerald-400":`bg-gradient-to-r ${p.gradient}`}`,style:{width:`${Math.min(100,h/m.xp*100)}%`}}),b>0&&e.jsx("div",{className:`absolute inset-y-0 rounded-full transition-all duration-500 ${D?"bg-emerald-300":"bg-indigo-300"}`,style:{left:`${Math.min(100,h/m.xp*100)}%`,width:`${Math.min(100-h/m.xp*100,b/m.xp*100)}%`}})]})]}),b>0&&e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl ${D?"bg-emerald-50 border border-emerald-100":"bg-blue-50 border border-blue-100"}`,children:[e.jsx("div",{className:`p-2 rounded-lg ${D?"bg-emerald-100 text-emerald-600":"bg-blue-100 text-blue-600"}`,children:D?e.jsx(Be,{size:14}):e.jsx(Je,{size:14})}),e.jsx("div",{className:"text-xs",children:D?e.jsx("span",{className:"font-bold text-emerald-800",children:N()}):e.jsxs("span",{className:"font-medium text-blue-800",children:[f," more ",o==="ultimate"?"UXP":"XP"," needed after this run",f<=30&&" â almost there!"]})})]}),o==="ultimate"&&b>0&&r<l&&e.jsxs("div",{className:"flex items-center gap-2 p-2.5 rounded-xl bg-amber-50 border border-amber-100 text-xs text-amber-700",children:[e.jsx(lt,{size:14,className:"flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"Note:"})," Only KLM & Air France flights earn UXP. This run earns ",l," XP but only ",r," UXP."]})]}),S&&e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-slate-100 text-xs text-slate-500",children:[e.jsx(Ee,{size:12}),e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold text-amber-600",children:["+",o==="ultimate"?C:P," scheduled"]})," ","â ",w," ",o==="ultimate"?"UXP":"XP"," total"]})]}),b===0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-slate-50 border border-slate-100",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-200 text-slate-500",children:e.jsx(Ns,{size:14})}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-bold text-slate-700",children:"Enter a route to simulate"}),e.jsxs("div",{className:"text-slate-500",children:[m.xp-h," ",o==="ultimate"?"UXP":"XP"," needed for ",m.label]})]})]})]})]})},bd=({route:t,cabin:s,isReturn:a,onClick:n})=>{const{xp:l,distance:r}=xd(t.code,s,a);return e.jsxs("button",{onClick:n,className:"flex items-center gap-3 p-3 rounded-xl border border-slate-200 bg-white hover:border-indigo-200 hover:shadow-md transition-all group text-left w-full",children:[e.jsx("div",{className:"text-2xl",children:t.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm truncate",children:t.label}),e.jsxs("div",{className:"text-xs text-slate-400",children:[ne(r)," mi"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-black text-indigo-600",children:["+",l]}),e.jsx("div",{className:"text-[10px] text-slate-400",children:"XP"})]}),e.jsx(we,{size:14,className:"text-slate-300 group-hover:text-indigo-400 transition-colors"})]})},gd=({segments:t,totalMiles:s,runXP:a})=>{if(t.length===0)return null;const n=t.reduce((i,x)=>x.xp/Math.max(1,x.distance)>i.xp/Math.max(1,i.distance)?x:i,t[0]),l=Math.round(a/t.length),r=new Set(t.flatMap(i=>[i.from,i.to])).size;return e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100/50 rounded-2xl p-4 border border-slate-200/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(el,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Run Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-slate-100",children:[e.jsx("div",{className:"text-lg font-black text-slate-800",children:t.length}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:"Segments"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-slate-100",children:[e.jsx("div",{className:"text-lg font-black text-slate-800",children:ne(s)}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:"Total Miles"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-slate-100",children:[e.jsx("div",{className:"text-lg font-black text-slate-800",children:r}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:"Airports"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-slate-100",children:[e.jsx("div",{className:"text-lg font-black text-indigo-600",children:l}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:"Avg XP/Seg"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-amber-50 border border-amber-100 rounded-xl px-3 py-2",children:[e.jsx(Rs,{size:14,className:"text-amber-500"}),e.jsxs("span",{className:"text-xs text-amber-800",children:[e.jsx("span",{className:"font-bold",children:"Best value:"})," ",n.from,"â",n.to," (",n.xp," XP, ",n.cabin,")"]})]})]})},fd=t=>{const s=["Explorer","Silver","Gold","Platinum","Ultimate"],a=s.indexOf(t);return t==="Platinum"||t==="Ultimate"?null:a<s.length-1?s[a+1]:null},jd=t=>{switch(t){case"Explorer":return 100;case"Silver":return 180;case"Gold":return 300;case"Platinum":return 300;case"Ultimate":return 300;default:return 300}},Ql={Economy:{label:"Economy",multiplier:"1Ã",color:"bg-slate-100 text-slate-700 border-slate-200"},"Premium Economy":{label:"Premium",multiplier:"1.5Ã",color:"bg-blue-50 text-blue-700 border-blue-200"},Business:{label:"Business",multiplier:"2Ã",color:"bg-indigo-50 text-indigo-700 border-indigo-200"},First:{label:"First",multiplier:"3Ã",color:"bg-amber-50 text-amber-700 border-amber-200"}},yd=({xpData:t,rollover:s,flights:a,manualLedger:n,qualificationSettings:l,demoStatus:r,displayXP:i,hasPdfBaseline:x=!1})=>{const{setViewMode:c}=it(),[o,u]=d.useState(""),[m,p]=d.useState("Economy"),[h,b]=d.useState(!0),g=d.useMemo(()=>Yt(l),[l]),{cycles:S}=d.useMemo(()=>Lt(t,s,a,n,g),[t,s,a,n,g]),P=d.useMemo(()=>us(S),[S]),C=P?.actualXP??0,w=x&&i!==void 0?i:C,f=P?.isUltimate??!1,D=P?.actualStatus??"Explorer",_=r??ms(D,f),N=_==="Ultimate",F=cl(_,N),j=jd(_),v=fd(_),A=Math.max(0,j-w),R=Math.min(100,Math.round(w/j*100)),X=d.useMemo(()=>{const y=o.toUpperCase().replace(/[^A-Z]/g," ").trim().split(/\s+/).filter(K=>K.length===3);if(y.length<2)return{valid:!1,xp:0,error:null,segments:0};const U=y.filter(K=>!dt[K]);if(U.length>0)return{valid:!1,xp:0,error:`Unknown: ${U.join(", ")}`,segments:0};let M=0,z=0;for(let K=0;K<y.length-1;K++){const{xp:Y}=yt(y[K],y[K+1],m);M+=Y,z++}if(h){const K=[...y].reverse();for(let Y=0;Y<K.length-1;Y++){const{xp:O}=yt(K[Y],K[Y+1],m);M+=O,z++}}return{valid:!0,xp:M,error:null,segments:z}},[o,m,h]),L=w+X.xp,G=L>=j,k=Math.min(100,Math.round(L/j*100)),I=Math.max(0,j-L);return e.jsxs("div",{className:"space-y-5 animate-in fade-in duration-500 max-w-2xl mx-auto pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"XP Planner"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"See how flights impact your status"})]}),e.jsxs("button",{onClick:()=>c("full"),className:"flex items-center gap-1.5 text-sm font-medium text-slate-500 hover:text-slate-700 transition-colors",children:[e.jsx(Ds,{size:16}),"Full view",e.jsx(we,{size:16})]})]}),e.jsxs("div",{className:`rounded-2xl p-4 ${N?"bg-gradient-to-r from-slate-800 to-slate-900 text-white":"bg-white border border-slate-100 shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-bold ${N?"text-white":"text-slate-900"}`,children:_}),A>0&&e.jsxs("span",{className:`text-xs ${N?"text-slate-400":"text-slate-500"}`,children:["â¢ ",A," XP to ",v||"requalify"]})]}),e.jsxs("span",{className:`text-sm font-bold ${F.accentColor}`,children:[w," / ",j]})]}),e.jsx("div",{className:`relative w-full h-2 rounded-full overflow-hidden ${N?"bg-slate-700":"bg-slate-100"}`,children:e.jsx("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${F.progressBar} rounded-full transition-all duration-500`,style:{width:`${R}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Route"}),e.jsxs("div",{className:"relative",children:[e.jsx(_s,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",value:o,onChange:y=>u(y.target.value.toUpperCase()),placeholder:"AMS-NRT or AMS CDG BKK",className:`w-full pl-10 pr-4 py-3 border rounded-xl text-sm font-mono focus:outline-none focus:ring-2 transition-all ${X.error?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-slate-200 focus:border-indigo-500 focus:ring-indigo-500/20"}`})]}),X.error&&e.jsx("p",{className:"mt-1.5 text-xs text-red-500",children:X.error})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-2",children:"Cabin Class"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.keys(Ql).map(y=>{const U=Ql[y],M=m===y;return e.jsxs("button",{onClick:()=>p(y),className:`px-3 py-2.5 rounded-xl border text-xs font-semibold transition-all ${M?U.color+" border-2":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("div",{children:U.label}),e.jsxs("div",{className:`text-[10px] font-normal ${M?"":"text-slate-400"}`,children:[U.multiplier," XP"]})]},y)})})]})]}),o.trim().length>=5&&e.jsx("div",{className:"px-5 pb-5 pt-2 border-t border-slate-100",children:X.valid?e.jsxs("div",{className:`rounded-2xl p-5 ${G?"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-100":"bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("button",{onClick:()=>b(!h),className:`flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-medium transition-colors ${h?"bg-indigo-100 text-indigo-700":"bg-slate-200 text-slate-600"}`,children:[e.jsx(Za,{size:12,className:h?"text-indigo-500":"text-slate-400"}),h?"Return":"One way"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[X.segments," segment",X.segments!==1?"s":""]})]}),e.jsxs("p",{className:`text-3xl font-black ${G?"text-emerald-600":"text-slate-800"}`,children:["+",X.xp," ",e.jsx("span",{className:"text-lg font-bold",children:"XP"})]})]}),e.jsx("div",{className:`p-2.5 rounded-xl ${G?"bg-emerald-100":"bg-white"}`,children:G?e.jsx(je,{size:22,className:"text-emerald-600"}):e.jsx(Ie,{size:22,className:"text-slate-400"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"After this trip"}),e.jsxs("span",{className:"font-bold text-slate-700",children:[L," / ",j," XP"]})]}),e.jsxs("div",{className:"relative w-full h-2.5 rounded-full bg-white/80 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-slate-300 z-10",style:{left:`${R}%`}}),e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full transition-all duration-500 ${G?"bg-emerald-500":"bg-indigo-500"}`,style:{width:`${k}%`}})]})]}),G?e.jsxs("p",{className:"mt-3 text-sm font-medium text-emerald-700 flex items-center gap-1.5",children:[e.jsx(Be,{size:14}),"You'll reach ",v||"your target","!"]}):e.jsxs("p",{className:"mt-3 text-sm text-slate-500",children:[I," XP still needed for ",v||"target"]})]}):!X.error&&e.jsxs("div",{className:"text-center py-6 text-slate-400",children:[e.jsx(le,{size:24,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Enter a valid route to see XP"})]})})]}),e.jsx("p",{className:"text-xs text-slate-400 text-center",children:"Tip: Business class earns 2Ã the XP of Economy"})]})},Nd=({xpData:t,rollover:s,flights:a,manualLedger:n,qualificationSettings:l,demoStatus:r,displayXP:i,hasPdfBaseline:x=!1})=>{const{symbol:c}=Ke(),{isSimpleMode:o}=it(),{trackCalculator:u}=rt(),[m,p]=d.useState(""),[h,b]=d.useState("Business"),[g,S]=d.useState(!0),[P,C]=d.useState("classic"),[w,f]=d.useState(0),[D,_]=d.useState(0),[N,F]=d.useState(10),[j,v]=d.useState([]),[A,R]=d.useState([]),[X,L]=d.useState(!1),[G,k]=d.useState(!1),[I,y]=d.useState({route:"",calculatedXP:"",actualXP:"",cabin:"Economy",notes:""}),[U,M]=d.useState(!1),[z,K]=d.useState(!1),Y=d.useMemo(()=>Yt(l),[l]),{cycles:O}=d.useMemo(()=>Lt(t,s,a,n,Y),[t,s,a,n,Y]),V=d.useMemo(()=>us(O),[O]),J=V?.actualXP??0,q=x&&i!==void 0?i:J,B=Math.max(V?.projectedXP??q,q),$=V?.actualUXP??0,Q=V?.projectedUXP??$,oe=V?.isUltimate??!1,se=r==="Ultimate"||oe,Z=V?.actualStatus??"Platinum",ee=r??ms(Z,oe);if(o)return e.jsx(yd,{xpData:t,rollover:s,flights:a,manualLedger:n,qualificationSettings:l,demoStatus:r,displayXP:i,hasPdfBaseline:x});const T=q;d.useEffect(()=>{if(!m){v([]),R([]);return}const W=m.toUpperCase().replace(/[^A-Z]/g," ").trim().split(/\s+/).filter(te=>te.length===3);if(W.length<2)return;const pe=[];if(W.forEach(te=>{!dt[te]&&!pe.includes(te)&&pe.push(te)}),pe.length>0){R(pe);return}else R([]);const Fe=(te,xe,qe,Rt)=>{const{distance:Ve,band:_t,xp:ls}=yt(te,xe,h);return{id:`${Rt}-${qe}-${te}-${xe}`,from:te,to:xe,distance:Ve,band:_t,xp:ls,cabin:h}},ae=[];for(let te=0;te<W.length-1;te++)ae.push(Fe(W[te],W[te+1],te,"out"));if(g){const te=[...W].reverse();for(let xe=0;xe<te.length-1;xe++)ae.push(Fe(te[xe],te[xe+1],xe,"in"))}v(ae),ae.length>0&&u("mileage_run")},[m,g,h]);const ce=(W,pe)=>{v(Fe=>Fe.map(ae=>{if(ae.id!==W)return ae;const{xp:te}=yt(ae.from,ae.to,pe);return{...ae,cabin:pe,xp:te}}))},fe=W=>{v(pe=>pe.map(Fe=>{const{xp:ae}=yt(Fe.from,Fe.to,W);return{...Fe,cabin:W,xp:ae}}))},Se=W=>{v(pe=>pe.filter(Fe=>Fe.id!==W))},Te=W=>{p(W)},Me=j.reduce((W,pe)=>W+pe.xp,0),H=Me,ie=j.reduce((W,pe)=>W+pe.distance,0),ue=d.useMemo(()=>j.reduce((W,pe)=>W+yt(pe.from,pe.to,"Economy").xp,0),[j]);let be=0,ve="Total Yield",Ye="Cost per XP",he=Me,Ae="Average cost for every XP gained in this run.";if(P==="optimizer"){const W=Math.max(0,w-D),pe=Math.max(0,Me-ue);be=pe>0?W/pe:0,ve="Marginal Yield",Ye="Cost per EXTRA XP",he=pe,Ae="Cost for every EXTRA XP gained by upgrading from Economy. (Upgrade Cost / Extra XP)"}else be=Me>0&&w>0?w/Me:0;const ot=(W=>W===0?{label:"-",color:"slate"}:W<=N*.6?{label:"Legendary",color:"violet"}:W<=N*.8?{label:"Excellent",color:"emerald"}:W<=N?{label:"On Target",color:"blue"}:W<=N*1.5?{label:"Pricey",color:"amber"}:{label:"Expensive",color:"slate"})(be),gt=async W=>{W.preventDefault(),M(!0);const pe=[`Route: ${I.route}`,`Cabin: ${I.cabin}`,`Calculated XP: ${I.calculatedXP}`,`Actual XP: ${I.actualXP}`,`Difference: ${Number(I.actualXP)-Number(I.calculatedXP)} XP`,I.notes?`Notes: ${I.notes}`:null].filter(Boolean).join(`
`),Fe=await xs({trigger:"xp_discrepancy",message:pe,page:"xp_run_simulator"});M(!1),Fe?(K(!0),y({route:"",calculatedXP:"",actualXP:"",cabin:"Economy",notes:""})):alert("Failed to send report. Please try again.")};return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 pb-12",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end justify-between gap-6 border-b border-slate-100 pb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-indigo-50 border border-indigo-100 text-[10px] font-bold text-indigo-600 mb-3 gap-1.5 uppercase tracking-wide",children:[e.jsx(Ns,{size:12}),e.jsx("span",{children:"Smart Route Builder"})]}),e.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"XP Run Simulator"}),e.jsxs("p",{className:"text-slate-500 mt-2 font-medium",children:["Plan your next status run based on your current ",e.jsxs("span",{className:"text-slate-900 font-bold",children:[T," XP"]})," balance."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl px-4 py-2 flex flex-col shadow-sm w-36 group hover:border-indigo-200 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide group-hover:text-indigo-500",children:["Target ",c,"/XP"]}),e.jsx(me,{text:"What is the maximum you want to pay for 1 XP? Used to calculate the Verdict."})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[e.jsx("span",{className:"text-xs text-slate-400 font-medium",children:c}),e.jsx("input",{type:"number",step:"0.5",value:N,onChange:W=>F(Number(W.target.value)),className:`text-sm font-bold text-slate-800 outline-none bg-transparent w-full ${Ws}`})]})]}),e.jsxs("div",{className:"bg-slate-100 p-1 rounded-xl flex items-center shadow-inner h-fit",children:[e.jsxs("button",{onClick:()=>C("classic"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all ${P==="classic"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(le,{size:14})," Classic"]}),e.jsxs("button",{onClick:()=>C("optimizer"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all ${P==="optimizer"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(Ss,{size:14})," Optimizer"]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-amber-100 flex items-center justify-center flex-shrink-0",children:e.jsx(lt,{size:16,className:"text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-amber-900",children:"XP calculations are estimates based on distance"}),e.jsx("p",{className:"text-xs text-amber-700",children:"Some routes may differ from actual Flying Blue values"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-amber-700 bg-amber-100 hover:bg-amber-200 rounded-lg transition-colors",children:[e.jsx(Ua,{size:12}),"Report Issue"]}),e.jsx("button",{onClick:()=>L(!X),className:"p-1.5 text-amber-600 hover:bg-amber-100 rounded-lg transition-colors",children:X?e.jsx(cs,{size:16}):e.jsx(nt,{size:16})})]})]}),X&&e.jsx("div",{className:"px-4 pb-4 pt-2 border-t border-amber-200 bg-amber-50/50",children:e.jsxs("div",{className:"space-y-3 text-xs text-amber-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"How we calculate XP:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-amber-700",children:[e.jsx("li",{children:"Flight distance determines the category (Domestic, Short, Medium, Long 1/2/3)"}),e.jsx("li",{children:"Cabin class and your status determine the XP multiplier"}),e.jsx("li",{children:"This follows the official Flying Blue distance bands"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"Why estimates may differ:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-amber-700",children:[e.jsx("li",{children:"AF/KLM manually override certain routes near category boundaries"}),e.jsx("li",{children:"Example: AMS-PEK is Long 3 (not Long 2) despite the distance"}),e.jsx("li",{children:"These overrides aren't publicly documented"})]})]}),e.jsx("p",{className:"text-amber-600 italic",children:"ð¡ Tip: Your Dashboard shows actual XP from imported PDFs, which reflects these exceptions."})]})})]}),G&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center",children:e.jsx(Ua,{size:20,className:"text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Report XP Discrepancy"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Help us improve our calculations"})]})]}),e.jsx("button",{onClick:()=>{k(!1),K(!1)},className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-xl transition-colors",children:e.jsx(Ce,{size:18})})]}),z?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(es,{size:24,className:"text-emerald-600"})}),e.jsx("h4",{className:"text-lg font-bold text-slate-900 mb-2",children:"Thanks for your report!"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"We'll investigate this route and update our calculations if needed."}),e.jsx("button",{onClick:()=>{k(!1),K(!1)},className:"px-6 py-2.5 bg-slate-900 text-white font-semibold rounded-xl hover:bg-slate-800 transition-colors",children:"Close"})]}):e.jsxs("form",{onSubmit:gt,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-1.5",children:"Route (e.g., AMS-PEK or AMS-CDG-JFK)"}),e.jsx("input",{type:"text",required:!0,value:I.route,onChange:W=>y({...I,route:W.target.value.toUpperCase()}),placeholder:"AMS-PEK",className:Ft})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-1.5",children:"Cabin"}),e.jsxs("select",{value:I.cabin,onChange:W=>y({...I,cabin:W.target.value}),className:Ft,children:[e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Premium Economy",children:"Premium Eco"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"First",children:"First"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-1.5",children:"Calculated"}),e.jsx("input",{type:"number",required:!0,value:I.calculatedXP,onChange:W=>y({...I,calculatedXP:W.target.value}),placeholder:"15",className:Ft})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-1.5",children:"Actual XP"}),e.jsx("input",{type:"number",required:!0,value:I.actualXP,onChange:W=>y({...I,actualXP:W.target.value}),placeholder:"20",className:Ft})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-1.5",children:"Notes (optional)"}),e.jsx("textarea",{value:I.notes,onChange:W=>y({...I,notes:W.target.value}),placeholder:"Any additional context...",rows:2,className:Ft})]}),e.jsx("button",{type:"submit",disabled:U,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white font-bold rounded-xl hover:from-amber-600 hover:to-orange-600 transition-all disabled:opacity-50",children:U?e.jsx(e.Fragment,{children:"Sending..."}):e.jsxs(e.Fragment,{children:[e.jsx(es,{size:16}),"Send Report"]})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"xl:col-span-5 space-y-6",children:[e.jsx(pd,{actualXP:q,projectedXP:B,actualUXP:$,projectedUXP:Q,runXP:Me,runUXP:H,currentStatus:ee,isUltimate:se}),e.jsx("div",{className:"bg-white p-6 rounded-[2rem] shadow-lg shadow-slate-200/40 border border-slate-100",children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide mb-2 flex items-center gap-2",children:[e.jsx(_s,{size:12})," Route Chain"]}),e.jsx("input",{type:"text",className:`${Ft} uppercase font-mono text-lg tracking-wider border-slate-200 focus:border-indigo-500 focus:ring-indigo-500/20`,placeholder:"AMS CDG DXB",value:m,onChange:W=>p(W.target.value)}),A.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 rounded-xl border border-red-100 flex items-start gap-2 text-red-600 text-xs",children:[e.jsx(Nt,{size:14,className:"shrink-0 mt-0.5"}),e.jsxs("span",{children:["Unknown: ",e.jsx("strong",{children:A.join(", ")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide mb-2 block",children:"Base Cabin"}),e.jsxs("select",{value:h,onChange:W=>b(W.target.value),className:`${Ft} text-xs`,children:[e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Premium Economy",children:"Prem. Eco"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"First",children:"First"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide mb-2 block",children:"Trip Type"}),e.jsxs("button",{onClick:()=>S(!g),className:`w-full py-2.5 px-3 rounded-xl text-xs font-bold transition-all border flex items-center justify-between ${g?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,children:[e.jsx("span",{children:g?"Return":"One-way"}),g&&e.jsx(Qa,{size:14})]})]})]}),e.jsx("div",{className:`p-4 rounded-xl border transition-colors ${P==="optimizer"?"bg-indigo-50/50 border-indigo-100":"bg-slate-50 border-slate-100"}`,children:P==="optimizer"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide",children:"Base Cost (Economy)"}),e.jsx(me,{text:"The price of the cheapest Economy ticket."})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold",children:c}),e.jsx("input",{type:"number",className:`${Ft} ${Ws} pl-8`,placeholder:"1000",value:D||"",onChange:W=>_(Number(W.target.value))})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-indigo-200"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"px-2 bg-indigo-50 text-[10px] text-indigo-400 font-bold uppercase",children:"vs"})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-bold text-indigo-500 uppercase tracking-wide mb-2 flex items-center gap-2",children:[e.jsx(Ge,{size:12})," Premium Cost"]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold",children:c}),e.jsx("input",{type:"number",className:`${Ft} ${Ws} pl-8 text-lg font-bold text-indigo-900`,placeholder:"2500",value:w||"",onChange:W=>f(Number(W.target.value))})]})]})]}):e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wide mb-2 flex items-center gap-2",children:[e.jsx(Ge,{size:12})," Total Run Cost"]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold",children:c}),e.jsx("input",{type:"number",className:`${Ft} ${Ws} pl-8 text-lg font-bold`,placeholder:"0",value:w||"",onChange:W=>f(Number(W.target.value))})]})]})})]})}),e.jsxs("div",{className:"bg-white p-5 rounded-[2rem] border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Pt,{size:16,className:"text-amber-500"}),e.jsx("h3",{className:"font-bold text-slate-800 text-sm",children:"Quick Routes from AMS"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:cd.map(W=>e.jsx(bd,{route:W,cabin:h,isReturn:g,onClick:()=>Te(W.code)},W.code))})]})]}),e.jsxs("div",{className:"xl:col-span-7 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Zl,{title:ve,value:`+${he}`,subtitle:P==="optimizer"?`Baseline: ${ue} XP (Eco)`:`${ne(ie)} miles`,icon:ws,badgeText:P==="optimizer"?"Delta":"Total",badgeColor:"blue",tooltip:"The XP you gain from this run."}),e.jsx(Zl,{title:"Efficiency",value:be>0?`${c}${be.toFixed(2)}`:`${c}0.00`,subtitle:Ye,icon:Oe,badgeText:ot.label,badgeColor:ot.color,tooltip:Ae})]}),e.jsx(gd,{segments:j,totalMiles:ie,runXP:Me}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100 bg-slate-50/30 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-slate-400"})," Segment Breakdown"]}),j.length>0&&e.jsxs("span",{className:"text-xs font-bold text-slate-400 bg-white border border-slate-200 px-2 py-1 rounded-lg",children:[j.length," Legs"]})]}),j.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>fe("Economy"),className:"p-1.5 hover:bg-white rounded-lg text-slate-400 hover:text-slate-600 transition-all",title:"Set all to Economy",children:e.jsx(bi,{size:16})}),e.jsx("button",{onClick:()=>fe("Business"),className:"p-1.5 hover:bg-white rounded-lg text-slate-400 hover:text-indigo-600 transition-all",title:"Set all to Business",children:e.jsx(gi,{size:16})})]})]}),e.jsx("div",{className:"p-5 flex-1 max-h-[500px] overflow-y-auto",children:j.length===0?e.jsxs("div",{className:"h-64 flex flex-col items-center justify-center text-slate-400 border-2 border-dashed border-slate-100 rounded-2xl bg-slate-50/50",children:[e.jsx(le,{className:"opacity-20 mb-4",size:48}),e.jsx("p",{className:"text-sm font-medium",children:"Enter a route to start calculating"}),e.jsx("p",{className:"text-xs text-slate-300 mt-1",children:"Or select a quick route below"})]}):e.jsx("div",{className:"space-y-3",children:j.map((W,pe)=>{const Fe=hd(W.distance,W.band);return e.jsxs("div",{className:"group relative flex flex-col sm:flex-row sm:items-center gap-4 p-4 rounded-2xl border border-slate-100 bg-white hover:border-indigo-100 hover:shadow-md transition-all",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-50 border border-slate-100 flex items-center justify-center text-xs font-bold text-slate-400 shrink-0 group-hover:bg-indigo-50 group-hover:text-indigo-600 transition-colors",children:pe+1}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"text-lg font-black text-slate-800",children:W.from}),e.jsx(ht,{size:14,className:"text-slate-300"}),e.jsx("span",{className:"text-lg font-black text-slate-800",children:W.to})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-500",children:[e.jsxs("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded text-slate-600",children:[W.distance," mi"]}),e.jsx("span",{className:"text-slate-300",children:"â¢"}),e.jsx("span",{className:"text-slate-600",children:W.band}),Fe&&e.jsxs("span",{className:"flex items-center gap-1 text-amber-600 bg-amber-50 px-1.5 py-0.5 rounded border border-amber-100 ml-2 animate-pulse",children:[e.jsx(_e,{size:10}),Fe.message]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[e.jsxs("select",{value:W.cabin,onChange:ae=>ce(W.id,ae.target.value),className:"bg-slate-50 border border-slate-200 text-xs font-bold text-slate-700 py-1.5 px-3 rounded-lg focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 cursor-pointer outline-none hover:bg-white transition-colors",children:[e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Premium Economy",children:"Prem. Eco"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"First",children:"First"})]}),e.jsxs("div",{className:"text-right min-w-[60px]",children:[e.jsxs("div",{className:"text-xl font-black text-indigo-600",children:["+",W.xp]}),e.jsx("div",{className:"text-[10px] text-indigo-400/80 font-bold uppercase",children:"XP"})]}),e.jsx("button",{onClick:()=>Se(W.id),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Ce,{size:16})})]})]},W.id)})})})]})]})]})]})};function vd(t,s,a){const n=t.reduce((m,p)=>m+(p.earnedXP||0),0),l=s.reduce((m,p)=>m+p.amex_xp+p.saf+p.misc+p.status_correction,0),r=n+l,i=t.reduce((m,p)=>m+(p.earnedMiles||0),0),x=a.reduce((m,p)=>m+p.miles_subscription+p.miles_amex+p.miles_flight+p.miles_other,0),c=i+x,o=t.length,u=o>0?Math.round(n/o*10)/10:0;return{totalXP:r,totalMilesEarned:c,totalFlights:o,avgXpPerFlight:u}}function wd(t,s){const a=t.filter(u=>en(u.airline)),n=t.filter(u=>!en(u.airline)),l=a.reduce((u,m)=>u+(m.uxp||m.earnedXP||0),0);let r=l,i=a.length,x=n.length;if(s){const u=s+"-01",m=a.filter(h=>h.date>=u),p=n.filter(h=>h.date>=u);r=m.reduce((h,b)=>h+(b.uxp||b.earnedXP||0),0),i=m.length,x=p.length}const c=900,o=Math.min(100,Math.round(r/c*100));return{totalUXP:l,uxpThisCycle:r,targetUXP:c,uxpFromFlights:l,klAfFlightCount:i,partnerFlightCount:x,progressPercentage:o}}function Dr(t){if(t.length===0)return{economy:0,premiumEconomy:0,business:0,first:0};const s={Economy:0,"Premium Economy":0,Business:0,First:0};t.forEach(n=>{n.cabin in s&&s[n.cabin]++});const a=t.length;return{economy:Math.round(s.Economy/a*100),premiumEconomy:Math.round(s["Premium Economy"]/a*100),business:Math.round(s.Business/a*100),first:Math.round(s.First/a*100)}}function Br(t){const s=t.toUpperCase();return s==="KL"||s==="KLM"}function Rr(t){const s=t.toUpperCase();return s==="AF"||s==="AIR FRANCE"||s==="AIRFRANCE"}function en(t){return Br(t)||Rr(t)}function _r(t){if(t.length===0)return{kl:0,af:0,partners:0};let s=0,a=0,n=0;t.forEach(r=>{Br(r.airline)?s++:Rr(r.airline)?a++:n++});const l=t.length;return{kl:Math.round(s/l*100),af:Math.round(a/l*100),partners:Math.round(n/l*100)}}function Ja(t,s,a){const n=t.filter(l=>l.date>=s&&l.date<=a);return _r(n)}function Sd(t,s){if(!s){const c=new Date().getFullYear(),o=`${c}-01-01`,u=`${c}-12-31`;return Ja(t,o,u)}const a=s+"-01",[n,l]=s.split("-").map(Number),r=l===1?n:n+1,i=l===1?12:l-1,x=`${r}-${String(i).padStart(2,"0")}-31`;return Ja(t,a,x)}function Pd(t){const s=new Date,a=s.toISOString().slice(0,10),n=new Date(s);n.setFullYear(n.getFullYear()-1);const l=n.toISOString().slice(0,10);return Ja(t,l,a)}function kd(t){if(t.length===0)return{score:0,percentage:0,insight:"Add flights to see your efficiency score.",factors:{cabinScore:0,airlineScore:0,routeScore:0}};const s=t.reduce((p,h)=>p+(h.earnedXP||0),0),a=t.reduce((p,h)=>{const b=h.earnedXP||0;return h.cabin==="Business"||h.cabin==="First"?p+b:h.cabin==="Premium Economy"?p+b*1.33:p+b*2},0),n=a>0?s/a*100:0,l=_r(t),r=l.kl+l.af,i=s/t.length,x=Math.min(100,i/20*100),c=n*.4+r*.35+x*.25,o=Math.round(c/100*10*10)/10;let u="";const m={cabinScore:n,airlineScore:r,routeScore:x};return o>=8?u="Excellent! You're maximizing your XP potential. Keep up the great work!":o>=6?n<r&&n<x?u="Good efficiency! Consider flying Business class more often for a boost.":r<n&&r<x?u="Solid score! Flying more KLM/AF instead of partners would improve UXP earnings.":u="Good efficiency! Longer routes could help maximize your XP earnings.":o>=4?n<50?u="Your cabin class mix has room for improvement. Business class earns 2x XP!":r<50?u="Many partner airline flights. KLM/AF flights earn valuable UXP toward Ultimate.":u="Consider longer routes or premium cabins to boost your XP efficiency.":u="There's significant room to optimize your Flying Blue strategy!",{score:Math.max(1,Math.min(10,o)),percentage:Math.round(c),insight:u,factors:m}}function Cd(t,s){const a={firstFlight:null,silverReached:null,goldReached:null,platinumReached:null,ultimateReached:null,currentStreak:0,memberSince:null};if(t.length===0)return a;const n=[...t].sort((h,b)=>h.date.localeCompare(b.date));a.firstFlight=n[0].date,a.memberSince=n[0].date.slice(0,4);let l=0,r=null,i=null,x=null;const c={};n.forEach(h=>{const b=h.date.slice(0,7);c[b]=(c[b]||0)+(h.earnedXP||0)}),s.forEach(h=>{const b=h.amex_xp+h.saf+h.misc;c[h.month]=(c[h.month]||0)+b});const o=Object.keys(c).sort();for(const h of o)l+=c[h],!r&&l>=100&&(r=`${h}-01`),!i&&l>=280&&(i=`${h}-01`),!x&&l>=580&&(x=`${h}-01`);a.silverReached=r,a.goldReached=i,a.platinumReached=x;const u=new Date().getFullYear(),m={};Object.entries(c).forEach(([h,b])=>{const g=parseInt(h.slice(0,4));m[g]=(m[g]||0)+b});let p=0;for(let h=u;h>=u-10&&(m[h]||0)>=100;h--)p++;return a.currentStreak=p,a}function Md(t){const s=[];if(t.length===0)return s;const a={};t.forEach(m=>{const p=m.route.split("-")[1];p&&(a[p]=(a[p]||0)+1)});const n=Object.entries(a).sort(([,m],[,p])=>p-m)[0];n&&s.push({icon:"ð¯",label:"Most visited",value:`${n[0]} (${n[1]}x)`});const r=t.reduce((m,p)=>m+(p.earnedXP||0),0)*200;if(r>0){const m=r>1e5?`${Math.round(r/1e3)}k km`:`${Math.round(r).toLocaleString()} km`;s.push({icon:"ð",label:"Est. distance",value:m})}const i=Dr(t),x=Object.entries(i).filter(([,m])=>m>0).sort(([,m],[,p])=>p-m)[0];if(x){const m={economy:"Economy",premiumEconomy:"Premium Eco",business:"Business",first:"First"};s.push({icon:"âï¸",label:"Favorite cabin",value:m[x[0]]||x[0]})}const c={};t.forEach(m=>{const p=m.date.slice(5,7);c[p]=(c[p]||0)+1});const o=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=Object.entries(c).sort(([,m],[,p])=>p-m)[0];return u&&s.push({icon:"ð",label:"Busiest month",value:o[parseInt(u[0])]||u[0]}),s.slice(0,4)}function Fd(t){if(!t)return"-";const s=new Date(t),a={month:"short",year:"numeric"};return s.toLocaleDateString("en-US",a)}function Ad(t){return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toLocaleString()}const Xd={Explorer:{bg:"bg-emerald-100",text:"text-emerald-700",ring:"ring-emerald-200"},Silver:{bg:"bg-slate-200",text:"text-slate-700",ring:"ring-slate-300"},Gold:{bg:"bg-amber-100",text:"text-amber-700",ring:"ring-amber-200"},Platinum:{bg:"bg-blue-100",text:"text-blue-700",ring:"ring-blue-200"},Ultimate:{bg:"bg-violet-100",text:"text-violet-700",ring:"ring-violet-200"}},Ed=({userEmail:t,currentStatus:s,milestones:a})=>{const n=t?t.split("@")[0]:"Flying Blue Member",l=Xd[s];return e.jsx("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6 sm:p-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-6",children:[e.jsx("div",{className:`w-20 h-20 rounded-2xl ${l.bg} flex items-center justify-center ring-4 ${l.ring}`,children:s==="Ultimate"?e.jsx(ze,{size:36,className:l.text}):e.jsx(Jt,{size:36,className:l.text})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-1",children:n}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Flying Blue Member"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center sm:justify-start gap-3",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-semibold ${l.bg} ${l.text}`,children:[e.jsx(De,{size:14}),s]}),a.memberSince&&e.jsxs("span",{className:"text-sm text-slate-500",children:["Member since ",a.memberSince]}),a.currentStreak>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-sm text-orange-600 font-medium",children:[e.jsx(da,{size:14,className:"text-orange-500"}),a.currentStreak," year streak"]})]})]})]})})},Js=({icon:t,label:s,value:a,sublabel:n,color:l="blue"})=>{const r={blue:"from-blue-500 to-indigo-500",amber:"from-amber-500 to-orange-500",emerald:"from-emerald-500 to-teal-500",violet:"from-violet-500 to-purple-500",slate:"from-slate-500 to-gray-500"};return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${r[l]} flex items-center justify-center shadow-lg`,children:t}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:s})]}),e.jsx("p",{className:"text-3xl font-black text-slate-800",children:typeof a=="number"?Ad(a):a}),n&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:n})]})},Dd=({stats:t})=>e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Js,{icon:e.jsx(Pt,{size:20,className:"text-white"}),label:"Total XP",value:t.totalXP,sublabel:"lifetime earned",color:"blue"}),e.jsx(Js,{icon:e.jsx(Ge,{size:20,className:"text-white"}),label:"Miles Earned",value:t.totalMilesEarned,sublabel:"all time",color:"amber"}),e.jsx(Js,{icon:e.jsx(le,{size:20,className:"text-white"}),label:"Flights",value:t.totalFlights,sublabel:"tracked",color:"emerald"}),e.jsx(Js,{icon:e.jsx(Je,{size:20,className:"text-white"}),label:"Avg XP/Flight",value:t.avgXpPerFlight,sublabel:"per segment",color:"violet"})]}),Bd=({efficiency:t})=>{const s=t.score>=7?"text-emerald-600":t.score>=5?"text-amber-600":"text-slate-600",a=t.score>=7?"from-emerald-500 to-teal-500":t.score>=5?"from-amber-500 to-orange-500":"from-slate-400 to-gray-400";return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"XP Efficiency Score"}),e.jsx("button",{className:"text-slate-400 hover:text-slate-600 transition-colors",title:"How is this calculated?",children:e.jsx(vt,{size:16})})]}),e.jsxs("div",{className:"flex items-end gap-4 mb-4",children:[e.jsx("span",{className:`text-5xl font-black ${s}`,children:t.score.toFixed(1)}),e.jsx("span",{className:"text-xl text-slate-400 font-medium mb-1",children:"/ 10"})]}),e.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden mb-4",children:e.jsx("div",{className:`h-full bg-gradient-to-r ${a} rounded-full transition-all duration-500`,style:{width:`${t.score*10}%`}})}),e.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed",children:['"',t.insight,'"']})]})},Wt=({label:t,percentage:s,color:a})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsxs("span",{className:"font-semibold text-slate-800",children:[s,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${a} rounded-full transition-all duration-500`,style:{width:`${s}%`}})})]}),Rd=({cabinMix:t})=>{const s=t.business+t.first;let a="";return s>=30?a=`ð¡ ${s}% premium is excellent! Top tier XP earning.`:s>=15?a=`ð¡ ${s}% premium is good! Room to grow for more XP.`:s>0?a="ð¡ Consider more Business class for 2x XP earnings.":a="ð¡ Business class earns 2x the XP of Economy!",e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-4",children:"Cabin Class Mix"}),e.jsxs("div",{className:"space-y-3",children:[t.economy>0&&e.jsx(Wt,{label:"Economy",percentage:t.economy,color:"bg-slate-400"}),t.premiumEconomy>0&&e.jsx(Wt,{label:"Premium Economy",percentage:t.premiumEconomy,color:"bg-emerald-500"}),t.business>0&&e.jsx(Wt,{label:"Business",percentage:t.business,color:"bg-blue-500"}),t.first>0&&e.jsx(Wt,{label:"First",percentage:t.first,color:"bg-violet-500"})]}),a&&e.jsx("p",{className:"text-sm text-slate-600 mt-4 pt-4 border-t border-slate-100",children:a})]})},_d=({airlineMixCycle:t,airlineMixPast12:s})=>{const[a,n]=Ue.useState("cycle"),l=a==="cycle"?t:s,r=l.kl+l.af;let i="";return r>=80?i=`${r}% of your flights are on KLM/Air France.`:r>=40?i=`${r}% KLM/AF, ${100-r}% partner airlines.`:r>0?i=`Mostly partner airlines (${100-r}%), with some KLM/AF.`:i="All flights on SkyTeam partner airlines.",e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Airline Mix"}),e.jsxs("div",{className:"flex bg-slate-100 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>n("cycle"),className:`px-2.5 py-1 text-[10px] font-semibold rounded-md transition-all ${a==="cycle"?"bg-white text-slate-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"This Cycle"}),e.jsx("button",{onClick:()=>n("past12"),className:`px-2.5 py-1 text-[10px] font-semibold rounded-md transition-all ${a==="past12"?"bg-white text-slate-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Past 12 Mo"})]})]}),e.jsxs("div",{className:"space-y-3",children:[l.kl>0&&e.jsx(Wt,{label:"KLM",percentage:l.kl,color:"bg-sky-500"}),l.af>0&&e.jsx(Wt,{label:"Air France",percentage:l.af,color:"bg-red-500"}),l.partners>0&&e.jsx(Wt,{label:"Partners",percentage:l.partners,color:"bg-slate-400"}),l.kl===0&&l.af===0&&l.partners===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No flights in this period"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-4 pt-4 border-t border-slate-100",children:i})]})},Ud=({uxpStats:t,currentStatus:s})=>{const a=s==="Ultimate",n=a?"to maintain Ultimate":"to reach Ultimate",l=Math.max(0,t.targetUXP-t.uxpThisCycle),r=t.klAfFlightCount>0?Math.round(t.totalUXP/t.klAfFlightCount):25,i=r>0?Math.ceil(l/r):0;let x="",c="text-slate-600";return t.progressPercentage>=100?(x=a?"â Ultimate status secured!":"â Ultimate unlocked!",c="text-emerald-600"):t.progressPercentage>=70?(x=`Almost there! ${l} UXP to go.`,c="text-blue-600"):t.progressPercentage>=40?(x=`On track â ~${i} more KLM/AF flights needed.`,c="text-amber-600"):(x=`${i} KLM/AF flights needed ${n}.`,c="text-slate-500"),e.jsxs("div",{className:"bg-gradient-to-br from-violet-50 to-purple-50 rounded-2xl border border-violet-100 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{size:18,className:"text-violet-600"}),e.jsx("h3",{className:"text-xs font-bold text-violet-600 uppercase tracking-wide",children:"Ultimate Progress"})]}),e.jsx("span",{className:"text-xs text-violet-500 font-medium",children:"This cycle"})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[e.jsx("span",{className:"text-4xl font-black text-violet-700",children:t.uxpThisCycle.toLocaleString()}),e.jsxs("span",{className:"text-lg text-violet-400 font-medium",children:["/ ",t.targetUXP.toLocaleString()," UXP"]})]}),e.jsx("div",{className:"h-3 bg-violet-100 rounded-full overflow-hidden mb-4",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-violet-500 to-purple-500 rounded-full transition-all duration-500",style:{width:`${Math.min(100,t.progressPercentage)}%`}})}),e.jsx("p",{className:`text-sm font-medium ${c}`,children:x}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-violet-100 flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-violet-600",children:[e.jsx("strong",{children:t.klAfFlightCount})," KLM/AF flights"]}),e.jsxs("span",{className:"text-slate-400",children:[t.partnerFlightCount," partner flights"]})]}),r>0&&t.klAfFlightCount>0&&e.jsxs("span",{className:"text-violet-500",children:["~",r," UXP/flight avg"]})]})]})},Td=({milestones:t,currentStatus:s})=>{const n=["Explorer","Silver","Gold","Platinum","Ultimate"].indexOf(s),l=[{status:"First Flight",date:t.firstFlight,icon:le,achieved:!!t.firstFlight},{status:"Silver",date:t.silverReached,icon:fi,achieved:n>=1},{status:"Gold",date:t.goldReached,icon:ws,achieved:n>=2},{status:"Platinum",date:t.platinumReached,icon:De,achieved:n>=3},{status:"Ultimate",date:t.ultimateReached,icon:ze,achieved:n>=4}];return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-6",children:"Your Journey"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-0 right-0 h-1 bg-slate-100 rounded-full"}),e.jsx("div",{className:"absolute top-4 left-0 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full transition-all duration-500",style:{width:`${Math.max(0,n/4*100)}%`}}),e.jsx("div",{className:"relative flex justify-between",children:l.map((r,i)=>{const x=r.icon,c=r.achieved,o=r.status===s||r.status==="First Flight"&&i===0&&n>=0;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all ${c?"bg-gradient-to-br from-blue-500 to-indigo-500 text-white shadow-lg":"bg-slate-100 text-slate-400"} ${o?"ring-4 ring-blue-100":""}`,children:e.jsx(x,{size:14})}),e.jsx("span",{className:`text-[10px] mt-2 font-semibold ${c?"text-slate-700":"text-slate-400"}`,children:r.status}),r.date&&e.jsx("span",{className:"text-[9px] text-slate-400 mt-0.5",children:Fd(r.date)})]},r.status)})})]}),t.currentStreak>1&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-100 flex items-center gap-2",children:[e.jsx(da,{size:16,className:"text-orange-500"}),e.jsxs("span",{className:"text-sm text-slate-600",children:[t.currentStreak," year ",s," streak"]})]})]})},zd=({facts:t})=>t.length===0?null:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-4",children:"Fun Facts"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:s.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:s.label}),e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:s.value})]})]},a))})]}),Id=({onOpenSettings:t})=>e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-4",children:"Settings"}),e.jsxs("button",{onClick:t,className:"w-full flex items-center justify-between px-4 py-3 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ca,{size:18,className:"text-slate-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Manage Data Settings"})]}),e.jsx(we,{size:18,className:"text-slate-400 group-hover:translate-x-1 transition-transform"})]}),e.jsxs("div",{className:"flex gap-3 mt-3",children:[e.jsxs("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border border-slate-200 hover:bg-slate-50 transition-colors text-sm font-medium text-slate-600",children:[e.jsx(vs,{size:16}),"Export"]}),e.jsxs("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border border-slate-200 hover:bg-slate-50 transition-colors text-sm font-medium text-slate-600",children:[e.jsx(St,{size:16}),"Import"]})]})]}),Ld=({onOpenSettings:t})=>e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{size:28,className:"text-slate-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"No flights yet"}),e.jsx("p",{className:"text-sm text-slate-500 mb-6 max-w-sm mx-auto",children:"Import your Flying Blue activity to see your loyalty profile, including lifetime stats, efficiency score, and milestones."}),e.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold rounded-xl shadow-lg shadow-blue-500/25 hover:shadow-xl hover:shadow-blue-500/30 transition-all",children:[e.jsx(St,{size:16}),"Import Data"]})]}),$d=({flights:t,xpData:s,milesData:a,currentStatus:n,qualificationSettings:l,onOpenSettings:r,userEmail:i})=>{const x=d.useMemo(()=>vd(t,s,a),[t,s,a]),c=d.useMemo(()=>Dr(t),[t]),o=d.useMemo(()=>Sd(t,l?.cycleStartMonth),[t,l?.cycleStartMonth]),u=d.useMemo(()=>Pd(t),[t]),m=d.useMemo(()=>kd(t),[t]),p=d.useMemo(()=>Cd(t,s),[t,s]),h=d.useMemo(()=>Md(t),[t]),b=d.useMemo(()=>wd(t,l?.cycleStartMonth),[t,l?.cycleStartMonth]),g=x.totalXP,S=n==="Ultimate"||n==="Platinum"&&g>=600;return t.length===0?e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Profile"}),e.jsx(Ld,{onOpenSettings:r})]}):e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Profile"}),e.jsx(Ed,{userEmail:i,currentStatus:n,milestones:p}),e.jsx(Dd,{stats:x}),S&&e.jsx(Ud,{uxpStats:b,currentStatus:n}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx(Bd,{efficiency:m}),h.length>0&&e.jsx(zd,{facts:h})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx(Rd,{cabinMix:c}),e.jsx(_d,{airlineMixCycle:o,airlineMixPast12:u})]}),e.jsx(Td,{milestones:p,currentStatus:n}),e.jsx(Id,{onOpenSettings:r})]})},Od=d.lazy(()=>ia(()=>Promise.resolve().then(()=>kr),void 0)),Gd=()=>e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 flex items-center gap-3",children:[e.jsx(Qe,{size:24,className:"animate-spin text-blue-500"}),e.jsx("span",{className:"text-slate-600",children:"Loading..."})]})}),Kd=({isOpen:t,onClose:s,data:a,setters:n,onReset:l,onLoadDemo:r,onStartOver:i,onRerunOnboarding:x,onUndoImport:c,canUndoImport:o=!1,importBackupInfo:u,emailConsent:m=!1,onEmailConsentChange:p,isDemoMode:h=!1,isLocalMode:b=!1,onExitDemo:g,isLoggedIn:S=!1,markDataChanged:P,forceSave:C,handleJsonImport:w,showToast:f})=>{const D=d.useRef(null),{signOut:_,user:N,deleteAccount:F}=Us(),{trackExport:j,trackImport:v}=rt(),[A,R]=d.useState(!1),[X,L]=d.useState(!1),[G,k]=d.useState(""),[I,y]=d.useState(!1),U=d.useMemo(()=>Yt(a.qualificationSettings??null),[a.qualificationSettings]),{cycles:M}=d.useMemo(()=>Lt(a.baseXpData,a.xpRollover,a.flights,a.manualLedger,U),[a.baseXpData,a.xpRollover,a.flights,a.manualLedger,U]),z=d.useMemo(()=>us(M),[M]);if(!t)return null;const K=()=>{try{const se=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),Z=URL.createObjectURL(se),ee=document.createElement("a");ee.href=Z;const T=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");ee.download=`skystatus-backup-${T}.json`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(Z),j()}catch(se){console.error("Export failed",se),f&&f("Export failed. Please try again.","error")}},Y=()=>{D.current?.click()},O=async se=>{const Z=se.target.files?.[0];if(Z)try{const ee=await Z.text(),T=JSON.parse(ee),ce={miles:T.baseMilesData?.length||0,flights:T.flights?.length||0,redemptions:T.redemptions?.length||0,manualLedgerMonths:T.manualLedger?Object.keys(T.manualLedger).length:0};if(w){if(!await w({flights:T.flights,baseMilesData:T.baseMilesData,baseXpData:T.baseXpData,redemptions:T.redemptions,manualLedger:T.manualLedger,qualificationSettings:T.qualificationSettings,xpRollover:T.xpRollover})){f&&f("Import failed: Could not save to database","error");return}}else T.baseMilesData&&n.setBaseMilesData(T.baseMilesData),T.baseXpData&&n.setBaseXpData(T.baseXpData),T.flights&&n.setFlights(T.flights),T.redemptions&&n.setRedemptions(T.redemptions),T.manualLedger&&n.setManualLedger(T.manualLedger),T.qualificationSettings&&n.setQualificationSettings(T.qualificationSettings),typeof T.xpRollover=="number"&&n.setXpRollover(T.xpRollover),T.currentMonth&&n.setCurrentMonth(T.currentMonth);v(ce.flights,ce.redemptions,ce.miles);const fe=[];ce.miles>0&&fe.push(`${ce.miles} miles entries`),ce.flights>0&&fe.push(`${ce.flights} flights`),ce.redemptions>0&&fe.push(`${ce.redemptions} redemptions`),ce.manualLedgerMonths>0&&fe.push(`${ce.manualLedgerMonths} manual ledger months`);const Te=!h&&!b&&S?" Reloading...":"",Me=fe.length>0?`Import completed! Restored: ${fe.join(", ")}.${Te}`:`Import completed. Data restored successfully.${Te}`;f&&f(Me,"success"),!h&&!b&&S?setTimeout(()=>{window.location.reload()},500):s()}catch(ee){console.error("Import failed",ee),f&&f("Import failed. Make sure you selected a valid SkyStatus JSON file.","error")}finally{D.current&&(D.current.value="")}},V=(se,Z,ee,T,ce)=>{const fe=new Set(a.flights.map(ie=>`${ie.date}-${ie.route}`)),Se=se.filter(ie=>!fe.has(`${ie.date}-${ie.route}`));if(Se.length>0&&n.setFlights(ie=>[...ie,...Se]),Z.length>0){const ie=new Map(a.baseMilesData.map((be,ve)=>[be.month,ve])),ue=[...a.baseMilesData];for(const be of Z){const ve=ie.get(be.month);ve!==void 0?ue[ve]={...ue[ve],...be,id:ue[ve].id}:ue.push(be)}n.setBaseMilesData(ue)}T&&n.setQualificationSettings({cycleStartMonth:T.cycleStartMonth,cycleStartDate:T.cycleStartDate,startingStatus:T.startingStatus,startingXP:T.startingXP??0}),ce&&Object.keys(ce).length>0&&n.setManualLedger(ie=>{const ue={...ie};for(const[be,ve]of Object.entries(ce))ue[be]={...ue[be]||{amexXp:0,bonusSafXp:0,miscXp:0,correctionXp:0},miscXp:ve};return ue}),P&&P();const Te=Z.filter(ie=>!a.baseMilesData.some(ue=>ue.month===ie.month)).length;let Me="Flying Blue import completed!";const H=[];Se.length>0&&H.push(`${Se.length} flights`),Te>0&&H.push(`${Te} months of miles`),T&&H.push(`cycle: ${T.startingStatus}`),H.length>0&&(Me+=` Added: ${H.join(", ")}`),f&&f(Me,"success"),s()},J=()=>{r(),s()},q=()=>{if(i)i();else{if(!window.confirm("Are you sure you want to start over? This wipes all data."))return;localStorage.clear(),window.location.reload()}},B=async()=>{await _(),s()},$=()=>{g&&(g(),s())},Q=async()=>{if(G==="DELETE"){y(!0);try{const{error:se}=await F();se?(f&&f("Failed to delete account. Please try again.","error"),console.error("Delete account error:",se)):(localStorage.clear(),s(),window.location.reload())}catch(se){f&&f("Failed to delete account. Please try again.","error"),console.error("Delete account error:",se)}finally{y(!1)}}},oe=()=>b?"Local mode â export to save your data":h?"Demo mode â data is temporary":"Manage your portfolio";return e.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-slate-900/70 backdrop-blur-sm",children:[e.jsxs("div",{className:"bg-white w-full max-w-lg max-h-[90vh] rounded-3xl shadow-2xl border border-slate-100 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-2xl flex items-center justify-center ${b?"bg-amber-50":"bg-indigo-50"}`,children:e.jsx(ji,{className:b?"text-amber-500":"text-indigo-500",size:18})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-slate-900",children:"Data Settings"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:oe()})]})]}),e.jsx("button",{onClick:s,className:"p-1.5 rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(Ce,{size:18})})]}),e.jsxs("div",{className:"px-6 py-5 pb-6 space-y-6 overflow-y-auto custom-scrollbar",children:[S&&N&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-400 mb-3",children:"Account"}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3.5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-blue-100",children:e.jsx(Jt,{className:"text-blue-600",size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:N.email}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Signed in â¢ Auto-save enabled"})]})]}),e.jsx("button",{onClick:B,className:"p-2 rounded-xl hover:bg-slate-200 text-slate-500 hover:text-slate-700 transition-colors",title:"Sign out",children:e.jsx(cn,{size:16})})]})]}),b&&e.jsxs("div",{className:"rounded-2xl border border-amber-300 bg-amber-50 px-4 py-3.5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-amber-200 flex-shrink-0",children:e.jsx(_e,{className:"text-amber-700",size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-amber-900",children:"Local Mode â Data Not Saved"}),e.jsxs("p",{className:"text-[11px] text-amber-700 mt-0.5",children:["Your data will be lost when you close the browser. Use ",e.jsx("span",{className:"font-bold",children:"Export JSON"})," below to save your work, or sign in for automatic cloud sync."]})]})]}),g&&e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{onClick:K,className:"flex-1 px-3 py-2 rounded-xl bg-amber-200 hover:bg-amber-300 text-amber-800 text-xs font-semibold transition-colors",children:"Export Now"}),e.jsx("button",{onClick:$,className:"px-3 py-2 rounded-xl bg-white border border-amber-300 hover:bg-amber-100 text-amber-800 text-xs font-semibold transition-colors",children:"Sign In Instead"})]})]}),h&&!b&&e.jsx("div",{className:"rounded-2xl border border-indigo-200 bg-indigo-50 px-4 py-3.5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-indigo-800",children:"Demo Mode Active"}),e.jsxs("p",{className:"text-[11px] text-indigo-600",children:["Exploring with sample data. ",S?"Exit to use your account.":"Sign in to save your data."]})]}),g&&e.jsx("button",{onClick:$,className:"px-3 py-1.5 rounded-xl bg-indigo-200 hover:bg-indigo-300 text-indigo-800 text-xs font-semibold transition-colors",children:"Exit Demo"})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-400 mb-3",children:"Import from Flying Blue"}),e.jsxs("button",{onClick:()=>R(!0),className:"w-full rounded-2xl border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 transition-all px-4 py-5 flex items-center gap-4",children:[e.jsx("span",{className:"inline-flex h-12 w-12 items-center justify-center rounded-xl bg-blue-500 shadow-lg shadow-blue-200",children:e.jsx(wt,{className:"text-white",size:24})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-bold text-slate-800",children:"Import Flying Blue PDF"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Upload your transaction history from flyingblue.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-400 mb-3",children:"Preferences"}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-slate-100",children:e.jsx(el,{className:"text-slate-600",size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:"Currency"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"For all costs and valuations"})]})]}),e.jsx("select",{value:a.currency,onChange:se=>n.setCurrency(se.target.value),className:"px-3 py-2 text-sm font-medium border border-slate-200 rounded-xl bg-slate-50 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent cursor-pointer",children:na.map(se=>e.jsxs("option",{value:se.code,children:[se.symbol," ",se.code," - ",se.label]},se.code))})]}),S&&x&&e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-indigo-100",children:e.jsx(Be,{className:"text-indigo-600",size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:"Setup Wizard"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Go through initial setup again"})]})]}),e.jsx("button",{onClick:()=>{x(),s()},className:"px-3 py-2 text-xs font-semibold text-indigo-600 border border-indigo-200 rounded-xl bg-indigo-50 hover:bg-indigo-100 transition-colors",children:"Re-run"})]}),S&&p&&e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-violet-100",children:e.jsx(as,{className:"text-violet-600",size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:"Email Updates"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Receive product news and tips"})]})]}),e.jsx("button",{onClick:()=>{p(!m),f?.(m?"Unsubscribed from email updates":"Subscribed to email updates","success")},className:`px-3 py-2 text-xs font-semibold rounded-xl transition-colors ${m?"text-violet-600 border border-violet-200 bg-violet-50 hover:bg-violet-100":"text-slate-500 border border-slate-200 bg-slate-50 hover:bg-slate-100"}`,children:m?"Subscribed â":"Subscribe"})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-400 mb-3",children:"Qualification Cycle"}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-blue-100",children:e.jsx(De,{className:"text-blue-600",size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:"Starting Status"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Your status when the cycle began"})]})]}),e.jsxs("select",{value:a.qualificationSettings?.startingStatus??"Explorer",onChange:se=>{const Z=se.target.value;n.setQualificationSettings(ee=>({cycleStartMonth:ee?.cycleStartMonth??new Date().toISOString().slice(0,7),cycleStartDate:ee?.cycleStartDate,startingStatus:Z,startingXP:ee?.startingXP??0,startingUXP:ee?.startingUXP,ultimateCycleType:ee?.ultimateCycleType})),P?.()},className:"px-3 py-2 text-sm font-medium border border-slate-200 rounded-xl bg-slate-50 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent cursor-pointer",children:[e.jsx("option",{value:"Explorer",children:"Explorer"}),e.jsx("option",{value:"Silver",children:"Silver"}),e.jsx("option",{value:"Gold",children:"Gold"}),e.jsx("option",{value:"Platinum",children:"Platinum"}),e.jsx("option",{value:"Ultimate",children:"Ultimate"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-indigo-100",children:e.jsx(et,{className:"text-indigo-600",size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:"Cycle Start Date"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:a.qualificationSettings?.cycleStartDate?"Flights before this date are excluded from XP":"Set the exact date you achieved your status"})]})]}),e.jsx("input",{type:"date",value:a.qualificationSettings?.cycleStartDate??"",onChange:se=>{const Z=se.target.value,ee=Z?Z.slice(0,7):a.qualificationSettings?.cycleStartMonth;n.setQualificationSettings(T=>({cycleStartMonth:ee??T?.cycleStartMonth??new Date().toISOString().slice(0,7),cycleStartDate:Z||void 0,startingStatus:T?.startingStatus??"Explorer",startingXP:T?.startingXP??0,startingUXP:T?.startingUXP,ultimateCycleType:T?.ultimateCycleType})),P?.()},className:"px-3 py-2 text-sm font-medium border border-slate-200 rounded-xl bg-slate-50 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent cursor-pointer"})]}),a.qualificationSettings?.cycleStartDate&&e.jsxs("div",{className:"bg-blue-50 rounded-xl px-3 py-2 text-xs text-blue-700",children:[e.jsx("strong",{children:"Note:"})," Flights before ",new Date(a.qualificationSettings.cycleStartDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})," will not count toward your current cycle's XP."]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-400 mb-3",children:"Backup & Restore"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:K,className:`w-full rounded-2xl border transition-colors px-4 py-4 flex flex-col items-center justify-center gap-2 ${b?"border-amber-200 bg-amber-50 hover:bg-amber-100":"border-slate-200 bg-slate-50 hover:bg-slate-100"}`,children:[e.jsx("span",{className:`inline-flex h-9 w-9 items-center justify-center rounded-xl ${b?"bg-amber-200":"bg-indigo-100"}`,children:e.jsx(vs,{className:b?"text-amber-700":"text-indigo-600",size:18})}),e.jsx("span",{className:`text-xs font-semibold ${b?"text-amber-800":"text-slate-800"}`,children:"Export JSON"})]}),e.jsxs("button",{onClick:Y,className:"w-full rounded-2xl border border-slate-200 bg-slate-50 hover:bg-slate-100 transition-colors px-4 py-4 flex flex-col items-center justify-center gap-2",children:[e.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-xl bg-emerald-100",children:e.jsx(St,{className:"text-emerald-600",size:18})}),e.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Import JSON"})]})]}),e.jsx("input",{ref:D,type:"file",accept:"application/json",className:"hidden",onChange:O})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-400 mb-3",children:"Data Actions"}),h&&e.jsx("button",{onClick:J,className:"w-full mb-2 rounded-2xl border border-slate-200 bg-white hover:bg-slate-50 transition-colors px-4 py-3.5 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-slate-100",children:e.jsx(za,{className:"text-slate-700",size:16})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-800",children:"Reload Demo Data"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Restore the original sample portfolio."})]})]})}),o&&c&&e.jsx("button",{onClick:()=>{if(window.confirm("Restore data from before your last PDF import? This will undo the import.")){const se=c();se&&f?f("Import undone - data restored","success"):!se&&f&&f("Could not restore backup","error")}},className:"w-full rounded-2xl border border-amber-100 bg-amber-50 hover:bg-amber-100 transition-colors px-4 py-3.5 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-amber-100",children:e.jsx(za,{className:"text-amber-600",size:16})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs font-semibold text-amber-700",children:"Undo Last Import"}),e.jsx("p",{className:"text-[11px] text-amber-500",children:"Restore data from before your last PDF import."})]})]})}),e.jsx("button",{onClick:q,className:"w-full rounded-2xl border border-red-100 bg-red-50 hover:bg-red-100 transition-colors px-4 py-3.5 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-red-100",children:e.jsx(ss,{className:"text-red-600",size:16})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs font-semibold text-red-700",children:"Start Over"}),e.jsx("p",{className:"text-[11px] text-red-500",children:"Wipe data and restart application."})]})]})})]}),S&&!h&&!b&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-red-200",children:[e.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-red-500 mb-3",children:"Danger Zone"}),X?e.jsxs("div",{className:"rounded-2xl border-2 border-red-300 bg-red-50 p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-xl bg-red-100 shrink-0",children:e.jsx(_e,{className:"text-red-600",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-red-800 mb-1",children:"Are you absolutely sure?"}),e.jsxs("p",{className:"text-xs text-red-700 leading-relaxed",children:["This action ",e.jsx("span",{className:"font-bold",children:"cannot be undone"}),". This will permanently delete your account and remove all your data from our servers."]})]})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 mb-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(vs,{className:"text-amber-600 shrink-0 mt-0.5",size:14}),e.jsxs("p",{className:"text-xs text-amber-800",children:[e.jsx("span",{className:"font-bold",children:"Recommended:"}),' Export your data first using the "Export JSON" button above. Once deleted, your data cannot be recovered.']})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs font-semibold text-red-700 mb-1.5",children:["Type ",e.jsx("span",{className:"font-mono bg-red-100 px-1.5 py-0.5 rounded",children:"DELETE"})," to confirm:"]}),e.jsx("input",{type:"text",value:G,onChange:se=>k(se.target.value.toUpperCase()),placeholder:"DELETE",className:"w-full px-3 py-2 text-sm border-2 border-red-200 rounded-lg focus:border-red-400 focus:outline-none font-mono"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{L(!1),k("")},className:"flex-1 px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Q,disabled:G!=="DELETE"||I,className:"flex-1 px-4 py-2 text-sm font-bold text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:I?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"â³"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(gl,{size:14}),"Delete My Account"]})})]})]}):e.jsx("button",{onClick:()=>L(!0),className:"w-full rounded-2xl border-2 border-red-200 bg-white hover:bg-red-50 transition-colors px-4 py-3.5 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-red-100",children:e.jsx(gl,{className:"text-red-600",size:16})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs font-semibold text-red-700",children:"Delete Account"}),e.jsx("p",{className:"text-[11px] text-red-500",children:"Permanently delete your account and all data."})]})]})})]})]})]}),A&&e.jsx(d.Suspense,{fallback:e.jsx(Gd,{}),children:e.jsx(Od,{isOpen:A,onClose:()=>R(!1),onImport:V,existingFlights:a.flights,existingMiles:a.baseMilesData,existingQualificationSettings:a.qualificationSettings,existingStatus:a.qualificationSettings?.startingStatus||null,existingActiveCycleStart:z?.startDate?.slice(0,7)||null,existingRolloverXP:z?.rolloverIn??null})})]})},Yd=[{value:"Explorer",label:"Explorer",xpRequired:0},{value:"Silver",label:"Silver",xpRequired:100},{value:"Gold",label:"Gold",xpRequired:180},{value:"Platinum",label:"Platinum",xpRequired:300},{value:"Ultimate",label:"Ultimate",xpRequired:400}],qd=[{value:.008,label:"Conservative",description:"Easy economy redemptions"},{value:.012,label:"Average",description:"Typical good deals"},{value:.018,label:"Aspirational",description:"Premium cabin long-haul"}],Vd=["AMS","CDG"],Hd=({value:t,onChange:s})=>{const[a,n]=d.useState(!1),[l,r]=d.useState(""),i=d.useRef(null),x=d.useMemo(()=>{const o=Object.entries(dt).map(([m,p])=>({code:m,name:p.name,country:p.country,isPriority:Vd.includes(m)}));return(l?o.filter(m=>m.code.toLowerCase().includes(l.toLowerCase())||m.name.toLowerCase().includes(l.toLowerCase())):o).sort((m,p)=>m.isPriority&&!p.isPriority?-1:!m.isPriority&&p.isPriority?1:m.code.localeCompare(p.code))},[l]),c=t?dt[t]:null;return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>{n(!a),setTimeout(()=>i.current?.focus(),100)},className:"w-full p-3 bg-white border border-slate-200 rounded-xl text-left flex items-center justify-between hover:border-slate-300 transition-colors",children:[t&&c?e.jsxs("span",{className:"font-medium text-slate-800",children:[t," - ",c.name]}):e.jsx("span",{className:"text-slate-400",children:"Select your home airport (optional)"}),e.jsx(we,{size:18,className:`text-slate-400 transition-transform ${a?"rotate-90":""}`})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)}),e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-xl z-50 max-h-80 overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-2 border-b border-slate-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(ds,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{ref:i,type:"text",placeholder:"Search airports...",value:l,onChange:o=>r(o.target.value),className:"w-full pl-9 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none focus:border-blue-300 focus:ring-2 focus:ring-blue-100"})]})}),e.jsxs("div",{className:"overflow-y-auto flex-1",children:[e.jsx("button",{type:"button",onClick:()=>{s(null),n(!1),r("")},className:"w-full px-4 py-2.5 text-left text-sm text-slate-500 hover:bg-slate-50 transition-colors",children:"No home airport"}),x.slice(0,100).map(o=>e.jsxs("button",{type:"button",onClick:()=>{s(o.code),n(!1),r("")},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-slate-50 transition-colors flex items-center gap-2 ${t===o.code?"bg-blue-50 text-blue-700":"text-slate-700"}`,children:[o.isPriority&&e.jsx(Rs,{size:12,className:"text-amber-500 fill-amber-500"}),e.jsx("span",{className:"font-mono font-medium",children:o.code}),e.jsx("span",{className:"text-slate-500 truncate",children:o.name})]},o.code)),x.length>100&&e.jsx("div",{className:"px-4 py-2 text-xs text-slate-400 text-center",children:"Type to search more airports..."})]})]})]})]})},Wd=({userEmail:t,onComplete:s,onPdfImport:a,pdfImportResult:n,onSkip:l,isReturningUser:r=!1,existingData:i})=>{const{trackOnboarding:x,trackOnboardingStepComplete:c}=rt(),[o,u]=d.useState(0),[m,p]=d.useState(!1),[h,b]=d.useState(i?.currency||"EUR"),[g,S]=d.useState(i?.homeAirport||null),[P,C]=d.useState(i?.currentStatus||"Explorer"),[w,f]=d.useState(i?.currentXP||0),[D,_]=d.useState(i?.currentUXP||0),[N,F]=d.useState(i?.rolloverXP||0),[j,v]=d.useState(i?.milesBalance||0),[A,R]=d.useState(i?.ultimateCycleType||"qualification"),[X,L]=d.useState(i?.targetCPM||.012),[G,k]=d.useState(i?.emailConsent||!1),I=na.find(B=>B.code===h)?.symbol||"â¬",y=n&&n.statusDetected,U=m||!y;Ue.useEffect(()=>{n&&(n.statusDetected&&C(n.statusDetected),n.xpDetected>0&&f(n.xpDetected),n.milesBalance>0&&v(n.milesBalance))},[n]);const M=[{id:"welcome",title:"Welcome"},{id:"import",title:"Import"},...U?[{id:"status",title:"Status"}]:[],{id:"valuation",title:"Valuation"},{id:"email",title:"Updates"},{id:"done",title:"Done"}],z=M.length,K=()=>{if(o<z-1){const B=M[o];B&&c(o+1,B.id),u(o+1)}},Y=()=>{o>0&&u(o-1)},O=()=>{p(!0),K()},V=()=>{x(!!n,(n?.flightsCount||0)>0),s({currency:h,homeAirport:g,currentStatus:P,currentXP:w,currentUXP:D,rolloverXP:N,milesBalance:j,ultimateCycleType:A,targetCPM:X,emailConsent:G,pdfImported:!!n,pdfFlightsCount:n?.flightsCount||0,isReturningUser:r})},J="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",q=()=>{switch(M[o]?.id){case"welcome":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(le,{className:"text-white transform -rotate-45",size:32})}),e.jsx("h2",{className:"text-2xl font-black text-slate-900 mb-2",children:r?"Welcome Back!":"Welcome to SkyStatus Pro!"}),e.jsx("p",{className:"text-slate-500",children:r?"Let's update your preferences.":"Let's personalize your experience in a few quick steps."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:[e.jsx(el,{size:14,className:"inline mr-2"}),"Currency"]}),e.jsx("select",{value:h,onChange:$=>b($.target.value),className:"w-full p-3 bg-white border border-slate-200 rounded-xl text-slate-800 font-medium focus:ring-2 focus:ring-blue-100 focus:border-blue-300 outline-none",children:na.map($=>e.jsxs("option",{value:$.code,children:[$.symbol," ",$.code," - ",$.name]},$.code))}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Used for all costs and valuations"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:[e.jsx(le,{size:14,className:"inline mr-2"}),"Home Airport"]}),e.jsx(Hd,{value:g,onChange:S,currencySymbol:I}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Useful for mileage run suggestions (optional)"})]})]})]});case"import":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(wt,{className:"text-blue-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Import Your Flying Blue Data"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"The fastest way to get started â upload your activity statement and we'll import everything automatically."})]}),n?e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx(ct,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-emerald-800",children:"Import Successful!"}),e.jsx("p",{className:"text-xs text-emerald-600",children:"Your data has been imported"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsx("p",{className:"text-emerald-600 text-xs font-medium",children:"Flights"}),e.jsx("p",{className:"font-bold text-emerald-800",children:n.flightsCount})]}),e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsx("p",{className:"text-emerald-600 text-xs font-medium",children:"XP Detected"}),e.jsx("p",{className:"font-bold text-emerald-800",children:n.xpDetected.toLocaleString()})]}),n.statusDetected&&e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsx("p",{className:"text-emerald-600 text-xs font-medium",children:"Status"}),e.jsx("p",{className:"font-bold text-emerald-800",children:n.statusDetected})]}),n.milesBalance>0&&e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsx("p",{className:"text-emerald-600 text-xs font-medium",children:"Miles Balance"}),e.jsx("p",{className:"font-bold text-emerald-800",children:n.milesBalance.toLocaleString()})]})]})]}):e.jsxs("button",{onClick:a,className:"w-full p-6 border-2 border-dashed border-blue-200 rounded-2xl hover:border-blue-400 hover:bg-blue-50/50 transition-all group",children:[e.jsx(St,{size:40,className:"text-blue-300 group-hover:text-blue-500 mx-auto mb-3 transition-colors"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Upload PDF"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"From flyingblue.com â My Account â Activity overview"})]})]});case"status":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Rs,{className:"text-indigo-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Your Flying Blue Status"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Tell us where you're at so we can track your progress."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Current Status"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Yd.map($=>e.jsx("button",{type:"button",onClick:()=>C($.value),className:`p-3 rounded-xl text-center transition-all ${P===$.value?"bg-indigo-600 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:e.jsx("p",{className:"font-bold text-xs",children:$.label})},$.value))})]}),P==="Ultimate"&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[e.jsxs("label",{className:"block text-sm font-bold text-amber-800 mb-3",children:[e.jsx(Nt,{size:14,className:"inline mr-2"}),"Ultimate Cycle Type"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white rounded-lg cursor-pointer hover:bg-amber-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"ultimateCycle",value:"qualification",checked:A==="qualification",onChange:()=>R("qualification"),className:"w-4 h-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Standard"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Follows qualification year (Nov-Oct)"})]})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white rounded-lg cursor-pointer hover:bg-amber-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"ultimateCycle",value:"calendar",checked:A==="calendar",onChange:()=>R("calendar"),className:"w-4 h-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Legacy"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Calendar year (Jan-Dec)"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"XP this qualification year"}),e.jsx("input",{type:"number",value:w||"",onChange:$=>f(Number($.target.value)),placeholder:"0",className:`w-full p-3 bg-white border border-slate-200 rounded-xl font-medium focus:ring-2 focus:ring-blue-100 focus:border-blue-300 outline-none ${J}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["Rollover XP",e.jsx("span",{className:"font-normal text-slate-400 ml-1",children:"(if known)"})]}),e.jsx("input",{type:"number",value:N||"",onChange:$=>F(Number($.target.value)),placeholder:"0",className:`w-full p-3 bg-white border border-slate-200 rounded-xl font-medium focus:ring-2 focus:ring-blue-100 focus:border-blue-300 outline-none ${J}`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Current miles balance"}),e.jsx("input",{type:"number",value:j||"",onChange:$=>v(Number($.target.value)),placeholder:"0",className:`w-full p-3 bg-white border border-slate-200 rounded-xl font-medium focus:ring-2 focus:ring-blue-100 focus:border-blue-300 outline-none ${J}`})]}),(P==="Platinum"||P==="Ultimate")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["UXP",e.jsx("span",{className:"font-normal text-slate-400 ml-1",children:"(Ultimate XP)"})]}),e.jsx("input",{type:"number",value:D||"",onChange:$=>_(Number($.target.value)),placeholder:"0",className:`w-full p-3 bg-white border border-slate-200 rounded-xl font-medium focus:ring-2 focus:ring-blue-100 focus:border-blue-300 outline-none ${J}`})]})]})]})]});case"valuation":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Je,{className:"text-emerald-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"How Do You Value Your Miles?"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"This affects portfolio calculations and ROI metrics."})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:qd.map($=>e.jsxs("button",{type:"button",onClick:()=>L($.value),className:`p-4 rounded-xl text-center transition-all ${Math.abs(X-$.value)<.001?"bg-emerald-600 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e.jsx("p",{className:"font-bold",children:$.label}),e.jsxs("p",{className:`text-lg font-black ${Math.abs(X-$.value)<.001?"text-white":"text-slate-800"}`,children:[I,$.value.toFixed(3)]}),e.jsx("p",{className:`text-[10px] mt-1 ${Math.abs(X-$.value)<.001?"text-emerald-200":"text-slate-400"}`,children:$.description})]},$.value))}),e.jsx("div",{className:"flex items-center gap-4 p-4 bg-slate-50 rounded-xl",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Or set a custom value"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-400 font-medium",children:I}),e.jsx("input",{type:"number",step:"0.001",value:X,onChange:$=>L(parseFloat($.target.value)||.012),className:`flex-1 p-2 bg-white border border-slate-200 rounded-lg font-bold text-slate-800 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-300 outline-none ${J}`}),e.jsx("span",{className:"text-slate-400 text-sm",children:"per mile"})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4",children:e.jsxs("p",{className:"text-xs text-blue-700",children:[e.jsx(Be,{size:12,className:"inline mr-1"}),e.jsx("strong",{children:"Tip:"})," This is the redemption value you aim for when booking award flights. Conservative (",I,"0.008) is easy to achieve, while aspirational (",I,"0.018+) requires strategic booking."]})})]});case"email":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-violet-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(as,{className:"text-violet-600",size:28})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Stay in the Loop"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Get occasional updates about new features."})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-slate-50 rounded-xl cursor-pointer hover:bg-slate-100 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:G,onChange:$=>k($.target.checked),className:"w-5 h-5 mt-0.5 rounded border-slate-300 text-violet-600 focus:ring-violet-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Yes, send me occasional product updates"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"New features, tips & tricks. No spam, unsubscribe anytime."})]})]}),e.jsx("div",{className:"bg-slate-100 rounded-xl p-4",children:e.jsxs("p",{className:"text-xs text-slate-500",children:["We'll only use your email (",e.jsx("strong",{children:t}),") for SkyStatus updates. See our"," ",e.jsx("a",{href:"/privacy",className:"text-blue-600 hover:underline",children:"Privacy Policy"}),"."]})})]});case"done":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(_a,{className:"text-white",size:32})}),e.jsx("h2",{className:"text-2xl font-black text-slate-900 mb-2",children:r?"Settings Updated!":"You're All Set!"}),e.jsx("p",{className:"text-slate-500",children:r?"Your new preferences":"Here's your setup summary"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-5 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Currency"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[I," ",h]})]}),g&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Home Airport"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[g," - ",dt[g]?.name]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Status"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[P,w>0&&` (${w.toLocaleString()} XP)`]})]}),j>0&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Miles Balance"}),e.jsx("span",{className:"font-bold text-slate-800",children:j.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Mile Valuation"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[I,X.toFixed(3)," per mile"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Email Updates"}),e.jsx("span",{className:"font-bold text-slate-800",children:G?"â Subscribed":"Not subscribed"})]})]})]});default:return null}};return e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-2 sm:p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] sm:max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"text-blue-600 transform -rotate-45",size:20}),e.jsx("span",{className:"font-bold text-slate-800",children:"SkyStatus Pro"})]}),l&&o<z-1&&e.jsx("button",{onClick:l,className:"p-1.5 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(Ce,{size:18})})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:M.map((B,$)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-all ${$===o?"w-6 bg-blue-600":$<o?"bg-blue-600":"bg-slate-200"}`},B.id))})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-6",children:q()}),e.jsx("div",{className:"p-4 border-t border-slate-100 bg-slate-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:Y,disabled:o===0,className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all ${o===0?"text-slate-300 cursor-not-allowed":"text-slate-600 hover:bg-slate-200"}`,children:[e.jsx(ts,{size:18}),"Back"]}),M[o]?.id!=="welcome"&&M[o]?.id!=="done"&&e.jsx("button",{onClick:M[o]?.id==="import"?O:K,className:"text-sm text-slate-400 hover:text-slate-600 transition-colors",children:"Skip"}),M[o]?.id==="done"?e.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl transition-all",children:[r?"Save & Close":"Start Exploring",e.jsx(_a,{size:18})]}):M[o]?.id==="import"&&n?e.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-6 py-2.5 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-700 transition-all",children:["Continue",e.jsx(we,{size:18})]}):e.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-all",children:["Continue",e.jsx(we,{size:18})]})]})})]})})},Jd=({onDemoMode:t,onLocalMode:s,onBack:a})=>{const{signIn:n,signUp:l,resetPassword:r,signInWithGoogle:i}=Us(),{trackAccessMode:x}=rt(),[c,o]=d.useState("login"),[u,m]=d.useState(""),[p,h]=d.useState(""),[b,g]=d.useState(!1),[S,P]=d.useState(!1),[C,w]=d.useState(null),[f,D]=d.useState(null),_=async v=>{v.preventDefault(),w(null),D(null),g(!0);try{if(c==="login"){const{error:A}=await n(u,p);A&&w(A.message)}else if(c==="signup"){const{error:A}=await l(u,p);A?w(A.message):(D("Check your email to confirm your account!"),o("login"))}else if(c==="reset"){const{error:A}=await r(u);A?w(A.message):(D("Check your email for a password reset link!"),o("login"))}}catch{w("An unexpected error occurred")}finally{g(!1)}},N=async()=>{if(i){w(null),P(!0);try{const{error:v}=await i();v?w(v.message):x("google")}catch{w("An unexpected error occurred")}finally{P(!1)}}},F=()=>{x("demo"),t()},j=()=>{s&&(x("local"),s())};return e.jsxs("div",{className:"relative min-h-screen bg-slate-900 flex flex-col items-center justify-center p-4",children:[a&&e.jsxs("button",{onClick:a,className:"absolute top-6 left-6 flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(It,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"bg-white p-3 rounded-2xl shadow-lg",children:e.jsx(le,{className:"text-slate-900 transform -rotate-45",size:32,fill:"currentColor"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"SkyStatus"}),e.jsx("p",{className:"text-xs font-bold text-blue-400 uppercase tracking-widest",children:"Pro Analytics"})]})]}),e.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:[c==="login"&&"Welcome back",c==="signup"&&"Create account",c==="reset"&&"Reset password"]}),e.jsxs("p",{className:"text-slate-500 mb-6",children:[c==="login"&&"Sign in to access your Flying Blue portfolio",c==="signup"&&"Start tracking your loyalty status",c==="reset"&&"Enter your email to receive a reset link"]}),c==="login"&&i&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,disabled:S,className:"w-full py-3 bg-white border border-slate-300 text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all flex items-center justify-center gap-3 disabled:opacity-50",children:[S?e.jsx(Qe,{size:18,className:"animate-spin"}):e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-3 bg-white text-slate-400",children:"or continue with email"})})]})]}),C&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl flex items-center gap-2 text-red-700 text-sm",children:[e.jsx(Nt,{size:16}),C]}),f&&e.jsxs("div",{className:"mb-4 p-3 bg-emerald-50 border border-emerald-200 rounded-xl flex items-center gap-2 text-emerald-700 text-sm",children:[e.jsx(Qt,{size:16}),f]}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1.5",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(as,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"email",value:u,onChange:v=>m(v.target.value),required:!0,autoComplete:"email",placeholder:"you@example.com",className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),c!=="reset"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1.5",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(yi,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"password",value:p,onChange:v=>h(v.target.value),required:!0,autoComplete:c==="signup"?"new-password":"current-password",placeholder:"â¢â¢â¢â¢â¢â¢â¢â¢",minLength:6,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),e.jsxs("button",{type:"submit",disabled:b,className:"w-full py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[b&&e.jsx(Qe,{size:18,className:"animate-spin"}),c==="login"&&"Sign In",c==="signup"&&"Create Account",c==="reset"&&"Send Reset Link"]})]}),c==="login"&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-100 rounded-xl flex gap-2 text-blue-700 text-sm",children:[e.jsx(lt,{size:16,className:"flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Not a Flying Blue login."})," This account only saves your manually entered data. We never ask for or connect to your Flying Blue credentials."]})]}),e.jsxs("div",{className:"mt-6 text-center text-sm",children:[c==="login"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o("reset"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Forgot password?"}),e.jsxs("div",{className:"mt-3 text-slate-500",children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>o("signup"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign up"})]})]}),c==="signup"&&e.jsxs("div",{className:"text-slate-500",children:["Already have an account?"," ",e.jsx("button",{onClick:()=>o("login"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]}),c==="reset"&&e.jsx("button",{onClick:()=>o("login"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Back to sign in"})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-3 bg-white text-slate-400",children:"or"})})]}),e.jsx("button",{onClick:F,className:"w-full py-3 bg-slate-100 text-slate-700 font-semibold rounded-xl hover:bg-slate-200 transition-all border border-slate-200",children:"Explore Demo"}),e.jsx("p",{className:"text-center text-xs text-slate-400 mt-2",children:"Try with sample data to see how it works"}),s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:j,className:"w-full mt-3 py-3 bg-white text-slate-600 font-semibold rounded-xl hover:bg-slate-50 transition-all border border-dashed border-slate-300",children:"Use Locally"}),e.jsx("p",{className:"text-center text-xs text-slate-400 mt-2",children:"Start empty, no account â use Export/Import in Data Settings to save your data"})]})]}),e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("p",{className:"text-slate-500 text-sm mb-4",children:"Track your Flying Blue XP, miles, and redemptions"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-xs text-slate-400",children:[e.jsx("a",{href:"/privacy",className:"hover:text-slate-600 transition-colors",children:"Privacy Policy"}),e.jsx("span",{children:"Â·"}),e.jsx("a",{href:"/terms",className:"hover:text-slate-600 transition-colors",children:"Terms of Service"})]})]})]})},Zd=({onBack:t})=>{const s="16 December 2024",[a,n]=Ue.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-12",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx(It,{size:18}),"Back to SkyStatus"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-xl",children:e.jsx(Zt,{className:"text-brand-600",size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Privacy Policy"}),e.jsxs("p",{className:"text-slate-500",children:["Last updated: ",s]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"1. Introduction"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'SkyStatus ("we", "our", or "us") respects your privacy. We are committed to protecting your personal data. This privacy policy explains how we collect, use, and safeguard your information when you use our Flying Blue loyalty tracking application at skystatus.pro.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"2. Data We Collect"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"We collect and process the following types of data:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Account data:"})," Email address and authentication information when you sign in with Google."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Flight data:"})," Flight records, routes, dates, and cabin class that you manually enter or import from Flying Blue PDFs."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Miles & XP data:"})," Your Flying Blue miles balance, XP points, and redemption history."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Usage data:"})," Basic analytics about how you use the application (if analytics are enabled)."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"3. PDF Import & Processing"}),e.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4 mb-4",children:e.jsx("p",{className:"text-emerald-800 font-medium",children:"ð Your Flying Blue PDFs are processed entirely in your browser. The PDF file is never uploaded to our servers."})}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"When you import a Flying Blue PDF:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Client-side processing:"})," The PDF is parsed entirely in your browser using JavaScript (PDF.js). No server is involved."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Data extraction:"})," We extract only flight data: dates, routes, cabin class, XP earned, and miles. Personal details like your name or Flying Blue number are not stored."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"No file storage:"})," The original PDF is never saved. Not on our servers, not in your browser. Only the extracted flight records are kept."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Your choice:"})," Extracted data is stored locally (Local Mode) or synced to your account (Cloud Mode). This depends on your preference."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"4. How We Use Your Data"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"We use your data exclusively to:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Provide and maintain the SkyStatus service"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Calculate and display your Flying Blue status progress"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Sync your data across devices when you're signed in"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Improve the application based on usage patterns"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"5. Data Storage & Security"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Your data is stored securely using Supabase. This is a trusted cloud database provider with enterprise-grade security. All data transmission is encrypted using TLS/SSL. We implement row-level security to ensure you can only access your own data. We do not sell, share, or provide your personal data to third parties."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"6. Local Mode"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:`SkyStatus offers a "Local Mode". In this mode, your data is stored only in your browser's local storage. It is never sent to our servers. We have no access to your data whatsoever. Note that local data is lost if you clear your browser data or switch devices.`})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"7. Your Rights (GDPR)"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"Under the General Data Protection Regulation (GDPR), you have the right to:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Access:"})," Request a copy of your personal data (use Data Settings â Export JSON)"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Rectification:"})," Correct any inaccurate data directly in the application"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Erasure:"})," Delete your account and all associated data (use Data Settings â Delete All Data)"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Portability:"})," Export your data in JSON format for use elsewhere"]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"8. Cookies & Analytics"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"SkyStatus uses cookies and analytics services. Here's what we use:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600 mb-4",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Essential cookies:"})," Required for authentication and session management. These cannot be disabled."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Functional cookies:"})," Remember your preferences like currency and home airport."]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Analytics cookies:"})," Google Analytics 4 (GA4) to understand how visitors use SkyStatus. This is optional and requires your consent."]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:[e.jsx("strong",{children:"ð Privacy-first analytics:"})," We use GA4 with enhanced privacy settings. IP addresses are anonymized, Google Signals is disabled, and no advertising features are enabled. We only collect anonymous usage data to improve SkyStatus. You can opt out at any time via the Cookie Settings in the footer."]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"9. Third-Party Services"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We use the following third-party services:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600 mt-4",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Supabase:"})," Database and authentication (",e.jsx("a",{href:"https://supabase.com/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:underline",children:"Privacy Policy"}),")"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Google OAuth:"})," Sign-in authentication (",e.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:underline",children:"Privacy Policy"}),")"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Google Analytics 4:"})," Website analytics (optional, requires consent) (",e.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:underline",children:"Privacy Policy"}),")"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Vercel:"})," Hosting and deployment (",e.jsx("a",{href:"https://vercel.com/legal/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:underline",children:"Privacy Policy"}),")"]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"10. Data Retention"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We retain your data for as long as your account is active. If you delete your account, all your data will be permanently removed from our servers within 30 days. Backup copies may persist for up to 90 days for disaster recovery purposes."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"11. Changes to This Policy"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'We may update this privacy policy from time to time. We will notify you of any significant changes by posting the new policy on this page and updating the "Last updated" date. We encourage you to review this policy periodically.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"12. Contact Us"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"If you have any questions about this privacy policy or our data practices, please contact us:"}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 text-brand-600 hover:text-brand-700 font-medium",children:[e.jsx(as,{size:18}),"Contact Support"]})})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-slate-400",children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})]}),e.jsx(Is,{isOpen:a,onClose:()=>n(!1)})]})},Qd=({onBack:t})=>{const s="11 December 2024",[a,n]=Ue.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-12",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx(It,{size:18}),"Back to SkyStatus"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-xl",children:e.jsx(wt,{className:"text-brand-600",size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Terms of Service"}),e.jsxs("p",{className:"text-slate-500",children:["Last updated: ",s]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"1. Acceptance of Terms"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'By accessing or using SkyStatus ("the Service"), you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service. We reserve the right to modify these terms at any time. Your continued use constitutes acceptance of any changes.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"2. Description of Service"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"SkyStatus is a personal tool for tracking Flying Blue loyalty program status, miles, and XP. The Service allows you to import and manage flight data, calculate status progress, and analyze your loyalty program performance. SkyStatus is an independent tool. It is not affiliated with, endorsed by, or connected to Air France-KLM, Flying Blue, or any airline."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"3. User Accounts"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"To use certain features of the Service, you may create an account using Google authentication. You agree to:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Provide accurate and complete information"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Maintain the security of your account credentials"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Accept responsibility for all activities under your account"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Notify us immediately of any unauthorized access"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"4. Acceptable Use"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"You agree not to:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Use the Service for any unlawful purpose"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Attempt to gain unauthorized access to our systems"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Interfere with or disrupt the Service or servers"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Reverse engineer or attempt to extract source code"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-brand-500 font-bold",children:"â¢"}),e.jsx("span",{children:"Use automated systems to access the Service without permission"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"5. Data Accuracy"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"While we strive to provide accurate calculations and information, SkyStatus is provided for informational purposes only. We do not guarantee the accuracy of XP calculations, status projections, or miles valuations. Always verify important information directly with Flying Blue or your airline. You are responsible for the accuracy of data you enter into the Service."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"6. Intellectual Property"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'The Service, including its original content, features, and functionality, is owned by SkyStatus and is protected by copyright, trademark, and other intellectual property laws. "Flying Blue" is a trademark of Air France-KLM. All airline names and logos are trademarks of their respective owners. Use of these names is for identification purposes only and does not imply endorsement.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"7. Disclaimer of Warranties"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'THE SERVICE IS PROVIDED "AS IS" AND "AS AVAILABLE" WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT. WE DO NOT WARRANT THAT THE SERVICE WILL BE UNINTERRUPTED, SECURE, OR ERROR-FREE.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"8. Limitation of Liability"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW, SKYSTATUS SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, OR ANY LOSS OF PROFITS OR REVENUES, WHETHER INCURRED DIRECTLY OR INDIRECTLY, OR ANY LOSS OF DATA, USE, GOODWILL, OR OTHER INTANGIBLE LOSSES RESULTING FROM YOUR USE OF THE SERVICE."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"9. Service Availability"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We reserve the right to modify, suspend, or discontinue the Service at any time without notice. We shall not be liable to you or any third party for any modification, suspension, or discontinuation of the Service. We recommend regularly exporting your data using the provided export functionality."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"10. Termination"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We may terminate or suspend your account and access to the Service immediately, without prior notice or liability, for any reason, including breach of these Terms. Upon termination, your right to use the Service will cease immediately. You may delete your account at any time through Data Settings."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"11. Governing Law"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"These Terms shall be governed by and construed in accordance with the laws of the Netherlands, without regard to its conflict of law provisions. Any disputes arising from these Terms or the Service shall be subject to the exclusive jurisdiction of the courts in the Netherlands."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"12. Contact Us"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"If you have any questions about these Terms of Service, please contact us:"}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 text-brand-600 hover:text-brand-700 font-medium",children:[e.jsx(as,{size:18}),"Contact Support"]})})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-slate-400",children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})]}),e.jsx(Is,{isOpen:a,onClose:()=>n(!1)})]})},ex=({onBack:t})=>{const s=[{icon:Ie,title:"XP Engine",description:"Track your XP across qualification cycles. See your progress toward the next status level with actual vs projected calculations.",color:"sky"},{icon:Ht,title:"Miles Tracker",description:"Monitor your miles balance, acquisition costs, and CPM metrics. Know exactly what your miles are worth.",color:"amber"},{icon:Be,title:"Redemption Calculator",description:"Evaluate award bookings by comparing CPM values. Maximize the value of every mile you spend.",color:"emerald"},{icon:Pt,title:"PDF Import",description:"Import your flight history directly from Flying Blue statements in 7 languages. No manual data entry required.",color:"purple"},{icon:le,title:"Mileage Run Simulator",description:"Plan strategic flights to reach your status goals. Find the best cost-per-XP routes from your home airport.",color:"blue"},{icon:ze,title:"Ultimate Status Tracking",description:"Dedicated UXP tracking for Platinum members pursuing Ultimate. Monitor both XP and UXP progress separately.",color:"yellow"}],a=["React","TypeScript","Tailwind CSS","Supabase","Vite","Vercel"],n=l=>{const r={sky:{bg:"bg-sky-50",text:"text-sky-600"},amber:{bg:"bg-amber-50",text:"text-amber-600"},emerald:{bg:"bg-emerald-50",text:"text-emerald-600"},purple:{bg:"bg-purple-50",text:"text-purple-600"},blue:{bg:"bg-blue-50",text:"text-blue-600"},yellow:{bg:"bg-yellow-50",text:"text-yellow-600"}};return r[l]||r.sky};return e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-12",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx(It,{size:18}),"Back to SkyStatus"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-xl",children:e.jsx(wt,{className:"text-brand-600",size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"About SkyStatus"}),e.jsx("p",{className:"text-slate-500",children:"Your Flying Blue companion"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:"Why SkyStatus?"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsx("p",{className:"leading-relaxed",children:"Flying Blue is great, but tracking your status progress shouldn't require a spreadsheet. SkyStatus was built by a frequent flyer who wanted a better way to visualize XP progress, understand mile valuations, and plan award redemptions."}),e.jsx("p",{className:"leading-relaxed",children:"Whether you're chasing Silver or maintaining Platinum, SkyStatus helps you stay on top of your qualification cycle with real-time tracking and smart projections."}),e.jsxs("p",{className:"leading-relaxed",children:["What started as a personal tool has grown into something used by ",e.jsx("strong",{className:"text-slate-900",children:"140+ Flying Blue members"})," across Europe and beyond. Every feature has been shaped by real user feedback from people who care about their status as much as you do."]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ni,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-bold text-slate-900",children:"Trusted by the Community"})]}),e.jsx("p",{className:"text-slate-600",children:"140+ Flying Blue members use SkyStatus to track their status qualification. This ranges from casual travelers reaching for Silver to frequent flyers maintaining Ultimate."})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:s.map(l=>{const r=n(l.color);return e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`p-2 ${r.bg} rounded-lg`,children:e.jsx(l.icon,{className:`w-5 h-5 ${r.text}`})}),e.jsx("h3",{className:"font-bold text-slate-900",children:l.title})]}),e.jsx("p",{className:"text-sm text-slate-600",children:l.description})]},l.title)})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:"Built With"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(l=>e.jsx("span",{className:"px-3 py-1.5 bg-slate-100 text-slate-700 rounded-lg text-sm font-medium",children:l},l))})]}),e.jsxs("div",{className:"bg-green-50 rounded-2xl p-6 border border-green-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-green-600",children:"ð"}),e.jsx("h3",{className:"font-bold text-slate-900",children:"Privacy First"})]}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Your PDF files are processed entirely in your browser. They never leave your device. Use Local Mode for complete privacy, or sign in with Google to sync across devices. Your data, your choice."})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg flex-shrink-0",children:e.jsx("span",{className:"text-amber-600",children:"ð"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-900 mb-1",children:"Independent Project"}),e.jsx("p",{className:"text-sm text-amber-800",children:"SkyStatus is an independent project and is not affiliated with, endorsed by, or connected to Air France-KLM or the Flying Blue loyalty program. All trademarks belong to their respective owners."})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(vi,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"font-bold text-slate-900",children:"Feedback & Suggestions"})]}),e.jsx("p",{className:"text-slate-600 text-sm",children:"SkyStatus is actively developed based on user feedback. Found a bug? Have an idea? Use the feedback button in the app or reach out directly. Every suggestion helps make SkyStatus better for everyone."})]}),e.jsxs("div",{className:"text-center text-sm text-slate-400",children:[e.jsxs("p",{children:["SkyStatus Pro v",Ka]}),e.jsx("p",{className:"mt-1",children:"Made with â in Amsterdam"})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-slate-400",children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})]})})},tx=({onBack:t})=>{const[s,a]=Ue.useState({type:"feedback",email:"",subject:"",message:""}),[n,l]=Ue.useState("idle"),r=async x=>{x.preventDefault(),l("submitting");try{const c=[`**Contact Form - ${s.type.toUpperCase()}**`,"",`**Subject:** ${s.subject}`,`**Email:** ${s.email}`,"","**Message:**",s.message].join(`
`),o=await xs({trigger:"contact_form",message:c,page:"/contact"});l(o?"success":"error")}catch(c){console.error("Error submitting contact form:",c),l("error")}},i=()=>{a({type:"feedback",email:"",subject:"",message:""}),l("idle")};return e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-12",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx(It,{size:18}),"Back to SkyStatus"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-xl",children:e.jsx(as,{className:"text-brand-600",size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Contact Us"}),e.jsx("p",{className:"text-slate-500",children:"We'd love to hear from you"})]})]}),n==="success"?e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(je,{className:"text-emerald-600",size:32})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Message Sent!"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Thanks for reaching out. We'll get back to you as soon as possible."}),e.jsx("button",{onClick:i,className:"text-brand-600 hover:text-brand-700 font-medium",children:"Send another message"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>a(x=>({...x,type:"feedback"})),className:`p-4 rounded-xl border-2 transition-all ${s.type==="feedback"?"border-brand-500 bg-brand-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx("svg",{className:`mx-auto mb-2 w-6 h-6 ${s.type==="feedback"?"text-brand-600":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("span",{className:`block font-medium text-sm ${s.type==="feedback"?"text-brand-700":"text-slate-600"}`,children:"Feedback"})]}),e.jsxs("button",{onClick:()=>a(x=>({...x,type:"bug"})),className:`p-4 rounded-xl border-2 transition-all ${s.type==="bug"?"border-red-500 bg-red-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx("svg",{className:`mx-auto mb-2 w-6 h-6 ${s.type==="bug"?"text-red-600":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:`block font-medium text-sm ${s.type==="bug"?"text-red-700":"text-slate-600"}`,children:"Report Bug"})]}),e.jsxs("button",{onClick:()=>a(x=>({...x,type:"question"})),className:`p-4 rounded-xl border-2 transition-all ${s.type==="question"?"border-amber-500 bg-amber-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx("svg",{className:`mx-auto mb-2 w-6 h-6 ${s.type==="question"?"text-amber-600":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:`block font-medium text-sm ${s.type==="question"?"text-amber-700":"text-slate-600"}`,children:"Question"})]})]}),e.jsxs("form",{onSubmit:r,className:"bg-white rounded-2xl border border-slate-200 p-8 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:["Your Email ",e.jsx("span",{className:"text-slate-400",children:"(for reply)"})]}),e.jsx("input",{type:"email",id:"email",required:!0,value:s.email,onChange:x=>a(c=>({...c,email:x.target.value})),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",placeholder:"your@email.com",disabled:n==="submitting"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-slate-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",id:"subject",required:!0,value:s.subject,onChange:x=>a(c=>({...c,subject:x.target.value})),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",placeholder:s.type==="bug"?"Brief description of the issue":s.type==="question"?"What would you like to know?":"What's on your mind?",disabled:n==="submitting"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-slate-700 mb-2",children:"Message"}),e.jsx("textarea",{id:"message",required:!0,rows:5,value:s.message,onChange:x=>a(c=>({...c,message:x.target.value})),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none",placeholder:s.type==="bug"?"Please describe the issue in detail. Include steps to reproduce if possible.":"Your message...",disabled:n==="submitting"})]}),n==="error"&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:[e.jsx(Nt,{size:18}),e.jsx("span",{children:"Something went wrong. Please try again."})]}),e.jsx("button",{type:"submit",disabled:n==="submitting",className:"w-full py-3 bg-brand-600 hover:bg-brand-700 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:n==="submitting"?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:18,className:"animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{size:18}),"Send Message"]})})]}),e.jsx("p",{className:"text-center text-sm text-slate-400",children:"We typically respond within 24 hours."})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-slate-400",children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})]})})},sx=({onBack:t})=>{const s="16 December 2024",[a,n]=Ue.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-12",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx(It,{size:18}),"Back to SkyStatus"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-xl",children:e.jsx(oa,{className:"text-brand-600",size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Cookie Policy"}),e.jsxs("p",{className:"text-slate-500",children:["Last updated: ",s]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"1. What Are Cookies?"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Cookies are small text files that are placed on your device when you visit a website. They are widely used to make websites work more efficiently, provide a better user experience, and give website owners information about how their site is being used."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"2. How We Use Cookies"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"SkyStatus uses cookies for different purposes. We categorize them as follows:"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[e.jsx("h3",{className:"font-bold text-emerald-800 mb-2",children:"Strictly Necessary Cookies"}),e.jsx("p",{className:"text-sm text-emerald-700 mb-2",children:"These cookies are essential for the website to function. They enable core functionality such as security, authentication, and accessibility. Without these cookies, the website cannot function properly."}),e.jsxs("p",{className:"text-xs text-emerald-600",children:[e.jsx("strong",{children:"Examples:"})," Authentication tokens, session identifiers, security preferences, cookie consent preferences."]}),e.jsx("p",{className:"text-xs text-emerald-800 font-semibold mt-2",children:"â These cookies cannot be disabled."})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[e.jsx("h3",{className:"font-bold text-blue-800 mb-2",children:"Functional Cookies"}),e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"These cookies remember your preferences and settings to enhance your experience. Without these cookies, some features may not work optimally."}),e.jsxs("p",{className:"text-xs text-blue-600",children:[e.jsx("strong",{children:"Examples:"})," Currency preference (EUR, USD, GBP, CHF), home airport setting, display preferences, language settings."]}),e.jsx("p",{className:"text-xs text-blue-800 font-semibold mt-2",children:"âï¸ You can disable these in Cookie Settings."})]}),e.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[e.jsx("h3",{className:"font-bold text-amber-800 mb-2",children:"Analytics Cookies"}),e.jsx("p",{className:"text-sm text-amber-700 mb-2",children:"These cookies help us understand how visitors interact with our website. All data is anonymized and used solely to improve SkyStatus."}),e.jsxs("p",{className:"text-xs text-amber-600",children:[e.jsx("strong",{children:"Examples:"})," Page views, feature usage statistics, error tracking, performance monitoring."]}),e.jsx("p",{className:"text-xs text-amber-800 font-semibold mt-2",children:"âï¸ You can disable these in Cookie Settings."})]}),e.jsxs("div",{className:"p-4 bg-slate-100 border border-slate-200 rounded-xl",children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:"Marketing Cookies"}),e.jsx("p",{className:"text-sm text-slate-600 mb-2",children:"These cookies are used to track visitors across websites for advertising purposes."}),e.jsxs("p",{className:"text-xs text-slate-500",children:[e.jsx("strong",{children:"Note:"})," SkyStatus currently does not use any marketing or advertising cookies."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"3. Cookie Details"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"Below is a detailed list of cookies we use:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"text-left py-2 px-3 font-semibold text-slate-700",children:"Cookie Name"}),e.jsx("th",{className:"text-left py-2 px-3 font-semibold text-slate-700",children:"Purpose"}),e.jsx("th",{className:"text-left py-2 px-3 font-semibold text-slate-700",children:"Duration"}),e.jsx("th",{className:"text-left py-2 px-3 font-semibold text-slate-700",children:"Type"})]})}),e.jsxs("tbody",{className:"text-slate-600",children:[e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:"skystatus_cookie_consent"}),e.jsx("td",{className:"py-2 px-3",children:"Stores your cookie preferences"}),e.jsx("td",{className:"py-2 px-3",children:"12 months"}),e.jsx("td",{className:"py-2 px-3",children:"Necessary"})]}),e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:"sb-*-auth-token"}),e.jsx("td",{className:"py-2 px-3",children:"Authentication session (Supabase)"}),e.jsx("td",{className:"py-2 px-3",children:"Session"}),e.jsx("td",{className:"py-2 px-3",children:"Necessary"})]}),e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:"skystatus_local_*"}),e.jsx("td",{className:"py-2 px-3",children:"Local mode data storage"}),e.jsx("td",{className:"py-2 px-3",children:"Persistent"}),e.jsx("td",{className:"py-2 px-3",children:"Functional"})]}),e.jsxs("tr",{className:"border-b border-slate-100 bg-blue-50/50",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:"_ga"}),e.jsx("td",{className:"py-2 px-3",children:"Google Analytics - distinguishes users"}),e.jsx("td",{className:"py-2 px-3",children:"2 years"}),e.jsx("td",{className:"py-2 px-3",children:"Analytics"})]}),e.jsxs("tr",{className:"border-b border-slate-100 bg-blue-50/50",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:"_ga_*"}),e.jsx("td",{className:"py-2 px-3",children:"Google Analytics 4 - maintains session state"}),e.jsx("td",{className:"py-2 px-3",children:"2 years"}),e.jsx("td",{className:"py-2 px-3",children:"Analytics"})]})]})]})}),e.jsxs("p",{className:"text-slate-500 text-sm mt-3",children:[e.jsx("strong",{children:"Note:"})," Analytics cookies (highlighted in blue) are only set after you give explicit consent. You can opt out at any time via Cookie Settings in the footer."]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"4. Managing Your Cookie Preferences"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"You have several options for managing cookies:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Cookie Settings:"}),' Click "Cookie Settings" in the footer to change your preferences at any time. Your choices will be saved for 12 months.']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Browser Settings:"})," Most browsers allow you to block or delete cookies through their settings. Note that blocking all cookies may affect website functionality."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Local Mode:"})," Use SkyStatus in Local Mode to minimize data storage. In this mode, data is only stored in your browser and no cloud services are used."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"5. Third-Party Cookies"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"SkyStatus uses the following third-party services that may set their own cookies:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600 mt-3",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Supabase:"})," For authentication and data storage.",e.jsx("a",{href:"https://supabase.com/privacy",className:"text-brand-600 hover:underline ml-1",target:"_blank",rel:"noopener noreferrer",children:"Supabase Privacy Policy"})]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Google Analytics 4:"})," For website analytics (only with your consent). We use privacy-enhanced settings: IP anonymization enabled, Google Signals disabled, no advertising features.",e.jsx("a",{href:"https://policies.google.com/privacy",className:"text-brand-600 hover:underline ml-1",target:"_blank",rel:"noopener noreferrer",children:"Google Privacy Policy"})]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Google Fonts:"})," For typography. Google may collect anonymous usage data.",e.jsx("a",{href:"https://policies.google.com/privacy",className:"text-brand-600 hover:underline ml-1",target:"_blank",rel:"noopener noreferrer",children:"Google Privacy Policy"})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"6. Your Rights Under GDPR"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"If you are located in the European Union, you have the following rights regarding cookies and personal data:"}),e.jsxs("ul",{className:"space-y-2 text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to be informed:"})," You have the right to know what cookies we use and why."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to consent:"})," Non-essential cookies are only set after you give explicit consent."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to withdraw consent:"})," You can change your cookie preferences at any time."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-brand-500 mt-1",children:"â¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to erasure:"})," You can delete all cookies through your browser settings."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"7. Updates to This Policy"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'We may update this Cookie Policy from time to time to reflect changes in our practices or for legal reasons. If we make significant changes, we will ask for your consent again. The "Last updated" date at the top of this policy indicates when it was last revised.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-3",children:"8. Contact Us"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"If you have any questions about our use of cookies or this Cookie Policy, please contact us:"}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 text-brand-600 hover:text-brand-700 font-medium",children:[e.jsx(as,{size:18}),"Contact Support"]})})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-slate-400",children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})]}),e.jsx(Is,{isOpen:a,onClose:()=>n(!1)})]})},ax=({item:t,isOpen:s,onToggle:a})=>e.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:a,className:"w-full flex items-center justify-between p-4 text-left bg-white hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"font-semibold text-slate-900 pr-4",children:t.question}),s?e.jsx(nt,{size:20,className:"text-slate-400 flex-shrink-0"}):e.jsx(we,{size:20,className:"text-slate-400 flex-shrink-0"})]}),s&&e.jsx("div",{className:"px-4 pb-4 bg-slate-50 border-t border-slate-100",children:e.jsx("div",{className:"pt-4 text-slate-600 leading-relaxed prose prose-sm max-w-none",children:t.answer})})]}),lx=({onBack:t})=>{const[s,a]=d.useState(new Set),[n,l]=d.useState(!1),r=x=>{const c=new Set(s);c.has(x)?c.delete(x):c.add(x),a(c)},i=[{title:"Getting Started",icon:e.jsx(De,{size:20}),items:[{question:"How do I get started with SkyStatus?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["When you first open SkyStatus, the ",e.jsx("strong",{children:"onboarding wizard"})," guides you through setup:"]}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Choose your home airport"})," - Used for popular route suggestions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Select your currency"})," - EUR, USD, GBP, or CHF for all cost displays"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Import your Flying Blue data"})," - Upload your PDF or enter manually"]})]}),e.jsxs("p",{className:"mt-3 p-3 bg-blue-50 rounded-lg text-sm",children:[e.jsx("strong",{children:"Tip:"})," You can always re-run the onboarding wizard from Data Settings if you want to change these preferences."]})]})},{question:"How do I enter my current status and XP?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"There are two ways to sync your Flying Blue status with SkyStatus:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Import your Flying Blue PDF"})," (recommended)",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-slate-500",children:"This automatically extracts all your flights, XP, and miles. Your status is detected from the PDF header."})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Enter manually:"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-slate-500",children:"Go to XP Engine â click the settings icon on your cycle â set your starting status and XP rollover."})]})]}),e.jsxs("p",{className:"mt-3 p-3 bg-blue-50 rounded-lg text-sm",children:[e.jsx("strong",{children:"Tip:"}),' Find your current XP on flyingblue.com under "My Account" â "XP Overview".']})]})},{question:"How do I import my Flying Blue PDF?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg text-sm border border-emerald-200 mb-4",children:[e.jsx("strong",{className:"text-emerald-800",children:"ð Privacy First:"}),e.jsxs("p",{className:"text-emerald-700 mt-1",children:["Your PDF is processed ",e.jsx("strong",{children:"entirely in your browser"}),". We never receive, upload, or store your PDF file. All parsing happens locally on your device."]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Step 1: Download your PDF from Flying Blue"})}),e.jsxs("ol",{className:"list-decimal list-inside mt-1 space-y-1 text-sm",children:[e.jsxs("li",{children:["Log in at ",e.jsx("a",{href:"https://www.flyingblue.com",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:underline",children:"flyingblue.com"})]}),e.jsxs("li",{children:["Go to ",e.jsx("strong",{children:"My Account"})," â ",e.jsx("strong",{children:"Activity overview"})]}),e.jsxs("li",{className:"text-amber-700 font-medium",children:["â ï¸ ",e.jsx("strong",{children:"Important:"})," Click the ",e.jsx("strong",{children:'"More"'})," button at the bottom repeatedly until ALL your activities are visible!"]}),e.jsxs("li",{children:["Scroll back up and click the ",e.jsx("strong",{children:'"Download"'})," button"]})]}),e.jsx("p",{className:"mt-3",children:e.jsx("strong",{children:"Step 2: Import in SkyStatus"})}),e.jsxs("ol",{className:"list-decimal list-inside mt-1 space-y-1 text-sm",children:[e.jsx("li",{children:'Click "Import PDF" (on Dashboard or in Data Settings)'}),e.jsx("li",{children:"Drag your PDF into the drop zone or click to select"}),e.jsx("li",{children:'Review the extracted data and click "Import"'})]})]})},{question:"What are the different login modes?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"SkyStatus offers three ways to use the app:"}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"ð Account Mode (recommended)"}),e.jsx("p",{className:"text-sm mt-1",children:"Sign in with Google or Magic Link. Your data syncs across devices and is securely stored."})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"ð® Demo Mode"}),e.jsx("p",{className:"text-sm mt-1",children:"Explore SkyStatus with sample data. No account needed. Data resets when you leave."})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"ð¾ Local Mode"}),e.jsx("p",{className:"text-sm mt-1",children:"Data stored only in your browser. Complete privacy, but no sync and data is lost if you clear your cache."})]})]})]})},{question:"How do I use Demo Mode?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Demo Mode lets you explore all SkyStatus features with sample data before entering your own."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("strong",{children:"To enter Demo Mode:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1 text-sm",children:[e.jsxs("li",{children:["On the login screen, click ",e.jsx("strong",{children:'"Try Demo"'})]}),e.jsx("li",{children:"You'll see sample data for a fictional Flying Blue member"}),e.jsx("li",{children:"Explore all features freely. Nothing you do affects real data"})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-violet-50 rounded-lg text-sm border border-violet-200",children:[e.jsx("strong",{className:"text-violet-800",children:"ð­ Switch between status levels:"}),e.jsxs("p",{className:"text-violet-700 mt-1",children:["In Demo Mode, a purple bar appears at the bottom. Click ",e.jsx("strong",{children:"Silver"}),", ",e.jsx("strong",{children:"Gold"}),", ",e.jsx("strong",{children:"Platinum"}),", or ",e.jsx("strong",{children:"Ultimate"})," to instantly see how SkyStatus looks for each status level!"]})]})]})}]},{title:"XP Engine",icon:e.jsx(Je,{size:20}),items:[{question:"What is the XP Engine?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["The ",e.jsx("strong",{children:"XP Engine"})," is the heart of SkyStatus. It tracks your qualification cycle and shows:"]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Actual XP"})," - XP from flights you've already taken"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Projected XP"})," - Including scheduled/future flights"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status progression"})," - Visual timeline of your status journey"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ultimate tracking"})," - UXP progress for Platinum members"]})]})]})},{question:"How do I configure my qualification cycle?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Click the ",e.jsx("strong",{children:"settings icon (âï¸)"})," on your cycle card in XP Engine to access:"]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Starting Status:"})," Your status at the beginning of this cycle (Explorer, Silver, Gold, Platinum, or Ultimate)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"XP Rollover:"})," XP carried over from your previous qualification year (max 300)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"UXP Rollover:"})," For Ultimate members, UXP carried over (max 900)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Cycle Start Month:"})," When your qualification year began"]})]})]})},{question:"What is the difference between Actual XP and Projected XP?",answer:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-indigo-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-indigo-800",children:"Actual XP"}),e.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:"XP from flights you have already taken. This is what Flying Blue shows as your current XP."})]}),e.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-amber-800",children:"Projected XP"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Includes XP from scheduled/future flights you've added. Helps you plan whether you'll reach your status goal."})]})]})})},{question:"How do I add manual XP corrections?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"If your XP doesn't match Flying Blue exactly, you can add corrections:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:["Go to ",e.jsx("strong",{children:"XP Engine"})]}),e.jsxs("li",{children:["Scroll to the ",e.jsx("strong",{children:"Monthly XP Ledger"})]}),e.jsxs("li",{children:["Find the month you want to correct and click the ",e.jsx("strong",{children:"edit icon"})]}),e.jsx("li",{children:"Enter the correction amount (positive to add, negative to subtract)"})]}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Use this for bonus XP from promotions, credit cards, or to fix small discrepancies."})]})},{question:'How does XP "payment" work on level-up?',answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:['When you reach a status threshold, that XP amount is "consumed" and your qualification year ',e.jsx("strong",{children:"resets"})," immediately:"]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-2 bg-slate-50 rounded",children:[e.jsx("span",{children:"Explorer â Silver"}),e.jsx("span",{className:"font-mono",children:"100 XP consumed"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-slate-50 rounded",children:[e.jsx("span",{children:"Silver â Gold"}),e.jsx("span",{className:"font-mono",children:"180 XP consumed"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-slate-50 rounded",children:[e.jsx("span",{children:"Gold â Platinum"}),e.jsx("span",{className:"font-mono",children:"300 XP consumed"})]})]}),e.jsxs("p",{className:"mt-3 text-sm",children:[e.jsx("strong",{children:"Example:"})," You have 250 XP as Silver. You earn 80 XP (total 330). You level up to Gold, paying 180 XP. You keep 150 XP, and your new qualification year starts on the 1st of the next month."]})]})},{question:"What is rollover XP?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"At the end of your qualification year, excess XP carries over to the next year:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Maximum XP rollover:"})," 300 XP (for Silver, Gold, Platinum)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Maximum UXP rollover:"})," 900 UXP (for Ultimate members)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"UXP Cap:"})," Total UXP balance cannot exceed 1800 UXP"]})]}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Example: You end the year with 450 XP as Platinum. You roll over 300 XP (the maximum) to start your next year."})]})},{question:"What is soft landing?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:['Flying Blue has a "soft landing" rule. If you fail to requalify, ',e.jsx("strong",{children:"you only drop one status level per year"}),"."]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Platinum â Gold"}),e.jsx("li",{children:"Gold â Silver"}),e.jsx("li",{children:"Silver â Explorer"})]}),e.jsxs("p",{className:"mt-3 p-3 bg-violet-50 rounded-lg text-sm text-violet-800",children:[e.jsx("strong",{children:"ð Ultimate Exception:"})," If you are Ultimate and fail to reach 900 UXP, you drop to ",e.jsx("strong",{children:"Platinum"})," (never lower). This ensures your Platinum for Life streak remains unbroken."]})]})}]},{title:"XP Run Simulator",icon:e.jsx(Ns,{size:20}),items:[{question:"What is the XP Run Simulator?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["The ",e.jsx("strong",{children:"XP Run Simulator"})," helps you plan mileage runs to reach your status goals. It calculates:"]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"XP earned for any route and cabin class"}),e.jsx("li",{children:"Cost per XP (efficiency analysis)"}),e.jsx("li",{children:"Status projection after the run"}),e.jsx("li",{children:"Multi-segment routes with stopover options"})]})]})},{question:"How do I use the XP Run Simulator?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Basic usage:"})}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:["Enter your route as airport codes: ",e.jsx("code",{className:"bg-slate-100 px-1 rounded",children:"AMS CDG BKK"})]}),e.jsx("li",{children:"Select your base cabin class"}),e.jsx("li",{children:`Toggle "Return" if you're flying round-trip`}),e.jsx("li",{children:"Enter the total cost to see efficiency metrics"})]})]})},{question:"How do I change cabin class for individual segments?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Each segment can have a different cabin class:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Enter your route to generate segments"}),e.jsxs("li",{children:["In the ",e.jsx("strong",{children:"Segment Breakdown"})," section, find the segment you want to change"]}),e.jsxs("li",{children:["Click the ",e.jsx("strong",{children:"cabin class dropdown"})," next to that segment"]})]}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Useful when you're flying Business outbound but Economy on the return."})]})},{question:"What are the distance bands?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"XP is based on flight distance (marketed by Flying Blue) and cabin class:"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{className:"p-2 bg-slate-50 rounded",children:"Short: < 500 mi"}),e.jsx("div",{className:"p-2 bg-slate-50 rounded",children:"Medium: 500-2000 mi"}),e.jsx("div",{className:"p-2 bg-slate-50 rounded",children:"Long 1: 2000-3500 mi"}),e.jsx("div",{className:"p-2 bg-slate-50 rounded",children:"Long 2: 3500-5000 mi"}),e.jsx("div",{className:"p-2 bg-slate-50 rounded",children:"Long 3: > 5000 mi"})]}),e.jsxs("p",{className:"mt-3 text-sm",children:[e.jsx("strong",{children:"XP Multipliers:"})," Economy (1x), Premium Economy (2x), Business (3x), First (5x)."]})]})},{question:"What is Classic Mode vs Optimizer Mode?",answer:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"Classic Mode"}),e.jsxs("p",{className:"text-sm mt-1",children:["Calculates ",e.jsx("strong",{children:"total cost Ã· total XP"}),". Simple efficiency metric for the entire trip."]})]}),e.jsxs("div",{className:"p-3 bg-indigo-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-indigo-800",children:"Optimizer Mode"}),e.jsxs("p",{className:"text-sm mt-1",children:["Calculates ",e.jsx("strong",{children:"marginal cost Ã· marginal XP"}),". Shows the cost of upgrading from Economy. This is useful for deciding whether to pay for a higher cabin."]})]})]})})}]},{title:"Flights & Data",icon:e.jsx(le,{size:20}),items:[{question:"How do I add flights manually?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Go to ",e.jsx("strong",{children:"Add Flight"})," from the menu:"]}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:["Enter the ",e.jsx("strong",{children:"flight date"})]}),e.jsxs("li",{children:["Enter ",e.jsx("strong",{children:"route"})," (e.g., AMS-CDG)"]}),e.jsxs("li",{children:["Select ",e.jsx("strong",{children:"airline"})," (KL, AF, or partner)"]}),e.jsxs("li",{children:["Choose ",e.jsx("strong",{children:"cabin class"})]}),e.jsxs("li",{children:["Mark as ",e.jsx("strong",{children:"flown"})," or ",e.jsx("strong",{children:"scheduled"})]})]})]})},{question:"How do I edit or delete flights?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["In the ",e.jsx("strong",{children:"Flight Ledger"})," (visible on Add Flight page):"]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Edit:"})," Click the pencil icon on any flight to modify details"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Delete:"})," Click the trash icon to remove a flight"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Toggle status:"})," Click the checkbox to switch between flown/scheduled"]})]})]})},{question:"What is the difference between KL/AF and partner flights?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-blue-800",children:"KLM (KL) & Air France (AF)"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Earn both XP and UXP. UXP counts toward Ultimate status."})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"Partner Airlines"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Earn XP only, not UXP. Partners include Delta, Kenya Airways, SkyTeam members, etc."})]})]}),e.jsxs("p",{className:"mt-3 text-sm",children:[e.jsx("strong",{children:"Important:"})," If you're aiming for Ultimate, focus on KL/AF flights!"]})]})},{question:"Why doesn't my XP match exactly with Flying Blue?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Small differences can occur due to:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Timing:"})," Flying Blue sometimes processes flights with a delay"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bonus XP:"})," Promotions or challenges not reflected in imports"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Distance overrides:"})," Some routes have special XP values"]})]}),e.jsxs("p",{className:"mt-3 text-sm",children:[e.jsx("strong",{children:"Solution:"})," Use the manual ledger in XP Engine to add corrections."]})]})}]},{title:"Miles & Redemptions",icon:e.jsx(Ge,{size:20}),items:[{question:"How do I track my miles balance?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["The ",e.jsx("strong",{children:"Miles Engine"})," tracks your award miles:"]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"View monthly breakdown of earned and spent miles"}),e.jsx("li",{children:"See cumulative balance over time"}),e.jsx("li",{children:"Track cost-per-mile for purchases"})]})]})},{question:"What is the Redemption Calculator?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["The ",e.jsx("strong",{children:"Redemption Calculator"})," helps you analyze the value of award bookings by comparing the miles used + taxes against the cash price of a ticket."]}),e.jsxs("p",{className:"mt-3 text-sm",children:[e.jsx("strong",{children:"Value guide:"})," <1.0Â¢ = Poor, 1.0-1.5Â¢ = Fair, 1.5-2.5Â¢ = Good, >2.5Â¢ = Excellent"]})]})},{question:"How is cost-per-mile calculated?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Formula:"})," Total costs Ã· Total miles earned"]}),e.jsxs("p",{className:"mt-2 text-sm",children:[e.jsx("strong",{children:"Example:"})," You spent â¬1,200 on flights and earned 100,000 miles. Your CPM = â¬1,200 / 100,000 = 1.2 cents per mile."]})]})}]},{title:"Data Settings",icon:e.jsx(ca,{size:20}),items:[{question:"How do I access Data Settings?",answer:e.jsx(e.Fragment,{children:e.jsxs("p",{children:["Click the ",e.jsx("strong",{children:"gear icon (âï¸)"})," in the sidebar or header. You can import PDF, export/import JSON backups, change currency, or reset data."]})})},{question:"How do I change my currency?",answer:e.jsx(e.Fragment,{children:e.jsxs("p",{children:["In ",e.jsx("strong",{children:"Data Settings"}),", select from EUR (â¬), USD ($), GBP (Â£), or CHF. Note: This changes the display symbol but does not convert existing numerical values."]})})},{question:"How do I export/import my data?",answer:e.jsx(e.Fragment,{children:e.jsxs("p",{children:["Use the ",e.jsx("strong",{children:"Export JSON"})," and ",e.jsx("strong",{children:"Import JSON"})," buttons in Data Settings to backup your data or transfer it between devices."]})})},{question:'What does "Start Over" do?',answer:e.jsx(e.Fragment,{children:e.jsxs("p",{children:[e.jsx("strong",{children:'"Start Over"'})," deletes all your flights, miles, XP data, and settings, returning you to the welcome screen. This cannot be undone."]})})},{question:"What is the email consent toggle?",answer:e.jsx(e.Fragment,{children:e.jsx("p",{children:"This controls whether we can contact you about features and updates. Your email is never shared with third parties."})})}]},{title:"Flying Blue Basics",icon:e.jsx(De,{size:20}),items:[{question:"What are the Flying Blue status levels?",answer:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-3 mt-2",children:[e.jsxs("div",{className:"p-3 bg-slate-100 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"Explorer (0 XP)"}),e.jsxs("ul",{className:"list-disc list-inside text-sm mt-1 space-y-0.5",children:[e.jsx("li",{children:"Base level for all members"}),e.jsx("li",{children:"4x Miles on eligible flights"})]})]}),e.jsxs("div",{className:"p-3 bg-slate-200 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800",children:"Silver (100 XP)"}),e.jsxs("ul",{className:"list-disc list-inside text-sm mt-1 space-y-0.5",children:[e.jsx("li",{children:"6x Miles on eligible flights"}),e.jsx("li",{children:"1 extra checked bag, SkyTeam Elite benefits"})]})]}),e.jsxs("div",{className:"p-3 bg-amber-100 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-amber-800",children:"Gold (180 XP)"}),e.jsxs("ul",{className:"list-disc list-inside text-sm mt-1 space-y-0.5",children:[e.jsx("li",{children:"7x Miles on eligible flights"}),e.jsx("li",{children:"Lounge access + 1 guest"}),e.jsx("li",{children:"SkyPriority"})]})]}),e.jsxs("div",{className:"p-3 bg-slate-700 text-white rounded-lg",children:[e.jsx("div",{className:"font-semibold",children:"Platinum (300 XP)"}),e.jsxs("ul",{className:"list-disc list-inside text-sm mt-1 space-y-0.5",children:[e.jsx("li",{children:"8x Miles on eligible flights"}),e.jsx("li",{children:"Platinum Service Line, Platinum for Life eligibility"}),e.jsx("li",{children:"Start earning UXP toward Ultimate"})]})]}),e.jsxs("div",{className:"p-3 bg-gradient-to-r from-violet-600 to-purple-600 text-white rounded-lg",children:[e.jsx("div",{className:"font-semibold",children:"Ultimate (300 XP + 900 UXP)"}),e.jsxs("ul",{className:"list-disc list-inside text-sm mt-1 space-y-0.5",children:[e.jsx("li",{children:"Requires 900 UXP in one cycle"}),e.jsx("li",{children:"4 free upgrade vouchers per year"}),e.jsx("li",{children:"Platinum card for 1 companion"})]})]})]})})},{question:"What is the difference between XP and Miles?",answer:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-indigo-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-indigo-800",children:"XP (Experience Points)"}),e.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:"Determines your status level. Resets each qualification year (excess rolls over, max 300)."})]}),e.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-emerald-800",children:"Miles (Award Miles)"}),e.jsx("p",{className:"text-sm text-emerald-700 mt-1",children:"Reward currency for free flights and upgrades. Accumulates over time."})]})]})})},{question:"What is UXP?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"UXP (Ultimate XP)"})," is a special counter that runs alongside regular XP. It determines if you reach Ultimate status."]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Earned on:"})," KLM and Air France operated flights (and SAF purchases)."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"NOT Earned on:"})," Partner flights (Delta, etc.) or Transavia."]})]}),e.jsx("p",{className:"mt-3",children:e.jsx("strong",{children:"Key points:"})}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1 text-sm",children:[e.jsx("li",{children:"Every UXP is also an XP, but not every XP is a UXP."}),e.jsx("li",{children:"To reach Ultimate, you need 900 UXP within your qualification year."}),e.jsx("li",{children:"You typically need to be Platinum to start qualifying for Ultimate."})]})]})},{question:"How does Platinum for Life work?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["If you maintain ",e.jsx("strong",{children:"Platinum or Ultimate"})," status for ",e.jsx("strong",{children:"10 consecutive years"}),", you become Platinum for Life."]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"You no longer need to earn XP to maintain Platinum status."}),e.jsx("li",{children:"Ultimate years count towards the 10-year goal."}),e.jsxs("li",{children:[e.jsx("strong",{children:"Crucial:"})," Because Ultimate members always soft-land to Platinum, achieving Ultimate guarantees your streak remains unbroken for at least one more year."]})]})]})},{question:"What is a qualification year?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Your personal 12-month period for earning XP. It is dynamic:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Level Up:"})," If you gain enough XP to upgrade status, your cycle ",e.jsx("strong",{children:"resets immediately"}),". Your new year starts the 1st day of the next month."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Requalification:"})," If you maintain status, your cycle dates stay the same."]})]})]})}]},{title:"Data & Privacy",icon:e.jsx(Zt,{size:20}),items:[{question:"Is my data safe?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Yes. SkyStatus is built with privacy as a priority:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Data stored encrypted in Supabase (SOC2 compliant)"}),e.jsx("li",{children:"All connections secured with TLS/SSL"}),e.jsx("li",{children:"Row-level security ensures you only see your own data"}),e.jsx("li",{children:"We never sell or share your data with third parties"}),e.jsx("li",{children:"You can export or delete your data anytime"})]}),e.jsxs("p",{className:"mt-2",children:["Read our full ",e.jsx("a",{href:"/privacy",className:"text-brand-600 hover:underline",children:"Privacy Policy"}),"."]})]})},{question:"Can I use SkyStatus without an account?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Yes!"})," SkyStatus offers ",e.jsx("strong",{children:"Local Mode"}),":"]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-500 font-bold",children:"â"}),e.jsx("span",{children:"No account required"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-500 font-bold",children:"â"}),e.jsx("span",{children:"Data never leaves your device"})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-sm",children:[e.jsx("strong",{className:"text-blue-800",children:"ð¡ Protect your data with Export/Import:"}),e.jsxs("p",{className:"mt-2 text-blue-700",children:["You can always save your data as a JSON file via ",e.jsx("strong",{children:"Data Settings"})," â ",e.jsx("strong",{children:"Export Data"})," and restore it later."]})]})]})}]},{title:"Troubleshooting",icon:e.jsx(wt,{size:20}),items:[{question:"My PDF import failed. What should I do?",answer:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Common causes and solutions:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Wrong PDF:"})," Make sure you're importing the Flying Blue activity PDF, not a booking confirmation."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Incomplete data:"}),' Did you click "More" on Flying Blue to load all activities before downloading?']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Language:"})," SkyStatus supports English, Dutch, French, and German PDFs. Other languages might fail."]})]})]})},{question:"Data is not syncing between devices",answer:e.jsx(e.Fragment,{children:e.jsx("p",{children:"Make sure you are logged in with the same account on both devices. Local Mode data does not sync. Changes usually sync within a few seconds."})})},{question:"How do I report a bug?",answer:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Click the ",e.jsx("strong",{children:"Bug Report"})," button in the sidebar (or footer on mobile). Describe what happened, what you expected, and include any error messages."]}),e.jsxs("p",{className:"mt-2 text-sm text-slate-500",children:["You can also ",e.jsx("button",{onClick:()=>l(!0),className:"text-brand-600 hover:underline font-medium",children:"contact support"})," directly."]})]})}]}];return e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx(It,{size:18}),"Back to SkyStatus"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-xl",children:e.jsx(vt,{className:"text-brand-600",size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Help & FAQ"}),e.jsx("p",{className:"text-slate-500",children:"Everything you need to know about SkyStatus"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 mb-8",children:[e.jsx("h2",{className:"font-semibold text-slate-900 mb-4",children:"Jump to topic"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map((x,c)=>e.jsxs("a",{href:`#section-${c}`,className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm font-medium text-slate-700 transition-colors",children:[x.icon,x.title]},c))})]}),e.jsx("div",{className:"space-y-8",children:i.map((x,c)=>e.jsxs("div",{id:`section-${c}`,className:"scroll-mt-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-brand-100 rounded-lg text-brand-600",children:x.icon}),e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:x.title})]}),e.jsx("div",{className:"space-y-3",children:x.items.map((o,u)=>{const m=`${c}-${u}`;return e.jsx(ax,{item:o,isOpen:s.has(m),onToggle:()=>r(m)},m)})})]},c))}),e.jsxs("div",{className:"mt-12 bg-gradient-to-br from-brand-500 to-blue-600 rounded-2xl p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Still have questions?"}),e.jsx("p",{className:"text-white/80 mb-6",children:"Get in touch and we'll be happy to help."}),e.jsx("button",{onClick:()=>l(!0),className:"inline-flex items-center gap-2 bg-white text-brand-600 px-6 py-3 rounded-xl font-semibold hover:bg-slate-50 transition-colors",children:"Contact Support"})]}),e.jsx(Is,{isOpen:n,onClose:()=>l(!1)}),e.jsxs("div",{className:"mt-8 text-center text-sm text-slate-400",children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})]})})},nx=({onGetStarted:t,onDemo:s})=>{const[a,n]=Ue.useState(!1);return yr(()=>n(!0)),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(jr,{isOpen:a,onClose:()=>n(!1)}),e.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-100",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-slate-900 p-2 rounded-xl",children:e.jsx(le,{className:"text-white transform -rotate-45",size:20,fill:"currentColor"})}),e.jsx("span",{className:"font-bold text-xl text-slate-900",children:"SkyStatus"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("a",{href:"/guide",className:"hidden sm:block px-4 py-2 text-slate-600 hover:text-slate-900 font-medium transition-colors",children:"Guides"}),e.jsx("a",{href:"/faq",className:"hidden sm:block px-4 py-2 text-slate-600 hover:text-slate-900 font-medium transition-colors",children:"Help & FAQ"}),e.jsx("button",{onClick:()=>n(!0),className:"hidden sm:flex p-2 text-slate-500 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",title:"Search (âK)",children:e.jsx(ds,{size:18})}),e.jsx("button",{onClick:s,className:"hidden sm:block px-4 py-2 text-slate-600 hover:text-slate-900 font-medium transition-colors",children:"View Demo"}),e.jsx("button",{onClick:t,className:"px-5 py-2.5 bg-slate-900 text-white rounded-xl font-semibold hover:bg-slate-800 transition-colors",children:"Sign In"})]})]})}),e.jsxs("section",{className:"relative pt-32 pb-20 px-4 sm:px-6 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 via-white to-indigo-50"}),e.jsx("div",{className:"absolute top-20 right-0 w-96 h-96 bg-blue-100 rounded-full blur-3xl opacity-40"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-80 h-80 bg-indigo-100 rounded-full blur-3xl opacity-40"}),e.jsx("div",{className:"absolute top-40 right-10 opacity-5 hidden lg:block",children:e.jsx(le,{size:400,className:"transform rotate-12"})}),e.jsx("div",{className:"relative max-w-6xl mx-auto",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full text-sm font-semibold mb-6",children:[e.jsx(Pt,{size:16}),"Free Flying Blue Analytics Tool"]}),e.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-black text-slate-900 leading-tight mb-6",children:["Master Your",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600",children:" Flying Blue "}),"Status"]}),e.jsx("p",{className:"text-xl text-slate-600 leading-relaxed mb-8 max-w-2xl",children:"Track your XP and analyze miles value. Plan mileage runs and optimize your path to Platinum status. Includes full Ultimate tracking for the top tier."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("button",{onClick:t,className:"group flex items-center justify-center gap-2 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-blue-500/25 hover:shadow-xl hover:shadow-blue-500/30 transition-all hover:scale-[1.02]",children:["Start Tracking",e.jsx(we,{size:20,className:"group-hover:translate-x-1 transition-transform"})]}),e.jsx("button",{onClick:s,className:"flex items-center justify-center gap-2 px-8 py-4 bg-white text-slate-700 rounded-2xl font-bold text-lg border-2 border-slate-200 hover:border-slate-300 hover:bg-slate-50 transition-all",children:"Explore with sample data"})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-8 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{size:16,className:"text-emerald-500"}),"100% free"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{size:16,className:"text-emerald-500"}),"Cloud sync or local-only"]})]})]})})]}),e.jsx("section",{className:"py-20 px-4 sm:px-6 bg-slate-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-black text-slate-900 mb-4",children:"Everything You Need to Maximize Your Status"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Powerful analytics and planning tools designed specifically for Flying Blue members"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-blue-200 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ie,{className:"text-blue-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"XP Qualification Tracker"}),e.jsx("p",{className:"text-slate-600",children:"Real-time progress tracking across qualification cycles. See exactly how many XP you need for your next status level."})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-blue-200 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ss,{className:"text-emerald-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Miles Valuation Engine"}),e.jsx("p",{className:"text-slate-600",children:"Calculate your true cost-per-mile and track redemption value. Know exactly what your miles are worth."})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-blue-200 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Je,{className:"text-purple-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"XP Run Simulator"}),e.jsx("p",{className:"text-slate-600",children:"Plan mileage runs with our simulator. Find the most efficient routes to reach your status goals."})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-blue-200 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mb-4",children:e.jsx(St,{className:"text-amber-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"PDF Import"}),e.jsx("p",{className:"text-slate-600",children:"Import your complete Flying Blue history from PDF. Automatic extraction of flights, miles, and XP data."})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-blue-200 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-100 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ht,{className:"text-rose-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Advanced Analytics"}),e.jsx("p",{className:"text-slate-600",children:"Visualize your earning patterns, redemption history, and ROI on miles acquisition strategies."})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-blue-200 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Zt,{className:"text-slate-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Privacy First"}),e.jsx("p",{className:"text-slate-600",children:"Your data stays yours. Use locally without an account, or sync securely across devices with encryption."})]})]})]})}),e.jsx("section",{className:"py-20 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-black text-slate-900 mb-4",children:"Get Started in Minutes"}),e.jsx("p",{className:"text-lg text-slate-600",children:"Three simple steps to take control of your Flying Blue journey"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg shadow-blue-500/25",children:e.jsx("span",{className:"text-2xl font-black text-white",children:"1"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3",children:"Download Your PDF"}),e.jsx("p",{className:"text-slate-600",children:'Go to Flying Blue â My Account â Activity overview. Click "More" until all activities load, then click "Download".'})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg shadow-blue-500/25",children:e.jsx("span",{className:"text-2xl font-black text-white",children:"2"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3",children:"Import & Analyze"}),e.jsx("p",{className:"text-slate-600",children:"Upload your PDF to SkyStatus. We automatically extract all your flights, miles, and XP data."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg shadow-blue-500/25",children:e.jsx("span",{className:"text-2xl font-black text-white",children:"3"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3",children:"Optimize Your Strategy"}),e.jsx("p",{className:"text-slate-600",children:"Use our tools to plan your path to the next status level and maximize your miles value."})]})]})]})}),e.jsx("section",{className:"py-20 px-4 sm:px-6 bg-white",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-100 text-emerald-700 px-4 py-2 rounded-full text-sm font-semibold mb-4",children:[e.jsx(Ra,{size:16}),"Flying Blue Knowledge Hub"]}),e.jsx("h2",{className:"text-3xl sm:text-4xl font-black text-slate-900 mb-4",children:"Learn Before You Fly"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Master Flying Blue with our comprehensive guides covering XP, status levels, miles value, and mileage run strategies."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[e.jsxs("a",{href:"/guide/what-is-flying-blue-xp",className:"group bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors",children:"What is Flying Blue XP?"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3",children:"Everything you need to know about Experience Points and how they determine your status level."}),e.jsxs("span",{className:"text-blue-600 text-sm font-semibold inline-flex items-center gap-1 group-hover:gap-2 transition-all",children:["Read Guide ",e.jsx(ht,{size:14})]})]}),e.jsxs("a",{href:"/guide/flying-blue-status-levels",className:"group bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors",children:"Status Levels Compared"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3",children:"Silver, Gold, Platinum, Ultimate: requirements, benefits, and which level to target."}),e.jsxs("span",{className:"text-blue-600 text-sm font-semibold inline-flex items-center gap-1 group-hover:gap-2 transition-all",children:["Read Guide ",e.jsx(ht,{size:14})]})]}),e.jsxs("a",{href:"/guide/flying-blue-gold-status",className:"group bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors",children:"How to Reach Gold Status"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3",children:"Gold (180 XP) is the sweet spot for most travelers. Strategies and cost analysis inside."}),e.jsxs("span",{className:"text-blue-600 text-sm font-semibold inline-flex items-center gap-1 group-hover:gap-2 transition-all",children:["Read Guide ",e.jsx(ht,{size:14})]})]}),e.jsxs("a",{href:"/guide/what-is-a-mileage-run",className:"group bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors",children:"What is a Mileage Run?"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3",children:"Flights taken for status points. Learn when they make sense and when to skip them."}),e.jsxs("span",{className:"text-blue-600 text-sm font-semibold inline-flex items-center gap-1 group-hover:gap-2 transition-all",children:["Read Guide ",e.jsx(ht,{size:14})]})]}),e.jsxs("a",{href:"/guide/flying-blue-miles-value",className:"group bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors",children:"What Are Miles Worth?"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3",children:"â¬0.01-0.02 per mile depending on redemption. Complete valuation guide by cabin class."}),e.jsxs("span",{className:"text-blue-600 text-sm font-semibold inline-flex items-center gap-1 group-hover:gap-2 transition-all",children:["Read Guide ",e.jsx(ht,{size:14})]})]}),e.jsxs("a",{href:"/guide/flying-blue-subscription",className:"group bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors",children:"Subscribe to Miles Worth It?"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3",children:"Costs â¬0.008/mile plus bonus XP. Great value for most active members."}),e.jsxs("span",{className:"text-blue-600 text-sm font-semibold inline-flex items-center gap-1 group-hover:gap-2 transition-all",children:["Read Guide ",e.jsx(ht,{size:14})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("a",{href:"/guide",className:"inline-flex items-center gap-2 px-6 py-3 bg-slate-900 text-white rounded-xl font-semibold hover:bg-slate-800 transition-colors",children:["View All Guides",e.jsx(we,{size:18})]})})]})}),e.jsx("section",{className:"py-20 px-4 sm:px-6 bg-gradient-to-br from-slate-900 to-slate-800",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-black text-white mb-4",children:"Track Every Status Level"}),e.jsx("p",{className:"text-lg text-slate-400",children:"From Explorer to Ultimate, we help you reach your goals"})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[{name:"Explorer",xp:"0 XP",color:"from-slate-400 to-slate-500",multiplier:"4x",subtitle:"Starting level"},{name:"Silver",xp:"100 XP",color:"from-gray-300 to-gray-400",multiplier:"6x",subtitle:null},{name:"Gold",xp:"180 XP",color:"from-amber-400 to-amber-500",multiplier:"7x",subtitle:null},{name:"Platinum",xp:"300 XP",color:"from-slate-300 to-slate-400",multiplier:"8x",subtitle:"Start earning UXP"},{name:"Ultimate",xp:"900 UXP",color:"from-slate-600 to-slate-800",multiplier:"9x",subtitle:"As Platinum member"}].map(l=>e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/10",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${l.color} flex items-center justify-center mb-4`,children:e.jsx(De,{className:"text-white",size:24})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:l.name}),e.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:[l.xp," required"]}),l.subtitle&&e.jsx("p",{className:"text-slate-500 text-xs mb-2",children:l.subtitle}),e.jsxs("div",{className:"text-emerald-400 font-semibold",children:[l.multiplier," Miles"]})]},l.name))})]})}),e.jsx("section",{className:"py-20 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-black text-slate-900 mb-4",children:"Ready to Optimize Your Flying Blue Journey?"}),e.jsx("p",{className:"text-lg text-slate-600 mb-8 max-w-2xl mx-auto",children:"Join 140+ Flying Blue members who use SkyStatus to track their progress and maximize their benefits."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs("button",{onClick:t,className:"group flex items-center justify-center gap-2 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-blue-500/25 hover:shadow-xl hover:shadow-blue-500/30 transition-all hover:scale-[1.02]",children:["Start Tracking",e.jsx(we,{size:20,className:"group-hover:translate-x-1 transition-transform"})]}),e.jsx("button",{onClick:s,className:"flex items-center justify-center gap-2 px-8 py-4 bg-slate-100 text-slate-700 rounded-2xl font-bold text-lg hover:bg-slate-200 transition-all",children:"Explore sample data"})]})]})}),e.jsx("footer",{className:"bg-slate-50 border-t border-slate-200 py-12 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-slate-900 p-2 rounded-xl",children:e.jsx(le,{className:"text-white transform -rotate-45",size:18,fill:"currentColor"})}),e.jsx("span",{className:"font-bold text-lg text-slate-900",children:"SkyStatus"})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[e.jsx("a",{href:"/guide",className:"hover:text-slate-700 transition-colors",children:"Guides"}),e.jsx("a",{href:"/faq",className:"hover:text-slate-700 transition-colors",children:"Help & FAQ"}),e.jsx("a",{href:"/about",className:"hover:text-slate-700 transition-colors",children:"About"}),e.jsx("a",{href:"/contact",className:"hover:text-slate-700 transition-colors",children:"Contact"}),e.jsx("a",{href:"/privacy",className:"hover:text-slate-700 transition-colors",children:"Privacy"}),e.jsx("a",{href:"/terms",className:"hover:text-slate-700 transition-colors",children:"Terms"}),e.jsx("a",{href:"/ai-info.html",className:"hover:text-slate-700 transition-colors",children:"AI Info"})]})]}),e.jsx("div",{className:"mt-8 pt-8 border-t border-slate-200 text-center text-sm text-slate-400",children:e.jsxs("p",{children:["Â© ",new Date().getFullYear()," SkyStatus. Not affiliated with Air France-KLM or Flying Blue."]})})]})})]})},tn={europe:{label:"Europe flight",cpm:.8,example:"AMS â BCN round trip"},medium:{label:"Medium-haul flight",cpm:1,example:"AMS â Dubai round trip"},long:{label:"Long-haul Economy",cpm:1.2,example:"AMS â New York round trip"},premium:{label:"Long-haul Premium Economy",cpm:1.5,example:"AMS â Tokyo round trip"},business:{label:"Business Class",cpm:2,example:"AMS â New York in Business"}},Da=[{min:2e3,max:3999,bonus:0,label:"No bonus"},{min:4e3,max:21999,bonus:.5,label:"50% bonus"},{min:22e3,max:49999,bonus:.6,label:"60% bonus"},{min:5e4,max:1e5,bonus:.8,label:"80% bonus"}],sn=[{id:"fb-platinum",name:"Flying Blue Amex Platinum",milesPerEuro:1.5,welcomeBonus:4e4,welcomeSpend:4e3,xpBonus:60,monthlyFee:55,color:"from-slate-700 to-slate-900",referralUrl:"https://americanexpress.com/nl-nl/referral/fb-platinum?ref=rEMCODtnU7&XLINK=MYCP"},{id:"fb-gold",name:"Flying Blue Amex Gold",milesPerEuro:1,welcomeBonus:2e4,welcomeSpend:4e3,xpBonus:30,monthlyFee:16.5,color:"from-yellow-600 to-yellow-800",referralUrl:"https://americanexpress.com/nl-nl/referral/fb-platinum?ref=rEMCODtnU7&XLINK=MYCP"},{id:"fb-silver",name:"Flying Blue Amex Silver",milesPerEuro:.8,welcomeBonus:2500,welcomeSpend:0,xpBonus:10,monthlyFee:0,color:"from-gray-400 to-gray-600",referralUrl:"https://americanexpress.com/nl-nl/creditcard/flying-blue-silver-card/"}];function rx({onBack:t}){const[s,a]=d.useState(""),[n,l]=d.useState("europe"),[r,i]=d.useState(!1),x=parseInt(s)||0,c=tn[n],u=(g=>{if(g<2e3)return{cost:g*.026,bonus:0,totalMiles:g,tier:"Minimum 2,000 miles"};const S=Da.find(w=>g>=w.min&&g<=w.max)||Da[Da.length-1];return{cost:Math.ceil(g/(1+S.bonus))*.026,bonus:S.bonus,totalMiles:g,tier:S.label}})(x),m=x*(c.cpm/100),p=x>0?u.cost/x*100:0,h=p<c.cpm,b=()=>{x>=2e3&&i(!0)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900",children:[e.jsx("header",{className:"border-b border-slate-700/50 bg-slate-900/80 backdrop-blur-sm sticky top-0 z-50",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(It,{size:20}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"text-blue-400",size:24}),e.jsx("span",{className:"text-lg font-semibold text-white",children:"Miles Calculator"})]}),e.jsx("div",{className:"w-16"})]})})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-8 sm:py-12",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-4",children:"Should you buy Flying Blue Miles?"}),e.jsx("p",{className:"text-lg text-slate-400 max-w-2xl mx-auto",children:"Find out if purchasing miles is worth it for your next trip â or if there's a smarter way to earn them."})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl p-6 sm:p-8 mb-8",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"How many miles do you need?"}),e.jsx("input",{type:"number",value:s,onChange:g=>{a(g.target.value),i(!1)},placeholder:"e.g. 25000",min:"2000",step:"1000",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-600 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Minimum 2,000 miles"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"What will you use them for?"}),e.jsx("select",{value:n,onChange:g=>{l(g.target.value),i(!1)},className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg appearance-none cursor-pointer",children:Object.entries(tn).map(([g,S])=>e.jsx("option",{value:g,children:S.label},g))}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:c.example})]})]}),e.jsx("button",{onClick:b,disabled:x<2e3,className:"w-full py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 disabled:from-slate-600 disabled:to-slate-700 disabled:cursor-not-allowed text-white font-semibold rounded-xl transition-all text-lg",children:"Calculate"})]}),r&&x>=2e3&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:`rounded-2xl p-6 sm:p-8 border ${h?"bg-emerald-900/30 border-emerald-700/50":"bg-amber-900/30 border-amber-700/50"}`,children:[e.jsxs("div",{className:"flex items-start gap-4",children:[h?e.jsx(Qt,{className:"text-emerald-400 flex-shrink-0 mt-1",size:28}):e.jsx(_e,{className:"text-amber-400 flex-shrink-0 mt-1",size:28}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${h?"text-emerald-300":"text-amber-300"}`,children:h?"Buying could be worth it!":"Buying is NOT worth it"}),e.jsx("p",{className:"text-slate-300",children:h?`For ${c.label.toLowerCase()}, you'd get more value than you pay.`:`For ${c.label.toLowerCase()}, you'd pay more than the miles are worth.`})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Purchase cost"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:["â¬",u.cost.toFixed(0)]}),e.jsx("p",{className:"text-xs text-slate-500",children:u.tier})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Redemption value"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:["~â¬",m.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["at ",c.cpm," CPM"]})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4",children:[e.jsxs("p",{className:"text-sm text-slate-400 mb-1",children:["You ",h?"save":"lose"]}),e.jsxs("p",{className:`text-2xl font-bold ${h?"text-emerald-400":"text-red-400"}`,children:["â¬",Math.abs(m-u.cost).toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[p.toFixed(2)," CPM effective"]})]})]})]}),!h&&e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Bt,{className:"text-blue-400",size:24}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Smarter: Earn miles with daily spending"})]}),e.jsxs("p",{className:"text-slate-400 mb-6",children:["Instead of buying ",x.toLocaleString()," miles for â¬",u.cost.toFixed(0),", consider a Flying Blue credit card. You'll earn miles on every purchase â and get a welcome bonus."]}),e.jsx("div",{className:"grid gap-4",children:sn.map(g=>{const S=g.welcomeBonus>=x?g.welcomeSpend:g.welcomeSpend+Math.ceil((x-g.welcomeBonus)/g.milesPerEuro);return e.jsx("a",{href:g.referralUrl,target:"_blank",rel:"noopener noreferrer",className:"block bg-gradient-to-r hover:scale-[1.02] transition-transform",children:e.jsxs("div",{className:`bg-gradient-to-r ${g.color} rounded-xl p-5 border border-white/10`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold text-white",children:g.name}),e.jsx(Es,{size:16,className:"text-white/60"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60",children:"Welcome bonus"}),e.jsxs("p",{className:"text-white font-medium",children:[g.welcomeBonus.toLocaleString()," miles"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60",children:"Miles per â¬"}),e.jsx("p",{className:"text-white font-medium",children:g.milesPerEuro})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60",children:"Monthly fee"}),e.jsx("p",{className:"text-white font-medium",children:g.monthlyFee===0?"Free":`â¬${g.monthlyFee}`})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-white/60",children:["Spend to reach ",x.toLocaleString()]}),e.jsxs("p",{className:"text-white font-medium",children:["â¬",S.toLocaleString()]})]})]})]})},g.id)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-4",children:"ð³ Card offers available in Netherlands. We may receive a referral bonus â this doesn't affect your offer."})]}),h&&e.jsx("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-2xl p-6",children:e.jsxs("p",{className:"text-slate-400 text-sm",children:[e.jsx(Bt,{className:"inline mr-2 text-blue-400",size:16}),e.jsx("strong",{className:"text-slate-300",children:"Tip:"})," Even when buying makes sense, a"," ",e.jsx("a",{href:sn[0].referralUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Flying Blue credit card"})," ","earns you miles on everyday purchases â building your balance for the next trip."]})}),e.jsxs("div",{className:"text-center pt-4",children:[e.jsx("p",{className:"text-slate-400 mb-4",children:"Want to track your Flying Blue status and optimize your strategy?"}),e.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors",children:[e.jsx(le,{size:18}),"Try SkyStatus Pro â Free"]})]})]}),!r&&e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 mt-8",children:[e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-xl p-5",children:[e.jsx(le,{className:"text-blue-400 mb-3",size:24}),e.jsx("h3",{className:"font-medium text-white mb-2",children:"Current promo"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Up to 80% bonus miles when buying 50,000+ miles. Valid until Dec 22, 2025."})]}),e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-xl p-5",children:[e.jsx(Ss,{className:"text-emerald-400 mb-3",size:24}),e.jsx("h3",{className:"font-medium text-white mb-2",children:"How we calculate"}),e.jsx("p",{className:"text-sm text-slate-400",children:"We compare your purchase cost to the typical redemption value for your trip type."})]}),e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-xl p-5",children:[e.jsx(Bt,{className:"text-amber-400 mb-3",size:24}),e.jsx("h3",{className:"font-medium text-white mb-2",children:"Honest advice"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Buying miles is rarely the best deal. We'll tell you when earning is smarter."})]})]})]}),e.jsx("footer",{className:"border-t border-slate-800 py-8 mt-12",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 text-center",children:e.jsxs("p",{className:"text-slate-500 text-sm",children:["Built by frequent flyers, for frequent flyers."," ",e.jsx("button",{onClick:t,className:"text-blue-400 hover:text-blue-300",children:"SkyStatus Pro"})]})})})]})}const Ba=[{value:"Silver",label:"Silver",tagline:"The Newcomer",colorActive:"bg-slate-100 text-slate-700 border-slate-400 ring-slate-200",colorInactive:"bg-slate-800/50 text-slate-400 border-slate-700 hover:bg-slate-700/50 hover:text-slate-300",icon:e.jsx(De,{size:14})},{value:"Gold",label:"Gold",tagline:"The Regular",colorActive:"bg-amber-100 text-amber-700 border-amber-400 ring-amber-200",colorInactive:"bg-slate-800/50 text-slate-400 border-slate-700 hover:bg-slate-700/50 hover:text-amber-400",icon:e.jsx(De,{size:14})},{value:"Platinum",label:"Platinum",tagline:"Road Warrior",colorActive:"bg-blue-100 text-blue-700 border-blue-400 ring-blue-200",colorInactive:"bg-slate-800/50 text-slate-400 border-slate-700 hover:bg-slate-700/50 hover:text-blue-400",icon:e.jsx(De,{size:14})},{value:"Ultimate",label:"Ultimate",tagline:"The Elite",colorActive:"bg-violet-100 text-violet-700 border-violet-400 ring-violet-200",colorInactive:"bg-slate-800/50 text-slate-400 border-slate-700 hover:bg-slate-700/50 hover:text-violet-400",icon:e.jsx(ze,{size:14})}],ix=({isDemoMode:t,demoStatus:s,onSetDemoStatus:a,onExitDemo:n,onCreateAccount:l})=>{const[r,i]=d.useState(!1),[x,c]=d.useState(!1),[o,u]=d.useState(!1),{trackDemoStatus:m,trackExitDemo:p}=rt();if(!t)return null;const h=Ba.find(S=>S.value===s),b=S=>{S!==s&&(m(s,S),u(!0),setTimeout(()=>{a(S),setTimeout(()=>u(!1),150)},150))},g=()=>{p("create_account"),n(),l&&l()};return r?e.jsxs("button",{onClick:()=>i(!1),className:"fixed bottom-20 lg:bottom-4 right-4 z-[60] bg-slate-900/95 backdrop-blur-md text-white px-4 py-2.5 rounded-xl shadow-xl border border-slate-700 flex items-center gap-2 hover:bg-slate-800 transition-all group",children:[e.jsx("div",{className:"p-1 bg-amber-500/20 rounded-lg",children:e.jsx(Be,{size:14,className:"text-amber-400"})}),e.jsxs("span",{className:"text-sm font-medium",children:["Demo: ",s]}),e.jsx(cs,{size:14,className:"text-slate-500 group-hover:text-white transition-colors"})]}):e.jsxs(e.Fragment,{children:[x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[70] lg:hidden",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed bottom-0 inset-x-0 z-[75] lg:hidden animate-in slide-in-from-bottom-4 duration-200",children:e.jsxs("div",{className:"bg-slate-900 rounded-t-3xl p-6 border-t border-slate-700",children:[e.jsx("div",{className:"w-12 h-1 bg-slate-700 rounded-full mx-auto mb-6"}),e.jsx("h3",{className:"text-white font-bold mb-4",children:"Select Status Level"}),e.jsx("div",{className:"space-y-2",children:Ba.map(S=>e.jsxs("button",{onClick:()=>{b(S.value),c(!1)},className:`w-full flex items-center justify-between p-4 rounded-xl border-2 transition-all ${s===S.value?S.colorActive+" ring-2":"bg-slate-800 text-slate-300 border-slate-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[S.icon,e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-semibold",children:S.label}),e.jsx("p",{className:"text-xs opacity-70",children:S.tagline})]})]}),s===S.value&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-current"})]},S.value))}),e.jsx("button",{onClick:()=>c(!1),className:"w-full mt-4 py-3 text-slate-400 text-sm",children:"Cancel"})]})})]}),e.jsx("div",{className:"fixed bottom-16 lg:bottom-0 inset-x-0 z-[60] p-4 pointer-events-none",children:e.jsx("div",{className:"max-w-3xl mx-auto pointer-events-auto",children:e.jsxs("div",{className:`bg-slate-900/95 backdrop-blur-md rounded-2xl shadow-2xl border border-slate-700/50 overflow-hidden transition-opacity duration-150 ${o?"opacity-70":"opacity-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-br from-amber-500/20 to-orange-500/20 rounded-lg",children:e.jsx(Be,{size:16,className:"text-amber-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-bold text-sm",children:"Demo Mode"}),e.jsx("span",{className:"hidden sm:inline text-slate-500 text-xs ml-2",children:"Experience SkyStatus"})]})]}),e.jsx("button",{onClick:()=>i(!0),className:"p-1.5 text-slate-500 hover:text-white hover:bg-slate-800 rounded-lg transition-all",title:"Minimize",children:e.jsx(Ce,{size:16})})]}),e.jsxs("div",{className:"hidden sm:block px-5 py-4",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-3 font-medium",children:"Experience SkyStatus as:"}),e.jsx("div",{className:"flex gap-2",children:Ba.map(S=>e.jsx("button",{onClick:()=>b(S.value),className:`flex-1 py-2.5 px-3 rounded-xl text-sm font-semibold border-2 transition-all ${s===S.value?S.colorActive+" ring-2":S.colorInactive}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[S.icon,S.label]})},S.value))})]}),e.jsx("div",{className:"sm:hidden px-5 py-4",children:e.jsxs("button",{onClick:()=>c(!0),className:`w-full flex items-center justify-between p-3 rounded-xl border-2 transition-all ${h?.colorActive||""} ring-2`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h?.icon,e.jsx("span",{className:"font-semibold",children:h?.label}),e.jsxs("span",{className:"text-xs opacity-70",children:["â¢ ",h?.tagline]})]}),e.jsx(we,{size:16})]})}),e.jsxs("div",{className:"flex items-center justify-between px-5 py-3 bg-slate-800/50 border-t border-slate-800",children:[e.jsx("p",{className:"text-slate-500 text-xs hidden sm:block",children:"Ready to track your own Flying Blue status?"}),e.jsx("p",{className:"text-slate-500 text-xs sm:hidden",children:"Track your own status"}),e.jsxs("button",{onClick:g,className:"flex items-center gap-1.5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white px-4 py-2 rounded-xl text-sm font-semibold transition-all shadow-lg shadow-blue-500/25",children:[e.jsx(Jt,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Create Account"}),e.jsx("span",{className:"sm:hidden",children:"Sign Up"}),e.jsx(we,{size:14})]})]})]})})})]})},ox=({message:t,type:s="success",duration:a=4e3,onClose:n})=>{const[l,r]=d.useState(!0),[i,x]=d.useState(!1);d.useEffect(()=>{const m=setTimeout(()=>{x(!0),setTimeout(n,300)},a);return()=>clearTimeout(m)},[a,n]);const c=()=>{x(!0),setTimeout(n,300)},o={success:e.jsx(Qt,{className:"text-emerald-500",size:20}),error:e.jsx(dn,{className:"text-red-500",size:20}),info:e.jsx(lt,{className:"text-blue-500",size:20})},u={success:"bg-emerald-50 border-emerald-200",error:"bg-red-50 border-red-200",info:"bg-blue-50 border-blue-200"};return e.jsxs("div",{className:`
        fixed bottom-6 right-6 z-50
        flex items-center gap-3 
        px-4 py-3 rounded-xl border shadow-lg
        ${u[s]}
        transition-all duration-300 ease-out
        ${i?"opacity-0 translate-y-2":"opacity-100 translate-y-0"}
        animate-in slide-in-from-bottom-4
      `,children:[o[s],e.jsx("span",{className:"text-slate-700 font-medium pr-2",children:t}),e.jsx("button",{onClick:c,className:"p-1 hover:bg-black/5 rounded-lg transition-colors",children:e.jsx(Ce,{size:16,className:"text-slate-400"})})]})};let cx=0;const dx=()=>{const[t,s]=d.useState([]),a=(r,i="success")=>{const x=++cx;s(c=>[...c,{message:r,type:i,id:x}])},n=r=>{s(i=>i.filter(x=>x.id!==r))};return{showToast:a,ToastContainer:()=>e.jsx(e.Fragment,{children:t.map((r,i)=>e.jsx("div",{style:{bottom:`${24+i*72}px`},className:"fixed right-6 z-50",children:e.jsx(ox,{message:r.message,type:r.type,onClose:()=>n(r.id)})},r.id))})}},xx="pdf-import-v1",an=`skystatus_maintenance_notice_${xx}`,mx=({isActiveUser:t})=>{const[s,a]=d.useState(!1),[n,l]=d.useState(!1);d.useEffect(()=>{if(t&&!localStorage.getItem(an)){const x=setTimeout(()=>a(!0),500);return()=>clearTimeout(x)}},[t]);const r=()=>{l(!0),setTimeout(()=>{localStorage.setItem(an,new Date().toISOString()),a(!1)},300)};return s?e.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 transition-opacity duration-300 ${n?"opacity-0":"opacity-100"}`,style:{backgroundColor:"rgba(15, 23, 42, 0.85)"},children:e.jsxs("div",{className:`relative w-full max-w-lg bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl shadow-2xl border border-slate-700 overflow-hidden transform transition-all duration-300 ${n?"scale-95 opacity-0":"scale-100 opacity-100"}`,children:[e.jsx("div",{className:"h-1.5 bg-gradient-to-r from-amber-500 via-orange-500 to-amber-500"}),e.jsx("button",{onClick:r,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":"Sluiten",children:e.jsx(Ce,{className:"w-5 h-5"})}),e.jsxs("div",{className:"p-6 sm:p-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 bg-amber-500/10 rounded-full flex items-center justify-center",children:e.jsx(wi,{className:"w-10 h-10 text-amber-500"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-slate-800 rounded-full flex items-center justify-center border-2 border-amber-500",children:e.jsx(Ee,{className:"w-4 h-4 text-amber-500"})})]})}),e.jsx("h2",{className:"text-2xl font-bold text-white text-center mb-2",children:"PDF Import Under Maintenance"}),e.jsx("p",{className:"text-slate-400 text-center mb-6",children:"We're rebuilding this feature for better accuracy"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(_e,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white mb-1",children:"Known Issues"}),e.jsxs("p",{className:"text-sm text-slate-300",children:["The PDF import currently has problems correctly detecting your ",e.jsx("strong",{className:"text-amber-400",children:"Flying Blue status"})," and ",e.jsx("strong",{className:"text-amber-400",children:"qualification cycle"})," for all users."]})]})]})}),e.jsx("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-emerald-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white mb-1",children:"What Still Works"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Flight data and miles transactions are usually imported correctly. You can still use manual entry for full accuracy."})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:r,className:"w-full py-3 px-4 bg-gradient-to-r from-sky-500 to-blue-600 hover:from-sky-400 hover:to-blue-500 text-white font-semibold rounded-xl transition-all duration-200 shadow-lg shadow-sky-500/25",children:"I Understand, Continue"}),e.jsx("p",{className:"text-xs text-slate-500 text-center",children:"We're working hard to fix this. Thank you for your patience! ð"})]})]})]})}):null};function ux(){return So(),null}function hx(){const{user:t,loading:s}=Us(),{showToast:a,ToastContainer:n}=dx(),{state:l,actions:r,meta:i}=jo(),x=ln(),c=Zr(),[o,u]=d.useState("dashboard"),[m,p]=d.useState(null),[h,b]=d.useState(!1),[g,S]=d.useState(!1),[P,C]=d.useState(!1),[w,f]=d.useState(!1),[D,_]=d.useState(!1),[N,F]=d.useState(null);d.useEffect(()=>{const k=x.pathname;k==="/privacy"?(p("privacy"),window.scrollTo(0,0)):k==="/terms"?(p("terms"),window.scrollTo(0,0)):k==="/faq"||k==="/help"?(p("faq"),window.scrollTo(0,0)):k==="/about"?(p("about"),window.scrollTo(0,0)):k==="/contact"?(p("contact"),window.scrollTo(0,0)):k==="/calculator"?(p("calculator"),window.scrollTo(0,0)):k==="/cookies"?(p("cookies"),window.scrollTo(0,0)):p(null)},[x.pathname]);const j=d.useMemo(()=>Yt(l.qualificationSettings??null),[l.qualificationSettings]),{cycles:v}=d.useMemo(()=>Lt(l.baseXpData,l.xpRollover,l.flights,l.manualLedger,j),[l.baseXpData,l.xpRollover,l.flights,l.manualLedger,j]),A=d.useMemo(()=>us(v),[v]),R=(k,I,y,U,M)=>{const z=k.length;r.handlePdfImport(k,I,y,U,M);const K=U?.startingXP?` (${U.startingXP} XP rollover)`:"",Y=U?` Â· Cycle: ${U.startingStatus} from ${U.cycleStartMonth}${K}`:"",O=M?Object.values(M).reduce((J,q)=>J+q,0):0,V=O>0?` (+${O} bonus XP)`:"";a(`Merged ${z} flights from PDF${V}${Y}. Duplicates skipped. Use Data Settings to undo.`,"success")},X=()=>{c("/"),p(null)};if(m==="privacy")return e.jsxs(xt,{children:[e.jsx(Zd,{onBack:X}),e.jsx(mt,{})]});if(m==="terms")return e.jsxs(xt,{children:[e.jsx(Qd,{onBack:X}),e.jsx(mt,{})]});if(m==="faq")return e.jsxs(xt,{children:[e.jsx(lx,{onBack:X}),e.jsx(mt,{})]});if(m==="about")return e.jsxs(xt,{children:[e.jsx(ex,{onBack:X}),e.jsx(mt,{})]});if(m==="contact")return e.jsxs(xt,{children:[e.jsx(tx,{onBack:X}),e.jsx(mt,{})]});if(m==="cookies")return e.jsxs(xt,{children:[e.jsx(sx,{onBack:X}),e.jsx(mt,{})]});if(m==="calculator")return e.jsxs(xt,{children:[e.jsx(rx,{onBack:X}),e.jsx(mt,{})]});if(s)return e.jsxs(xt,{children:[e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Qe,{size:48,className:"animate-spin text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"Loading..."})]})}),e.jsx(mt,{})]});if(!t&&!i.isDemoMode&&!i.isLocalMode)return h?e.jsxs(xt,{children:[e.jsx(Jd,{onDemoMode:r.handleEnterDemoMode,onLocalMode:r.handleEnterLocalMode,onBack:()=>b(!1)}),e.jsx(mt,{})]}):e.jsxs(xt,{children:[e.jsx(nx,{onGetStarted:()=>b(!0),onDemo:r.handleEnterDemoMode}),e.jsx(mt,{})]});if(i.isLoading)return e.jsxs(xt,{children:[e.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Qe,{size:48,className:"animate-spin text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-500",children:"Loading your portfolio..."})]})}),e.jsx(mt,{})]});const L=()=>e.jsxs("div",{className:"bg-gradient-to-r from-brand-50 to-blue-50 border border-brand-200 rounded-2xl p-4 md:p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2.5 bg-brand-100 rounded-xl",children:e.jsx(wt,{className:"text-brand-600",size:22})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-800",children:"Have your Flying Blue PDF?"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Import all your ",o==="addFlight"?"flights":"miles transactions"," at once instead of adding them manually",e.jsx("button",{onClick:()=>f(k=>!k),className:"ml-2 text-brand-600 hover:text-brand-700 font-medium underline underline-offset-2",children:w?"Hide instructions":"How to get it?"})]})]})]}),e.jsxs("button",{onClick:()=>C(!0),className:"flex-shrink-0 flex items-center gap-2 bg-brand-600 hover:bg-brand-700 text-white px-5 py-2.5 rounded-xl font-semibold text-sm transition-colors",children:[e.jsx(St,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Import PDF"}),e.jsx("span",{className:"sm:hidden",children:"Import"})]})]}),w&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-brand-200 space-y-3",children:[e.jsxs("ol",{className:"space-y-2 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"flex-shrink-0 w-5 h-5 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),e.jsxs("span",{children:["Log in to ",e.jsx("a",{href:"https://www.flyingblue.com",target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 font-semibold hover:underline",children:"flyingblue.com"})]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"flex-shrink-0 w-5 h-5 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),e.jsxs("span",{children:["Go to ",e.jsx("strong",{children:"My Account"})," â ",e.jsx("strong",{children:"Activity overview"})]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"flex-shrink-0 w-5 h-5 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),e.jsxs("span",{className:"text-amber-700",children:[e.jsx("strong",{children:'Click "More"'})," repeatedly until ",e.jsx("em",{children:"all"})," your activities are visible"]})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"flex-shrink-0 w-5 h-5 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-xs font-bold",children:"4"}),e.jsxs("span",{children:["Scroll back up and click ",e.jsx("strong",{children:'"Download"'})]})]})]}),e.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[e.jsx("strong",{children:"â ï¸ Important:"}),` Flying Blue only exports what's visible on screen. If you skip the "More" step, your PDF will be incomplete!`]})]})]}),G=()=>{switch(o){case"dashboard":return e.jsx($l,{state:{milesData:l.milesData,xpData:l.xpData,redemptions:l.redemptions,xpRollover:l.xpRollover,currentMonth:l.currentMonth,flights:l.flights,targetCPM:l.targetCPM,manualLedger:l.manualLedger,qualificationSettings:l.qualificationSettings,displayXP:l.displayXP,displayUXP:l.displayUXP,displayMiles:l.displayMiles,displayStatus:l.displayStatus,hasPdfBaseline:!!l.pdfBaseline},navigateTo:u,onUpdateCurrentMonth:r.setCurrentMonth,onPdfImport:R,demoStatus:i.isDemoMode?i.demoStatus:void 0});case"addFlight":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{}),e.jsx(ad,{onApply:r.handleFlightIntakeApply,currentStatus:l.currentStatus}),e.jsx(Wc,{flights:l.flights,onChange:r.handleFlightsUpdate,xpData:l.xpData,currentRollover:l.xpRollover})]});case"addMiles":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{}),e.jsx(od,{milesData:l.milesData,onUpdate:r.handleManualLedgerUpdate,currentMonth:l.currentMonth})]});case"miles":return e.jsx(Pc,{data:l.milesData,onUpdate:r.handleManualLedgerUpdate,currentMonth:l.currentMonth,onUpdateCurrentMonth:r.setCurrentMonth,targetCPM:l.targetCPM,onUpdateTargetCPM:r.handleTargetCPMUpdate,redemptions:l.redemptions});case"xp":return e.jsx(Bc,{data:l.xpData,baseData:l.baseXpData,onUpdate:r.setBaseXpData,rollover:l.xpRollover,onUpdateRollover:r.handleXPRolloverUpdate,uxpRollover:l.uxpRollover,onUpdateUxpRollover:r.handleUxpRolloverUpdate,flights:l.flights,onUpdateFlights:r.handleFlightsUpdate,manualLedger:l.manualLedger,onUpdateManualLedger:r.handleManualXPLedgerUpdate,qualificationSettings:l.qualificationSettings,onUpdateQualificationSettings:r.handleQualificationSettingsUpdate,demoStatus:i.isDemoMode?i.demoStatus:void 0,displayXP:l.displayXP,displayUXP:l.displayUXP,hasPdfBaseline:!!l.pdfBaseline});case"redemption":return e.jsx(Rc,{redemptions:l.redemptions,onUpdate:r.handleRedemptionsUpdate,baselineCpm:r.calculateGlobalCPM(),targetCpm:l.targetCPM});case"analytics":return e.jsx(Tc,{xpData:l.xpData,rollover:l.xpRollover,redemptions:l.redemptions,milesData:l.milesData,currentMonth:l.currentMonth,targetCPM:l.targetCPM});case"mileageRun":return e.jsx(Nd,{xpData:l.xpData,rollover:l.xpRollover,flights:l.flights,manualLedger:l.manualLedger,qualificationSettings:l.qualificationSettings,demoStatus:i.isDemoMode?i.demoStatus:void 0,displayXP:l.displayXP,hasPdfBaseline:!!l.pdfBaseline});case"profile":return e.jsx($d,{flights:l.flights,xpData:l.xpData,milesData:l.milesData,currentStatus:l.currentStatus,qualificationSettings:l.qualificationSettings,onOpenSettings:()=>S(!0),userEmail:t?.email});default:return e.jsx($l,{state:{milesData:l.milesData,xpData:l.xpData,redemptions:l.redemptions,xpRollover:l.xpRollover,currentMonth:l.currentMonth,flights:l.flights,targetCPM:l.targetCPM,manualLedger:l.manualLedger,qualificationSettings:l.qualificationSettings,displayXP:l.displayXP,displayUXP:l.displayUXP,displayMiles:l.displayMiles,displayStatus:l.displayStatus,hasPdfBaseline:!!l.pdfBaseline},navigateTo:u,onUpdateCurrentMonth:r.setCurrentMonth,onPdfImport:R,demoStatus:i.isDemoMode?i.demoStatus:void 0})}};return e.jsxs(xt,{children:[e.jsx(ux,{}),e.jsxs(Po,{currency:l.currency,children:[e.jsxs(Lo,{currentView:o,onNavigate:u,onOpenSettings:()=>S(!0),isDemoMode:i.isDemoMode||i.isLocalMode,isLocalMode:i.isLocalMode,children:[i.isSaving&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-slate-900 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 z-50",children:[e.jsx(Qe,{size:16,className:"animate-spin"}),e.jsx("span",{className:"text-sm",children:"Saving..."})]}),G()]}),t&&!i.onboardingCompleted&&!i.isDemoMode&&!i.isLocalMode&&e.jsx(Wd,{userEmail:t.email||"",isReturningUser:l.flights.length>0,existingData:{currency:l.currency,homeAirport:l.homeAirport,currentStatus:l.currentStatus,currentXP:l.qualificationSettings?.startingXP||0,currentUXP:l.currentUXP,rolloverXP:l.xpRollover,milesBalance:l.milesBalance,ultimateCycleType:l.qualificationSettings?.ultimateCycleType||"qualification",targetCPM:l.targetCPM,emailConsent:i.emailConsent},onComplete:k=>{r.handleOnboardingComplete(k),k.pdfImported?a(`Imported ${k.pdfFlightsCount} flights.`,"success"):l.flights.length>0?a("Settings updated!","success"):a("Welcome to SkyStatus Pro!","success")},onPdfImport:()=>_(!0),pdfImportResult:N,onSkip:()=>{r.handleOnboardingComplete({currency:l.currency||"EUR",homeAirport:l.homeAirport||null,currentStatus:l.currentStatus||"Explorer",currentXP:l.qualificationSettings?.startingXP||0,currentUXP:l.currentUXP||0,rolloverXP:l.xpRollover||0,milesBalance:l.milesBalance||0,ultimateCycleType:l.qualificationSettings?.ultimateCycleType||"qualification",targetCPM:l.targetCPM||.012,emailConsent:i.emailConsent||!1,isReturningUser:l.flights.length>0})}}),e.jsx(As,{isOpen:D,onClose:()=>_(!1),onImport:(k,I,y,U,M)=>{r.handlePdfImport(k,I,y,U,M);const z=k.reduce((Y,O)=>Y+(O.earnedXP||0),0),K=I.reduce((Y,O)=>Y+O.miles_subscription+O.miles_amex+O.miles_flight+O.miles_other-O.miles_debit,0);F({flightsCount:k.length,xpDetected:z,statusDetected:U?.startingStatus||null,milesBalance:Math.max(0,K)}),_(!1)},existingFlights:l.flights,existingMiles:l.baseMilesData,existingQualificationSettings:l.qualificationSettings,existingStatus:l.currentStatus,existingActiveCycleStart:A?.startDate?.slice(0,7)||null,existingRolloverXP:A?.rolloverIn??null}),e.jsx(As,{isOpen:P,onClose:()=>C(!1),onImport:(k,I,y,U,M)=>{R(k,I,y,U,M)},existingFlights:l.flights,existingMiles:l.baseMilesData,existingQualificationSettings:l.qualificationSettings,existingStatus:l.currentStatus,existingActiveCycleStart:A?.startDate?.slice(0,7)||null,existingRolloverXP:A?.rolloverIn??null}),e.jsx(Kd,{isOpen:g,onClose:()=>S(!1),data:{baseMilesData:l.baseMilesData,baseXpData:l.baseXpData,redemptions:l.redemptions,flights:l.flights,xpRollover:l.xpRollover,currentMonth:l.currentMonth,targetCPM:l.targetCPM,currency:l.currency,manualLedger:l.manualLedger,qualificationSettings:l.qualificationSettings,homeAirport:l.homeAirport},setters:{setBaseMilesData:r.setBaseMilesData,setBaseXpData:r.setBaseXpData,setRedemptions:r.setRedemptions,setFlights:r.setFlights,setXpRollover:r.setXpRollover,setCurrentMonth:r.setCurrentMonth,setTargetCPM:r.setTargetCPM,setCurrency:r.handleCurrencyUpdate,setManualLedger:r.setManualLedger,setQualificationSettings:r.setQualificationSettings},onReset:r.handleStartEmpty,onLoadDemo:r.handleLoadDemo,onStartOver:r.handleStartOver,onRerunOnboarding:r.handleRerunOnboarding,onUndoImport:r.handleUndoImport,canUndoImport:r.canUndoImport,importBackupInfo:r.importBackupInfo,emailConsent:i.emailConsent,onEmailConsentChange:r.handleEmailConsentChange,isDemoMode:i.isDemoMode||i.isLocalMode,isLocalMode:i.isLocalMode,onExitDemo:r.handleExitDemoMode,isLoggedIn:!!t,markDataChanged:r.markDataChanged,forceSave:r.forceSave,handleJsonImport:r.handleJsonImport,showToast:a}),e.jsx(n,{}),e.jsx(mt,{}),e.jsx(mx,{isActiveUser:!!t||i.isLocalMode}),e.jsx(ix,{isDemoMode:i.isDemoMode,demoStatus:i.demoStatus,onSetDemoStatus:r.handleSetDemoStatus,onExitDemo:r.handleExitDemoMode,onCreateAccount:()=>b(!0)})]})]})}Ia.createRoot(document.getElementById("root")).render(e.jsx(Ue.StrictMode,{children:e.jsx(Qr,{children:e.jsx(Bi,{children:e.jsx(hx,{})})})}));
